!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=208)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRenderingRegionKey=t.isPivotTablePhase2Enabled=t.updateCellMergeInformation=t.isSubPixelRenderingEnabled=t.getDynamicImageInformationFromCell=t.getDynamicImages=t.extendHighContrastScheme=t.extendRenderingContext=t.areTwoRectsEqual=t.isPointInRect=t.doRangesIntersect=t.intersects1D=t.isFontContainsVerticalAlignment=t.rgbToColorHex=t.getModelColumnIndex=t.getModelRowIndex=t.isDefined=t.prepareTextRunRanges=t.removeHardBreaks=t.shouldRenderFormulaOnCell=t.updateCellText=t.getDisplayText=t.getFormattedTextForMetadata=t.getFormattedText=t.isHighContrastMode=t.hasWorkbookBackgroundColor=t.getWorkbookBackgroundColor=t.setCellCachedDisplayText=t.getActualFontSizeFromFont=t.getActualFontSize=t.getTextRunText=t.getShrunkFontSize=t.cellHasShrinkToFit=t.getCellPositionInArray=t.getCellFont=t.getColumnWidth=t.setCellAndSpannedOverCellsDirty=t.initializeCellCachedObjects=t.isCellAdjacentToMergedCell=t.getLinePixelTranslation=t.throwError=t.verifyCellStyleAndFont=t.getFontLookupKey=t.getCellFontWeightStyle=t.getFontCssString=t.getFontCssStringFromFont=t.getFontCssStringFromCell=t.binarySearch=t.numbersComparer=t.verifyArgumentNotNull=void 0,t.registerCanvasHitRegionsFromCache=t.renderingRegionContainsDirtyCells=t.validateRenderingRegion=t.getDrawingOffsetXForRenderingRegion=t.incrementNumericVal=t.duplicateFont=t.duplicateBorderStyle=t.duplicateStyle=void 0;var r=n(1),i=n(28),o=n(3),a=n(7),l=n(9),s=n(86),d=n(132),u=n(18),c=n(11),g=n(32),h=n(26);function f(e,t,n){if(null==e)throw Error(n+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function m(e,t){return e-t}function p(e,t,n,r,i){for(var o=t,a=t+n-1;o<=a;){var l=o+(a-o>>1),s=i(e instanceof Array?e[l]:e.item(l),r);if(0===s)return l;s<0?o=l+1:a=l-1}return~o}function C(e,t,n){var r,o=y(e.Bold||!1,e.Italic||!1),a=null!==(r=null!=t?t:e.Size)&&void 0!==r?r:i.DefaultFontSizePt;return O(e)&&(a=d.getVerticalAlignmentFontSizeAdjusted(a)),v(n,o,a,e.FontName)}function v(e,t,n,r){var i=u.canonizeFontName(r);return e.ClientOnlyCache&&e.ClientOnlyCache.FallbackFonts&&e.ClientOnlyCache.FallbackFonts[T(i,n)]&&(i=g.DefaultFallbackFontName),t+" "+n+'pt "'+i+'"'}function y(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function T(e,t){return t+"pt "+u.canonizeFontName(e)}function S(e,t){if(f(e,"cell","getCellFont"),f(t.Styles,"Styles","getCellFont"),f(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var n=r.getCellStyle(t,e);e.CachedFont=r.getReferencedObjectById(n.FontID||0,t.Fonts)}return e.CachedFont}function F(e,t){var n=p(t,0,t.length,e,r.cellsPositionComparer);return n<0&&(n=~n),n}function x(e){return!e.PreviewText&&!e.DisplayFormula&&e.CachedStyle.ShrinkToFit&&!e.WrapText}function w(e){if(x(e))return e.ShrunkSize}function R(e,t,n){var r,i,o=x(e),a=o?e.ShrunkSize:t.Size;return O(t)&&!n&&(a=d.getVerticalAlignmentFontSizeAdjusted(a)),a<0&&l.setRenderingResultInfo("\n      actual font size < 0.\n      doesCellHaveShrinkToFit: "+o+",\n      cell.ShrunkSize: "+e.ShrunkSize+",\n      Font:\n        size: "+t.Size+";\n        fontName: "+u.getFontNameForLogging(t.FontName)+";\n        refCount: "+(t.RefCount||0)+";\n      cell.CachedStyle:\n        isHidden: "+(null===(r=e.CachedStyle)||void 0===r?void 0:r.IsHidden)+";\n        shrinkToFit: "+(null===(i=e.CachedStyle)||void 0===i?void 0:i.ShrinkToFit)+";\n      cell.Ifmt: "+(e.Ifmt||0)+";\n      cell.WrapText: "+e.WrapText+";\n    "),a}function b(e){return!a.isNullOrUndefined(e)}function I(e,t,n){var r;if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:null!==(r=t.CachedDisplayTextRuns)&&void 0!==r?r:t.TextRuns,Fonts:n.Fonts}}function A(e,t){if(e.PreviewText)return e.PreviewText;if(e.DisplayFormula)return e.FormulaInfo.Formula;if(c.shouldRenderVerticalText(e)&&e.Text&&e.OriginalText&&(n=e.Text,/^(#)+$/.test(n)))return e.OriginalText;var n;if(!L(e))return e.Text;if(a.isNullOrUndefined(e.CachedDisplayText))if(!a.isNullOrUndefined(e.Text)&&a.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0){var r=I(e.Text,e,t);!a.isNullOrUndefined(r)&&r.Text.indexOf(o.HardBreak)>=0&&(e.CachedDisplayTextRuns=function(e){var t=e.TextRuns,n=[],r=e.Text;D(t,r);for(var i=0,a=0;a<t.length;a++){var l=t[a];f(l.EndIndex,"EndIndex","getAdjustedTextRuns"),f(l.StartIndex,"StartIndex ","getAdjustedTextRuns");var s=l.StartIndex,d=l.EndIndex;i!==s&&(d+=i-s,s=i);for(var u=l.StartIndex;u<l.EndIndex;u++)r.charAt(u)!==o.HardBreak||e.WrapText||d--;n.push({StartIndex:s,EndIndex:d,FontID:l.FontID,CachedFont:l.CachedFont}),i=d}return n}(e)),e.CachedDisplayText=P(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function P(e){return-1!==e.indexOf(o.HardBreakCRLF)||-1!==e.indexOf(o.HardBreak)?e.replace(/\r\n|\n/g,""):e}function D(e,t){var n;if(void 0===(null===(n=e[0])||void 0===n?void 0:n.EndIndex))for(var r=0;r<e.length;r++){var i=e[r],o=r<e.length-1?e[r+1].StartIndex:t.length;i.EndIndex=o}}function M(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t}function O(e){return!a.isNullOrUndefined(e.VerticalAlign)&&e.VerticalAlign!==r.FontVerticalAlignment.None}function k(e,t,n,r){return!(t<n||r<e)}function L(e){var t,n=e.ValueType===r.CellValueType.Number,i=!a.isNullOrUndefined(e.Text)&&a.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(o.HardBreak)>=0&&e.Text!==e.CachedDisplayText,l=(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill;return n||i||l}function H(e){return a.isNullOrUndefined(e)?1:e+1}t.verifyArgumentNotNull=f,t.numbersComparer=m,t.binarySearch=p,t.getFontCssStringFromCell=function(e,t){return C(e.CachedFont,w(e),t)},t.getFontCssStringFromFont=C,t.getFontCssString=v,t.getCellFontWeightStyle=y,t.getFontLookupKey=T,t.verifyCellStyleAndFont=function(e,t,n){f(t,"cell",n),t.CachedStyle||r.getCellStyle(e,t),t.CachedFont||S(t,e)},t.throwError=function(e,t){throw Error(t+": "+e)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,n){f(n,"model","isCellAdjacentToMergedCell");for(var i=function(e,t,n){return[r.getCell(e-1,t,n),r.getCell(e+1,t,n),r.getCell(e,t-1,n),r.getCell(e,t+1,n)]}(e,t,n),o=0;o<i.length;o++)if(i[o]&&i[o].Merge)return!0;return!1},t.initializeCellCachedObjects=function(e,t,n){if(f(e.Styles,"styles","helpers.initCellCachedObjects"),f(e.Fonts,"fonts","helpers.initCellCachedObjects"),t.CachedStyle=r.getReferencedObjectById(t.StyleID||0,e.Styles),a.isNullOrUndefined(e.BorderStyles)||(t.CachedBorderStyle=r.getReferencedObjectById(t.BorderStyleID||0,e.BorderStyles)),t.CachedFont=r.getReferencedObjectById(t.CachedStyle.FontID||0,e.Fonts),t.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},!a.isNullOrUndefined(t.TextRuns))for(var i=0;i<t.TextRuns.length;i++){var o=t.TextRuns[i];o.CachedFont=r.getReferencedObjectById(o.FontID||0,e.Fonts)}t.CachedDisplayText=void 0,t.CachedDisplayTextRuns=void 0,n&&t.Text&&(t.CachedDisplayText=A(t,e))},t.setCellAndSpannedOverCellsDirty=function(e,t){var n=r.getModelClientCache(e);n.DirtyCellsKeys||(n.DirtyCellsKeys=[]),n.DirtyCellsKeys.push(r.getCellLookupKey(t.Row,t.Col));var i=F(t,e.Cells),o=r.getAllSpanningCellsKeys(e.Cells,t,i);n.DirtyCellsKeys=n.DirtyCellsKeys.concat(o)},t.getColumnWidth=function(e,t){if(f(t,"model","getColumnWidth"),f(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model. colIndex: "+e+", columnWidths.length: "+t.ColumnWidths.length);return t.ColumnWidths[e]},t.getCellFont=S,t.getCellPositionInArray=F,t.cellHasShrinkToFit=x,t.getShrunkFontSize=w,t.getTextRunText=function(e,t,n){var r=t[e].StartIndex,i=n.length;return e<t.length-1&&(i=t[e+1].StartIndex),n.substring(r,i)},t.getActualFontSize=function(e){return R(e,e.CachedFont,!0)},t.getActualFontSizeFromFont=R,t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t){return a.isNullOrUndefined(e)?b(t)?t:o.DefaultBackgroundColor:M(e.BackgroundColor)},t.hasWorkbookBackgroundColor=b,t.isHighContrastMode=function(e){return!a.isNullOrUndefined(e.highContrastScheme)},t.getFormattedText=I,t.getFormattedTextForMetadata=function(e,t,n){if(t.TextRuns&&n.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:n.Fonts}},t.getDisplayText=A,t.updateCellText=function(e,t,n){t.Text=n,L(t)&&(t.CachedDisplayText=A(t,e)),r.isAccAndCustomNumFmtApplicable(t)?s.updateNumFmtFromCell(t):t.NumFmt=void 0},t.shouldRenderFormulaOnCell=function(e,t){var n;return!(!t||!(null===(n=e.FormulaInfo)||void 0===n?void 0:n.Formula))&&(e.FormulaInfo.FormulaType===r.CellFormulaType.Formula||e.FormulaInfo.FormulaType===r.CellFormulaType.ArrayFormula&&e.FormulaInfo.IsArrayRoot)},t.removeHardBreaks=P,t.prepareTextRunRanges=D,t.isDefined=function(e){return void 0!==e},t.getModelRowIndex=function(e,t){return f(e,"model","getModelRowIndex"),f(e.RowNumbers,"RowNumbers","getModelRowIndex"),p(e.RowNumbers,0,e.RowNumbers.length,t,m)},t.getModelColumnIndex=function(e,t){return f(e,"model","getModelColumnIndex"),f(e.ColumnNumbers,"ColumnNumbers","getModelColumnIndex"),p(e.ColumnNumbers,0,e.ColumnNumbers.length,t,m)},t.rgbToColorHex=M,t.isFontContainsVerticalAlignment=O,t.intersects1D=k,t.doRangesIntersect=function(e,t){var n=k(e.FirstColumn,e.LastColumn,t.FirstColumn,t.LastColumn),r=k(e.FirstRow,e.LastRow,t.FirstRow,t.LastRow);return n&&r},t.isPointInRect=function(e,t){return k(t.x,t.x,e.x,e.x+e.width)&&k(t.y,t.y,e.y,e.y+e.height)},t.areTwoRectsEqual=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height==e.height},t.extendRenderingContext=function(e){f(e.zoom,"context.zoom","extendRenderingContext");var t=e;return t.scaleFactor=e.devicePixelRatio*e.zoom,t},t.extendHighContrastScheme=function(e,t){var n=t;n.HeaderPartialSelectionFontColor=r.PartialRowColSelectionHCFontColor,e.highContrastScheme=n},t.getDynamicImages=function(e,t){switch(t){case h.ImageType.Sparkline:return e.Sparklines;case h.ImageType.InCellImage:return e.InCellImages;default:throw Error("getDynamicImages: unsupported image type = "+t)}},t.getDynamicImageInformationFromCell=function(e,t){switch(t){case h.ImageType.Sparkline:return e.Sparkline;case h.ImageType.InCellImage:return e.InCellImage;default:throw Error("getDynamicImageInformationFromCell: unsupported image type = "+t)}},t.isSubPixelRenderingEnabled=function(){return function(){if(window&&window.navigator)return!(navigator.userAgent.indexOf("Edge/")>=0)&&navigator.userAgent.indexOf("Chrome/")>=0;return!1}()||function(){if(window&&window.navigator)return navigator.userAgent.indexOf(" Firefox/")>=0;return!1}()},t.updateCellMergeInformation=function(e,t,n){var r=t.Merge;if(r.SpansBlocks){r.HeightAdjustedForDrawing=Math.round(r.Height*n),r.WidthAdjustedForDrawing=Math.round(r.Width*n),r.OriginDeltaXAdjustedForDrawing=Math.round(r.OriginDeltaX*n),r.OriginDeltaYAdjustedForDrawing=Math.round(r.OriginDeltaY*n);var i=e.RowOffsets[t.Row]-r.OriginDeltaY;r.SpansNextBlockVertically=i+r.Height>e.BlockHeight;var o=e.ColumnOffsets[t.Col]-r.OriginDeltaX;r.SpansNextBlockHorizontally=o+r.Width>e.BlockWidth}},t.isPivotTablePhase2Enabled=function(e){return r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&r.isChangeGateEnabled(r.ChangeGate.PivotTablePhase2)},t.getRenderingRegionKey=function(e){return(e.startOffsetX<<10)+e.startOffsetY},t.duplicateStyle=function(e,t,n,i){var o={BackgroundColor:t.BackgroundColor,HorizontalAlignment:t.HorizontalAlignment||r.HorizontalAlignment.Automatic,ID:n||0,NamedStyleId:t.NamedStyleId||0,RefCount:i||0,VerticalAlignment:t.VerticalAlignment,Indentation:t.Indentation||0,IsUnlocked:t.IsUnlocked,IsHidden:t.IsHidden,ReadingOrder:t.ReadingOrder||r.ReadingOrderType.Context,FontID:t.FontID||0,ShrinkToFit:t.ShrinkToFit,Gradient:t.Gradient};if(e.Fonts){var a=r.getReferencedObjectById(t.FontID||0,e.Fonts);a.RefCount=H(a.RefCount||0)}return o},t.duplicateBorderStyle=function(e,t,n){for(var r=[],i=0;i<e.Borders.length;i++){var o=e.Borders[i],a={BorderLineStyle:o.BorderLineStyle,BorderPosition:o.BorderPosition,Weight:o.Weight,Color:{Red:o.Color.Red,Blue:o.Color.Blue,Green:o.Color.Green}};r.push(a)}return{Borders:r,ID:t||0,RefCount:n||0}},t.duplicateFont=function(e,t,n){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,ID:t||0,Italic:e.Italic,RefCount:n||0,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}},t.incrementNumericVal=H,t.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},t.validateRenderingRegion=function(e,t,n){f(e,"renderingRegion","validateRenderingRegion");var r=t.RowOffsets[e.startRow],i=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],o=t.ColumnOffsets[e.startColumn],a=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(r>e.startOffsetY||i<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= "+e.startOffsetY+", endOffsetY = "+e.endOffsetY+", firstRowStartOffset= "+r+", lastRowEndOffset= "+i+", modelHeight= "+t.BlockHeight+", rowHeights= "+t.RowHeights+", rowOffsets= "+t.RowOffsets+", startRow = "+e.startRow+", endRow = "+e.endRow+", isRTL = "+t.IsRtl+", DPR: "+n.devicePixelRatio+", zoom: "+n.zoom);if(o>e.startOffsetX||a<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= "+e.startOffsetX+", endOffsetX = "+e.endOffsetX+", firstColumnStartOffset= "+o+", lastColumnEndOffset= "+a+", modelWidth= "+t.BlockWidth+", colWidths= "+t.ColumnWidths+", colOffsets= "+t.ColumnOffsets+", startColumn = "+e.startColumn+", endColumn = "+e.endColumn+", isRTL = "+t.IsRtl+", DPR: "+n.devicePixelRatio+", zoom: "+n.zoom)},t.renderingRegionContainsDirtyCells=function(e,t){if(0===e.startOffsetX&&0===e.startOffsetY&&e.endOffsetX===t.BlockWidth&&e.endOffsetY===t.BlockHeight)return!0;for(var n=t.ClientOnlyCache.DirtyCellsKeys,i=0;i<n.length;i++){var o=n[i],a=r.getRowColFromCellKey(o),l=a.row,s=a.column,d=k(s,s,e.startColumn,e.endColumn),u=k(l,l,e.startRow,e.endRow);if(d&&u)return!0}return!1},t.registerCanvasHitRegionsFromCache=function(e,t){if(e)for(var n in e)for(var r=e[n],i=0;i<r.length;i++)t(r[i])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.ChangeGate=t.MaxBitsPerRenderFlag=t.MaxAllowedRowColCount=t.isModelCellContainedInRange=t.getCellLog=t.getRangeLog=t.isCellContainedInRange=t.getRangeTopLeftCell=t.getReferencedObjectById=t.compareGridBlockModels=t.areFormattedTextsEqual=t.areCellsEqual=t.areArraysEqual=t.annonymize=t.SpillDirection=t.serializeCell=t.PartialRowColSelectionBackgroundColor=t.PartialRowColSelectionHCFontColor=t.DefaultHeaderBackgroundColor=t.DefaultRowHeaderWidth=t.DefaultColHeaderHeight=t.columnNumberToTitle=t.createHeaderBlockModel=t.CalcBlockModel=t.validateCellShouldExistInModelUnsafe=t.getRenderingRegionHitTestCache=t.getOrCreateCell=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.cleanHitTestCache=t.initModelClientCache=t.getModelClientCache=t.getAdjacentCellsKeysOld=t.getAdjacentCellsKeys=t.getSpilledOverCount=t.getRowColFromCellKey=t.uniqueValuesFilter=t.getAllSpanningCellsKeys=t.getDefaultCell=t.verifyArgumentNotNull=t.isAccAndCustomNumFmtApplicable=t.doesNumFmtOverrideText=t.isRenderFlagEnabled=t.getReferencedObjectToCache=t.getCellLookupKey=void 0;var r=n(4);r.__exportStar(n(31),t),r.__exportStar(n(114),t);var i=n(36);Object.defineProperty(t,"getCellLookupKey",{enumerable:!0,get:function(){return i.getCellLookupKey}}),Object.defineProperty(t,"getReferencedObjectToCache",{enumerable:!0,get:function(){return i.getReferencedObjectToCache}}),Object.defineProperty(t,"isRenderFlagEnabled",{enumerable:!0,get:function(){return i.isRenderFlagEnabled}}),Object.defineProperty(t,"doesNumFmtOverrideText",{enumerable:!0,get:function(){return i.doesNumFmtOverrideText}}),Object.defineProperty(t,"isAccAndCustomNumFmtApplicable",{enumerable:!0,get:function(){return i.isAccAndCustomNumFmtApplicable}}),Object.defineProperty(t,"verifyArgumentNotNull",{enumerable:!0,get:function(){return i.verifyArgumentNotNull}}),Object.defineProperty(t,"getDefaultCell",{enumerable:!0,get:function(){return i.getDefaultCell}}),Object.defineProperty(t,"getAllSpanningCellsKeys",{enumerable:!0,get:function(){return i.getAllSpanningCellsKeys}}),Object.defineProperty(t,"uniqueValuesFilter",{enumerable:!0,get:function(){return i.uniqueValuesFilter}}),Object.defineProperty(t,"getRowColFromCellKey",{enumerable:!0,get:function(){return i.getRowColFromCellKey}}),Object.defineProperty(t,"getSpilledOverCount",{enumerable:!0,get:function(){return i.getSpilledOverCount}}),Object.defineProperty(t,"getAdjacentCellsKeys",{enumerable:!0,get:function(){return i.getAdjacentCellsKeys}}),Object.defineProperty(t,"getAdjacentCellsKeysOld",{enumerable:!0,get:function(){return i.getAdjacentCellsKeysOld}}),Object.defineProperty(t,"getModelClientCache",{enumerable:!0,get:function(){return i.getModelClientCache}}),Object.defineProperty(t,"initModelClientCache",{enumerable:!0,get:function(){return i.initModelClientCache}}),Object.defineProperty(t,"cleanHitTestCache",{enumerable:!0,get:function(){return i.cleanHitTestCache}}),Object.defineProperty(t,"isDifferentialRenderingSupported",{enumerable:!0,get:function(){return i.isDifferentialRenderingSupported}}),Object.defineProperty(t,"getCell",{enumerable:!0,get:function(){return i.getCell}}),Object.defineProperty(t,"getCellStyle",{enumerable:!0,get:function(){return i.getCellStyle}}),Object.defineProperty(t,"cellsPositionComparer",{enumerable:!0,get:function(){return i.cellsPositionComparer}}),Object.defineProperty(t,"getOrCreateCell",{enumerable:!0,get:function(){return i.getOrCreateCell}}),Object.defineProperty(t,"getRenderingRegionHitTestCache",{enumerable:!0,get:function(){return i.getRenderingRegionHitTestCache}}),Object.defineProperty(t,"validateCellShouldExistInModelUnsafe",{enumerable:!0,get:function(){return i.validateCellShouldExistInModelUnsafe}});var o=n(127);Object.defineProperty(t,"CalcBlockModel",{enumerable:!0,get:function(){return o.CalcBlockModel}});var a=n(128);Object.defineProperty(t,"createHeaderBlockModel",{enumerable:!0,get:function(){return a.createHeaderBlockModel}}),Object.defineProperty(t,"columnNumberToTitle",{enumerable:!0,get:function(){return a.columnNumberToTitle}});var l=n(83);Object.defineProperty(t,"DefaultColHeaderHeight",{enumerable:!0,get:function(){return l.DefaultColHeaderHeight}}),Object.defineProperty(t,"DefaultRowHeaderWidth",{enumerable:!0,get:function(){return l.DefaultRowHeaderWidth}}),Object.defineProperty(t,"DefaultHeaderBackgroundColor",{enumerable:!0,get:function(){return l.DefaultHeaderBackgroundColor}}),Object.defineProperty(t,"PartialRowColSelectionHCFontColor",{enumerable:!0,get:function(){return l.PartialRowColSelectionHCFontColor}}),Object.defineProperty(t,"PartialRowColSelectionBackgroundColor",{enumerable:!0,get:function(){return l.PartialRowColSelectionBackgroundColor}});var s=n(84);Object.defineProperty(t,"serializeCell",{enumerable:!0,get:function(){return s.serializeCell}});var d=n(81);Object.defineProperty(t,"SpillDirection",{enumerable:!0,get:function(){return d.SpillDirection}});var u=n(84);Object.defineProperty(t,"annonymize",{enumerable:!0,get:function(){return u.annonymize}});var c=n(130);Object.defineProperty(t,"areArraysEqual",{enumerable:!0,get:function(){return c.areArraysEqual}}),Object.defineProperty(t,"areCellsEqual",{enumerable:!0,get:function(){return c.areCellsEqual}}),Object.defineProperty(t,"areFormattedTextsEqual",{enumerable:!0,get:function(){return c.areFormattedTextsEqual}}),Object.defineProperty(t,"compareGridBlockModels",{enumerable:!0,get:function(){return c.compareGridBlockModels}});var g=n(79);Object.defineProperty(t,"getReferencedObjectById",{enumerable:!0,get:function(){return g.getReferencedObjectById}});var h=n(131);Object.defineProperty(t,"getRangeTopLeftCell",{enumerable:!0,get:function(){return h.getRangeTopLeftCell}}),Object.defineProperty(t,"isCellContainedInRange",{enumerable:!0,get:function(){return h.isCellContainedInRange}}),Object.defineProperty(t,"getRangeLog",{enumerable:!0,get:function(){return h.getRangeLog}}),Object.defineProperty(t,"getCellLog",{enumerable:!0,get:function(){return h.getCellLog}}),Object.defineProperty(t,"isModelCellContainedInRange",{enumerable:!0,get:function(){return h.isModelCellContainedInRange}});var f=n(80);Object.defineProperty(t,"MaxAllowedRowColCount",{enumerable:!0,get:function(){return f.MaxAllowedRowColCount}}),Object.defineProperty(t,"MaxBitsPerRenderFlag",{enumerable:!0,get:function(){return f.MaxBitsPerRenderFlag}});var m=n(59);Object.defineProperty(t,"ChangeGate",{enumerable:!0,get:function(){return m.ChangeGate}}),Object.defineProperty(t,"isChangeGateEnabled",{enumerable:!0,get:function(){return m.isChangeGateEnabled}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAdjustedForDrawingOffsetsInitialized=t.initializeOffsetsForDrawing=t.getClipMaskWidth=t.getReOrderDiv=t.isCellShrunk=t.getHighContrastTextColor=t.isRtlChar=t.getColOffsetAdjustedForDrawing=t.shouldRenderGridLines=t.cellIntersectsRenderingRegion=t.hexToRgb=t.drawLine=t.restoreClipping=t.applyClipping=t.drawClipRect=t.getContainerClipMaskWidth=t.getTextDrawingMaxHeight=t.getTextDrawingMaxWidth=t.isSafari=t.getBlockDimensionsAdjustedForDrawing=t.getRowHeightFromOffsets=t.getColWidthFromOffsets=t.getDefaultBorderLineWidth=void 0;var r=n(1),i=n(3),o=n(7),a=n(32),l=n(0),s={},d={},u={};function c(e,t){return Math.round(e*t)}function g(e){return e-i.GridLineWidthPx}function h(e,t,n,r,i){e.beginPath(),e.rect(t,n,r,i),e.stroke(),e.clip()}t.getDefaultBorderLineWidth=function(e){return o.isNullOrUndefined(s[e])?(s[e]=Math.max(Math.round(e),1),s[e]):s[e]},t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=c,t.isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.getTextDrawingMaxWidth=function(e,t,n,r,o){var l=0;n&&(l=n+a.IconTextMinimalPadding);var s=t+l+r+o;return Math.max(0,e-i.GridLineWidthPx-s)},t.getTextDrawingMaxHeight=function(e,t){return Math.max(0,e-i.GridLineWidthPx-t)},t.getContainerClipMaskWidth=g,t.drawClipRect=h,t.applyClipping=function(e,t){t&&(e.save(),e.strokeStyle="transparent",h(e,t.x,t.y,t.width,t.height))},t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,n,r,i){e.moveTo(t,n),e.lineTo(r,i)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,n=parseInt(t,16);return{Red:n>>16&255,Green:n>>8&255,Blue:255&n}},t.cellIntersectsRenderingRegion=function(e,t){var n=e.Row,r=e.Row,i=e.Col,o=e.Col;e.Merge?(r+=e.Merge.Rows,o+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(i=0),e.Merge.OriginDeltaY&&(n=0))):e.Spill&&(i-=e.Spill.SpanToStart,o+=e.Spill.SpanToEnd);var a=l.intersects1D(i,o,t.startColumn,t.endColumn),s=l.intersects1D(n,r,t.startRow,t.endRow);return a&&s},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetAdjustedForDrawing=function(e,t){var n=t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,r=n[n.length-1];return t.IsRtl?r-n[e+1]:n[e]},t.isRtlChar=function(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647},t.getHighContrastTextColor=function(e,t){return o.isNullOrUndefined(t.HeaderPartialSelectionFontColor)||e.CachedStyle.BackgroundColor!==r.PartialRowColSelectionBackgroundColor?o.isNullOrUndefined(e.Hyperlink)?function(e){u[e]||(u[e]=l.rgbToColorHex(e));return u[e]}(t.TextColor):function(e){d[e]||(d[e]=l.rgbToColorHex(e));return d[e]}(t.LinkColor):t.HeaderPartialSelectionFontColor},t.isCellShrunk=function(e){return!(!e.ShrunkSize||!e.CachedFont)&&e.ShrunkSize<e.CachedFont.Size},t.getReOrderDiv=function(e,t){var n=document.createElement("div");return n.style.visibility="hidden",n.style.direction=e.BaseDir,n.style.position="absolute",n.style.width=Math.max(2e3,1.1*t)+"px",n},t.getClipMaskWidth=function(e,t,n){var i=g(e)-t-n;return r.isChangeGateEnabled(r.ChangeGate.RichValueIconTextSpillsInCenterAlignment)?Math.max(0,i):i},t.initializeOffsetsForDrawing=function(e,t){var n=e.RowHeights,i=e.ColumnWidths,o=e.RowOffsets,a=e.ColumnOffsets;r.verifyArgumentNotNull(n,"rowHeights","initializeOffsetsForDrawing"),r.verifyArgumentNotNull(i,"colWidths","initializeOffsetsForDrawing"),r.verifyArgumentNotNull(o,"rowOffsets","initializeOffsetsForDrawing"),r.verifyArgumentNotNull(a,"colOffsets","initializeOffsetsForDrawing");var l=r.getModelClientCache(e);l.RowOffsetsAdjustedForDrawing=[];for(var s=0;s<o.length;s++){var d=o[s];l.RowOffsetsAdjustedForDrawing.push(Math.round(d*t))}for(l.ColOffsetsAdjustedForDrawing=[],s=0;s<a.length;s++){d=a[s];l.ColOffsetsAdjustedForDrawing.push(Math.round(d*t))}l.RowOffsetsAdjustedForDrawing.push(c(e.BlockHeight,t)),l.ColOffsetsAdjustedForDrawing.push(c(e.BlockWidth,t))},t.isAdjustedForDrawingOffsetsInitialized=function(e){return!!e.ClientOnlyCache&&!!e.ClientOnlyCache.RowOffsetsAdjustedForDrawing&&!!e.ClientOnlyCache.ColOffsetsAdjustedForDrawing}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GapBetweenRotatedDoubleUnderline=t.GapBetweenDoubleUnderline=t.NinetyDegreeInRadians=t.RightTextAlign=t.LeftTextAlign=t.RotatedTextPaddingMultiplier=t.MaxOrientationRange=t.MinOrientationRange=t.MaxUnicodeThaiRange=t.MinUnicodeThaiRange=t.FormulaErrorBorderStyle=t.FormulaErrorFontColor=t.FormulaErrorBackgroundColor=t.FontHeightToBaselineGapRatio=t.SkeletonCellsColor=t.SkeletonColor=t.UnderlineMarginFromTextBaseline=t.UnderlineLineWidth=t.MediumDotDashedLineDash=t.MediumDashedLineDash=t.DashedDotDotLineDash=t.DashedDotLineDash=t.DashedLineDash=t.DottedLineDash=t.ColoredGridLineDash=t.DefaultDash=t.MediumBorderWeight=t.ThinBorderWeight=t.HardBreakCRLF=t.HardBreakCR=t.HardBreak=t.Whitespace=t.EmptyString=t.RightHorizontalAlignmentItalicExtraPadding=t.EmptyLineTextToken=t.EmptyFormattedText=t.EmptyLine=t.DefaultCellFontColor=t.DefaultBackgroundColor=t.HighContrastPageLayoutWidthPx=t.GridLineWidthPx=t.TextLineHeightPx=t.InCellVerticalPaddingPx=t.InCellIndentPaddingPx=t.InCellBottomAndCenterVerticalPaddingPx=t.InCellEndOfTextHorizontalPaddingPx=t.InCellHorizontalPaddingPx=t.MinimalScaleFactorForGridlinesRendering=t.PageLayoutLineColor=t.DefaultGridlineColor=void 0;var r=n(1);t.DefaultGridlineColor="#d4d4d4",t.PageLayoutLineColor="#9e9e9e",t.MinimalScaleFactorForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.HighContrastPageLayoutWidthPx=2,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0,containsThaiCharacters:!1}],containsThaiCharacters:!1},t.RightHorizontalAlignmentItalicExtraPadding=3,t.EmptyString="",t.Whitespace=" ",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.SkeletonCellsColor="#aaaaaa",t.FontHeightToBaselineGapRatio=.22;var i={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Top,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Bottom,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Left,Color:i,Weight:2},{BorderLineStyle:r.BorderLineType.Dashed,BorderPosition:r.BorderPositionType.Right,Color:i,Weight:2}],ID:r.UniqueStyleID.FormulaError,RefCount:0},t.MinUnicodeThaiRange=3584,t.MaxUnicodeThaiRange=3711,t.MinOrientationRange=-90,t.MaxOrientationRange=90,t.RotatedTextPaddingMultiplier=4,t.LeftTextAlign="left",t.RightTextAlign="right",t.NinetyDegreeInRadians=Math.PI/2,t.GapBetweenDoubleUnderline=2,t.GapBetweenRotatedDoubleUnderline=3.14},function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",(function(){return i})),n.d(t,"__assign",(function(){return o})),n.d(t,"__rest",(function(){return a})),n.d(t,"__decorate",(function(){return l})),n.d(t,"__param",(function(){return s})),n.d(t,"__metadata",(function(){return d})),n.d(t,"__awaiter",(function(){return u})),n.d(t,"__generator",(function(){return c})),n.d(t,"__createBinding",(function(){return g})),n.d(t,"__exportStar",(function(){return h})),n.d(t,"__values",(function(){return f})),n.d(t,"__read",(function(){return m})),n.d(t,"__spread",(function(){return p})),n.d(t,"__spreadArrays",(function(){return C})),n.d(t,"__spreadArray",(function(){return v})),n.d(t,"__await",(function(){return y})),n.d(t,"__asyncGenerator",(function(){return T})),n.d(t,"__asyncDelegator",(function(){return S})),n.d(t,"__asyncValues",(function(){return F})),n.d(t,"__makeTemplateObject",(function(){return x})),n.d(t,"__importStar",(function(){return R})),n.d(t,"__importDefault",(function(){return b})),n.d(t,"__classPrivateFieldGet",(function(){return I})),n.d(t,"__classPrivateFieldSet",(function(){return A}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function l(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function s(e,t){return function(n,r){t(n,r,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function h(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function C(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,l=o.length;a<l;a++,i++)r[i]=o[a];return r}function v(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function T(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||l(e,t)}))})}function l(e,t){try{(n=i[e](t)).value instanceof y?Promise.resolve(n.value.v).then(s,d):u(o[0][2],n)}catch(e){u(o[0][3],e)}var n}function s(e){l("next",e)}function d(e){l("throw",e)}function u(e,t){e(t),o.shift(),o.length&&l(o[0][0],o[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:i?i(t):t}:i}}function F(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}function x(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return w(t,e),t}function b(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function A(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSpillCellEndCol=t.isIconAlignedToTheLeft=t.getAdjustedCellArea=t.getCellDimensionsAdjustedForDrawing=t.getSpillCellStartOffset=t.getOffsetLeftSpill=t.getSpillCellWidthAdjustedForDrawing=t.getSpillCellWidth=t.isCellSpansMultipleRowsOrBlocks=t.getCellTopAdjustedForDrawing=t.getCellCenterXAdjustedForDrawing=t.getCellCenterYAdjustedForDrawing=t.getCellBottomAdjustedForDrawing=t.getSpillCellRightAdjustedForDrawing=t.getCellRightAdjustedForDrawing=t.getSpillCellLeftAdjustedForDrawing=t.getCellLeftAdjustedForDrawing=t.getCellHeightAdjustedForDrawing=t.getCellWidthAdjustedForDrawing=t.getCellTop=t.getCellBottom=t.getCellRight=t.getCellLeft=t.getCellHeight=t.getCellWidth=void 0;var r=n(0),i=n(1),o=n(2),a=n(3),l=n(7),s=n(33);function d(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellWidth"),r.verifyArgumentNotNull(e,"model","getCellWidth"),r.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&r.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),R(e,t,n,!1)}function u(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellHeight"),r.verifyArgumentNotNull(e,"model","getCellHeight"),r.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge&&r.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","getCellHeight"),w(e,t,n,!1)}function c(e,t){return x(e,t,!1,!1)}function g(e,t){return r.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),R(e,t,!1,!0)}function h(e,t){return r.verifyArgumentNotNull(e,"model","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellHeightAdjustedForDrawing"),w(e,t,!1,!0)}function f(e,t,n,i){return r.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),r.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),b(e,t,void 0,n,!0,i)}function m(e,t){return!e.IsRtl||t.RichValueIcon?f(e,t,!1,!1):p(e,t,!1)-y(t,e)+a.GridLineWidthPx}function p(e,t,n){var r=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,i=r.length-1,o=t.Col;if(!e.IsRtl||n)return f(e,t,n,!1)+g(e,t)-a.GridLineWidthPx;var l=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return r[i]+l-r[o]}function C(e,t,n){return x(e,t,!0,n)}function v(e,t){var n=t.ColumnOffsets[F(e)],r=S(e,t),i=t.ColumnOffsets[r];return t.ColumnWidths[r]+Math.abs(i-n)}function y(e,t){var n=A(t,F(e),!0),r=S(e,t),i=A(t,r,!0);return o.getColWidthFromOffsets(r,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+Math.abs(i-n)}function T(e,t){var n;return!!s.isCFIconAlignedToTheLeft(e,t)||(!(!i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,e)||!t.RichValueIcon)||!l.isNullOrUndefined(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)&&!e.IsRtl)}function S(e,t){return r.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}function F(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}function x(e,t,n,r){var i=I(e,t.Row,n);return t.Merge&&t.Merge.SpansBlocks&&!r&&(i-=function(e,t){return t?e.Merge.OriginDeltaYAdjustedForDrawing:e.Merge.OriginDeltaY}(t,n)),i}function w(e,t,n,r){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.HeightAdjustedForDrawing:e.Merge.Height}(t,r);var i=I(e,t.Row,r);return function(e,t,n){var r=t.Row+t.Merge.Rows;return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[r+1]:e.RowOffsets[r]+e.RowHeights[r]}(e,t,r)-i}return function(e,t,n){if(n)return o.getRowHeightFromOffsets(t.Row,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing);return e.RowHeights[t.Row]}(e,t,r)}function R(e,t,n,i){if(t.Merge){if(t.Merge.SpansBlocks&&!n)return function(e,t){return t?e.Merge.WidthAdjustedForDrawing:e.Merge.Width}(t,i);var a=A(e,t.Col,i);return function(e,t,n){var r=t.Col+t.Merge.Columns;return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[r+1]:e.ColumnOffsets[r]+e.ColumnWidths[r]}(e,t,i)-a}return function(e,t,n){return n?o.getColWidthFromOffsets(t.Col,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing):r.getColumnWidth(t.Col,e)}(e,t,i)}function b(e,t,n,r,i,o){var l=A(e,t.Col,i);return t.Merge&&t.Merge.SpansBlocks&&!o&&(l-=function(e,t){return t?e.Merge.OriginDeltaXAdjustedForDrawing:e.Merge.OriginDeltaX}(t,i)),!e.IsRtl||r?l:(i?p(e,t,r):n-l)-R(e,t,!1,i)+a.GridLineWidthPx}function I(e,t,n){return n?e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[t]:e.RowOffsets[t]}function A(e,t,n){return n?e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[t]:e.ColumnOffsets[t]}t.getCellWidth=d,t.getCellHeight=u,t.getCellLeft=function(e,t,n){return r.verifyArgumentNotNull(t,"cell","getCellWidth"),r.verifyArgumentNotNull(e,"model","getCellWidth"),r.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge&&r.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth"),b(e,t,n,!1,!1,!1)},t.getCellRight=function(e,t,n){var r=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(r-=t.Merge.OriginDeltaX),e.IsRtl?n-r:r+d(e,t,!1)-a.GridLineWidthPx},t.getCellBottom=function(e,t){return c(e,t)+u(e,t,!1)},t.getCellTop=c,t.getCellWidthAdjustedForDrawing=g,t.getCellHeightAdjustedForDrawing=h,t.getCellLeftAdjustedForDrawing=f,t.getSpillCellLeftAdjustedForDrawing=m,t.getCellRightAdjustedForDrawing=p,t.getSpillCellRightAdjustedForDrawing=function(e,t){return!t.Spill&&e.IsRtl?p(e,t,!1):f(e,t,!1,!1)+y(t,e)-a.GridLineWidthPx},t.getCellBottomAdjustedForDrawing=function(e,t){return C(e,t,!1)+h(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return C(e,t,!1)+h(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t){return(p(e,t,!1)+f(e,t,!1,!1))/2},t.getCellTopAdjustedForDrawing=C,t.isCellSpansMultipleRowsOrBlocks=function(e){return!l.isNullOrUndefined(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=v,t.getSpillCellWidthAdjustedForDrawing=y,t.getOffsetLeftSpill=function(e,t){var n=A(t,e.Col,!1),r=A(t,t.IsRtl?Math.max(F(e),S(e,t)):Math.min(F(e),S(e,t)),!1);return Math.abs(r-n)},t.getSpillCellStartOffset=function(e,t,n,r){var o=function(e,t,n,r){var i=T(e,t)?n:0,o=e.IsRtl?0:r;return i+o}(t,e,n,r),l=t.ColumnOffsets[F(e)]+o;if(t.IsRtl){if(i.isRenderFlagEnabled(i.RenderFlagsArray.CFIconsWithCAS,t)){var s=S(e,t),d=t.ColumnOffsets[s],u=t.ColumnWidths[s];return t.BlockWidth-d-u+o+a.GridLineWidthPx}return t.BlockWidth-v(e,t)-l+a.GridLineWidthPx}return l},t.getCellDimensionsAdjustedForDrawing=function(e,t,n){return{x:f(e,t,n,!1)-a.GridLineWidthPx,y:C(e,t,!1)-a.GridLineWidthPx,width:g(e,t)+a.GridLineWidthPx,height:h(e,t)+a.GridLineWidthPx}},t.getAdjustedCellArea=function(e,t,n){var r=t.Spill&&n;return{x:r?m(e,t):f(e,t,!1,!1),y:C(e,t,!1),width:r?y(t,e):g(e,t),height:h(e,t)}},t.isIconAlignedToTheLeft=T,t.getSpillCellEndCol=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellHorizontalIndentationPaddingPx=t.doesExpandCollapseButtonShiftText=t.getDistanceFromCellStartToIconEnd=t.getOverhangHashWidth=t.getNumFmtHashWidth=t.getNumFmtSeparatorWidth=t.getFormattedTextLineFontMetrics=t.getFormattedTextLineHeight=t.getLargestFont=t.getTextLineHeight=t.getBidiContext=t.measureTextHeightForVerticalText=t.measureTextRunsHeightForVerticalText=t.measureTextRunsWidth=t.cacheLegacyTextWidthOnCell=t.getTextWidthNoCaching=t.getTextWidth=t.getTextHorizontalPosition=t.getTextDecorationLineWidth=t.getYPositionForFontVerticalAlignmentRtf=t.getMiddleBaseline=t.getTextOffsetYAlphabeticBaseline=t.isCellBottomPaddingRequired=t.getTextVerticalPosition=t.getFontLineHeight=t.getCellAdornmentPadding=t.getHorizontalPadding=t.getWrapTextAdditionalPadding=t.getCellTextClipMask=t.getCellTextHorizontalPaddingWithoutVisualElements=t.getCellTextHorizontalPadding=t.getIndentationPaddingPx=t.getCellTextCenterX=t.calculateSubSuperOffsetY=t.measureTextWidth=void 0;var r=n(4),i=n(1),o=n(3),a=n(8),l=n(28),s=n(7),d=n(0),u=n(46),c=n(60),g=n(61),h=n(48),f=n(10),m=n(13),p=n(5),C=n(90),v=n(2),y=n(11),T=n(51),S=n(33),F=n(9),x=n(15),w=n(64),R=n(12),b=n(19),I=!0,A={},P={},D={},M={},O=0,k=0,L=0;function H(e,t,n,r){if(!t)return 0;if(r){k++;var i=e.font,o=M[i];if(o){var l=o[t];if(l)return L++,l}else o={};var s=j(e,t,n);return o[t]=s,M[i]=o,++O===R.getServiceSetting(12,200)&&(a.ULS.sendTraceTag(544310413,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Info,'measureTextWidth: Cache Reset, {"cacheHits"='+L+', "totalCalls"='+k+"}"),O=0,M={},L=0,k=0),s}return j(e,t,n)}function E(e,t,n,r){var a=ne(e,t,n,r),l=p.isIconAlignedToTheLeft(e,t)?a:0,s=d.isPivotTablePhase2Enabled(e),u=f.getExpandCollapseButtonPadding(t,s),c=f.shouldExpandCollapseButtonShiftText(e,t)?u:0,g=e.IsRtl?o.GridLineWidthPx:0,h=p.getCellLeft(e,t,e.BlockWidth)+l+c,m=p.getCellWidth(e,t,!1)-a-u;return i.isChangeGateEnabled(i.ChangeGate.RichValueIconTextSpillsInCenterAlignment)&&(m=Math.max(0,m)),h+m/2-g}function B(e){return e*o.InCellIndentPaddingPx}function N(e,t,n,r){return ie(t,e,z(t,e,n,r))}function W(e,t,n,r,o,a,l){var s=re(t,o),d=m.getEffectiveHorizontalAlignment(e,t),u=g.CalibriRegularPadding;switch(d){case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return s+c.approximateValue(n,u)+l;case i.HorizontalAlignment.Right:return r&&(u=g.CalibriItalicPadding),s+c.approximateValue(n,u)+l;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return a?c.approximateValue(n,u):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+d)}}function z(e,t,n,r){var o=function(e,t,n,r){if(function(e,t){var n,r=S.isCFIconAlignedToTheLeft(e,t),o=!!(null===(n=t.LinkedEntity)||void 0===n?void 0:n.IconWidth)||i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,e)&&!!t.RichValueIcon;if((r||o)&&!b.shouldDrawRotatedText(e,t.CachedStyle,t.CachedFont)){var a=p.isIconAlignedToTheLeft(e,t),l=m.getEffectiveHorizontalAlignment(e,t);switch(l){case i.HorizontalAlignment.Right:return!a;case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return a;case i.HorizontalAlignment.Center:case i.HorizontalAlignment.CenterAcrossSelection:return!0;default:throw Error("unexpected context alignment "+l)}}return!1}(e,t))return ne(e,t,n,r);return 0}(e,t,n,r);if(f.shouldExpandCollapseButtonShiftText(e,t)){var a=d.isPivotTablePhase2Enabled(e);o+=f.getExpandCollapseButtonPadding(t,a)}return o+=x.shouldAddAutoFilterPadding(e,t)?x.getAutoFilterButtonPadding(e,t,n,r):0}function j(e,t,n){if(!t)return 0;if(n&&I){try{var r=t.replace(/^\s+|\s+$/g,""),i=e.measureText(r);if(!s.isNullOrUndefined(i.actualBoundingBoxLeft)&&!s.isNullOrUndefined(i.actualBoundingBoxRight)){var o=Math.abs(i.actualBoundingBoxRight)+Math.abs(i.actualBoundingBoxLeft),a=t.length-r.length,l=0;if(a>0)l=a*e.measureText(" ").width;return o+l}}catch(e){}I=!1}return oe(e,t)}function _(e,t,n){var r=function(e,t,n){return u.getCachedFontMetrics(n,t,e).height}(e,t,n);return Math.ceil(r*l.LineHeightUsingDivFontFactor)}function V(e,t){return C.cellHasBottomDoubleBorder(t,e)||v.isCellShrunk(t)}function U(e,t,n,r){switch(e){case i.FontVerticalAlignment.Subscript:var o=G(r);return n+t.baseline/2-o;case i.FontVerticalAlignment.Superscript:return n-2*(t.middle-t.baseline);default:throw Error("getYPositionForFontVerticalAlignmentRtf: Font vertical alignment "+e+" is unexpected here")}}function G(e){return e?l.SubscriptVerticalPaddingForUnderlinePx:0}function q(e,t,n,r){return J(e-(t+o.GridLineWidthPx-n)/2,r)}function Y(e,t,n){return J(e+t,n)}function J(e,t){return e-l.LineHeightBottomConstantPx-t}function X(e,t,n){n.CachedDrawingLayout||(n.CachedDrawingLayout={CellTextLayout:{}}),n.CachedDisplayText||d.updateCellText(t,n,n.Text);var r=!n.DisplayFormula&&n.TextRuns;if(n.CachedDrawingLayout.CellTextLayout.Width){if(r&&!n.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:n.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:n.CachedDrawingLayout.TextRunDrawingInformation}}var o=!w.isTestRun(),a=d.getDisplayText(n,t);if(r){var l=$(n),s=K(e,n.TextRuns,n.Text,t,l);return{width:s.totalSize,textRunsDrawingInformation:s.textRunsDrawingInformation}}return{width:H(e,a,o,i.isRenderFlagEnabled(i.RenderFlagsArray.TextWidthClientPhase1,t))}}function K(e,t,n,r,i){var o=e.textAlign;e.textAlign="left";var a=Z(e,r,n,!1,i,t);return e.textAlign=o,a}function Z(e,t,n,o,a,l){for(var s=[],u=function(e,t,n){if(void 0!==e&&e.HasBidi)return h.prepareTextRunsForBidiLayout(t,n);return t}(a,l,n),c=0,g=i.isRenderFlagEnabled(i.RenderFlagsArray.TextWidthClientPhase1,t),f=0;f<u.length;f++){var m=u[f],p={FontID:m.FontID||0,StartIndex:m.StartIndex},C=d.getTextRunText(f,u,n),v=m.CachedFont,y=d.getFontCssStringFromFont(v,void 0,t);if(o){var T=_(t,v.Size,v.FontName),S=Q(T,C);p.HeightPx=S,p.WidthPx=T,c+=S}else{e.font=y;var F=H(e,C,f===u.length-1,g);p.Underline=v.Underline,p.WidthPx=F,c+=F}p.Strikethrough=v.StrikeThrough,p.Text=C,p.FontCss=y,s[f]=r.__assign(r.__assign({},p),m)}return{textRunsDrawingInformation:s,totalSize:c}}function Q(e,t){return e*T.breakToGraphemes(t).length}function $(e){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var n=h.analyzeBidiText(e.Text,e.CachedStyle.ReadingOrder||i.ReadingOrderType.Context);return e.CachedDrawingLayout.BidiContext=n,n}function ee(e,t){d.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),d.verifyArgumentNotNull(e.CachedFont,"CachedFont","getTextLineHeight");var n,r=!!e.TextRuns;if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;r&&(n=te(t,e.TextRuns));var i=r?n.Size:d.getActualFontSizeFromFont(e,e.CachedFont,!0),o=r?n.FontName:e.CachedFont.FontName;s.isNullOrUndefined(o)&&F.setRenderingResultInfo("\n    isRichText: "+r+",\n    fontSize: "+i+"\n    ");var a=_(t,i,o);return e.CachedDrawingLayout.CellTextLayout.LineHeight=a,a}function te(e,t){for(var n,r=0;r<t.length;r++){var o=t[r],a=i.getReferencedObjectById(o.FontID||0,e.Fonts);(!n||n.Size<a.Size)&&(n=a)}if(!n)throw"getLargestFont: Largest fonts is supposed to be defined";return n}function ne(e,t,n,r){var o;if(t.PreviewText)return 0;if((!!(null===(o=t.LinkedEntity)||void 0===o?void 0:o.IconWidth)||i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,e)&&!!t.RichValueIcon)&&t.DisplayFormula)return 0;var a=d.getActualFontSize(t);return f.getIconSizeAndPadding(e,t,a,n,r)}function re(e,t){return y.shouldRenderVerticalText(e)?0:B(t)}function ie(e,t,n){var r=t.CachedStyle.Indentation||0,i=d.getActualFontSize(t),o=!s.isNullOrUndefined(t.WrapText)||d.cellHasShrinkToFit(t),a=y.shouldRenderVerticalText(t)?ee(t,e)/2:0;return W(e,t,i,t.CachedFont.Italic,r,o,n)+a}function oe(e,t){return e.measureText(t).width}function ae(e,t,n,r){var o=P[r];if((o||(P[r]=oe(e,"#"),o=P[r]),n.CachedFont.Italic)&&!D[r]){var a=H(e,"#",!0,i.isRenderFlagEnabled(i.RenderFlagsArray.TextWidthClientPhase1,t));D[r]=a-o}}t.measureTextWidth=H,t.calculateSubSuperOffsetY=function(e,t,n,r,i,o){return o?U(t,i,r,f.isBottomPaddingNeededForSubscriptUnderline(n,e.CachedStyle.VerticalAlignment)):0},t.getCellTextCenterX=E,t.getIndentationPaddingPx=B,t.getCellTextHorizontalPadding=N,t.getCellTextHorizontalPaddingWithoutVisualElements=function(e,t){return ie(e,t,0)},t.getCellTextClipMask=function(e,t,n,r,i,o,a){return{x:t+(e.IsRtl&&!a?0:o),y:n,width:v.getContainerClipMaskWidth(r)-o,height:i}},t.getWrapTextAdditionalPadding=function(e,t,n){var r=d.getActualFontSize(t),i=!s.isNullOrUndefined(t.WrapText)||d.cellHasShrinkToFit(t),o=x.shouldAddAutoFilterPadding(e,t)?x.getAutoFilterButtonPadding(e,t,n.zoom,n.devicePixelRatio):0;return W(e,t,r,t.CachedFont.Italic,0,i,o)},t.getHorizontalPadding=W,t.getCellAdornmentPadding=z,t.getFontLineHeight=_,t.getTextVerticalPosition=function(e,t,n,r,a,l){var s,c,g=e.TextRuns,h=g?te(t,e.TextRuns):e.CachedFont,m=g?h.Size:d.getActualFontSize(e),C=p.getCellTop(t,e),v=p.getCellBottom(t,e),y=V(t,e)?o.InCellVerticalPaddingPx:0;if(d.isFontContainsVerticalAlignment(h))if(l)s=l;else{var T=u.getCachedFontMetrics(h.FontName,m,t),S=f.isBottomPaddingNeededForSubscriptUnderline(h,a);s=function(e,t,n){switch(t){case i.FontVerticalAlignment.Subscript:return e.baseline/2+G(n);case i.FontVerticalAlignment.Superscript:return e.middle+(e.middle-e.baseline);default:return e.baseline}}(T,g?i.FontVerticalAlignment.None:h.VerticalAlign||0,S)}else s=l||u.getCachedFontMetrics(h.FontName,m,t).baseline;switch(a){case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:c=y+J(v,s);break;case i.VerticalAlignment.Top:c=Y(C,n,s);break;case i.VerticalAlignment.Center:c=q(v,r,n,s);break;default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+a)}return{absoluteY:c,lastTextLineAlphabeticBaselineOffset:s}},t.isCellBottomPaddingRequired=V,t.getTextOffsetYAlphabeticBaseline=function(e,t,n,r,o,a){var l=_(e,r,o),s=u.getCachedFontMetrics(o,r,e).baseline;switch(a){case i.VerticalAlignment.Center:case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return q(t,n,l,s);case i.VerticalAlignment.Bottom:return J(t,s);case i.VerticalAlignment.Top:return Y(t-n,l,s)}},t.getMiddleBaseline=function(e,t,n,r){var i=u.getCachedFontMetrics(n.FontName,r,e);return t-(i.middle-i.baseline)},t.getYPositionForFontVerticalAlignmentRtf=U,t.getTextDecorationLineWidth=function(e){return c.approximateValue(e,g.CalibriTextDecorationLineWidth)},t.getTextHorizontalPosition=function(e,t,n){var r=m.getEffectiveHorizontalAlignment(e,t),a=N(t,e,n.zoom,n.devicePixelRatio);switch(r){case i.HorizontalAlignment.Right:return p.getCellRight(e,t,e.BlockWidth)-a;case i.HorizontalAlignment.Center:return E(e,t,n.zoom,n.devicePixelRatio);case i.HorizontalAlignment.Automatic:case i.HorizontalAlignment.Left:return p.getCellLeft(e,t,e.BlockWidth)+a;case i.HorizontalAlignment.CenterAcrossSelection:return function(e,t,n,r){if(t.Spill){var i=ne(e,t,n,r),a=d.isPivotTablePhase2Enabled(e),l=f.getExpandCollapseButtonPadding(t,a),s=e.IsRtl?o.GridLineWidthPx:0,u=p.getSpillCellWidth(t,e)-i-l;return p.getSpillCellStartOffset(t,e,i,l)+u/2-s}return E(e,t,n,r)}(e,t,n.zoom,n.devicePixelRatio);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+r)}},t.getTextWidth=function(e,t,n){var r=X(e,t,n),i=r.width,o=r.textRunsDrawingInformation;return n.CachedDrawingLayout.CellTextLayout.Width=i,n.CachedDrawingLayout.TextRunDrawingInformation=o,i},t.getTextWidthNoCaching=function(e,t,n){return X(e,t,n).width},t.cacheLegacyTextWidthOnCell=function(e,t,n){var r=H(e,n.CachedDisplayText,!1,i.isRenderFlagEnabled(i.RenderFlagsArray.TextWidthClientPhase1,t));n.CachedDrawingLayout.CellTextLayout.Width=r},t.measureTextRunsWidth=K,t.measureTextRunsHeightForVerticalText=function(e,t,n,r,i,o,a){return i?{textRunsDrawingInformation:[],totalSize:o*n.length}:Z(e,r,n,!0,a,t)},t.measureTextHeightForVerticalText=Q,t.getBidiContext=$,t.getTextLineHeight=ee,t.getLargestFont=te,t.getFormattedTextLineHeight=function(e,t){var n=te(e,t.TextRuns);return _(e,n.Size,n.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){var n=te(e,t.TextRuns);return u.getCachedFontMetrics(n.FontName,n.Size,e)},t.getNumFmtSeparatorWidth=function(e,t,n){var r,i;d.verifyArgumentNotNull(null===(r=n.NumFmt)||void 0===r?void 0:r.Separator,"separator","getNumFmtSeparatorWidth");var o=null===(i=n.NumFmt)||void 0===i?void 0:i.Separator,a=d.getFontCssStringFromCell(n,t)+o,l=A[a];if(s.isNullOrUndefined(l)||0===l){var u=oe(e,o);return A[a]=u,u}return A[a]},t.getNumFmtHashWidth=function(e,t,n){d.verifyArgumentNotNull(n,"cell","getNumFmtSeparatorWidth");var r=d.getFontCssStringFromCell(n,t);return ae(e,t,n,r),P[r]},t.getOverhangHashWidth=function(e,t,n){d.verifyArgumentNotNull(n,"cell","getOverhangHashWidth");var r=d.getFontCssStringFromCell(n,t);return ae(e,t,n,r),D[r]},t.getDistanceFromCellStartToIconEnd=ne,t.doesExpandCollapseButtonShiftText=function(e,t){var n=m.getEffectiveHorizontalAlignment(e,t);switch(n){case i.HorizontalAlignment.Left:case i.HorizontalAlignment.CenterAcrossSelection:case i.HorizontalAlignment.Center:return!e.IsRtl;case i.HorizontalAlignment.Right:return e.IsRtl;case i.HorizontalAlignment.Automatic:default:throw Error("doesExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getCellHorizontalIndentationPaddingPx=re},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringFormat=t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e},t.stringFormat=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}},function(e,t,n){"use strict";n.r(t);var r,i=n(89);!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={}));var o=n(56);function a(e,t,n,r){var i=[],o=e.map((function(e){return function(e,t,n){var r={};if(r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category,e.correlationId){var i=n.findIndex((function(t){return t===e.correlationId}));i<0&&(i=n.push(e.correlationId)-1),r.I=i}var o=1e3*e.type+e.level;return r.D=o,r}(e,r,i)})),a=function(e,t,n,r,i){var o={};o.T=e,o.L=t,o.S=n,o.I=r,i&&i.length>0&&(o.W=i);return o.V=1,o}(r,o,t,n,i);return JSON.stringify(a)}var l=n(14),s=function(){function e(t,n){var r=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){r.triggerUpload(!1,!1)},this.flush=function(){r.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){if(window.clearTimeout(r.timeoutId),r.logCache.length>0){r.uploadId+=1;var i=a(r.logCache,r.userSessionId,r.uploadId,r.timestampBase);Object(o.a)(i,r.remoteUrlEndpoint,n),r.logCache=[],r.timestampBase=Date.now()}t&&(r.timeoutId=window.setTimeout(r.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return r.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===l.a.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}(),d=function(){function e(e,t){this.correlationId="",this.cache=new s(e,t)}return e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,n,r){g(this.cache,e,t,n,r,this.correlationId)},e.prototype.debugAssertTag=function(e,t,n,r){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,n,r){n&&g(this.cache,e,t,l.a.Error,r,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose},e}();function u(e,t){return new d(e,t)}function c(e,t){var n=new s(e,t);return{sendTraceTag:function(e,t,r,i){return g(n,e,t,r,i,"")},shipAssertTag:function(e,t,r,i){r&&g(n,e,t,l.a.Error,i,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:n.flush,flushOnClose:n.flushOnClose,setCorrelationId:function(){}}}function g(e,t,n,i,o,a){if(!(i>l.a.Info)){var s={timestamp:Date.now(),category:n,tag:t,level:i,type:r.Trace,message:o,correlationId:a};e.handleTrace(s)}}var h=n(57),f=n(4),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t}(n(58).a),p=n(62);n.d(t,"UlsLoggerWrapper",(function(){return i.b})),n.d(t,"ULS",(function(){return i.a})),n.d(t,"initializeLogger",(function(){return i.c})),n.d(t,"RemoteUlsLogger",(function(){return d})),n.d(t,"getUlsLogger",(function(){return u})),n.d(t,"getUlsLoggerDeprecated",(function(){return c})),n.d(t,"formatForUpload",(function(){return a})),n.d(t,"uploadLogs",(function(){return o.a})),n.d(t,"LogCategory",(function(){return h.a})),n.d(t,"LogType",(function(){return r})),n.d(t,"TraceLevel",(function(){return l.a})),n.d(t,"UnitTestLogger",(function(){return m})),n.d(t,"ConsoleLogger",(function(){return p.a}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRenderingResultInfo=t.setRenderingResultMonitorable=t.validateClippingState=t.getRenderingMessage=t.RenderPerformanceMetric=t.trackDuration=t.clearPerformanceMetrics=t.createRenderResult=t.verifyPerformanceNowSupported=t.perf=void 0;var r="",i=0,o=[];t.perf=l()?window.performance:void 0;var a=void 0;function l(){if(a)return a;a=!1,window.performance&&"function"==typeof window.performance.now&&(a=!0);try{window.performance.now()}catch(e){a=!1}return a}function s(e){d(e,0)}function d(e,t){var n;e&&""!==e&&(r=(r+"; "+e).substring(0,2500),(n=t)>i&&(i=n))}t.verifyPerformanceNowSupported=l,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:o,messageLevel:i}},t.clearPerformanceMetrics=function(){o=[]},t.trackDuration=function(e,n,r){var i=t.perf?t.perf.now():-1;if(n(),t.perf){var a=t.perf.now()-i;r?o[e]+=a:o[e]=a}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderInternalDurationMs=3]="RenderInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForPivotTable=21]="ClearGridLinesForPivotTable",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines",e[e.DrawExpandCollapseButtonsMs=27]="DrawExpandCollapseButtonsMs",e[e.DrawAutoFiltersMs=28]="DrawAutoFiltersMs",e[e.RegisterHitRegionsMs=29]="RegisterHitRegionsMs",e[e.DrawInCellImagesMs=30]="DrawInCellImagesMs",e[e.DrawRichErrorMs=31]="DrawRichErrorMs",e[e.DrawCommentsMs=32]="DrawCommentsMs",e[e.DrawRichValueIcons=33]="DrawRichValueIcons",e[e.DrawPhoneticTextDurationMs=34]="DrawPhoneticTextDurationMs",e[e.HyperlinkEventRegistrationMs=35]="HyperlinkEventRegistrationMs",e[e.CellTooltipRegistrationMs=36]="CellTooltipRegistrationMs",e[e.RegisterTableSelectorsMs=37]="RegisterTableSelectorsMs",e[e.DrawPreviewCellsModeOverlayMs=38]="DrawPreviewCellsModeOverlayMs",e[e.DrawSkeletonCellsMs=39]="DrawSkeletonCellsMs"}(t.RenderPerformanceMetric||(t.RenderPerformanceMetric={})),t.getRenderingMessage=function(){var e=r;r="";var t=i;return i=0,{message:e,level:t}},t.validateClippingState=function(e,t){e.isClear||s("Clipping masks were not restored properly. Rendering stage: "+t),e.clippedWithoutSave&&s("Clipping without saving the context. No context was previously saved. Hence, will not be able to restore. Rendering stage: "+t)},t.setRenderingResultMonitorable=function(e){d(e,1)},t.setRenderingResultInfo=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doesCellContainsHashesCFIconsAndExpandCollapse=t.cellTextReplacedWithHashes=t.getCellRightVisualElementsPadding=t.shouldExpandCollapseButtonShiftText=t.getExpandCollapseButtonWidth=t.getExpandCollapseButtonPadding=t.getIconSizeAndPadding=t.adjustNumberToRange=t.isBottomPaddingNeededForSubscriptUnderline=t.getIconHorizontalPadding=t.getIconSize=void 0;var r=n(60),i=n(61),o=n(1),a=n(63),l=n(3),s=n(13),d=n(0),u=n(49),c=n(135),g=n(15);function h(e,t){return Math.floor(r.approximateValue(e,i.FontSizeToIconSize)*t)}function f(e,t){return Math.floor(r.approximateValue(e,i.IconHorizontalPadding)*t)}function m(e,t){var n;return!(null===(n=e.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)||!t&&C(e)?0:a.ExpandCollapseButtonSizePx+a.PaddingBetweenExpandCollapseButtonAndTextPx}function p(e){if(!e.Text)return!1;var t=e.Text.split("#").length-1;return e.CachedIsTextWidthExceedsCellWidth||t===e.Text.length&&e.ValueType===o.CellValueType.Number}function C(e){var t,n;return(null===(t=e.CondFormat)||void 0===t?void 0:t.Icon)&&(null===(n=e.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)&&p(e)}t.getIconSize=h,t.getIconHorizontalPadding=f,t.isBottomPaddingNeededForSubscriptUnderline=function(e,t){return t===o.VerticalAlignment.Bottom&&(e.Underline===o.FontUnderline.Single||e.Underline===o.FontUnderline.Double)},t.adjustNumberToRange=function(e,t,n){return e<t?t:e>n?n:e},t.getIconSizeAndPadding=function(e,t,n,r,i){var a,s,d;if(null===(a=t.CondFormat)||void 0===a?void 0:a.Icon)return h(n,1)+f(n,1)+l.GridLineWidthPx;if(o.isRenderFlagEnabled(o.RenderFlagsArray.CanvasHitTest,e)&&t.RichValueIcon){var m=c.shouldAddRichValueIconPadding(e,t)?g.getAutoFilterButtonPadding(e,t,r,i):0;return t.RichValueIcon.Width+u.RichValueIconRightHorizontalPadding+m}return(null===(s=t.LinkedEntity)||void 0===s?void 0:s.IconWidth)?null===(d=t.LinkedEntity)||void 0===d?void 0:d.IconWidth:0},t.getExpandCollapseButtonPadding=m,t.getExpandCollapseButtonWidth=function(e){return e?a.ExpandCollapseButtonSizePx+a.PaddingBetweenExpandCollapseButtonAndTextPx:0},t.shouldExpandCollapseButtonShiftText=function(e,t){var n=s.getEffectiveHorizontalAlignment(e,t);switch(n){case o.HorizontalAlignment.Left:case o.HorizontalAlignment.CenterAcrossSelection:case o.HorizontalAlignment.Center:return!e.IsRtl;case o.HorizontalAlignment.Right:return e.IsRtl;case o.HorizontalAlignment.Automatic:default:throw Error("shouldExpandCollapseButtonShiftText: unsupported horizontalAlignment: "+n)}},t.getCellRightVisualElementsPadding=function(e,t){var n,r=d.isPivotTablePhase2Enabled(e);return e.IsRtl&&(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator)?m(t,r):0},t.cellTextReplacedWithHashes=p,t.doesCellContainsHashesCFIconsAndExpandCollapse=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=t.shouldRenderVerticalText=void 0;var r=n(1);function i(e){var t;return!0===(null===(t=e.CachedStyle)||void 0===t?void 0:t.VerticalText)&&!e.DisplayFormula&&!e.PreviewText}t.shouldRenderVerticalText=i,t.isVerticalAlignmentJustifiedOrDistributedForVerticalText=function(e){if(i(e))switch(e.CachedStyle.VerticalAlignment){case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentJustifiedOrDistributedForVerticalText=function(e){var t;if(i(e))switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invalidHyperlinkCallback=t.shouldHitTestHandleEvent=t.getDevicePixelRatio=t.getAppZoom=t.getServiceSetting=t.tableSelectorsCallback=t.setLastInputMethod=t.togglePivotDrill=t.togglePivotDrillFromChildElement=t.handleGoTo=t.followHyperlink=t.invokeRibbonCommandWithCellReference=t.showOrCloseFloatingCommentCallback=t.pivotFilterClickHandler=t.handleRibbonCommand=t.registerExternalCallbacks=void 0;var r,i=n(7),o=n(0);t.registerExternalCallbacks=function(e){r=e},t.handleRibbonCommand=function(e,t,n,i){o.verifyArgumentNotNull(r,"externalCallbacks","handleRibbonCommand"),r.handleRibbonCommandCallback(e,t,n,i)},t.pivotFilterClickHandler=function(e,t,n){o.verifyArgumentNotNull(r,"externalCallbacks","showPivotFilterMenu"),r.pivotFilterClickHandlerCallback(e,t,n)},t.showOrCloseFloatingCommentCallback=function(e,t,n){o.verifyArgumentNotNull(r,"externalCallbacks","showFloatingCommentCallback"),r.showOrCloseFloatingCommentCallback(e,t,n)},t.invokeRibbonCommandWithCellReference=function(e,t,n,i){o.verifyArgumentNotNull(r,"externalCallbacks","invokeRibbonCommandWithCellReference"),r.invokeRibbonCommandWithCellReferenceCallback(e,t,n,i)},t.followHyperlink=function(e,t){o.verifyArgumentNotNull(r,"externalCallbacks","followHyperlink"),r.followHyperlinkCallback(e,t)},t.handleGoTo=function(e,t,n,i,a,l,s){o.verifyArgumentNotNull(r,"externalCallbacks","handleGoTo"),r.handleGoToCallback(e,t,n,i,a,l,s)},t.togglePivotDrillFromChildElement=function(e){o.verifyArgumentNotNull(r,"externalCallbacks","togglePivotDrillFromChildElement"),r.togglePivotDrillFromChildElementCallback(e)},t.togglePivotDrill=function(e,t,n,i,a){o.verifyArgumentNotNull(r,"externalCallbacks","togglePivotDrill"),r.togglePivotDrillCallback(e,t,n,i,a)},t.setLastInputMethod=function(e){o.verifyArgumentNotNull(r,"externalCallbacks","setLastInputMethod"),r.setLastInputMethod(e)},t.tableSelectorsCallback=function(e,t,n,i){o.verifyArgumentNotNull(r,"externalCallbacks","tableSelectorsCallback"),r.tableSelectorsCallback(e,t,n,i)};var a={};t.getServiceSetting=function(e,t){if(!r)return t;if(!i.isNullOrUndefined(a[e]))return a[e];var n=r.getServiceSetting(e);return a[e]=n,i.isNullOrUndefined(n)?t:n},t.getAppZoom=function(){return r.getAppZoom()},t.getDevicePixelRatio=function(){return r.getDevicePixelRatio()},t.shouldHitTestHandleEvent=function(){return r.shouldHitTestHandleEvent()},t.invalidHyperlinkCallback=function(){return r.invalidHyperlinkCallback()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustXForHorizontalAlignment=t.getEffectiveHorizontalAlignment=t.getTextAlignment=t.isHorizontalAlignmentAdvance=t.isHorizontalAlignmentJustifiedAndDistributed=t.isHorizontalAlignmentCenteredAcrossSelection=void 0;var r=n(1),i=n(7),o=n(2),a=n(19),l=n(11);function s(e,t){var n,o,s;if(t.DisplayFormula)return r.HorizontalAlignment.Left;if(t.PreviewText)return d(e,t);var u=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||r.HorizontalAlignment.Automatic;if((null===(o=t.PivotTable)||void 0===o?void 0:o.HasExpandCollapseIndicator)&&!i.isNullOrUndefined(t.Spill)&&u!==r.HorizontalAlignment.CenterAcrossSelection)return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;if(a.shouldDrawRotatedText(e,t.CachedStyle,t.CachedFont))return a.getOrientationInCanvas(e.IsRtl,null===(s=t.CachedStyle)||void 0===s?void 0:s.Orientation)<0?r.HorizontalAlignment.Left:r.HorizontalAlignment.Right;switch(u){case r.HorizontalAlignment.Fill:return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.Automatic:return l.shouldRenderVerticalText(t)?r.HorizontalAlignment.Left:d(e,t)}return u}function d(e,t){var n,a,l,s=(null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||r.HorizontalAlignment.Automatic;if((null===(a=t.PivotTable)||void 0===a?void 0:a.HasExpandCollapseIndicator)&&(s===r.HorizontalAlignment.Distributed||s===r.HorizontalAlignment.Fill))return e.IsRtl?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;switch((null===(l=t.CachedStyle)||void 0===l?void 0:l.ReadingOrder)||r.ReadingOrderType.Context){case r.ReadingOrderType.LeftToRight:return r.HorizontalAlignment.Left;case r.ReadingOrderType.RightToLeft:return r.HorizontalAlignment.Right;case r.ReadingOrderType.Context:var d=t.Text;if(!i.isNullOrUndefined(d)&&""!==d)return o.isRtlChar(d[0])?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left}return r.HorizontalAlignment.Left}t.isHorizontalAlignmentCenteredAcrossSelection=function(e){var t;return(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment){case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Distributed:return!0}return!1},t.isHorizontalAlignmentAdvance=function(e){return e>r.HorizontalAlignment.Right},t.getTextAlignment=function(e,t){if(l.shouldRenderVerticalText(t))return"center";var n=s(e,t);switch(n){case r.HorizontalAlignment.Right:return"right";case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return"center";case r.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: "+n)}},t.getEffectiveHorizontalAlignment=s,t.adjustXForHorizontalAlignment=function(e,t,n,i){var o=0,a=s(e,t);switch(a){case r.HorizontalAlignment.Left:o=n;break;case r.HorizontalAlignment.Right:o=n-i;break;case r.HorizontalAlignment.Center:case r.HorizontalAlignment.CenterAcrossSelection:o=n-i/2;break;default:throw Error("unexpected context alignment "+a)}return o}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilterLeftAdjustedForDrawing=t.getFilterBottomAdjustedForDrawing=t.isTextAlignedOnButton=t.shouldAddAutoFilterPaddingForMetadata=t.shouldAddAutoFilterPadding=t.getAutoFilterPaddingForAdvancedHorizontalAlignment=t.getAutoFilterButtonPaddingForShrinkToFit=t.getAutoFilterButtonPadding=t.getFilterSizeAdjustedForDrawing=void 0;var r=n(1),i=n(5),o=n(2),a=n(21),l=n(38);function s(e,t,n,r){return a.getInteractiveIconMaxSizeAdjustedForDrawing(l.AutoFilterIconRectPx,e,t,n,r,!1,!0)}function d(e,t,n,r){var i=s(e,t,1,n);return Math.round(i/n+l.AutoFilterTextHorizontalPaddingPx*r)}function u(e,t){return(null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Right&&!e.IsRtl||(null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Left&&e.IsRtl}t.getFilterSizeAdjustedForDrawing=s,t.getAutoFilterButtonPadding=d,t.getAutoFilterButtonPaddingForShrinkToFit=function(e,t,n,i){return function(e,t){var n,i;if(!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)||!(null===(n=t.CachedStyle)||void 0===n?void 0:n.ShrinkToFit))return!1;var o=(null===(i=t.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)||r.HorizontalAlignment.Automatic,a=e.IsRtl?o===r.HorizontalAlignment.Right:o===r.HorizontalAlignment.Left;return t.AutoFilter&&a}(e,t)?d(e,t,n,i):0},t.getAutoFilterPaddingForAdvancedHorizontalAlignment=function(e,t,n,i){return function(e,t){var n;if(!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e))return!1;var i=((null===(n=t.CachedStyle)||void 0===n?void 0:n.HorizontalAlignment)||r.HorizontalAlignment.Automatic)>3;return t.AutoFilter&&i}(e,t)?d(e,t,n,i):0},t.shouldAddAutoFilterPadding=function(e,t){return!!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&(t.AutoFilter&&u(e,t.CachedStyle))},t.shouldAddAutoFilterPaddingForMetadata=function(e,t){return!!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&(t.Autofilter&&u(e,t.CachedStyle))},t.isTextAlignedOnButton=u,t.getFilterBottomAdjustedForDrawing=function(e,t,n,a,s){var d,u=o.getDefaultBorderLineWidth(s*a),c=i.getCellHeightAdjustedForDrawing(e,t)-2*u>n?Math.round(l.AutoFilterPaddingBottomPx*a):0;switch(null===(d=t.CachedStyle)||void 0===d?void 0:d.VerticalAlignment){case r.VerticalAlignment.Top:return i.getCellTopAdjustedForDrawing(e,t,!1)+c+u+n;case r.VerticalAlignment.Center:return i.getCellBottomAdjustedForDrawing(e,t)-Math.round(i.getCellHeightAdjustedForDrawing(e,t)/2)+Math.round(n/2);case r.VerticalAlignment.Bottom:default:return i.getCellBottomAdjustedForDrawing(e,t)-c-u}},t.getFilterLeftAdjustedForDrawing=function(e,t,n,r,a){var s=o.getDefaultBorderLineWidth(a*r),d=i.getCellWidthAdjustedForDrawing(e,t)-2*s>n?Math.round(l.AutoFilterHorizontalPaddingPx*r):0;return e.IsRtl?i.getCellLeftAdjustedForDrawing(e,t,!1,!1)+s:i.getCellRightAdjustedForDrawing(e,t,!1)-n-s-d}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CircledExclamationMarkWidthRectSizeRatio=t.ExclamationMarkMinSpaceBetweenRectangels=t.ExclamationMarkTopRectHeightSizeRatio=t.ExclamationMarkSpaceBetweenRectanglesRatio=t.ExclamationMarkLeftRectanglePaddingRatio=t.ExclamationMarkWidthRectSizeRatio=t.ExclamationMarkBottomRectHeightSizeRatio=t.CrossMarkInnerSmallPaddingRatio=t.CrossMarkInnerBigPaddingRatio=t.CrossMarkInnerCenterRatio=t.CrossMarkOuterSmallPaddingRatio=t.CrossMarkOuterBigPaddingRatio=t.CircledCheckMarkTopMiddleXRatio=t.CircledCheckMarkTopMiddleYRatio=t.CircledCheckMarkTopLeftXRatio=t.CircledCheckMarkTopLeftYRatio=t.CircledCheckMarkMiddleRightXRatio=t.CircledCheckMarkMiddleRightYRatio=t.CircledCheckMarkTopRightXRatio=t.CircledCheckMarkTopRightYRatio=t.CircledCheckMarkBottomYRatio=t.CircledCheckMarkMiddleYRatio=t.CircledCheckMarkMiddleXRatio=t.CheckMarkTopMiddleXRatio=t.CheckMarkTopMiddleYRatio=t.CheckMarkTopLeftXRatio=t.CheckMarkTopLeftYRatio=t.CheckMarkMiddleRightYRatio=t.CheckMarkTopRightXRatio=t.CheckMarkTopRightYRatio=t.CheckMarkBottomYRatio=t.CheckMarkMiddleYRatio=t.CheckMarkMiddleXRatio=t.UnusedColor=t.Circle360Deg=t.Circle180Deg=t.Circle90Deg=t.Circle0Deg=t.Circle270Deg=t.StarInset=t.StarRotation2Cos=t.StarRotationCos=t.StarRotation2Sin=t.StarRotationSin=t.MinimalIconSize=t.MinimalIconPadding=t.FlagPoleWidth=t.CirclePaddingFromBoundariesPx=t.IconImageLookup=t.CFIconImage=void 0,t.StripedCircleLowerLineAngle=t.StripedCircleMiddleLineAngle=t.StripedCircleUpperLineAngle=t.CircleHighContrastLargeRadiusPortion=t.CircleHighContrastMediumRadiusPortion=t.CircleHighContrastSmallRadiusPortion=t.QuarterPiTan=t.CircledCrossMarkPaddingFromCircleRatio=t.CircledCrossMarkInnerBigPaddingRatio=t.CircledCrossMarkInnerSmallPaddingRatio=t.CircledCrossMarkInnerCenterRatio=t.CircledCrossMarkOuterBigPaddingRatio=t.CircledCrossMarkOuterSmallPaddingRatio=t.ArrowAngle=t.ArrowUpRightTipYRatio=t.ArrowUpRightTipXRatio=t.ArrowDownRightTipYRatio=t.ArrowDownRightTipXRatio=t.ArrowHeightRatio=t.ArrowWidthRatio=t.CircledExclamationMarkPaddingFromCircle=t.CircledExclamationMarkTopRectHeightSizeRatio=t.CircledExclamationMarkLeftCircleSizeRatio=void 0,function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(r=t.CFIconImage||(t.CFIconImage={})),t.IconImageLookup=[[r.ColoredArrowDown,r.ColoredArrowRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowRight,r.GrayArrowUp],[r.FlagLow,r.FlagMedium,r.FlagHigh],[r.CircleLow,r.CircleMedium,r.CircleHigh],[r.TrafficLow,r.TrafficMedium,r.TrafficHigh],[r.SignLow,r.SignMedium,r.CircleHigh],[r.CircleSymbolLow,r.CircleSymbolMedium,r.CircleSymbolHigh],[r.SymbolLow,r.SymbolMedium,r.SymbolHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.FourCircleLow,r.FourCircleMedium1,r.FourCircleMedium2,r.FourCircleHigh],[r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.FourCircleLow,r.CircleLow,r.CircleMedium,r.CircleHigh],[r.ColoredArrowDown,r.ColoredArrowDownRight,r.ColoredArrowRight,r.ColoredArrowUpRight,r.ColoredArrowUp],[r.GrayArrowDown,r.GrayArrowDownRight,r.GrayArrowRight,r.GrayArrowUpRight,r.GrayArrowUp],[r.SignalBarEmpty,r.SignalBarLow,r.SignalBarMedium1,r.SignalBarMedium2,r.SignalBarHigh],[r.CircleEmpty,r.Circle25,r.CircleHalf,r.Circle75,r.CircleFilled],[r.StarLow,r.StarMedium,r.StarHigh],[r.TriangleLow,r.TriangleMedium,r.TriangleHigh],[r.QuadrantEmpty,r.Quadrant25,r.QuadrantHalf,r.Quadrant75,r.QuadrantFull]],t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3,t.MinimalIconSize=4;var i=Math.PI/5;t.StarRotationSin=Math.sin(i),t.StarRotation2Sin=Math.sin(2*i),t.StarRotationCos=Math.cos(i),t.StarRotation2Cos=Math.cos(2*i),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.4,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkPaddingFromCircle=2,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125,t.QuarterPiTan=Math.tan(Math.PI/4),t.CircleHighContrastSmallRadiusPortion=.4,t.CircleHighContrastMediumRadiusPortion=.55,t.CircleHighContrastLargeRadiusPortion=.7,t.StripedCircleUpperLineAngle=.05*Math.PI,t.StripedCircleMiddleLineAngle=.25*Math.PI,t.StripedCircleLowerLineAngle=.45*Math.PI},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeLinesAdjustment=t.ShapeOutlineWidthPx=void 0;var r=n(0);t.ShapeOutlineWidthPx=1,t.ShapeLinesAdjustment=r.getLinePixelTranslation(t.ShapeOutlineWidthPx)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canonizeFontName=t.isKnownFont=t.sanitizeFontName=t.getFontNameForLogging=void 0;var r=n(28);function i(e){return"Sanitized_"+e}function o(e){return r.KnownFontNamesLowerCase.indexOf(e.replace(/\s/g,"").toLowerCase())>-1}t.getFontNameForLogging=function(e){var t="Custom Font";return o(e)&&(t=i(e)),t},t.sanitizeFontName=i,t.isKnownFont=o,t.canonizeFontName=function(e){var t=e,n=e.indexOf("(Body)");return n>0&&(t=e.substring(0,n).trim()),t.replace(/[\""]/g,"").toLowerCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUnderlinePadding=t.degreeToRadians=t.getRotatedTextVerticalPadding=t.getRotatedTextVerticalPosition=t.getRotatedTextHorizontalPosition=t.getEffectiveHorizontalAlignmentForRotatedText=t.getIndexOfMaxLineWidth=t.getRotatedWrapTextWidth=t.getRotatedTextBoxHeight=t.getRotatedTextBoxWidth=t.applyRotation=t.getOrientationInCanvas=t.isRotatedTextSlice2Enabled=t.isRotatedTextSlice1Enabled=t.shouldDrawRotateTextSlice1=t.shouldDrawRotatedText=void 0;var r=n(1),i=n(0),o=n(60),a=n(61),l=n(3);function s(e,t){return d(e)&&!!(null==(i=t)?void 0:i.Orientation)&&!((n=null==t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill||n===r.HorizontalAlignment.CenterAcrossSelection);var n,i}function d(e){return r.isRenderFlagEnabled(r.RenderFlagsArray.TextOrientationSlice1,e)}function u(e){return r.isRenderFlagEnabled(r.RenderFlagsArray.TextOrientationSlice2,e)}function c(e,t,n){return e*Math.abs(Math.cos(n))+t}t.shouldDrawRotatedText=function(e,t,n){var r;return!(!(r=n)||!r.StrikeThrough&&!r.Underline&&!r.VerticalAlign)?u(e)&&s(e,t):s(e,t)},t.shouldDrawRotateTextSlice1=s,t.isRotatedTextSlice1Enabled=d,t.isRotatedTextSlice2Enabled=u,t.getOrientationInCanvas=function(e,t){(t>l.MaxOrientationRange||t<l.MinOrientationRange)&&i.throwError("Orientation is not in the defined range","getOrientationInCanvas");var n=-1*t;return e?-1*n:n},t.applyRotation=function(e,t,n,r){e.save(),e.textAlign=r<0?l.LeftTextAlign:l.RightTextAlign,e.translate(t,n),e.rotate(r)},t.getRotatedTextBoxWidth=c,t.getRotatedTextBoxHeight=function(e,t,n){return e*Math.abs(Math.sin(n))+t*Math.abs(Math.cos(n))},t.getRotatedWrapTextWidth=function(e,t,n){var r=e.length;if(1===r)return c(e[0].width,t[0],n);if(r>1){for(var i=Math.abs(Math.cos(n)),o=Math.abs(Math.sin(n)),a=e[0].width*i,l=0,s=1;s<e.length;s++)l+=t[s]/o,a=Math.max(a,l+e[s].width*i);return a+t[0]}return 0},t.getIndexOfMaxLineWidth=function(e){for(var t=0,n=0,r=0;r<e.length;r++)e[r].width>n&&(n=e[r].width,t=r);return t},t.getEffectiveHorizontalAlignmentForRotatedText=function(e,t){switch(e){case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.JustifyDistributed:return t?r.HorizontalAlignment.Right:r.HorizontalAlignment.Left;case r.HorizontalAlignment.Left:case r.HorizontalAlignment.Right:case r.HorizontalAlignment.Center:return e;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Fill:default:throw Error("getEffectiveHorizontalAlignmentForRotatedText: Unsupported horizontal alignment "+e)}},t.getRotatedTextHorizontalPosition=function(e,t,n,i,o,a,l,s,d){var u=s<0;switch(e){case r.HorizontalAlignment.Left:return u?t+i*Math.abs(Math.sin(s))+o:t+l-i+o+a;case r.HorizontalAlignment.Right:return u?n-l-o-a+i:n-i*Math.abs(Math.sin(s))-o;case r.HorizontalAlignment.Center:return u?t+(d-l)/2+i:n-(d-l)/2-i;default:throw Error("getRotatedTextHorizontalPosition: unsupported horizontalAlignment: "+e)}},t.getRotatedTextVerticalPosition=function(e,t,n,i,o,a,s){switch(e){case r.VerticalAlignment.Top:return a+i+t;case r.VerticalAlignment.Center:return s-(o-i)/2;case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:default:return s-(t-(n?l.InCellVerticalPaddingPx:0))}},t.getRotatedTextVerticalPadding=function(e,t){var n=!!e.WrapText||i.cellHasShrinkToFit(e),l=a.CalibriRegularPadding;switch(e.CachedStyle.VerticalAlignment){case r.VerticalAlignment.Center:return n?o.approximateValue(t,l):0;case r.VerticalAlignment.Top:return e.CachedFont.Italic&&(l=a.CalibriItalicPadding),o.approximateValue(t,l);case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:case r.VerticalAlignment.Bottom:default:return o.approximateValue(t,l)}},t.degreeToRadians=function(e){return e*Math.PI/180},t.getUnderlinePadding=function(e,t){return e.Underline?function(e){return Math.abs(e)===l.NinetyDegreeInRadians}(t)?2*l.GridLineWidthPx:l.GridLineWidthPx:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHitRegionInternal=t.registerTooltipHitRegion=t.registerLongPressHitRegion=t.registerCursorHitRegion=t.registerHitRegion=void 0;var r=n(1);function i(e,t,n){(function(e,t){var n=r.getCellLookupKey(t.Row,t.Col),i=e[n];i||(e[n]=[],i=e[n]);return i})(t,e).push(n)}function o(e){var t=e.rect,n=Math.round(t.x/e.scaleFactor),r=Math.round(t.y/e.scaleFactor),i=Math.round(t.width/e.scaleFactor),o=Math.round(t.height/e.scaleFactor),a=e.renderingRegion,l=n-(e.isRtl?e.blockWidth-a.endOffsetX:a.startOffsetX),s=r-a.startOffsetY;return{x:e.isMirrored?a.endOffsetX-n-i:l,y:s,width:i,height:o}}t.registerHitRegion=function(e,t,n,r,a,l){var s={eventType:l,callback:a,zIndex:r,region:o(n)};i(e,t.CellHitRegions,s)},t.registerCursorHitRegion=function(e,t,n,r,a){var l={cursorType:r,zIndex:a,region:o(n)};i(e,t.CellCursorHitRegions,l)},t.registerLongPressHitRegion=function(e,t,n,r,a,l){var s={zIndex:r,region:o(n),onStart:a,onEnd:l};i(e,t.CellLongPressHitRegions,s)},t.registerTooltipHitRegion=function(e,t,n,r,a){var l={tooltipText:r,zIndex:a,region:o(n)};i(e,t.CellTooltipHitRegions,l)},t.registerHitRegionInternal=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDynamicImageCallback=t.createRichErrorCallback=t.createCommentsCallback=t.getUnadjustedHitRegionFromRect=t.getInteractiveIconMaxSizeAdjustedForDrawing=void 0;var r=n(5),i=n(2),o=n(12),a=n(0),l=n(7),s=n(26);function d(e,t,n,r){var i=function(e,t){var n,r,i=e.RowNumbers[t.Row]-1,o=e.ColumnNumbers[t.Col]-1,a=(null===(n=t.Merge)||void 0===n?void 0:n.OriginRow)||0,l=(null===(r=t.Merge)||void 0===r?void 0:r.OriginColumn)||0;a&&l&&(i=a,o=l);return{commentRow:i,commentColumn:o}}(e,t),a=i.commentRow,l=i.commentColumn;return n?function(i){return t.HasIgnorableError&&u(e,t,e.RibbonCommands.CardViewHideTemporaryCard,!0)(i),c(e,t,!1,!0)(i),o.showOrCloseFloatingCommentCallback(a,l,n),r}:function(i){return c(e,t,!0,!0)(i),o.showOrCloseFloatingCommentCallback(a,l,n),r}}function u(e,t,n,r){var i=e.RowNumbers[t.Row],a=e.ColumnNumbers[t.Col];return function(l){var s=n===e.RibbonCommands.CardViewShowTemporaryErrorCard;return t.Comment&&s&&d(e,t,!1,!1)(l),o.invokeRibbonCommandWithCellReference(l,n,i,a),r}}function c(e,t,n,r){var i=e.RowNumbers[t.Row],d=e.ColumnNumbers[t.Col];return function(u){var c=a.getDynamicImageInformationFromCell(t,s.ImageType.InCellImage);return l.isNullOrUndefined(c)||o.invokeRibbonCommandWithCellReference(u,n?e.RibbonCommands.CardViewShowTemporaryDataCard:e.RibbonCommands.CardViewHideTemporaryCard,i,d),r}}t.getInteractiveIconMaxSizeAdjustedForDrawing=function(e,t,n,o,a,l,s){var d=i.getDefaultBorderLineWidth(a*o),u=r.getCellWidthAdjustedForDrawing(t,n)-d,c=r.getCellHeightAdjustedForDrawing(t,n)-d,g=e;return s&&(g*=o),l&&(g*=a),Math.ceil(Math.max(Math.min(g,u,c),0))},t.getUnadjustedHitRegionFromRect=function(e,t,n,r){return{isMirrored:r,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n.x,y:n.y,width:n.width,height:n.height},isRtl:e.IsRtl,blockWidth:e.BlockWidth}},t.createCommentsCallback=d,t.createRichErrorCallback=u,t.createDynamicImageCallback=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SymbolHighOuterColor=t.SymbolMediumInnerColor=t.SymbolMediumOuterColor=t.SymbolLowInnerColor=t.SymbolLowOuterColor=t.SignLowInnerColor=t.SignLowOuterColor=t.SignMediumInnerColor=t.SignMediumOuterColor=t.StarEmptyInnerColor=t.StarEmptyOuterColor=t.StarFilledInnerColor=t.StarFilledOuterColor=t.TriangleHighInnerColor=t.TriangleHighOuterColor=t.TriangleMediumInnerColor=t.TriangleMediumOuterColor=t.TriangleLowInnerColor=t.TriangleLowOuterColor=t.FlagHighInnerColor=t.FlagHighOuterColor=t.FlagMediumInnerColor=t.FlagMediumOuterColor=t.FlagLowInnerColor=t.FlagLowOuterColor=t.FlagPoleColor=t.QuadrantBoxesOutlineColor=t.QuadrantBoxesFilledColor=t.QuadrantBoxesEmptyColor=t.SignalBarOutlineColor=t.SignalBarFilledColor=t.SignalBarEmptyColor=t.TrafficHighRimmedRectColor=t.FourCircleHighOuterColor=t.FourCircleHighInnerColor=t.FourCircleLowOuterColor=t.FourCircleMedium1OuterColor=t.FourCircleMedium1InnerColor=t.FourCircleMedium2OuterColor=t.FourCircleMedium2InnerColor=t.CircleEmptyOuterColor=t.CircleEmptyInnerColor=t.CircleFilledOuterColor=t.CircleFilledInnerColor=t.CircleHighOuterColor=t.CircleHighInnerColor=t.CircleMediumOuterColor=t.CircleMediumInnerColor=t.CircleLowOuterColor=t.CircleLowInnerColor=void 0,t.CircleSymbolInnerShapeInnerColor=t.ArrowRightOuterColor=t.ArrowDownOuterColor=t.ArrowUpOuterColor=t.ArrowRightInnerColor=t.ArrowDownInnerColor=t.ArrowUpInnerColor=t.ArrowGrayInnerColor=t.ArrowGrayOuterColor=t.SymbolHighInnerColor=void 0,t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagPoleColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedOffsetXforHorizontalAlignment=t.measureFormattedTextWidth=t.substringFormattedText=t.fillRichTextFormat=void 0;var r=n(1),i=n(0),o=n(6),a=n(48),l=n(29),s=n(2),d=n(5),u=n(9),c=n(3),g=n(13),h=n(30),f=n(7),m=n(65),p=n(46),C=n(52),v=n(11),y=n(10),T=n(51),S=n(28),F=n(15);function x(e,t){return e>=t.StartIndex&&e<t.EndIndex}function w(e,t,n){for(var r=[],i=0;i<t.length;i++){var o=t[i];if(x(e,o))return i;o&&r.push({index:i,startIndex:o.StartIndex,endIndex:o.EndIndex})}var a=n.text,l=n.formattedTextLength,s=n.isCarriageReturnExists,d=T.breakToGraphemes(a);throw Error("Failed to find text run index for textOffsetIndex: "+e+", runs.length: "+t.length+", runsIndices: "+JSON.stringify(r)+", formattedTextLength: "+l+", isCarriageReturnExists:"+s+", isGraphemeExists: "+((null==a?void 0:a.length)!==d.length)+" ")}function R(e,t,n){var r=e.CachedFont;e.ShrunkSize=r.Size*t,e.FontCss=i.getFontCssStringFromFont(r,e.ShrunkSize,n),e.WidthPx=e.WidthPx*t}function b(e,t,n){var r=t.CachedFont;t.ShrunkSize=n;var a=o.getFontLineHeight(e,t.ShrunkSize,null==r?void 0:r.FontName),l=o.measureTextHeightForVerticalText(a,t.Text);t.FontCss=i.getFontCssStringFromFont(r,t.ShrunkSize,e),t.MaxGlyphHeightPx=a,t.HeightPx=l}function I(e,t){for(var n=0,i=t,o=!1,a=!1,l=t;l<e.length;l++){var s=e[l];if(s.Underline===r.FontUnderline.None)break;s.Underline===r.FontUnderline.Single?o=!0:s.Underline===r.FontUnderline.Double&&(a=!0);var d=s.CachedFont;n=Math.max(n,s.ShrunkSize||d.Size),i=l}return{maxFontSize:n,sequenceEndRunIndex:i,hasMixedUnderlineTypes:o&&a}}function A(e,t,n,r,i,o){var a=r&&!f.isNullOrUndefined(o)?o:i;return g.adjustXForHorizontalAlignment(e,t,n,a)}function P(e,t,n,r,i){return r?n:i?t:e}function D(e,t,n,i,a,l){var s,d=l,u=0;return(s=t===r.FontVerticalAlignment.Subscript||t===r.FontVerticalAlignment.Superscript)&&(u=o.calculateSubSuperOffsetY(e,t||r.FontVerticalAlignment.None,n,i,a,s),d=!0),{subSuperOffsetY:u,hasVerticalAlignedFont:d,isFontVerticalAlignment:s}}function M(e,t,n,i,o,a,s,d,u,c,g,h,f,p){var C=a,v=o;if(f)!function(e,t,n,i,o,a,s,d,u,c,g){var h,f;if(!n.JustifyDistributedLine)return;var m=t+(u?0:n.JustifyDistributedLine.Start.Offset),p=m,C=!0===n.Strikethrough;O(e,o,a,n.JustifyDistributedLine.Start,t,i,u,n.MaxGlyphHeightPx,s,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.Start.Offset+n.JustifyDistributedLine.Start.Width),(null===(h=n.JustifyDistributedLine)||void 0===h?void 0:h.Middle)&&(O(e,o,a,n.JustifyDistributedLine.Middle,t,i,u,n.MaxGlyphHeightPx,s,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.Middle.Offset+n.JustifyDistributedLine.Middle.Width));(null===(f=n.JustifyDistributedLine)||void 0===f?void 0:f.End)&&(O(e,o,a,n.JustifyDistributedLine.End,t,i,u,n.MaxGlyphHeightPx,s,C,d,c,g),m=t+(u?0:n.JustifyDistributedLine.End.Offset+n.JustifyDistributedLine.End.Width));if(!u&&(n.Underline!==r.FontUnderline.None||n.Strikethrough)){var v={clipRect:c,textPositionX:p,textPositionY:i,textWidth:m-p,partOfMixedUnderlineSequence:n.HasMixedUnderline};l.cacheTextDecorationLayout(o,a,s,v,d,n.UnderlineWidth)}}(e,o,s,a,t,n,i,s.CachedFont,h,c,p);else{if(k(e,t,n,s.Text,o,a,h,s.MaxGlyphHeightPx,i,!0===s.Strikethrough,s.CachedFont,c),!h&&(s.Underline!==r.FontUnderline.None||s.Strikethrough)){var y={clipRect:c,textPositionX:o,textPositionY:a,textWidth:s.WidthPx,containSubscript:g===r.FontVerticalAlignment.Subscript,partOfMixedUnderlineSequence:s.HasMixedUnderline};l.cacheTextDecorationLayout(t,n,i,y,s.CachedFont,s.UnderlineWidth)}h?C=function(e,t,n,i,o){var a=o+1<i.length?m.getTextRun(!0,i,o+1).HeightPx:0;switch(e){case r.VerticalAlignment.Top:return t-a;case r.VerticalAlignment.Center:return t-(n.HeightPx+a)/2;case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:return t-n.HeightPx}}(n.CachedStyle.VerticalAlignment,a,s,d,u):v+=s.WidthPx}return{offsetX:v,offsetY:C}}function O(e,t,n,r,i,o,a,l,s,d,u,c,g){var h=i,f=o;a?f-=r.Offset:h+=r.Offset,k(e,t,n,r.Text,h,f,a,l,s,d,u,c,g)}function k(e,t,n,r,i,o,a,l,s,d,u,c,g){a?C.fillVerticalTextForRTF(e,t,n,r,i,o,l,s,d,u,c,g):e.fillText(r,i,o)}function L(e,t){for(var n=0,r=t[0],i=0;i<e.length;i++){var o=e[i].CachedFont;n=Math.max(n,o.Size),r.Size<n&&(r=o)}return r}t.fillRichTextFormat=function(e,t,n,c,C,T,x,w,O,k){if(i.verifyArgumentNotNull(c,"cell","fillRichTextFormat"),i.verifyArgumentNotNull(n,"model","fillRichTextFormat"),i.verifyArgumentNotNull(C,"formattedText","fillRichTextFormat"),i.verifyArgumentNotNull(C.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0!==C.Text.length){var H=C.TextRuns;i.verifyArgumentNotNull(H[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");var E=function(e,t){if(!t)return!1;if(v.isVerticalAlignmentJustifiedOrDistributedForVerticalText(e))return!(t.breakType===h.BreakType.Justify&&t.isProcessingLastLine);return g.isHorizontalAlignmentJustifiedAndDistributed(e)}(c,k),B=function(e,t,n,l,c,g,h,p,C){var T=o.getBidiContext(n),x=v.shouldRenderVerticalText(n),w=function(e,t,n,r,i){var a,l,s=t.Fonts;if(n.WrapText){var d=o.measureTextRunsWidth(e,r,i,t,o.getBidiContext(n));l=d.totalSize,a=d.textRunsDrawingInformation}else l=o.getTextWidth(e,t,n),a=n.CachedDrawingLayout.TextRunDrawingInformation;if(!a||!r)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";var u=L(a,s);return{totalTextRunWidth:l,largestFont:u,preparedRuns:a}}(e,t,n,c,g),A=0,P=w.totalTextRunWidth,D=w.largestFont,M=w.preparedRuns;!x&&T.HasRtl&&u.trackDuration(u.RenderPerformanceMetric.ReorderBidiTextRuns,(function(){a.reorderTextRunsForBidiDrawing(M,g,T,P)}),!0);x&&(A=function(e,t){for(var n=0,r=0;r<t.length;r++){var i=t[r],a=i.CachedFont,l=o.getFontLineHeight(e,null==a?void 0:a.Size,null==a?void 0:a.FontName),s=o.measureTextHeightForVerticalText(l,i.Text);i.MaxGlyphHeightPx=l,i.HeightPx=s,n+=s}return n}(t,M));n.CachedStyle.ShrinkToFit&&(x?A=function(e,t,n,r){var i=d.getCellHeight(e,t,!1);if(r<i)return r;return function(e,t,n,r){for(var i=0,o=0;o<t.length;o++){var a=(d=t[o]).CachedFont,l=Math.floor(a.Size*r);b(e,d,l),i+=d.HeightPx}for(;i<n;){i=0;for(o=0;o<t.length;o++){if((d=t[o]).ShrunkSize<S.MaxAllowedFontSize){var s=d.ShrunkSize+1;b(e,d,s)}i+=d.HeightPx}}for(;i>n;){i=0;for(o=0;o<t.length;o++){var d;if((d=t[o]).ShrunkSize>S.MinAllowedFontSize){s=d.ShrunkSize-1;b(e,d,s)}i+=d.HeightPx}}return i}(e,n,i,i/r)}(t,n,M,A):P=function(e,t,n,r,a){var l=d.getCellWidth(e,t,!1),u=t.CachedStyle.Indentation||0,c=F.shouldAddAutoFilterPadding(e,t)?F.getAutoFilterButtonPadding(e,t,n.zoom,n.devicePixelRatio):0,g=r[0].CachedFont,h=o.getHorizontalPadding(e,t,g.Size,t.CachedFont.Italic,u||0,!0,c),f=i.isPivotTablePhase2Enabled(e),m=s.getTextDrawingMaxWidth(l,h,o.getDistanceFromCellStartToIconEnd(e,t,n.zoom,n.devicePixelRatio),y.getExpandCollapseButtonPadding(t,f),0);if(a<m)return a;for(var p=m/(a+h),C=0,v=0;v<r.length;v++){var T=r[v];R(T,p,e),C+=T.WidthPx}return C}(t,n,l,M,P));(function(e){var t=0;for(;t<e.length;){if(e[t].Underline===r.FontUnderline.None)t++;else for(var n=I(e,t),i=n.maxFontSize,a=n.sequenceEndRunIndex,l=n.hasMixedUnderlineTypes,s=o.getTextDecorationLineWidth(i);t<=a;t++)e[t].UnderlineWidth=s,e[t].HasMixedUnderline=l}})(M),!h||f.isNullOrUndefined(p)||f.isNullOrUndefined(C)||m.prepareTextRunsForJustifyAndDistributed(e,t,C,p,M,x);return{totalTextRunHeight:A,totalTextRunWidth:P,largestFont:D,preparedRuns:M}}(e,n,c,t,H,C.Text,E,O,k),N=B.totalTextRunHeight,W=B.totalTextRunWidth,z=B.largestFont,j=B.preparedRuns,_=r.getCellStyle(n,c);i.verifyArgumentNotNull(_,"cellStyle","fillRichTextFormat"),function(e,t,n,a,u,c,g,h,C,y,T,F,x){var w,R,b,I=e.textAlign,O=e.textBaseline,k=e.font,H=e.fillStyle,E=v.shouldRenderVerticalText(a),B=h;E&&(B=function(e,t,n,i,o,a,l){var s;if(!a&&(null===(s=t.CachedStyle)||void 0===s?void 0:s.VerticalAlignment)===r.VerticalAlignment.Justify){var u=L(n,e.Fonts),c=p.getCachedFontMetrics(u.FontName,u.Size,e).baseline;return d.getCellBottom(e,t)-S.LineHeightBottomConstantPx-c-(l-i)}return o}(n,a,C,y,B,T,x));B=function(e,t,n,a,l,s,d){if(t)return function(e,t,n,i){var o=e.CachedStyle.VerticalAlignment,a=i.length-1,l=i[a].HeightPx||0;switch(o){case r.VerticalAlignment.Top:return t+n-l;case r.VerticalAlignment.Justify:case r.VerticalAlignment.Distributed:case r.VerticalAlignment.Bottom:return t;case r.VerticalAlignment.Center:return t+(n-l)/2}}(n,a,l,s);return function(e,t,n,a){var l=n.CachedStyle.VerticalAlignment,s=o.getFontLineHeight(e,t.Size,t.FontName),d=p.getCachedFontMetrics(t.FontName,t.Size,e).baseline;i.verifyArgumentNotNull(d,"textBaselineAdjustY","adjustYForVerticalAlignment");var u=a-d;if(l===r.VerticalAlignment.Center)return u+(s-d)/2;return u}(e,d,n,a)}(n,E,a,B,y,C,c);var N=E?g:A(n,a,g,T,u,x),W=!1;e.textAlign="left",e.textBaseline="alphabetic",t.highContrastScheme&&(e.fillStyle=s.getHighContrastTextColor(a,t.highContrastScheme));for(var z=0;z<C.length;z++){var j=m.getTextRun(E,C,z);i.verifyArgumentNotNull(j.CachedFont,"run.CachedFont","drawTextRuns");var _=j.CachedFont,V=_.VerticalAlign,U=0,G=!1;E||a.WrapText||(w=D(a,V,_,h,p.getCachedFontMetrics(_.FontName,_.Size,n),W),U=w.subSuperOffsetY,G=w.isFontVerticalAlignment,W=w.hasVerticalAlignedFont),e.font=j.FontCss,t.highContrastScheme||(e.fillStyle=j.CachedFont.Color),R=M(e,n,a,t,N,P(h,U,B,E,G),j,C,z,F,V,E,T,x),N=R.offsetX,B=R.offsetY}W&&!f.isNullOrUndefined(null===(b=a.CachedDrawingLayout)||void 0===b?void 0:b.UnderlineRuns)&&l.alignVerticalUnderlineRuns(n,a,a.CachedDrawingLayout.UnderlineRuns);e.textAlign=I,e.textBaseline=O,e.font=k,e.fillStyle=H}(e,t,n,c,W,z,T,x,j,N,E,w,null==k?void 0:k.maxWidth)}},t.substringFormattedText=function(e,t,n){if(i.verifyArgumentNotNull(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return c.EmptyFormattedText;var r=e.Text.substring(t,n);if(0===r.length)return{Text:r,Fonts:e.Fonts,TextRuns:[]};var o=e.TextRuns;if(i.verifyArgumentNotNull(o,"formattedText.runs","substringFormattedText"),0===o.length)throw Error("Invalid param: formattedText runs.length === 0");i.prepareTextRunRanges(o,e.Text);var a=e.Text.length,l={isCarriageReturnExists:-1!==e.Text.indexOf("\r"),formattedTextLength:a,text:e.Text},s=w(t,o,l),d=n&&n<e.Text.length?w(n-1,o,l):o.length-1,u=[],g=o[s];u.push({StartIndex:0,FontID:g.FontID||0,CachedFont:g.CachedFont});for(var h=s+1;h<=d;h++){var f=o[h],m=f.StartIndex-t;u.push({StartIndex:m,FontID:f.FontID||0,CachedFont:f.CachedFont})}return{Text:r,Fonts:e.Fonts,TextRuns:u}},t.measureFormattedTextWidth=function(e,t,n){return o.measureTextRunsWidth(e,t.TextRuns,t.Text,n).totalSize},t.getAdjustedOffsetXforHorizontalAlignment=A},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyTrueCallback=t.EmptyFalseCallback=t.TouchCallback=t.MinLongPressDurationMs=t.DoubleClickEventType=t.ClickEventType=t.DefaultTooltip=t.DefaultCursorType=t.PointerCursorType=t.UnsetCursorType=t.OutsideCanvasPoint=t.PointerUpEvent=t.PointerDownEvent=t.PointerMoveEvent=t.LongPressEventType=t.TooltipEventType=t.CursorEventType=t.HitMapKeyXShift=t.MaxHitMapOffsetCount=t.DefaultHitMapSectionsCount=void 0;var r=n(12);t.DefaultHitMapSectionsCount=30,t.MaxHitMapOffsetCount=32,t.HitMapKeyXShift=5,t.CursorEventType="cursor",t.TooltipEventType="tooltip",t.LongPressEventType="longpress",t.PointerMoveEvent="pointermove",t.PointerDownEvent="pointerdown",t.PointerUpEvent="pointerup",t.OutsideCanvasPoint={x:-1,y:-1},t.UnsetCursorType="unset",t.PointerCursorType="pointer",t.DefaultCursorType="default",t.DefaultTooltip="",t.ClickEventType="click",t.DoubleClickEventType="dblclick",t.MinLongPressDurationMs=800;t.TouchCallback=function(e){return r.setLastInputMethod(e),!1};t.EmptyFalseCallback=function(){return!1};t.EmptyTrueCallback=function(){return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRoundRectangle=t.drawRectangle=void 0;var r=n(1),i=n(17);t.drawRectangle=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawRectangle"),r.verifyArgumentNotNull(t,"drawingContext","drawRectangle");var n=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,d=t.width,u=a+i.ShapeLinesAdjustment,c=l-s-i.ShapeLinesAdjustment;o&&function(e,t,n,r,i,o){e.strokeStyle=o,e.beginPath(),e.rect(t,n,r,i),e.stroke()}(e,u,c,d,s,o),n&&function(e,t,n,r,i,o){e.fillStyle=o,e.beginPath(),e.fillRect(t,n,r,i),e.fill()}(e,a+i.ShapeOutlineWidthPx,l-s,d-i.ShapeOutlineWidthPx,s-i.ShapeOutlineWidthPx,n)},t.drawRoundRectangle=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawRoundRectangle"),r.verifyArgumentNotNull(t,"drawingContext","drawRoundRectangle");var n=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,d=t.width,u=t.radius,c=a+i.ShapeLinesAdjustment,g=l-s-i.ShapeLinesAdjustment,h=c+d,f=g+s;e.beginPath(),e.roundRect?e.roundRect(c,g,d,s,[u]):(e.moveTo(c+u,g),e.lineTo(h-u,g),e.quadraticCurveTo(h,g,h,g+u),e.lineTo(h,f-u),e.quadraticCurveTo(h,f,h-u,f),e.lineTo(c+u,f),e.quadraticCurveTo(c,f,c,f-u),e.lineTo(c,g+u),e.quadraticCurveTo(c,g,c+u,g)),e.closePath(),n&&(e.fillStyle=n,e.fill()),o&&(e.strokeStyle=o,e.stroke())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testHelper=t.getOrLoadStaticImage=t.getOrLoadVersionedImage=t.clearImageFromCache=t.setStaticImageUrl=t.initializeGridRendererImageLoader=t.ImageType=t.ImageLoadStatus=void 0;var r,i=n(1);!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(r=t.ImageLoadStatus||(t.ImageLoadStatus={})),function(e){e[e.Sparkline=0]="Sparkline",e[e.InCellImage=1]="InCellImage"}(t.ImageType||(t.ImageType={}));var o={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function l(e,t,n,i){var o=g(e);if(o||(h(e,o={blockIdentifiers:[t],status:r.Initialized,version:n,url:i}),i))switch(o.status){case r.Loaded:return o.image;case r.LoadFailed:return;case r.Loading:return void u(t,o);case r.Initialized:return u(t,o),void(o.url&&c(o));default:throw Error("getOrLoadImageByKey: unexpected image statue: "+o.status)}}function s(e){return"STATIC"+e}function d(e,t){return e+t}function u(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function c(e){if(!e.url)throw Error("image url is not set, unexpected call");var t=new Image;t.onload=function(){e.status=r.Loaded,i.verifyArgumentNotNull(o.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),o.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=r.LoadFailed,i.verifyArgumentNotNull(o.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),o.onImageLoadFailureCallback("image failed to load, URL: "+e.url+", registeredModelsCount: "+e.blockIdentifiers.length+", registeredModelsCount: "+e.blockIdentifiers),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=r.Loading}function g(e){return a[e]}function h(e,t){a[e]=t}function f(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){o.onImageLoadSuccessCallback=e,o.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){i.verifyArgumentNotNull(t,"url","setStaticImageUrl");var n=s(e),o=g(n);if(o){if(o.url)throw Error("setStaticImageUrl: image url already defined. image: "+e+", old url: "+o.url+", new url: "+t);o.url=t,c(o)}else h(n,{blockIdentifiers:[],status:r.Initialized,url:t})},t.clearImageFromCache=function(e,t){var n=d(e,t);g(n)&&f(n)},t.getOrLoadVersionedImage=function(e,t,n,r,i){var o=d(e,r),a=g(o);return!a||a.version===t&&a.url===n||f(o),l(o,i,t,n)},t.getOrLoadStaticImage=function(e,t){return l(s(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:function(e){return g(e)},resetImageCache:function(){for(var e in a)delete a[e]},getImageKey:function(e,t){return d(e,t)}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubscriptVerticalPaddingForUnderlinePx=t.KnownFontNamesLowerCase=t.LineHeightBottomConstantPx=t.LineHeightUsingDivFontFactor=t.LineLeading=t.LineHeightFontFactor=t.DefaultFontName=t.DefaultFontSizePt=t.MaxAllowedFontSize=t.MinAllowedFontSize=void 0,t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.KnownFontNamesLowerCase=["angsananew","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho","xlyellow"],t.SubscriptVerticalPaddingForUnderlinePx=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.alignVerticalUnderlineRuns=t.drawTextDecoration=t.cacheTextDecorationLayout=t.measureAndCacheTextDecorationLayout=void 0;var r=n(1),i=n(3),o=n(0),a=n(2),l=n(6),s=n(5),d=n(13),u=n(7),c=n(11),g=n(19);function h(e,t,n,i,a,l){if(o.verifyArgumentNotNull(t,"cell","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),o.verifyArgumentNotNull(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),a.Underline!==r.FontUnderline.None&&!c.shouldRenderVerticalText(t)){var s={underline:a.Underline},d=p(e,t,n,i,s,a,!1,l),u=t.CachedDrawingLayout.UnderlineRuns;if(d&&u.push(d),C(s)){var g=p(e,t,n,i,{underline:s.underline===r.FontUnderline.DoubleAccounting?r.FontUnderline.SingleAccounting:r.FontUnderline.Single},a,!0,l);g&&u.push(g)}}if(a.StrikeThrough){var h=p(e,t,n,i,{strikethrough:!0},a,!1,void 0);if(h)t.CachedDrawingLayout.StrikethroughRuns.push(h)}}function f(e,t,n,r,i,o){for(var a=0,l=[i,o];a<l.length;a++){var s=l[a];if(s&&s.length>0){if(!t||!n){var d=s[0];t=c=null!=r?r:d.Color,n=d.LineWidth,e.strokeStyle=c,e.lineWidth=d.LineWidth}for(var u=0;u<s.length;u++){var c,g=s[u],h=t!==(c=null!=r?r:g.Color),f=n!==g.LineWidth;(h||f)&&(t=c,n=g.LineWidth,e.stroke(),e.strokeStyle=c,e.lineWidth=g.LineWidth,e.beginPath()),S(e,g)}}}return{lineColor:t,lineWidth:n}}function m(e){return e[0].Y>e[1].Y?{top:e[1],bottom:e[0]}:{top:e[0],bottom:e[1]}}function p(e,t,n,a,h,f,m,p){var v=n.scaleFactor,S=m||a.partOfMixedUnderlineSequence&&h.underline===r.FontUnderline.Single,F=o.getActualFontSizeFromFont(t,f,!1),x=function(e,t,n,i,a,g,h,f){var m,p,C,v,y=i.textPositionX,T=i.textWidth,S=n.scaleFactor;if(a.underline===r.FontUnderline.SingleAccounting||a.underline===r.FontUnderline.DoubleAccounting){var F=l.getCellTextHorizontalPadding(t,e,n.zoom,n.devicePixelRatio);p=s.getCellLeft(e,t,e.BlockWidth)+F,C=s.getCellRight(e,t,e.BlockWidth)-F}else{var x=!u.isNullOrUndefined(t.TextRuns)||d.isHorizontalAlignmentJustifiedAndDistributed(t);m=function(e,t,n,i,o){var a,l,s=o?r.HorizontalAlignment.Left:d.getEffectiveHorizontalAlignment(e,t);c.shouldRenderVerticalText(t)&&(s=r.HorizontalAlignment.Center);switch(s){case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:a=n,l=n+i;break;case r.HorizontalAlignment.Right:a=n-i,l=n;break;case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:a=n-i/2,l=n+i/2;break;default:a=n,l=n+i}return{startX:a,endX:l}}(e,t,y,T,x),p=m.startX,C=m.endX}v=a.strikethrough?function(e,t,n,r,i){var a=n.textPositionY;o.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","calculateStrikethroughY");var s=l.getTextDecorationLineWidth(i.Size);return l.getMiddleBaseline(e,a,i,r)-s/2}(e,t,i,g,h):function(e,t,n,r){var i=t.textPositionY;o.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var a=null!=r?r:l.getTextDecorationLineWidth(n);return i+2*a}(t,i,g,f);return p=Math.round(p*S),C=Math.round(C*S),v=Math.round(v*S),{startX:p,endX:C,Y:v}}(e,t,n,a,h,F,f,p),w=x.startX,R=x.endX,b=x.Y,I=function(e,t,n){var r=(null!=n?n:l.getTextDecorationLineWidth(t))*e;return Math.max(Math.floor(r),1)}(v,F,p),A=Math.round(i.UnderlineMarginFromTextBaseline*I);C(h)&&(b+=A);var P=g.shouldDrawRotatedText(e,t.CachedStyle,t.CachedFont);S&&(b=b-I*(P?i.GapBetweenRotatedDoubleUnderline:i.GapBetweenDoubleUnderline)+A);return P?{StartX:w,EndX:R,Y:b,LineWidth:I,Color:f.Color}:function(e,t,n,r,o,a,l,d,u){var c=r.clipRect,g=n.scaleFactor;if(function(e,t,n,r,i,o,a,l){return function(e,t,n,r){var i=s.getCellTopAdjustedForDrawing(e,t,!1),o=r+n;return r<=i&&o<=i}(e,t,i,o)||y(e,t,i,o)||function(e,t,n,r){var i=e.clipRect,o=t.scaleFactor,a=i?(i.x+i.width)*o:0,l=!1;i&&(l=n>=a&&r>=a);return l}(r,n,a,l)||function(e,t,n,r){var i=e.clipRect,o=t.scaleFactor,a=i?i.x*o:0,l=!1;i&&(l=n<=a&&r<=a);return l}(r,n,a,l)}(e,t,n,r,o,a,l,d)&&(!r.containSubscript||!y(e,t,o,a)))return;if(c){var h=Math.round(c.x*g),f=Math.round(c.width*g)+h,m=T(l,d,h,f);l=m.start,d=m.end}if(function(e,t,n,r){var o=r+n,a=s.getCellTopAdjustedForDrawing(e,t,!1)+i.GridLineWidthPx,l=s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx;return r<=a||o>=l}(e,t,o,a)&&(!r.containSubscript||!y(e,t,o,a))){h=s.getCellTopAdjustedForDrawing(e,t,!1),f=s.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx;var p=T(a,a+o,h,f);a=p.start,o=p.end-a}return{StartX:l,EndX:d,Y:a,LineWidth:o,Color:u.Color}}(e,t,n,a,I,b,w,R,f)}function C(e){return e.underline===r.FontUnderline.Double||e.underline===r.FontUnderline.DoubleAccounting}function v(e,t){return e[t].StartX===e[t+1].StartX}function y(e,t,n,r){var i=s.getCellBottomAdjustedForDrawing(e,t);return r>=i&&r+n>=i}function T(e,t,n,r){var i=Math.min(e,t),o=Math.max(e,t),a=Math.min(n,r),l=Math.max(n,r);return{start:Math.max(i,a),end:Math.min(o,l)}}function S(e,t){if(0!==t.LineWidth){var n=t.Y+o.getLinePixelTranslation(t.LineWidth);!function(e,t,n,r){e.moveTo(t,r),e.lineTo(n,r)}(e,t.StartX,t.EndX,n)}}t.measureAndCacheTextDecorationLayout=function(e,t,n,r,i){var o=n.CachedFont.Underline,a=n.CachedFont.StrikeThrough;(o||a)&&""!==n.CachedDisplayText&&(i.textWidth=l.getTextWidth(e,t,n),h(t,n,r,i,n.CachedFont))},t.cacheTextDecorationLayout=h,t.drawTextDecoration=function(e,t,n){var r,l,d,u,c;e.beginPath();for(var h=[],m=t.ClientOnlyCache.CellsToRender,p=0;p<m.length;p++){var C=m[p];if(a.cellIntersectsRenderingRegion(C,n.renderingRegion)&&(o.verifyArgumentNotNull(C.CachedFont,"cell.CachedFont","drawTextDecoration"),(C.CachedFont.StrikeThrough||C.CachedFont.Underline||C.TextRuns)&&!(C.CondFormat&&(null===(r=C.CondFormat)||void 0===r?void 0:r.Icon)&&(null===(d=null===(l=C.CondFormat)||void 0===l?void 0:l.Icon)||void 0===d?void 0:d.IconOnly)||C.ShowSkeleton))){o.verifyArgumentNotNull(C.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");var v=C.CachedDrawingLayout.TextOrientationLayout,y=C.CachedDrawingLayout.UnderlineRuns,T=C.CachedDrawingLayout.StrikethroughRuns,S=n.highContrastScheme?a.getHighContrastTextColor(C,n.highContrastScheme):void 0;if(!!v&&g.shouldDrawRotatedText(t,C.CachedStyle,C.CachedFont))h.push(C);else{var F=f(e,u,c,S,y,T);u=F.lineColor,c=F.lineWidth}}}e.stroke(),h.length>0&&function(e,t,n,r){for(var o=0;o<r.length;o++){var l=r[o],d=l.CachedDrawingLayout.TextOrientationLayout,u=l.CachedDrawingLayout.UnderlineRuns,c=l.CachedDrawingLayout.StrikethroughRuns,h=n.highContrastScheme?a.getHighContrastTextColor(l,n.highContrastScheme):void 0,m=void 0;if(d.IsCellClipped){var p=s.getCellLeftAdjustedForDrawing(e,l,!1,!1),C=s.getCellTopAdjustedForDrawing(e,l,!1),v=s.getCellWidthAdjustedForDrawing(e,l)-i.GridLineWidthPx,y=s.getCellHeightAdjustedForDrawing(e,l)-i.GridLineWidthPx;m={x:p,y:C,width:v,height:y}}a.applyClipping(t,m),g.applyRotation(t,d.TranslateX*n.scaleFactor,d.TranslateY*n.scaleFactor,d.Angle),t.beginPath(),f(t,void 0,void 0,h,u,c),t.stroke(),t.restore(),a.restoreClipping(t,m)}}(t,e,n,h)},t.alignVerticalUnderlineRuns=function(e,t,n){if(!(u.isNullOrUndefined(n)||n.length<=0))for(var r=function(e,t,n){for(var r=-1,i=-1,o=0,a=!1,l=0;l<n.length;l++)if(!(l>0&&v(n,l-1)))if(l<n.length-1&&v(n,l)){var d=m([n[l],n[l+1]]),u=d.top,c=d.bottom;u.Y>r&&(r=u.Y),c.Y>i&&(i=c.Y,o=Math.max(c.LineWidth,1),a=!0)}else n[l].Y>r&&(r=n[l].Y,a||(o=Math.max(n[l].LineWidth,1)));y(e,t,o,i)&&(i=s.getCellBottomAdjustedForDrawing(e,t)-o,r=i-2*o);r-i<2*o&&(r=i-2*o);return{closestToBottomUnderline:r,closestToBottomDoubleUnderline:i,closestToBottomUnderlineWidth:o}}(e,t,n),i=0;i<n.length;i++)if(!(i>0&&n[i].StartX===n[i-1].StartX)){if(i<n.length-1&&n[i].StartX===n[i+1].StartX){var o=m([n[i],n[i+1]]),a=o.top,l=o.bottom;a.Y=r.closestToBottomUnderline,l.Y=r.closestToBottomDoubleUnderline,n[i+1].LineWidth=r.closestToBottomUnderlineWidth}else n[i].Y=r.closestToBottomUnderline;n[i].LineWidth=r.closestToBottomUnderlineWidth}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineDirection=t.BreakType=void 0,function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(t.BreakType||(t.BreakType={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.LineDirection||(t.LineDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UniqueHeadersFontID=t.UniqueHeadersStyleID=t.TolType=t.DirtyType=t.SparklineType=t.CFIconSet=t.RichValueIconType=t.RichValueCellType=t.MenuEntryIdentifier=t.OutlineState=t.FontVerticalAlignment=t.FontUnderline=t.BorderPositionType=t.BorderLineType=t.MenuItemType=t.RenderFlagsArray=t.CellsEncoding=t.AutoFilterType=t.CellFormulaType=t.CellValueType=t.UniqueStyleID=t.VerticalAlignment=t.HorizontalAlignment=t.ReadingOrderType=t.BackgroundFillType=t.GradientShadingStyle=t.RangeType=t.PivotMeasureType=t.PivotSortInfo=t.PivotFilterType=t.PivotTableDataFieldFormatType=t.PivotTableDataFieldAggregationType=t.MenuDisplayType=void 0,function(e){e[e.Gallery=0]="Gallery",e[e.List=1]="List"}(t.MenuDisplayType||(t.MenuDisplayType={})),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.AggregationTypeMax=11]="AggregationTypeMax"}(t.PivotTableDataFieldAggregationType||(t.PivotTableDataFieldAggregationType={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(t.PivotTableDataFieldFormatType||(t.PivotTableDataFieldFormatType={})),function(e){e[e.Invalid=0]="Invalid",e[e.FirstTop10=1]="FirstTop10",e[e.Count=1]="Count",e[e.Percent=2]="Percent",e[e.Sum=3]="Sum",e[e.LastTop10=3]="LastTop10",e[e.CaptionFirst=4]="CaptionFirst",e[e.CaptionEquals=4]="CaptionEquals",e[e.CaptionDoesNotEqual=5]="CaptionDoesNotEqual",e[e.CaptionBeginsWith=6]="CaptionBeginsWith",e[e.CaptionDoesNotBeginWith=7]="CaptionDoesNotBeginWith",e[e.CaptionEndsWith=8]="CaptionEndsWith",e[e.CaptionDoesNotEndWith=9]="CaptionDoesNotEndWith",e[e.CaptionContains=10]="CaptionContains",e[e.CaptionDoesNotContain=11]="CaptionDoesNotContain",e[e.CaptionIsGreaterThan=12]="CaptionIsGreaterThan",e[e.CaptionIsGreaterThanOrEqualTo=13]="CaptionIsGreaterThanOrEqualTo",e[e.CaptionIsLessThan=14]="CaptionIsLessThan",e[e.CaptionIsLessThanOrEqualTo=15]="CaptionIsLessThanOrEqualTo",e[e.CaptionIsBetween=16]="CaptionIsBetween",e[e.CaptionIsNotBetween=17]="CaptionIsNotBetween",e[e.ValueFirst=18]="ValueFirst",e[e.ValueEqual=18]="ValueEqual",e[e.ValueNotEqual=19]="ValueNotEqual",e[e.ValueGreaterThan=20]="ValueGreaterThan",e[e.ValueGreaterThanOrEqual=21]="ValueGreaterThanOrEqual",e[e.ValueLessThan=22]="ValueLessThan",e[e.ValueLessThanOrEqual=23]="ValueLessThanOrEqual",e[e.ValueBetween=24]="ValueBetween",e[e.ValueNotBetween=25]="ValueNotBetween",e[e.DateFirst=26]="DateFirst",e[e.DateEquals=26]="DateEquals",e[e.DateOlderThan=27]="DateOlderThan",e[e.DateNewerThan=28]="DateNewerThan",e[e.DateBetween=29]="DateBetween",e[e.DateTomorrow=30]="DateTomorrow",e[e.DateToday=31]="DateToday",e[e.DateYesterday=32]="DateYesterday",e[e.DateNextWeek=33]="DateNextWeek",e[e.DateThisWeek=34]="DateThisWeek",e[e.DateLastWeek=35]="DateLastWeek",e[e.DateNextMonth=36]="DateNextMonth",e[e.DateThisMonth=37]="DateThisMonth",e[e.DateLastMonth=38]="DateLastMonth",e[e.DateNextQuarter=39]="DateNextQuarter",e[e.DateThisQuarter=40]="DateThisQuarter",e[e.DateLastQuarter=41]="DateLastQuarter",e[e.DateNextYear=42]="DateNextYear",e[e.DateThisYear=43]="DateThisYear",e[e.DateLastYear=44]="DateLastYear",e[e.DateYearToDate=45]="DateYearToDate",e[e.DateAllDatesInPeriodQuarter1=46]="DateAllDatesInPeriodQuarter1",e[e.DateAllDatesInPeriodQuarter2=47]="DateAllDatesInPeriodQuarter2",e[e.DateAllDatesInPeriodQuarter3=48]="DateAllDatesInPeriodQuarter3",e[e.DateAllDatesInPeriodQuarter4=49]="DateAllDatesInPeriodQuarter4",e[e.DateAllDatesInPeriodJanuary=50]="DateAllDatesInPeriodJanuary",e[e.DateAllDatesInPeriodFebruary=51]="DateAllDatesInPeriodFebruary",e[e.DateAllDatesInPeriodMarch=52]="DateAllDatesInPeriodMarch",e[e.DateAllDatesInPeriodApril=53]="DateAllDatesInPeriodApril",e[e.DateAllDatesInPeriodMay=54]="DateAllDatesInPeriodMay",e[e.DateAllDatesInPeriodJune=55]="DateAllDatesInPeriodJune",e[e.DateAllDatesInPeriodJuly=56]="DateAllDatesInPeriodJuly",e[e.DateAllDatesInPeriodAugust=57]="DateAllDatesInPeriodAugust",e[e.DateAllDatesInPeriodSeptember=58]="DateAllDatesInPeriodSeptember",e[e.DateAllDatesInPeriodOctober=59]="DateAllDatesInPeriodOctober",e[e.DateAllDatesInPeriodNovember=60]="DateAllDatesInPeriodNovember",e[e.DateAllDatesInPeriodDecember=61]="DateAllDatesInPeriodDecember",e[e.DateNotEqual=62]="DateNotEqual",e[e.DateOlderOrEqual=63]="DateOlderOrEqual",e[e.DateNewerOrEqual=64]="DateNewerOrEqual",e[e.DateNotBetween=65]="DateNotBetween",e[e.Last=65]="Last"}(t.PivotFilterType||(t.PivotFilterType={})),function(e){e[e.None=0]="None",e[e.SortAscending=1]="SortAscending",e[e.SortDescending=2]="SortDescending",e[e.SortAscendingByValue=3]="SortAscendingByValue",e[e.SortDescendingByValue=4]="SortDescendingByValue"}(t.PivotSortInfo||(t.PivotSortInfo={})),function(e){e[e.None=0]="None",e[e.Explicit=1]="Explicit",e[e.Implicit=2]="Implicit"}(t.PivotMeasureType||(t.PivotMeasureType={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(t.RangeType||(t.RangeType={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(t.GradientShadingStyle||(t.GradientShadingStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(t.BackgroundFillType||(t.BackgroundFillType={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(t.ReadingOrderType||(t.ReadingOrderType={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(t.UniqueStyleID||(t.UniqueStyleID={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(t.CellValueType||(t.CellValueType={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(t.CellFormulaType||(t.CellFormulaType={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(t.AutoFilterType||(t.AutoFilterType={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(t.CellsEncoding||(t.CellsEncoding={})),function(e){e[e.CanvasHitTest=4]="CanvasHitTest",e[e.CFIconsWithCAS=6]="CFIconsWithCAS",e[e.GetFormattedTextFix=7]="GetFormattedTextFix",e[e.FormulaViewCellImagesFix=17]="FormulaViewCellImagesFix",e[e.PhoneticSlice1=20]="PhoneticSlice1",e[e.TextMaxWidthEwaJsFix=21]="TextMaxWidthEwaJsFix",e[e.TextWidthClientPhase1=22]="TextWidthClientPhase1",e[e.TableSelectorsHitTest=23]="TableSelectorsHitTest",e[e.CanvasHeaders=24]="CanvasHeaders",e[e.TextOrientationSlice1=25]="TextOrientationSlice1",e[e.ByExamplePreviewMode=26]="ByExamplePreviewMode",e[e.ShowDynamicImageCardOnHover=27]="ShowDynamicImageCardOnHover",e[e.TextOrientationSlice2=28]="TextOrientationSlice2"}(t.RenderFlagsArray||(t.RenderFlagsArray={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(t.MenuItemType||(t.MenuItemType={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(t.BorderPositionType||(t.BorderPositionType={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(t.OutlineState||(t.OutlineState={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter",e[e.SortAtoZ=30]="SortAtoZ",e[e.SortZtoA=31]="SortZtoA",e[e.SortSmallestToLargest=32]="SortSmallestToLargest",e[e.SortLargestToSmallest=33]="SortLargestToSmallest",e[e.SortOldestToNewest=34]="SortOldestToNewest",e[e.SortNewestToOldest=35]="SortNewestToOldest",e[e.SortByColor=36]="SortByColor",e[e.FilterByColor=37]="FilterByColor"}(t.MenuEntryIdentifier||(t.MenuEntryIdentifier={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(t.RichValueCellType||(t.RichValueCellType={})),function(e){e[e.Disambiguation=0]="Disambiguation",e[e.Sync=1]="Sync",e[e.LinkedEntity=2]="LinkedEntity"}(t.RichValueIconType||(t.RichValueIconType={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(t.CFIconSet||(t.CFIconSet={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(t.SparklineType||(t.SparklineType={})),function(e){e[e.None=0]="None",e[e.ModelCellChanges=2]="ModelCellChanges",e[e.ModelCoreChanges=4]="ModelCoreChanges",e[e.ScaleFactorChange=8]="ScaleFactorChange",e[e.ViewportChange=16]="ViewportChange",e[e.ExternalChanges=32]="ExternalChanges",e[e.NoCanvasCache=64]="NoCanvasCache",e[e.ModelCellPreviewChanges=128]="ModelCellPreviewChanges"}(t.DirtyType||(t.DirtyType={})),function(e){e[e.None=0]="None",e[e.Autofit=1]="Autofit",e[e.Spill=2]="Spill"}(t.TolType||(t.TolType={})),function(e){e[e.Default=-1]="Default",e[e.PartialRowColSelection=0]="PartialRowColSelection",e[e.WholeRowColSelection=1]="WholeRowColSelection",e[e.Hover=2]="Hover",e[e.SelectionAndHover=3]="SelectionAndHover"}(t.UniqueHeadersStyleID||(t.UniqueHeadersStyleID={})),function(e){e[e.Default=-1]="Default",e[e.Selection=0]="Selection"}(t.UniqueHeadersFontID||(t.UniqueHeadersFontID={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DistanceBetweenCFIconAndExpandCollapseButton=t.DefaultFallbackFontName=t.IconTextMinimalPadding=t.DefaultTextBaseline=void 0,t.DefaultTextBaseline="alphabetic",t.IconTextMinimalPadding=1,t.DefaultFallbackFontName="calibri",t.DistanceBetweenCFIconAndExpandCollapseButton=2},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCFIconAlignedToTheLeft=t.drawIconFromPoints=t.fillAndStroke=void 0;var r=n(1),i=n(13);function o(e,t,n){t&&(e.fillStyle=t,e.fill()),e.strokeStyle=n,e.stroke()}t.fillAndStroke=o,t.drawIconFromPoints=function(e,t,n,r){e.beginPath(),e.moveTo(r[0].x,r[0].y);for(var i=1;i<r.length;i++)e.lineTo(r[i].x,r[i].y);o(e,t,n)},t.isCFIconAlignedToTheLeft=function(e,t){var n,o=null===(n=t.CondFormat)||void 0===n?void 0:n.Icon;if(o){if(o.IconOnly){var a=i.getEffectiveHorizontalAlignment(e,t);return a===r.HorizontalAlignment.Left||a===r.HorizontalAlignment.Automatic}return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PeriodToEvalInMs=t.CanvasHeight=t.CanvasWidth=t.ResultMessageCollectorDisabled=t.ResultMessageInsufficientData=void 0,t.ResultMessageInsufficientData="Insufficient Data",t.ResultMessageCollectorDisabled="Collector Disabled",t.CanvasWidth=1,t.CanvasHeight=1,t.PeriodToEvalInMs=10},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPassiveTelemetryCollector=void 0;var r=n(107),i=function(){function e(e){this.isDisabled=!1,this.name=e,this.data=[]}return e.prototype.canCollectorExecute=function(){return!this.isDisabled&&!!this.data},e.prototype.getCollectorName=function(){return this.name},e.prototype.disable=function(){this.isDisabled=!0},e.prototype.register=function(e){this.data.push(e),r.registerCollector(this)},e}();t.AbstractPassiveTelemetryCollector=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSpilledOverCount=t.uniqueValuesFilter=t.cellsPositionComparer=t.getCellStyle=t.getCell=t.isDifferentialRenderingSupported=t.getRenderingRegionHitTestCache=t.cleanHitTestCache=t.initModelClientCache=t.validateCellShouldExistInModelUnsafe=t.getOrCreateCell=t.getModelClientCache=t.getAdjacentCellsKeys=t.getAdjacentCellsKeysOld=t.getAllSpillingOverCells=t.getAllSpanningCellsKeys=t.getDefaultCell=t.verifyArgumentNotNull=t.isAccAndCustomNumFmtApplicable=t.doesNumFmtOverrideText=t.isRenderFlagEnabled=t.getReferencedObjectToCache=t.getRowColFromCellKey=t.getCellLookupKey=void 0;var r=n(79),i=n(31),o=n(45),a=n(80),l=n(81),s=n(59);function d(e,t){return(e<<a.CellLookupRowShift)+t}function u(e){var t=e%a.CellLookupColumnMod;return{row:e>>a.CellLookupRowShift,column:t}}function c(e,t){if(!o.isNullOrUndefined(t.RenderFlagsArray)){var n=Math.floor(e/a.MaxBitsPerRenderFlag);if(n<t.RenderFlagsArray.length){var r=e%a.MaxBitsPerRenderFlag;return 0!=(t.RenderFlagsArray[n]&1<<r)}}return!1}function g(e){return!!h(e)&&(s.isChangeGateEnabled(s.ChangeGate.AcctApplicableIfNumFmtIsDefined)?!o.isNullOrUndefined(e.NumFmt)&&""!==e.Text:(e.Ifmt||0)>=a.NumFmtAccountingStartIndex&&!o.isNullOrUndefined(e.NumFmt)&&""!==e.Text)}function h(e){return e.ValueType===i.CellValueType.Number}function f(e,t,n){if(null==e)throw Error(n+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function m(e,t,n,o){void 0===n&&(n=void 0),void 0===o&&(o=void 0);var a=n&&0!==n.length?r.getReferencedObjectById(i.UniqueStyleID.Default,n):void 0;return{Col:t,CachedStyle:a,CachedFont:o&&0!==o.length&&a?r.getReferencedObjectById(a.FontID||0,o):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:i.UniqueStyleID.Default,BorderStyleID:i.UniqueStyleID.DefaultBorder,Text:"",ValueType:i.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}}function p(e,t){for(var n=[],r=0;r<t.length;r++){var i=u(t[r]),o=i.row,a=i.column,s=D(e,o,a),c=s.cellBefore,g=s.cellAfter;c&&I(c)&&P(c,a,l.SpillDirection.End)&&n.push(d(c.Row,c.Col)),g&&I(g)&&P(g,a,l.SpillDirection.Start)&&n.push(d(g.Row,g.Col))}return n}function C(e){return e.ClientOnlyCache||T(e),e.ClientOnlyCache}function v(e,t,n){var r=x(t,n,e);return r||(y(e,t,n),m(t,n,e.Styles,e.Fonts))}function y(e,t,n){if(f(e.RowNumbers,"RowNumbers","validateCellShouldExistInModelUnsafe"),f(e.ColumnNumbers,"ColumnNumbers","validateCellShouldExistInModelUnsafe"),f(e.Styles,"Styles","validateCellShouldExistInModelUnsafe"),t<0||n<0||t>=e.RowNumbers.length||n>=e.ColumnNumbers.length)throw Error("validateCellShouldExistInModelUnsafe: cell requested for a cell which is not in range of the model. rowIndex:  "+t+", RowNumbers.length: "+e.RowNumbers.length+",  colIndex:  "+n+", ColumnNumbers.length: "+e.ColumnNumbers.length)}function T(e){e.ClientOnlyCache||(e.ClientOnlyCache={},e.ClientOnlyCache.DirtyType=i.DirtyType.None),c(i.RenderFlagsArray.CanvasHitTest,e)&&!e.ClientOnlyCache.RenderingRegionsHitTestCache&&function(e){e.ClientOnlyCache&&(e.ClientOnlyCache.RenderingRegionsHitTestCache={})}(e);var t=e.ClientOnlyCache;if(F(e)){var n=t.DirtyCellsKeys.filter(R);t.DirtyCellsKeys=n.sort(O)}t.CellsToRender=function(e){if(!F(e))return e.Cells;return e.ClientOnlyCache.CellLookup=M(e),L(e,e.ClientOnlyCache.DirtyCellsKeys)}(e),t.GridlineOverridingCellsToRender=function(e,t){if(!F(e))return e.Cells;for(var n=[],r=0;r<t.length;r++){var i=t[r],o=H(e,i);n.push(i);for(var a=0;a<o.length;a++)n.push(o[a])}var l=n.filter(R).sort(O);return L(e,l)}(e,t.DirtyCellsKeys),e.ClientOnlyCache.FallbackFonts={}}function S(e,t){e.ClientOnlyCache&&e.ClientOnlyCache.RenderingRegionsHitTestCache||T(e);var n=e.ClientOnlyCache.RenderingRegionsHitTestCache[t];return n||(e.ClientOnlyCache.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}},e.ClientOnlyCache.RenderingRegionsHitTestCache[t])}function F(e){var t=C(e);return t.IsDirty&&!t.DisableDiffRendering&&t.DirtyCellsKeys&&t.DirtyCellsKeys.length>0}function x(e,t,n){f(n,"model","initCellLookup");var r=C(n);return r.CellLookup||(r.CellLookup=M(n)),r.CellLookup[d(e,t)]}function w(e,t){return f(t,"cell","getCellStyle"),f(e.Styles,"Styles","getCellStyle"),t.CachedStyle||(t.CachedStyle=r.getReferencedObjectById(t.StyleID||0,e.Styles)),t.CachedStyle}function R(e,t,n){return n.indexOf(e)===t}function b(e,t){return t.Spill?e===l.SpillDirection.Start?t.Spill.SpanToStart:t.Spill.SpanToEnd:0}function I(e){return e&&!!e.Text&&""!==e.Text}function A(e,t,n,r,i){for(var o=t+n;o>=0&&o<e.length;){var a=e[o];if(a.Row!==r)return;if(I(a))return P(a,i,-n)?a:void 0;o+=n}}function P(e,t,n){var r=Math.abs(t-e.Col);return!!(e.Spill&&b(n,e)>=r)}function D(e,t,n){for(var r=void 0,i=void 0,o=0;o<e.length;o++){var a=e[o];if(!(a.Row<t)){if(a.Row>t)break;if(a.Col<n&&(r=a),a.Col>n){i=a;break}}}return{cellBefore:r,cellAfter:i}}function M(e){f(e,"model","initCellLookup"),f(e.Cells,"model.Cells","initCellLookup");for(var t={},n=0;n<e.Cells.length;n++){var r=e.Cells[n];if(r)if(t[d(r.Row,r.Col)]=r,r.Merge)for(var i=0;i<=r.Merge.Rows;i++)for(var o=0;o<=r.Merge.Columns;o++)t[d(r.Row+i,r.Col+o)]=r;else t[d(r.Row,r.Col)]=r}return t}function O(e,t){var n=u(e),r=u(t);return k(n.row,n.column,r.row,r.column)}function k(e,t,n,r){return e===n&&t===r?0:e>n||e===n&&t>r?1:-1}function L(e,t){for(var n=[],r=e.ClientOnlyCache,i=0;i<t.length;i++){var o=t[i],a=r.CellLookup[o],l=u(o),s=l.row,d=l.column;a&&a.Row===s&&a.Col===d&&n.push(a)}return n}function H(e,t){for(var n=[],r=u(t),i=r.row,o=r.column,a=Math.max(0,o-1),l=Math.min(e.ColumnNumbers.length-1,o+1),s=Math.max(0,i-1),c=Math.min(e.RowNumbers.length,i+1),g=s;g<=c;g++)for(var h=a;h<=l;h++){var f=x(g,h,e);f&&E(e,f)&&n.push(d(f.Row,f.Col))}return n}function E(e,t){var n=w(e,t),i=function(e,t){f(t,"cell","getCellBorderStyle"),f(e.BorderStyles,"BorderStyles","getCellBorderStyle"),t.CachedBorderStyle||(t.CachedBorderStyle=r.getReferencedObjectById(t.BorderStyleID||0,e.BorderStyles));return t.CachedBorderStyle}(e,t);return!!n.BackgroundColor||!!n.Gradient||i.Borders.length>0||!!t.HasError}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];e[r]&&(e[r]=[])}}function N(e,t,n,r){var i=v(e,n,r);t.push(d(i.Row,i.Col)),i.Row===n&&i.Col===r||t.push(d(n,r))}t.getCellLookupKey=d,t.getRowColFromCellKey=u,t.getReferencedObjectToCache=function(e,t){if(s.isChangeGateEnabled(s.ChangeGate.TreatZeroAndUndefinedAsEqual)){if(f(e,"Id","helpers.getReferencedObjectToCache"),!o.isNullOrUndefined(t))return r.getReferencedObjectById(e,t)}else if(!o.isNullOrUndefined(t)&&!o.isNullOrUndefined(e))return r.getReferencedObjectById(e,t)},t.isRenderFlagEnabled=c,t.doesNumFmtOverrideText=function(e){return!!h(e)&&(""!==e.WrapText&&""!==e.Text||g(e))},t.isAccAndCustomNumFmtApplicable=g,t.verifyArgumentNotNull=f,t.getDefaultCell=m,t.getAllSpanningCellsKeys=function(e,t,n){var r=[];if(0===(r=r.concat(function(e,t,n){if(!t.Merge&&!t.Spill)return[];var r=[];if(t.Merge)for(var i=0;i<=t.Merge.Rows;i++)for(var o=0;o<=t.Merge.Columns;o++)r.push(d(t.Row+i,t.Col+o));if(t.Spill){for(var a=0;a<t.Spill.SpanToEnd;a++)r.push(d(t.Row,t.Col+a+1));for(a=0;a<t.Spill.SpanToStart;a++)r.push(d(t.Row,t.Col-a-1));if(t.Spill.SpanToEnd){var s=t.Col+t.Spill.SpanToEnd,u=A(e,n,l.SpillDirection.End,t.Row,s);u&&r.push(d(u.Row,u.Col))}if(t.Spill.SpanToStart){s=t.Col-t.Spill.SpanToStart;var c=A(e,n,l.SpillDirection.Start,t.Row,s);c&&r.push(d(c.Row,c.Col))}}return r}(e,t,n))).length){var i=A(e,n,l.SpillDirection.Start,t.Row,t.Col);i&&r.push(d(i.Row,i.Col));var o=A(e,n,l.SpillDirection.End,t.Row,t.Col);o&&r.push(d(o.Row,o.Col))}return r},t.getAllSpillingOverCells=p,t.getAdjacentCellsKeysOld=function(e,t,n){var r=[];if(t-1>=0){var i=v(e,t-1,n);r.push(d(i.Row,i.Col))}if(n-1>=0){i=v(e,t,n-1);r.push(d(i.Row,i.Col))}if(t+1<e.RowNumbers.length){i=v(e,t+1,n);r.push(d(i.Row,i.Col))}if(n+1<e.ColumnNumbers.length){i=v(e,t,n+1);r.push(d(i.Row,i.Col))}return r},t.getAdjacentCellsKeys=function(e,t){for(var n,r,i=[],o=Math.max(0,t.Row-1),a=Math.min(e.RowNumbers.length-1,t.Row+1+((null===(n=null==t?void 0:t.Merge)||void 0===n?void 0:n.Rows)||0)),l=Math.max(0,t.Col-1),s=Math.min(e.ColumnNumbers.length-1,t.Col+1+((null===(r=t.Merge)||void 0===r?void 0:r.Columns)||0)),d=o;d<=a;d++)N(e,i,d,l),N(e,i,d,s);for(var u=l;u<=s;u++)N(e,i,o,u),N(e,i,a,u);return i=i.concat(p(e.Cells,i))},t.getModelClientCache=C,t.getOrCreateCell=v,t.validateCellShouldExistInModelUnsafe=y,t.initModelClientCache=T,t.cleanHitTestCache=function(e,t){var n=S(e,t),r=e.ClientOnlyCache;F(e)?(B(n.CellHitRegions,r.DirtyCellsKeys),B(n.CellCursorHitRegions,r.DirtyCellsKeys),B(n.CellTooltipHitRegions,r.DirtyCellsKeys),B(n.CellLongPressHitRegions,r.DirtyCellsKeys)):r.RenderingRegionsHitTestCache&&(r.RenderingRegionsHitTestCache[t]={CellCursorHitRegions:{},CellHitRegions:{},CellLongPressHitRegions:{},CellTooltipHitRegions:{}})},t.getRenderingRegionHitTestCache=S,t.isDifferentialRenderingSupported=F,t.getCell=x,t.getCellStyle=w,t.cellsPositionComparer=function(e,t){return k(e.Row,e.Col,t.Row,t.Col)},t.uniqueValuesFilter=R,t.getSpilledOverCount=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdjustedDrawingOffset=t.getMaxLineOffset=t.drawGridLines=void 0;var r=n(3),i=n(2),o=n(0),a=n(7),l=n(0);function s(e,t,n){var o=Math.round(e*t)-r.GridLineWidthPx/2;if(n&&i.isSafari()){var a=window?window.devicePixelRatio:-1;2===a&&t===a/2&&(o-=1)}return o}function d(e,t,n,r){var i=e+t-n;return i=Math.min(i,r)}t.drawGridLines=function(e,t,n){if(!(t.RowOffsets&&t.ColumnOffsets&&t.RowHeights&&t.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: "+!t.RowOffsets+", ColumnOffsets: "+!t.ColumnOffsets+", RowHeights: "+!t.RowHeights+", ColumnWidths: "+!t.ColumnWidths;if(t.RowOffsets.length!==t.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(t.ColumnOffsets.length!==t.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";if(t.ShowGridLines&&!(n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)&&i.shouldRenderGridLines(o.isHighContrastMode(n),o.hasWorkbookBackgroundColor(t.BackgroundColor))){e.lineWidth=r.GridLineWidthPx,e.setLineDash(function(e){if(!a.isNullOrUndefined(e.GridLineColor))return r.ColoredGridLineDash;return r.DefaultDash}(t)),e.strokeStyle=function(e,t){if(!a.isNullOrUndefined(t.highContrastScheme))return""+l.rgbToColorHex(t.highContrastScheme.TextColor);if(!a.isNullOrUndefined(e.GridLineColor))return e.GridLineColor;return r.DefaultGridlineColor}(t,n);var u=o.getLinePixelTranslation(r.GridLineWidthPx),c=s(t.BlockWidth,n.scaleFactor,!1),g=s(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,r,o,a){for(var l=a.startRow,s=a.endRow,u=l;u<=s;u++){var c=d(t[u],i.getRowHeightFromOffsets(u,t),r,o);i.drawLine(e,0,c,n,c)}}(e,t.ClientOnlyCache.RowOffsetsAdjustedForDrawing,t.BlockWidth*n.scaleFactor,u,g,n.renderingRegion),function(e,t,n,r,o,a){for(var l=a.startColumn,s=a.endColumn,u=l;u<=s;u++){var c=d(t[u],i.getColWidthFromOffsets(u,t),r,o);i.drawLine(e,c,0,c,n)}}(e,t.ClientOnlyCache.ColOffsetsAdjustedForDrawing,t.BlockHeight*n.scaleFactor,u,c,n.renderingRegion),e.stroke()}},t.getMaxLineOffset=s,t.getAdjustedDrawingOffset=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RightArrowPosition=t.LeftArrowPosition=t.ArrowTipWidthPx=t.ArrowLengthPx=t.FilterPoints=t.MiniChevronPoints=t.ChevronPoints=t.FilterDrawingThresholdPx=t.AutoFilterRectRadius=t.AutoFilterIconRectPx=t.AutoFilterStrokeColor=t.AutoFilterBackgroundColor=t.AutoFilterBorderColor=t.AutoFilterLineWidthPx=t.AutoFilterDefaultSizePx=t.AutoFilterTextHorizontalPaddingPx=t.AutoFilterHorizontalPaddingPx=t.AutoFilterPaddingBottomPx=t.AutoFilterColor=void 0,t.AutoFilterColor="#3A3A38",t.AutoFilterPaddingBottomPx=1,t.AutoFilterHorizontalPaddingPx=1,t.AutoFilterTextHorizontalPaddingPx=2,t.AutoFilterDefaultSizePx=17,t.AutoFilterLineWidthPx=1,t.AutoFilterBorderColor="gray",t.AutoFilterBackgroundColor="white",t.AutoFilterStrokeColor="black",t.AutoFilterIconRectPx=16,t.AutoFilterRectRadius=2,t.FilterDrawingThresholdPx=3;t.ChevronPoints=[{x:5,y:6},{x:8,y:9},{x:11,y:6}];t.MiniChevronPoints=[{x:3,y:9},{x:5,y:11},{x:7,y:9}];var r={x:8,y:3};t.FilterPoints=[r,{x:8,y:5},{x:10,y:6},{x:10,y:10},{x:12,y:10},{x:12,y:6},{x:14,y:5},{x:14,y:3},r],t.ArrowLengthPx=8,t.ArrowTipWidthPx=3,t.LeftArrowPosition={x:4,y:3},t.RightArrowPosition={x:11,y:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAdvancedVerticalAlignmentOffsetYForWrapText=t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=t.getEffectiveVerticalAlignment=t.isVerticalAlignmentJustifyOrDistributed=t.AdvVerticalAlignmentFormat=void 0;var r,i=n(1);!function(e){e[e.WrapText=0]="WrapText",e[e.CFIcon=1]="CFIcon"}(r=t.AdvVerticalAlignmentFormat||(t.AdvVerticalAlignmentFormat={})),t.isVerticalAlignmentJustifyOrDistributed=function(e){switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return!0}return!1},t.getEffectiveVerticalAlignment=function(e,t,n,o,a,l,s){if(s)return i.VerticalAlignment.Bottom;switch(e){case i.VerticalAlignment.Top:case i.VerticalAlignment.Bottom:case i.VerticalAlignment.Center:return e;case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return function(e,t,n,o,a,l){switch(t){case r.WrapText:return function(e,t,n,r,o){if(1===o||t<r)switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Center}if(t<n&&t>=r)switch(e){case i.VerticalAlignment.Justify:case i.VerticalAlignment.Distributed:return i.VerticalAlignment.Top}return e}(e,n,o,a,l);case r.CFIcon:return function(e){switch(e){case i.VerticalAlignment.Justify:return i.VerticalAlignment.Top;case i.VerticalAlignment.Distributed:default:return i.VerticalAlignment.Center}}(e)}}(e,t,n,o,a,l)}},t.getAdvancedVerticalAlignmentLineGapHeightForWraptext=function(e,t,n){return(e-t)/(n-1)},t.getAdvancedVerticalAlignmentOffsetYForWrapText=function(e,t,n){return e-t*n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateContextForCurrentCell=t.getDefaultContextState=void 0;var r=n(1),i=n(0),o=n(32),a=n(13),l=n(3),s=n(2);function d(e){return e?"rtl":"ltr"}t.getDefaultContextState=function(e,t){return{fontColor:e?i.rgbToColorHex(e.TextColor):l.DefaultCellFontColor,fontProperties:"",direction:d(t),textBaseline:"bottom",textAlign:"start"}},t.updateContextForCurrentCell=function(e,t,n,u,c){var g=a.getTextAlignment(u,n);t.textAlign!==g&&(t.textAlign=g,e.textAlign=g);var h=o.DefaultTextBaseline;h!==t.textBaseline&&(e.textBaseline=h,t.textBaseline=h);var f=i.getFontCssStringFromCell(n,u);t.fontProperties===f&&e.font===f||(t.fontProperties=f,e.font=f);var m=function(e,t){if(t)return s.getHighContrastTextColor(e,t);if(e.HasError)return l.FormulaErrorFontColor;return e.CachedFont.Color}(n,c);t.fontColor!==m&&(t.fontColor=m,e.fillStyle=m);var p=function(e,t){switch(e){case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.Context:return d(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(n.CachedStyle.ReadingOrder||r.ReadingOrderType.Context,u.IsRtl);p!==t.direction&&(t.direction=p,e.direction=p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTrianglePathOnCellCorner=t.getRightAngledTriangleSize=t.drawTriangle=void 0;var r=n(0),i=n(71),o=n(42),a=n(21),l=n(3);t.drawTriangle=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","drawTriangle"),r.verifyArgumentNotNull(t,"drawingContext","drawTriangle");var i=t.innerColor,o=t.outerColor,a=t.left,l=t.bottom,s=t.height,d=t.width,u=a+d/2,c=n?l+s:l-s;e.beginPath(),e.moveTo(a,l),e.lineTo(a+d,l),e.lineTo(u,c),e.closePath(),i&&(e.fillStyle=i,e.fill()),o&&(e.strokeStyle=o,e.stroke())},t.getRightAngledTriangleSize=function(e,t,n,r,i){return a.getInteractiveIconMaxSizeAdjustedForDrawing(n,e,t,r,i,!0,!0)},t.createTrianglePathOnCellCorner=function(e,t,n){var a=r.getLinePixelTranslation(l.GridLineWidthPx),s=t.left,d=t.bottom,u=t.height,c=t.width,g=n===i.Position.Right,h=d-u,f=g?s-a:s,m=[{x:f,y:h},{x:f+c+a,y:h},{x:f+(g?c+a:0),y:h+u+a},{x:f,y:h}];o.createShapePath(e,m)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createShapePath=t.shouldClipHorizontally=t.shouldClipVertically=t.getClipRect=void 0;var r=n(5),i=n(3);function o(e,t,n,o){return n>=r.getCellBottomAdjustedForDrawing(e,t)-i.GridLineWidthPx||n-o<=r.getCellTopAdjustedForDrawing(e,t,!1)}function a(e,t,n,o,a){var l,s=e.IsRtl,d=t.Spill&&(a||(null===(l=t.PivotTable)||void 0===l?void 0:l.HasExpandCollapseIndicator));return n<=(d?r.getSpillCellLeftAdjustedForDrawing(e,t):r.getCellLeftAdjustedForDrawing(e,t,s,!1))||n+o>=(d?r.getSpillCellRightAdjustedForDrawing(e,t):r.getCellRightAdjustedForDrawing(e,t,!1)-i.GridLineWidthPx)}t.getClipRect=function(e,t,n,l,s,d){var u=function(e,t,n,r,i,l){return a(e,t,n,i,l)||o(e,t,r,i)}(e,t,n,l,s,d),c=t.Spill&&d;if(u)return{x:c?r.getSpillCellLeftAdjustedForDrawing(e,t):r.getCellLeftAdjustedForDrawing(e,t,!1,!1),y:r.getCellTopAdjustedForDrawing(e,t,!1),width:c?r.getSpillCellWidthAdjustedForDrawing(t,e)-i.GridLineWidthPx:r.getCellWidthAdjustedForDrawing(e,t)-i.GridLineWidthPx,height:r.getCellHeightAdjustedForDrawing(e,t)-i.GridLineWidthPx}},t.shouldClipVertically=o,t.shouldClipHorizontally=a,t.createShapePath=function(e,t){if(t&&!(t.length<2)){var n=t[0];e.moveTo(n.x,n.y);for(var r=1;r<t.length;r++){var i=t[r];e.lineTo(i.x,i.y)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldTextBeClipped=t.getCurrentTimeInMs=t.calculateExecutionsPerSecond=void 0;var r=n(1),i=n(13);function o(){return Date.now()}t.calculateExecutionsPerSecond=function(e,t){for(var n=o(),r=0;o()-n<t;)e(r),r++;return r*(1e3/t)},t.getCurrentTimeInMs=o,t.shouldTextBeClipped=function(e,t){var n,o,a,l;return t.CachedStyle||r.getCellStyle(e,t),t.TextRuns||t.Spill||t.Merge||t.DisplayFormula||t.PreviewText||(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)||t.WrapText||i.isHorizontalAlignmentCenteredAcrossSelection(t)||(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)===r.HorizontalAlignment.Fill||(null===(a=t.CachedStyle)||void 0===a?void 0:a.ShrinkToFit)||((null===(l=t.CachedStyle)||void 0===l?void 0:l.Indentation)||0)>0}},function(e,t,n){"use strict";n.r(t);var r=n(4),i=n(89),o=n(57),a=n(14),l=["auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mouseout","mouseover","mouseup","pointerover","pointerenter","pointerdown","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","touchstart","touchend","touchcancel","keydown","keypress","keyup","beforeinput","input","compositionstart","compositionupdate","compositionend","dragstart","dragend","dragenter","dragleave","dragover","drop"],s={events:["click","keypress","mousedown"],durationThresholdInMs:100,patchTaskScheduling:!1};function d(){var e,t;t="logInteractivityReport",i.a.shipAssertTag(539829777,o.a.msoulscat_Wac_BrowserGeneral,U(),"InteractivityTracker:validateTrackerStarted - non-started tracker: caller "+t);var n,r,l,s,d,u=function(e){var t=[];for(var n in e){var r=e[n];r.action=n,t.push(r)}return t}(JSON.parse(JSON.stringify(x)));n=q("OfficeVSO:5397136_UseAppInfoCallback")&&G()?null===(e=z())||void 0===e?void 0:e.appState:N(),q("OfficeVSO:5682845_InteractivityTrackerReportWithSendBeaconTraceTag")?(r=137704527,l=a.a.Warning,s=!1,d="InteractivityTracker:logInteractivityReport - state: "+n+" totals: "+JSON.stringify(u),(null==L?void 0:L.sendBeaconTraceTag)?null==L||L.sendBeaconTraceTag(r,l,s,d):(i.a.sendTraceTag(539550627,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:sendBeaconTraceTag - interactivityTrackerCallbacks.sendBeaconTraceTag does not exist. Sending trace tag instead for tag: "+r),i.a.sendTraceTag(r,o.a.msoulscat_Wac_BrowserGeneral,l,d))):i.a.sendTraceTag(137704527,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:logInteractivityReport - state: "+n+" totals: "+JSON.stringify(u))}var u=[];function c(){return u}function g(e){u.length>2e3&&(u=u.slice(-1e3)),u.push(e)}var h=window.setTimeout,f=window.requestAnimationFrame,m=window.requestIdleCallback;function p(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=performance.now();try{e(t)}finally{var i=performance.now();g({kind:"TO",start:r,end:i})}};return h(i,t,n)}function C(e){return f((function(t){var n=performance.now();try{e(t)}finally{g({kind:"RAF",start:n,end:performance.now()})}}))}function v(e,t){return m((function(t){var n=performance.now();try{e(t)}finally{g({kind:"RIC",start:n,end:performance.now()})}}),t)}var y=!1;function T(){y&&(window.setTimeout=h,window.requestAnimationFrame=f,window.requestIdleCallback=m,y=!1,i.a.sendTraceTag(539829779,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:stopSchedulingTracker - stopped"))}function S(e,t){var n=function(e,t){return function(e){return c().filter(e).map((function(e){return{kind:e.kind,duration:e.end-e.start}}))}({inputDelay:function(t){return t.end>=e.startTime&&t.end<e.processingStart},renderingDelay:function(t){return t.start>=e.processingEnd&&t.start<=e.startTime+e.duration}}[t])}(t,e),r={};return n.forEach((function(e){var t=r[e.kind];t||(t=r[e.kind]={count:0,duration:0}),t.duration+=e.duration,t.count+=1})),r}var F={},x={},w=void 0;function R(e,t){var n;if(function(e,t){if(!t)return!1;if(0===t.length)return i.a.sendTraceTag(539829786,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:validateTrackEventParams -  no userAction value"),!1;if(!e)return!1;if(!(e instanceof Event))return!1;return!0}(e,t)&&function(e){if(!U())return i.a.sendTraceTag(539829787,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:validateTrackerStated - tracker not started. userAction dropped: "+e),!1;return!0}(t)){var r,l,s=D(e.type,e.timeStamp),u=function(e,t,n){var r=F[e];if(void 0!==r){if(!q("OfficeVSO:5622928_EventActionDuplicationHandling"))return i.a.sendTraceTag(539829782,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. type: "+t.type+" new:"+n+" old: "+r.action),i.a.debugAssertTag(539829783,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:checkDuplicateAction - duplicate tracked action is not allowed, new action will replace the old one. type: "+t.type+" new:"+n+" old: "+r.action),!0;if(void 0!==r.find((function(e){return e.action===n})))return i.a.sendTraceTag(539829784,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: "+n+" was already tracked on the same event with type: "+t.type),i.a.debugAssertTag(539829785,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:checkDuplicateAction - duplicate tracked action. Same action: "+n+" was already tracked on the same event with type: "+t.type),!0}return!1}(s,e,t);if(q("OfficeVSO:5397136_UseAppInfoCallback")&&G()?(!function(){var e,t=K();(null===(e=z())||void 0===e?void 0:e.appState)!==(null==t?void 0:t.appState)&&(d(),k(),function(e){e&&(W=e)}(t))}(),r=null===(n=z())||void 0===n?void 0:n.appState):((l=X())!==N()&&(B=l,!0)&&(d(),k()),r=N()),function(e,t){if(q("OfficeVSO:5622928_EventActionDuplicationHandling")){var n=F[t];n?n.push(e):F[t]=[e]}else F[t]=e}({action:t,state:r},s),!q("OfficeVSO:5622928_EventActionDuplicationHandling")||!u)I(t).total+=1;var c=z();i.a.sendTraceTag(137704644,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:trackEvent - userActionKey: "+s+" userAction: "+t+", appState: "+(null==c?void 0:c.appState)+", coAuthCount: "+(null==c?void 0:c.coAuthCount))}}function b(e){var t=-1,n=X();if(e.getEntries().forEach((function(e){var r=e.entryType;i.a.shipAssertTag(539829780,o.a.msoulscat_Wac_BrowserGeneral,"event"===r,"InteractivityTracker:handleObservedEvents - unexpected observed entry type: "+r),function(e,t){var n=e.name;if(function(e){return H[e]}(n)){var r=function(e){var t=D(e.name,e.startTime),n=F[t];if(n)return delete F[t],n;return q("OfficeVSO:5622928_EventActionDuplicationHandling")?[{action:"undefined",state:void 0}]:{action:"undefined",state:void 0}}(e);if(q("OfficeVSO:5618974_DropAllCrossStateEvents")&&function(e,t,n){var r=q("OfficeVSO:5622928_EventActionDuplicationHandling")?t[0]:t;if(void 0!==r.state&&r.state!==n){var i=D(e.name,e.startTime);return delete F[i],!0}return!1}(e,r,t))return;var i=e.startTime+e.duration;q("OfficeVSO:5622928_EventActionDuplicationHandling")?r.forEach((function(t){A(e,t,n,i)})):A(e,r,n,i)}}(e,n),e.startTime>t&&(t=e.startTime)})),q("OfficeVSO:5380753_clearTrackedEventsToUserAction")){var r=function(e){var t=0;for(var n in F){var r=M(n);if(r&&r<e)performance.now()-r>3e3&&(delete F[n],t+=1)}return t}(t);i.a.sendTraceTag(539829781,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:handleObservedEvents - cleared "+r+" tracked events}")}}function I(e){var t=x[e];return t||(t={total:0,slow:0},x[e]=t),t}function A(e,t,n,r){var l=z();!function(e,t,n,r,l){var s=function(e){if(0!==c().length)return{inputDelayTotals:S("inputDelay",e),renderingDelayTotals:S("renderingDelay",e)}}(n),d="InteractivityTracker:logEvent - EventTiming - state: "+e.state+" userAction: "+e.action+", eventName: "+t+", eventStartToNextFrame: "+n.duration.toFixed(2)+", startTime: "+n.startTime.toFixed(2)+", processingStart: "+n.processingStart.toFixed(2)+", processingEnd: "+n.processingEnd.toFixed(2)+", renderTime: "+r.toFixed(2)+", appState: "+(null==l?void 0:l.appState)+", coAuthCount: "+(null==l?void 0:l.coAuthCount)+", "+(s?" tasksTotals: "+JSON.stringify(s)+",":"")+("undefined"===e.action&&q("OfficeVSO:5708339_eventTargetIdInIntlgTag")?" eventTargetId: "+P(n):"");i.a.sendTraceTag(137704134,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,d)}(t,n,e,r,l);var s=I(t.action);!function(e,t,n,r){var i;if(w){var o=e.action;"undefined"===o&&q("OfficeVSO:5697068_informativeDataOnUndefinedActions")&&(o="untracked__"+t.name+"__"+P(t));var a={name:o,appState:null!==(i=e.state)&&void 0!==i?i:null==r?void 0:r.appState};w.dispatchEvent(new CustomEvent("TrackerProcessEventEntry",{detail:{startTime:t.startTime,endTime:n,actionProps:a}}))}}(t,e,r,l),s.slow+=1,s.slow>s.total&&"undefined"!==t.action&&i.a.sendTraceTag(539829788,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:processEventTimingEntry: action "+t.action+" slow count ("+s.slow+") higher then total ("+s.total+"). trackedEventsToUserAction size is "+Object.keys(F).length)}function P(e){var t=e.target;return t?""===t.id||Y(t.id)?t.className:t.id:"unknownTarget"}function D(e,t){return e+"_"+t}function M(e){var t=e.indexOf("_"),n=t>-1?e.substring(t+1):void 0;return n?parseFloat(n):void 0}function O(){F={}}function k(){x={}}var L,H={},E=void 0,B=void 0;function N(){return null!=B?B:void 0}var W=void 0;function z(){return null!=W?W:void 0}function j(e){var t;if(void 0===e&&(e=s),(null==e?void 0:e.patchTaskScheduling)&&(window.setTimeout=p,window.requestAnimationFrame=C,window.requestIdleCallback=v,y=!0,i.a.sendTraceTag(539829778,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:startSchedulingTracker - started")),!function(){if(U())return i.a.sendTraceTag(539829774,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:canStartObserver:false - repeated start attempt"),!1;return!0}())return i.a.sendTraceTag(539829765,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTracker:startInteractivityTracker - cannot start interactivityTracker"),{started:!1,failureReason:"cannot start interactivityTracker"};var n=function(e){if(!e.durationThresholdInMs||e.durationThresholdInMs<0)return i.a.shipAssertTag(539829770,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.durationThresholdInMs undefined or < 0"),s;if(null==e.events||0===e.events.length)return i.a.shipAssertTag(539829771,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - unexpected options.events missing or empty"),s;for(var t=0,n=e.events;t<n.length;t++){var r=n[t];if(r&&l.indexOf(r)<0)return i.a.shipAssertTag(539829772,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - invalid event in options.events "+r),s}if(e.callbacks&&"function"!=typeof e.callbacks.getAppState)return i.a.shipAssertTag(539829773,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:validateOptions - getAppState is not a function"),s;return e}(e);return J(),null===(t=n.events)||void 0===t||t.forEach((function(e){H[e]=!0})),L=null==e?void 0:e.callbacks,B=X(),W=K(),(null==L?void 0:L.isChangeGateEnabled("OfficeVSO:5612712_fixDoubleReportPostBeforeUnloadEvent"))?window.addEventListener("beforeunload",_):window.addEventListener("beforeunload",d),window.addEventListener("visibilitychange",J),function(e){try{return(E=new PerformanceObserver(b)).observe({type:"event",buffered:!0,durationThreshold:e.durationThresholdInMs}),i.a.sendTraceTag(539829775,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:startInteractivityTracker - started"),{started:!0}}catch(e){return i.a.sendTraceTag(539829776,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:startInteractivityTracker - failed to start. Error: "+e),V(),{started:!1,failureReason:"Error: "+e}}}(n)}function _(){d(),k()}function V(){return U()?(null==E||E.disconnect(),E=void 0,q("OfficeVSO:5468954_cleanTrackedEventsOnTrackerStop")&&(k(),O()),window.removeEventListener("beforeunload",d),window.removeEventListener("visibilitychange",J),O(),k(),T(),!0):(i.a.shipAssertTag(539829766,o.a.msoulscat_Wac_BrowserGeneral,!1,"InteractivityTracker:stopInteractivityTracker - attempt stop non-started"),!1)}function U(){return!Y(E)}function G(){return!Y(null==L?void 0:L.getCurrentAppInfo)}function q(e){if(null==L?void 0:L.isChangeGateEnabled)try{return null==L?void 0:L.isChangeGateEnabled(e)}catch(e){i.a.sendTraceTag(539829767,o.a.msoulscat_Wac_BrowserGeneral,a.a.Error,"InteractivityTracker:isChangeGateEnabled - failed to call isChangeGateEnabledCallback. Error: "+e)}return!1}function Y(e){return null==e}function J(){q("OfficeVSO:5610366_StopTrackingEventsWhenPageIsHidden")&&"hidden"===document.visibilityState&&O()}function X(){if(null==L?void 0:L.getAppState)try{return null==L?void 0:L.getAppState()}catch(e){i.a.sendTraceTag(539829768,o.a.msoulscat_Wac_BrowserGeneral,a.a.Error,"InteractivityTracker:getAppState - failed to call getAppStateCallback. Error: "+e)}}function K(){if(null==L?void 0:L.getCurrentAppInfo)try{return Object(r.__assign)({},null==L?void 0:L.getCurrentAppInfo())}catch(e){i.a.sendTraceTag(539829769,o.a.msoulscat_Wac_BrowserGeneral,a.a.Error,"InteractivityTracker:getCurrentAppInfo - failed to call getCurrentAppInfoCallback. Error: "+e)}}function Z(e,t){var n=window.__InteractivityTracker__;n&&n.track(e,t)}var Q=function(){function e(){this.collectedActions=[],this.collectingEnabled=!1}return e.prototype.startCollectingSlowActions=function(e){e||this.cleanCollectedActions(),this.collectingEnabled=!0},e.prototype.stopCollectingSlowActions=function(){this.collectingEnabled=!1},e.prototype.collectSlowUserAction=function(e){this.collectingEnabled&&e&&this.collectedActions.push(e)},e.prototype.retrieveAllSlowActions=function(){return Object(r.__spreadArray)([],this.collectedActions)},e.prototype.cleanCollectedActions=function(){this.collectedActions=[]},e.prototype.retrieveSlowActionsBetweenTimeRange=function(e,t){return this.collectedActions.filter((function(n){return e>=n.startTime&&e<=n.endTime||t>=n.startTime&&t<=n.endTime}))},e}(),$=function(){function e(){}return e.prototype.addEventListener=function(e,t){},e.prototype.onError=function(e){},e.prototype.postMessage=function(e){},e.prototype.terminate=function(){},e}(),ee=(function(){function e(){}e.prototype.generateWebWorkerAPI=function(){return new $}}(),function(){function e(){this.xmlHTTPRequest=new XMLHttpRequest}return e.prototype.open=function(e,t,n){this.xmlHTTPRequest.open(e,t,n)},e.prototype.send=function(e){this.xmlHTTPRequest.send(e)},e}()),te=function(){function e(){}return e.prototype.generateXMLHTTPRequestWrapper=function(){return new ee},e}(),ne=function(){function e(){}return e.prototype.getCurrentTimestamp=function(){return performance.now()},e}(),re=function(){function e(e,t,n){return this.performanceAPIChecker=e,this.performanceTimestampRetriever=t,this.logger=n,this.startTimestamp=-1,this.stopTimestamp=-1,this.performanceAPIChecker.isPerformanceAPIAvailable()?this.performanceAPIChecker.isPerformanceNowDefined()?void(this.unsupportedEnvironment=!1):(this.logger.logPerformanceNowMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0)):(this.logger.logPerformanceMissingInJSEnvironment(),void(this.unsupportedEnvironment=!0))}return e.prototype.start=function(){this.unsupportedEnvironment?this.logger.logStopWatchStartingInUnsupportedEnvironment():this.startTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.stop=function(){this.unsupportedEnvironment?this.logger.logStopWatchStoppingInUnsupportedEnvironment():this.stopTimestamp=this.performanceTimestampRetriever.getCurrentTimestamp()},e.prototype.getElapsedTime=function(){if(-1===this.startTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStart(),-1;if(-1===this.stopTimestamp)return this.logger.logGetElapsedTimeCalledWithoutCallingStop(),-1;var e=this.stopTimestamp-this.startTimestamp;return this.resetTimestamps(),e},e.prototype.resetTimestamps=function(){this.startTimestamp=-1,this.stopTimestamp=-1},e}(),ie=function(){function e(){}return e.prototype.logPerformanceMissingInJSEnvironment=function(){i.a.sendTraceTag(579110677,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to find performance in the JS environment")},e.prototype.logPerformanceNowMissingInJSEnvironment=function(){i.a.sendTraceTag(579110678,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to find performance.now in the JS environment")},e.prototype.logStopWatchStartingInUnsupportedEnvironment=function(){i.a.sendTraceTag(579110679,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Starting the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logStopWatchStoppingInUnsupportedEnvironment=function(){i.a.sendTraceTag(579110680,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Stopping the stopwatch in an unsupported environment. Incorrect data will be stored")},e.prototype.logGetElapsedTimeCalledWithoutCallingStart=function(){i.a.sendTraceTag(579110683,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Stopwatch needs to be started before you can get elapsed time")},e.prototype.logGetElapsedTimeCalledWithoutCallingStop=function(){i.a.sendTraceTag(579110684,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Stopwatch needs to be stopped before you can get elapsed time")},e}(),oe=function(){function e(){}return e.prototype.isPerformanceAPIAvailable=function(){return null!=performance},e.prototype.isPerformanceNowDefined=function(){return"now"in performance},e}(),ae=function(){function e(){}return e.createNewStopWatch=function(){var e=new ie,t=new oe,n=new ne;return new re(t,n,e)},e}(),le=function(){function e(){}return e.prototype.logOperation=function(e,t,n,r,l,s,d,u){var c={};d.forEach((function(e,t){c[t]=e})),i.a.sendTraceTag(578958171,o.a.msoulscat_Wac_Telemetry,l?a.a.Error:a.a.Info,JSON.stringify({operationName:e,parentOperationName:t,didOperationSucceed:n,measuredRunTime:r,logs:s,properties:c,exception:u}))},e.prototype.logFallbackResultReturned=function(){i.a.sendTraceTag(578090845,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Fallback result is being returned")},e}(),se=new(function(){function e(){this.elements=[]}return e.prototype.push=function(e){this.elements.unshift(e)},e.prototype.pop=function(){return this.elements.shift()},e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e}()),de=function(){function e(e,t,n,r){var i=se.peek(),o=void 0!==i?i:"";se.push(e),this.logs=[],this.propertyBag=new Map;var a=ae.createNewStopWatch();a.start();var l=void 0,s=!1;try{s=(l=t(this)).didOperationFailUnexpectedly}catch(e){this.exception=e,s=!0}this.operationResult=void 0!==l?l:n,a.stop(),r.logOperation(e,o,this.operationResult.didOperationSucceed,a.getElapsedTime(),s,this.logs,this.propertyBag,this.exception),se.pop()}return e.prototype.addLog=function(e){this.logs.push(e)},e.prototype.addProperty=function(e,t){this.propertyBag.set(e,t)},e.prototype.getResult=function(){return this.operationResult.result},e.startNew=function(t,n,r,i){return new e(t,n,r,null==i?new le:i)},e}(),ue=function(){function e(e,t,n){this.didOperationSucceed=e,this.didOperationFailUnexpectedly=t,this.result=n}return e.generateOperationResult=function(t){return new e(t.didOperationSucceed,null!=t.didOperationFailUnexpectedly&&t.didOperationFailUnexpectedly,t.result)},e}();var ce=function(){function e(e){this.logger=e}return e.prototype.isBrowserChromiumBased=function(e){return function(e,t){var n=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckChromiumBrowser",(function(n){if(n.addProperty("UserAgent",e),0===e.localeCompare(""))return t.logEmptyUserAgentString(),ue.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var r=e.match(/(Chrome\/|CriOS\/)/g);return null!=e.match(/(CriOS\/)/g)&&t.logChromiumOnIOS(),null===r?(t.logBrowserUserAgentNotChromiumBased(),ue.generateOperationResult({didOperationSucceed:!0,result:!1})):ue.generateOperationResult({didOperationSucceed:!0,result:!0})}),n).getResult()}(e,this.logger)},e.prototype.parseChromeMajorVersionNumber=function(e){return function(e,t){var n=ue.generateOperationResult({didOperationSucceed:!1,result:-1});return de.startNew("ParseChromiumMajorVersionNumber",(function(n){n.addProperty("UserAgent",e);var r=e.match(/((Chrome\/|CriOS\/)(\d|\.)+)/g);if(null==r)return t.logChromeNotPresentInUserAgent(),ue.generateOperationResult({didOperationSucceed:!1,result:-1});var i=r[0].split("/");if(i.length<2)return t.logUnableToIsolateChromeInformationFromUserAgent(),ue.generateOperationResult({didOperationSucceed:!1,result:-1});var o=i[1].split(".");if(o.length<4)return t.logUnableToExtractChromeVersionInformation(),ue.generateOperationResult({didOperationSucceed:!1,result:-1});var a=o[0],l=parseInt(a,10);if(isNaN(l))return t.logUnableToParseChromeMajorVersionString(),ue.generateOperationResult({didOperationSucceed:!1,result:-1});return n.addProperty("MajorVersionNumber",l),ue.generateOperationResult({didOperationSucceed:!0,result:l})}),n).getResult()}(e,this.logger)},e}(),ge=function(){function e(){}return e.prototype.logWindowMissingInJSEnvironment=function(){i.a.sendTraceTag(578834847,o.a.msoulscat_Wac_Telemetry,a.a.Warning,"Unable to find window in the JS environment")},e.prototype.logEmptyUserAgentString=function(){i.a.sendTraceTag(578834850,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Empty user agent string")},e.prototype.logChromiumOnIOS=function(){i.a.sendTraceTag(578834851,o.a.msoulscat_Wac_Telemetry,a.a.Info,"iOS version of Chromium based browser detected")},e.prototype.logBrowserUserAgentNotChromiumBased=function(){i.a.sendTraceTag(578834880,o.a.msoulscat_Wac_Telemetry,a.a.Info,"Browser not chromium based")},e.prototype.logUserAgentSpoofedToBeChromium=function(){i.a.sendTraceTag(578834881,o.a.msoulscat_Wac_Telemetry,a.a.Info,"Browser user agent spoofed to be chromium based")},e.prototype.logUserAgentToParseChromiumMajorVersionNumber=function(e){i.a.sendTraceTag(578834882,o.a.msoulscat_Wac_Telemetry,a.a.Info,e)},e.prototype.logChromeNotPresentInUserAgent=function(){i.a.sendTraceTag(578834883,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Chrome was not found in the user agent")},e.prototype.logUnableToIsolateChromeInformationFromUserAgent=function(){i.a.sendTraceTag(578834884,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to isolate chrome information from the user agent")},e.prototype.logUnableToExtractChromeVersionInformation=function(){i.a.sendTraceTag(578834885,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to extract chrome version information from the user agent")},e.prototype.logUnableToParseChromeMajorVersionString=function(){i.a.sendTraceTag(578834886,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to parse the chromium major version number")},e.prototype.logRequestIdleCallbackMissing=function(){i.a.sendTraceTag(576582740,o.a.msoulscat_Wac_Telemetry,a.a.Warning,"Unable to find window.requestIdleCallback in the JS environment")},e.prototype.logCallbackBeingInvokedImmediately=function(){i.a.sendTraceTag(576582743,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Callback is being invoked immediately as there is no platform support for deferring work")},e.prototype.logCancelIdleCallbackMissing=function(){i.a.sendTraceTag(576582744,o.a.msoulscat_Wac_Telemetry,a.a.Warning,"Unable to find window.cancelIdleCallback in the JS environment")},e.prototype.logUnknownMechanism=function(){i.a.sendTraceTag(576582747,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to find a way to cancel the idle time job")},e.prototype.logWindowSetTimeOutMissingInJSEnvironment=function(){i.a.sendTraceTag(576239755,o.a.msoulscat_Wac_Telemetry,a.a.Error,"window.setTimeout is missing in JS environment")},e.prototype.logTimerJobDuration=function(e){i.a.sendTraceTag(576239756,o.a.msoulscat_Wac_Telemetry,a.a.Info,""+e)},e.prototype.logTimerJobScheduled=function(){i.a.sendTraceTag(576239757,o.a.msoulscat_Wac_Telemetry,a.a.Info,"Timer job was scheduled")},e.prototype.logWindowPerformanceMissingInJSEnvironment=function(){i.a.sendTraceTag(576218121,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to find window.performance in the JS environment")},e.prototype.logWindowPerformanceNowMissingInJSEnvironment=function(){i.a.sendTraceTag(576218122,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Unable to find window.performance.now in the JS environment")},e.prototype.logNavigatorMissingInJSEnvironment=function(){i.a.sendTraceTag(574657350,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Navigator is missing in the JS environment")},e.prototype.logSendBeaconNotSupported=function(){i.a.sendTraceTag(573970625,o.a.msoulscat_Wac_Telemetry,a.a.Info,"SendBeacon not supported in current environment")},e.prototype.logBeaconURLIsEmpty=function(){i.a.sendTraceTag(573919702,o.a.msoulscat_Wac_Telemetry,a.a.Error,"We were passed an empty URL for sendBeacon")},e.prototype.logBeaconDataIsEmpty=function(){i.a.sendTraceTag(573907718,o.a.msoulscat_Wac_Telemetry,a.a.Error,"We were passed an empty data for sendBeacon")},e.prototype.logDocumentMissingInJsEnvironment=function(){i.a.sendTraceTag(573572181,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Document is not present in JS Environment")},e.prototype.logDocumentVisibilityStateMissingInJsEnvironment=function(){i.a.sendTraceTag(573572182,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Document VisibilityState is not present in JS Environment")},e.prototype.logDocumentAddEventListenerMissingInJsEnvironment=function(){i.a.sendTraceTag(573572183,o.a.msoulscat_Wac_Telemetry,a.a.Error,"Document AddEventListener is not present in JS Environment")},e}(),he=function(){function e(){}return e.getBrowserUtils=function(){var e=new ge;return new ce(e)},e}();var fe,me=function(){function e(e,t){this.windowPropertyChecker=e,this.logger=t}return e.prototype.scheduleJobForIdleTime=function(e){var t,n,r,i,o;t=function(){e()},n=this.windowPropertyChecker,r=this.logger,o=ue.generateOperationResult({didOperationSucceed:!1,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}}),de.startNew("RequestIdleCallbackShim",(function(){if(n.hasProperty("requestIdleCallback")){var e=window.requestIdleCallback(t,i);return ue.generateOperationResult({didOperationSucceed:!0,result:{id:e,underlyingMechanism:"requestIdleCallback"}})}r.logRequestIdleCallbackMissing();var o=Date.now(),a={didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-o))}};return r.logCallbackBeingInvokedImmediately(),t(a),ue.generateOperationResult({didOperationSucceed:!0,result:{id:-1,underlyingMechanism:"InvalidUnderlyingMechanism"}})}),o).getResult()},e}(),pe=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,n=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckWindowProperty",(function(n){if(null==window)return t.logger.logWindowMissingInJSEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("PropertyNameChecked",e);var r=e in window;return n.addProperty("DoesPropertyExistOnWindow",r),ue.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()},e}(),Ce=(function(){function e(){}e.getIdleTimeJobScheduler=function(){var e=new ge,t=new pe(e);return new me(t,e)}}(),function(){function e(){}return e.prototype.getBooleanPropertyValue=function(e){var t=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckSelfProperty",(function(t){t.addProperty("PropertyChecked",e);var n=!!self.hasOwnProperty(e)&&self[e];return ue.generateOperationResult({didOperationSucceed:!0,result:n})}),t).getResult()},e}()),ve=function(){function e(e){this.selfPropertyChecker=e}return e.prototype.isSiteCrossOriginIsolated=function(){var e=this,t=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckCrossOriginSiteIsolation",(function(){var t=e.selfPropertyChecker.getBooleanPropertyValue("crossOriginIsolated");return ue.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e}(),ye=(function(){function e(){}e.getChecker=function(){var e=new Ce;return new ve(e)}}(),function(){function e(e){this.logger=e}return e.prototype.setTimerJob=function(e,t){var n=this,r=ue.generateOperationResult({didOperationSucceed:!1,result:void 0});de.startNew("SetTimerJob",(function(){return null==window?(n.logger.logWindowMissingInJSEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):null==window.setTimeout?(n.logger.logWindowSetTimeOutMissingInJSEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:void 0,didOperationFailUnexpectedly:!0})):(n.logger.logTimerJobDuration(t),window.setTimeout(e,t),n.logger.logTimerJobScheduled(),ue.generateOperationResult({didOperationSucceed:!0,result:void 0}))}),r)},e}()),Te=(function(){function e(){}e.getTimerJobScheduler=function(){var e=new ge;return new ye(e)}}(),function(){function e(e){var t=this;this.logger=e,this.onVisibilityChange=function(){t.updateIsHidden()},this.isDocumentPresentInJsEnvironment()||this.logger.logDocumentMissingInJsEnvironment(),this.isDocumentVisibilityStatePresentInJsEnvironment()||this.logger.logDocumentVisibilityStateMissingInJsEnvironment(),this.isDocumentAddEventListenerPresentInJsEnvironment()||this.logger.logDocumentAddEventListenerMissingInJsEnvironment(),this.lastUnHiddenDate=void 0,this.isDocumentHidden=!1,this.updateIsHidden(),document.addEventListener("visibilitychange",this.onVisibilityChange)}return e.prototype.isDocumentVisibleNow=function(){var e=this,t=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckDocumentVisibility",(function(){if(!e.isDocumentPresentInJsEnvironment())return e.logger.logDocumentMissingInJsEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});if(!e.isDocumentVisibilityStatePresentInJsEnvironment())return e.logger.logDocumentVisibilityStateMissingInJsEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});var t="hidden"!==document.visibilityState;return ue.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.wasDocumentHiddenDuringTimeRange=function(e){var t=this,n=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("WasDocumentHiddenDuringTimeRange",(function(){if(t.isDocumentHidden)return ue.generateOperationResult({didOperationSucceed:!0,result:!0});if(void 0===t.lastUnHiddenDate)return ue.generateOperationResult({didOperationSucceed:!0,result:!1});var n=Date.now()-t.lastUnHiddenDate<e;return ue.generateOperationResult({didOperationSucceed:!0,result:n})}),n).getResult()},e.prototype.isDocumentPresentInJsEnvironment=function(){return null!=document},e.prototype.isDocumentVisibilityStatePresentInJsEnvironment=function(){return"visibilityState"in document},e.prototype.isDocumentAddEventListenerPresentInJsEnvironment=function(){return"addEventListener"in document},e.prototype.updateIsHidden=function(){this.isDocumentHidden="hidden"===document.visibilityState,this.isDocumentHidden||(this.lastUnHiddenDate=Date.now())},e}());!function(){function e(){}e.getDocumentVisibilityChecker=function(){var e=new ge;return new Te(e)}}();!function(e){e.SendBeacon="sendBeacon"}(fe||(fe={}));var Se=function(){function e(e,t,n,r){this.navigatorPropertyChecker=e,this.navigatorAPI=t,this.xmlHTTPRequestWrapperFactory=n,this.logger=r}return e.prototype.sendBeacon=function(e){return t=this.navigatorPropertyChecker,n=this.navigatorAPI,r=this.xmlHTTPRequestWrapperFactory,i=this.logger,o=e.url,a=e.data,l=ue.generateOperationResult({didOperationSucceed:!1,result:!1}),de.startNew("SendBeaconCall",(function(e){if(0===o.length)return i.logBeaconURLIsEmpty(),ue.generateOperationResult({didOperationSucceed:!1,result:!1});if(0===a.length)return i.logBeaconDataIsEmpty(),ue.generateOperationResult({didOperationSucceed:!1,result:!1});if(!t.hasProperty(fe.SendBeacon)){i.logSendBeaconNotSupported();var l=r.generateXMLHTTPRequestWrapper();return l.open("POST",o,!0),l.send(a),e.addProperty("POSTRequestSent",!0),ue.generateOperationResult({didOperationSucceed:!0,result:!0})}var s=n.sendBeacon(o,a);return e.addProperty("BeaconRequestSuccessfullyQueued",s),ue.generateOperationResult({didOperationSucceed:!0,result:s})}),l).getResult();var t,n,r,i,o,a,l},e}(),Fe=function(){function e(e){this.logger=e}return e.prototype.hasProperty=function(e){var t=this,n=ue.generateOperationResult({didOperationSucceed:!1,result:!1});return de.startNew("CheckNavigatorProperty",(function(n){if(null==navigator)return t.logger.logNavigatorMissingInJSEnvironment(),ue.generateOperationResult({didOperationSucceed:!1,result:!1,didOperationFailUnexpectedly:!0});n.addProperty("NavigatorPropertyChecked",e);var r=e in navigator;return n.addProperty("IsPropertyPresentInNavigatorResult",r),ue.generateOperationResult({didOperationSucceed:!0,result:r})}),n).getResult()},e}(),xe=function(){function e(e){this.logger=e}return e.prototype.sendBeacon=function(e,t){return null==navigator?(this.logger.logNavigatorMissingInJSEnvironment(),!1):navigator.sendBeacon(e,t)},e}(),we=(function(){function e(){}e.getSendBeaconScheduler=function(){var e=new ge,t=new Fe(e),n=new xe(e),r=new te;return new Se(t,n,r,e)}}(),function(){function e(e){this.logger=e}return e.prototype.getCurrentTimestamp=function(){if(null!=window)if(null!=window.performance){if(null!=window.performance.now)return window.performance.now();this.logger.logWindowPerformanceNowMissingInJSEnvironment()}else this.logger.logWindowPerformanceMissingInJSEnvironment();else this.logger.logWindowMissingInJSEnvironment()},e}()),Re=(function(){function e(){}e.getTimestampRetriever=function(){var e=new ge;return new we(e)}}(),function(){function e(){this.elements=[]}return e.prototype.peek=function(){return this.elements.length>0?this.elements[0]:void 0},e.prototype.queue=function(e){this.elements.push(e)},e.prototype.dequeue=function(){this.elements.shift()},e.prototype.length=function(){return this.elements.length},e}()),be=(function(){function e(){}e.createQueue=function(){return new Re}}(),function(){function e(e){this.logger=e,this.logger=e}return e.prototype.retrieveUserAgent=function(){var e=this,t=ue.generateOperationResult({didOperationSucceed:!1,result:""});return de.startNew("RetrieveUserAgent",(function(){var t=e.getUserAgentFromNavigatorAPI();return ue.generateOperationResult({didOperationSucceed:!0,result:t})}),t).getResult()},e.prototype.getUserAgentFromNavigatorAPI=function(){return"undefined"==typeof navigator?(this.logger.logNavigatorMissingInJSEnvironment(),""):navigator.userAgent},e}()),Ie=function(){function e(){}return e.getUserAgentRetriever=function(){return new be(new ge)},e}(),Ae=function(){function e(){this.elements=[]}return e.prototype.peek=function(){var e=this.count();if(0!==e)return this.elements[e-1]},e.prototype.push=function(e){this.elements.push(e)},e.prototype.pop=function(){this.elements.pop()},e.prototype.count=function(){return this.elements.length},e}(),Pe=(function(){function e(){}e.createStack=function(){return new Ae}}(),function(){function e(){}return e.getWindowPropertyChecker=function(){var e=new ge;return new pe(e)},e}()),De=function(){function e(e){this.windowPropertyChecker=e}return e.prototype.isWebWorkerAPIAvailable=function(){return!!this.windowPropertyChecker.hasProperty("Worker")},e}(),Me=(function(){function e(){}e.getWebWorkerAPIAvailabilityChecker=function(){var e=Pe.getWindowPropertyChecker();return new De(e)}}(),function(){function e(){}return e.prototype.generateGuid=function(){return""},e}());!function(){function e(){}e.getGuidGenerator=function(){return new Me}}();var Oe=function(){function e(){}return e.prototype.create=function(){var e,t,n=new Error,r=null===(e=n.stack)||void 0===e?void 0:e.includes("interactivity.min.js"),l=null===(t=n.stack)||void 0===t?void 0:t.includes("gridRenderer.min.js");if(i.a.sendTraceTag(539492420,o.a.msoulscat_Wac_BrowserGeneral,a.a.Info,"InteractivityTrackerFactory.create: isScriptFromNewSlice: "+r+", isScriptFromOldSlice: "+l),function(){var e;if(!window.PerformanceObserver)return i.a.sendTraceTag(539829760,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"InteractivityTracker:isInteractivityTrackerSupported:false - no PerformanceObserver"),!1;if(!PerformanceObserver.supportedEntryTypes)return i.a.sendTraceTag(539829761,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver missing supportedEntryTypes"),!1;if((null===(e=null===PerformanceObserver||void 0===PerformanceObserver?void 0:PerformanceObserver.supportedEntryTypes)||void 0===e?void 0:e.indexOf("event"))<0)return i.a.sendTraceTag(539829762,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"isInteractivityTrackerSupported:false - PerformanceObserver not supporting event timing"),!1;var t=Ie.getUserAgentRetriever().retrieveUserAgent(),n=he.getBrowserUtils();return n.isBrowserChromiumBased(t)?!(n.parseChromeMajorVersionNumber(t)<85)||(i.a.sendTraceTag(539829764,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"isInteractivityTrackerSupported:false - user agent chromium version < 85"),!1):(i.a.sendTraceTag(539829763,o.a.msoulscat_Wac_BrowserGeneral,a.a.Warning,"isInteractivityTrackerSupported:false - user agent is not chromium based."),!1)}()){var s=window.__InteractivityTracker__;return s||(s=window.__InteractivityTracker__=new ke),s}},e}(),ke=function(){function e(){}return e.prototype.start=function(e){return j(e)},e.prototype.stop=function(){return V()},e.prototype.track=function(e,t){R(e,t)},e.prototype.createActionsRetriever=function(){var e,t=new Q;return e=t.collectSlowUserAction.bind(t),w||(w=new EventTarget),w.addEventListener("TrackerProcessEventEntry",(function(t){return e(t.detail)})),t},e}(),Le=new Oe;n.d(t,"startInteractivityTracker",(function(){return j})),n.d(t,"stopInteractivityTracker",(function(){return V})),n.d(t,"trackEventResponseTime",(function(){return Z})),n.d(t,"InteractivityTrackerFactoryGlobal",(function(){return Le}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNullOrUndefined=void 0,t.isNullOrUndefined=function(e){return null==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recalculateFontMetrics=t.getCachedFontMetrics=void 0;var r=n(9),i=n(18),o=n(47),a=n(32),l=n(0),s=document.createElement("div"),d=document.createElement("img"),u=document.createElement("img");s.innerText=".",s.style.visibility="hidden",d.style.height="0px",u.style.height="0px",s.appendChild(d),s.appendChild(u),(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(s);var c={"6pt arial":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:4.072916}},"7pt arial":{fontSize:7,fontMetrics:{height:11,baseline:2,middle:4.416666698}},"8pt arial":{fontSize:8,fontMetrics:{height:12,baseline:2.666666030883789,middle:4.765625}},"9pt arial":{fontSize:9,fontMetrics:{height:14,baseline:3.33333,middle:6.109375}},"10pt arial":{fontSize:10,fontMetrics:{height:15,baseline:3.6666666,middle:6.453125}},"11pt arial":{fontSize:11,fontMetrics:{height:16,baseline:4,middle:6.796875}},"12pt arial":{fontSize:12,fontMetrics:{height:19,baseline:4.33333333,middle:8.15625}},"13pt arial":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666679,middle:9.15625}},"14pt arial":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.84375}},"16pt arial":{fontSize:16,fontMetrics:{height:25,baseline:5.33333333,middle:11.53125}},"18pt arial":{fontSize:18,fontMetrics:{height:28,baseline:5.66666666,middle:12.21875}},"20pt arial":{fontSize:20,fontMetrics:{height:30,baseline:6,middle:12.9166666}},"22pt arial":{fontSize:22,fontMetrics:{height:34,baseline:6.666667938232422,middle:14.609375}},"24pt arial":{fontSize:24,fontMetrics:{height:37,baseline:7.333333,middle:15.63541}},"25pt arial":{fontSize:25,fontMetrics:{height:39,baseline:8,middle:16.6458339}},"26pt arial":{fontSize:26,fontMetrics:{height:40,baseline:8,middle:16.984375}},"28pt arial":{fontSize:28,fontMetrics:{height:43,baseline:8.6666666,middle:18.3437}},"36pt arial":{fontSize:36,fontMetrics:{height:55,baseline:10.666667938232422,middle:23.453125}},"20pt arial black":{fontSize:20,fontMetrics:{height:37,baseline:8,middle:14.90625}},"16pt browallia new":{fontSize:16,fontMetrics:{height:27,baseline:8,middle:11.6145839}},"1pt calibri":{fontSize:1,fontMetrics:{height:1,baseline:0,middle:.3125}},"2pt calibri":{fontSize:2,fontMetrics:{height:3,baseline:.7407407760620117,middle:1.3541667461395264}},"3pt calibri":{fontSize:3,fontMetrics:{height:4,baseline:.7407407760620117,middle:1.6666667461395264}},"4pt calibri":{fontSize:4,fontMetrics:{height:7,baseline:1.4814815521240234,middle:2.719907522201538}},"5pt calibri":{fontSize:5,fontMetrics:{height:8,baseline:1.4814815521240234,middle:3.032407760620117}},"6pt calibri":{fontSize:6,fontMetrics:{height:9,baseline:2,middle:3.8541669}},"7pt calibri":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.8333333969}},"8pt calibri":{fontSize:8,fontMetrics:{height:13,baseline:2.6666669845581055,middle:5.46875}},"9pt calibri":{fontSize:9,fontMetrics:{height:15,baseline:3.3333330154418945,middle:5.78125}},"10pt calibri":{fontSize:10,fontMetrics:{height:17,baseline:3.3333330154418945,middle:7.09375}},"11pt calibri":{fontSize:11,fontMetrics:{height:18,baseline:4,middle:7.40625}},"12pt calibri":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.71875}},"13pt calibri":{fontSize:13,fontMetrics:{height:21,baseline:4.6666666,middle:8.6875}},"14pt calibri":{fontSize:14,fontMetrics:{height:21,baseline:5.33333396911621,middle:9.328125}},"15pt calibri":{fontSize:15,fontMetrics:{height:23,baseline:5.6666666667,middle:9.640625}},"16pt calibri":{fontSize:16,fontMetrics:{height:26,baseline:6,middle:10.953125}},"17pt calibri":{fontSize:17,fontMetrics:{height:27,baseline:5.925926208496094,middle:11.192131042480469}},"18pt calibri":{fontSize:18,fontMetrics:{height:29,baseline:6.666666030883789,middle:11.578125}},"19pt calibri":{fontSize:19,fontMetrics:{height:31,baseline:6.666666030883789,middle:12.546297073364258}},"20pt calibri":{fontSize:20,fontMetrics:{height:32,baseline:7.333333969116211,middle:13.1875}},"21pt calibri":{fontSize:21,fontMetrics:{height:34,baseline:7.407405853271484,middle:13.91203498840332}},"22pt calibri":{fontSize:22,fontMetrics:{height:36,baseline:8,middle:14.8125}},"23pt calibri":{fontSize:23,fontMetrics:{height:37,baseline:8.148151397705078,middle:15.266206741333008}},"24pt calibri":{fontSize:24,fontMetrics:{height:39,baseline:8.666666793,middle:16.09375}},"25pt calibri":{fontSize:25,fontMetrics:{height:41,baseline:8.88888931274414,middle:16.63194465637207}},"26pt calibri":{fontSize:26,fontMetrics:{height:43,baseline:9.333333,middle:17.3854179}},"27pt calibri":{fontSize:27,fontMetrics:{height:44,baseline:9.629631042480469,middle:17.98611068725586}},"28pt calibri":{fontSize:28,fontMetrics:{height:45,baseline:10,middle:18.666666}},"29pt calibri":{fontSize:29,fontMetrics:{height:47,baseline:10.370368957519531,middle:19.351852416992188}},"30pt calibri":{fontSize:30,fontMetrics:{height:48,baseline:10.370372772216797,middle:19.652780532836914}},"31pt calibri":{fontSize:31,fontMetrics:{height:50,baseline:11.11111068725586,middle:20.70602035522461}},"32pt calibri":{fontSize:32,fontMetrics:{height:52,baseline:11.11111068725586,middle:21.018518447875977}},"33pt calibri":{fontSize:33,fontMetrics:{height:54,baseline:11.851852416992188,middle:22.06018829345703}},"34pt calibri":{fontSize:34,fontMetrics:{height:55,baseline:11.851852416992188,middle:22.37268829345703}},"35pt calibri":{fontSize:35,fontMetrics:{height:57,baseline:12.592594146728516,middle:23.425926208496094}},"36pt calibri":{fontSize:36,fontMetrics:{height:59,baseline:12.666666679,middle:24.140625}},"37pt calibri":{fontSize:37,fontMetrics:{height:60,baseline:13.333335876464844,middle:24.791667938232422}},"38pt calibri":{fontSize:38,fontMetrics:{height:61,baseline:13.333335876464844,middle:25.104167938232422}},"39pt calibri":{fontSize:39,fontMetrics:{height:64,baseline:14.444446563720703,middle:26.510421752929688}},"40pt calibri":{fontSize:40,fontMetrics:{height:65,baseline:14.074073791503906,middle:26.458335876464844}},"41pt calibri":{fontSize:41,fontMetrics:{height:67,baseline:14.444446563720703,middle:27.135421752929688}},"42pt calibri":{fontSize:42,fontMetrics:{height:68,baseline:14.814811706542969,middle:27.812496185302734}},"43pt calibri":{fontSize:43,fontMetrics:{height:70,baseline:15.555553436279297,middle:28.871524810791016}},"44pt calibri":{fontSize:44,fontMetrics:{height:71,baseline:15.555557250976562,middle:29.18402862548828}},"45pt calibri":{fontSize:45,fontMetrics:{height:73,baseline:16.296295166015625,middle:30.21990966796875}},"46pt calibri":{fontSize:46,fontMetrics:{height:76,baseline:16.666664123535156,middle:30.90277862548828}},"47pt calibri":{fontSize:47,fontMetrics:{height:77,baseline:16.666667938232422,middle:31.215282440185547}},"48pt calibri":{fontSize:48,fontMetrics:{height:72,baseline:17.333332061767578,middle:31.859375}},"49pt calibri":{fontSize:49,fontMetrics:{height:80,baseline:17.777774810791016,middle:32.951385498046875}},"50pt calibri":{fontSize:50,fontMetrics:{height:81,baseline:17.77777862548828,middle:33.24652862548828}},"51pt calibri":{fontSize:51,fontMetrics:{height:83,baseline:18.518516540527344,middle:34.30555725097656}},"52pt calibri":{fontSize:52,fontMetrics:{height:84,baseline:18.888893127441406,middle:34.982643127441406}},"53pt calibri":{fontSize:53,fontMetrics:{height:87,baseline:18.888893127441406,middle:35.295143127441406}},"54pt calibri":{fontSize:54,fontMetrics:{height:88,baseline:18.888885498046875,middle:35.607635498046875}},"55pt calibri":{fontSize:55,fontMetrics:{height:90,baseline:20,middle:37.02546310424805}},"56pt calibri":{fontSize:56,fontMetrics:{height:91,baseline:20,middle:37.32638931274414}},"57pt calibri":{fontSize:57,fontMetrics:{height:92,baseline:20,middle:37.638893127441406}},"58pt calibri":{fontSize:58,fontMetrics:{height:94,baseline:21.111114501953125,middle:39.062503814697266}},"59pt calibri":{fontSize:59,fontMetrics:{height:96,baseline:21.111106872558594,middle:39.375}},"60pt calibri":{fontSize:60,fontMetrics:{height:98,baseline:21.111114501953125,middle:39.687503814697266}},"61pt calibri":{fontSize:61,fontMetrics:{height:100,baseline:22.22222900390625,middle:41.111114501953125}},"62pt calibri":{fontSize:62,fontMetrics:{height:101,baseline:22.22222137451172,middle:41.40625}},"63pt calibri":{fontSize:63,fontMetrics:{height:102,baseline:22.22222900390625,middle:41.718753814697266}},"64pt calibri":{fontSize:64,fontMetrics:{height:104,baseline:23.333335876464844,middle:43.142364501953125}},"65pt calibri":{fontSize:65,fontMetrics:{height:106,baseline:23.3333328,middle:43.458332061}},"66pt calibri":{fontSize:66,fontMetrics:{height:107,baseline:23.333335876464844,middle:43.767364501953125}},"67pt calibri":{fontSize:67,fontMetrics:{height:110,baseline:24.44445037841797,middle:45.19097900390625}},"68pt calibri":{fontSize:68,fontMetrics:{height:111,baseline:24.444442749023438,middle:45.50347137451172}},"69pt calibri":{fontSize:69,fontMetrics:{height:112,baseline:24.44445037841797,middle:45.798614501953125}},"70pt calibri":{fontSize:70,fontMetrics:{height:114,baseline:25.555557250976562,middle:47.22222137451172}},"71pt calibri":{fontSize:71,fontMetrics:{height:116,baseline:25.55554962158203,middle:47.53472137451172}},"72pt calibri":{fontSize:72,fontMetrics:{height:117,baseline:25.925926208496094,middle:48.21759033203125}},"85pt calibri":{fontSize:85,fontMetrics:{height:138,baseline:30,middle:56.31945037841797}},"98pt calibri":{fontSize:98,fontMetrics:{height:160,baseline:35.55554962158203,middle:65.88541412353516}},"100pt calibri":{fontSize:100,fontMetrics:{height:162,baseline:35.55555725097656,middle:66.51620483398438}},"111pt calibri":{fontSize:111,fontMetrics:{height:181,baseline:40,middle:74.35763549804688}},"124pt calibri":{fontSize:124,fontMetrics:{height:202,baseline:44.44444274902344,middle:82.82986450195312}},"137pt calibri":{fontSize:137,fontMetrics:{height:223,baseline:48.888885498046875,middle:91.30209350585938}},"150pt calibri":{fontSize:150,fontMetrics:{height:243,baseline:53.33332824707031,middle:99.77430725097656}},"163pt calibri":{fontSize:163,fontMetrics:{height:266,baseline:58.88890075683594,middle:109.34028625488281}},"176pt calibri":{fontSize:176,fontMetrics:{height:287,baseline:63.333343505859375,middle:117.81251525878906}},"189pt calibri":{fontSize:189,fontMetrics:{height:308,baseline:67.77778625488281,middle:126.28474426269531}},"202pt calibri":{fontSize:202,fontMetrics:{height:329,baseline:72.22222900390625,middle:134.7569580078125}},"215pt calibri":{fontSize:215,fontMetrics:{height:350,baseline:76.66668701171875,middle:143.22918701171875}},"228pt calibri":{fontSize:228,fontMetrics:{height:371,baseline:81.11111450195312,middle:151.70138549804688}},"241pt calibri":{fontSize:241,fontMetrics:{height:392,baseline:86.66665649414062,middle:161.26736450195312}},"254pt calibri":{fontSize:254,fontMetrics:{height:413,baseline:91.11111450195312,middle:169.7395782470703}},"267pt calibri":{fontSize:267,fontMetrics:{height:434,baseline:95.5555419921875,middle:178.2117919921875}},"280pt calibri":{fontSize:280,fontMetrics:{height:456,baseline:100,middle:186.68402099609375}},"293pt calibri":{fontSize:293,fontMetrics:{height:477,baseline:104.4444580078125,middle:195.13888549804688}},"306pt calibri":{fontSize:306,fontMetrics:{height:499,baseline:110,middle:204.72222900390625}},"319pt calibri":{fontSize:319,fontMetrics:{height:519,baseline:114.4444580078125,middle:213.1944580078125}},"332pt calibri":{fontSize:332,fontMetrics:{height:540,baseline:118.88885498046875,middle:221.66665649414062}},"345pt calibri":{fontSize:345,fontMetrics:{height:561,baseline:123.33334350585938,middle:230.138916015625}},"358pt calibri":{fontSize:358,fontMetrics:{height:582,baseline:127.77777099609375,middle:238.61111450195312}},"371pt calibri":{fontSize:371,fontMetrics:{height:604,baseline:133.33331298828125,middle:248.17709350585938}},"384pt calibri":{fontSize:384,fontMetrics:{height:626,baseline:137.77780151367188,middle:256.6493225097656}},"397pt calibri":{fontSize:397,fontMetrics:{height:647,baseline:142.22222900390625,middle:265.12152099609375}},"409pt calibri":{fontSize:409,fontMetrics:{height:666,baseline:146.66668701171875,middle:273.2812805175781}},"12pt calibri light":{fontSize:12,fontMetrics:{height:19,baseline:4,middle:7.6979169845581055}},"14pt comic sans ms":{fontSize:14,fontMetrics:{height:26,baseline:5.3333332061,middle:10.03125}},"9pt georgia":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:5.890625}},"8pt microsoft sans serif":{fontSize:8,fontMetrics:{height:12,baseline:2,middle:4.760416507720947}},"8pt meiryo ui":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.9375}},"9pt meiryo ui":{fontSize:9,fontMetrics:{height:16,baseline:3,middle:6.3125}},"11pt meiryo ui":{fontSize:11,fontMetrics:{height:19,baseline:3,middle:7.046875}},"10pt segoe ui":{fontSize:10,fontMetrics:{height:18,baseline:3.3333330154418945,middle:6.666666030883789}},"6pt times new roman":{fontSize:6,fontMetrics:{height:10,baseline:2.666665,middle:4.45833301}},"7pt times new roman":{fontSize:7,fontMetrics:{height:11,baseline:2.666666698,middle:4.75}},"8pt times new roman":{fontSize:8,fontMetrics:{height:11,baseline:2.666666030883789,middle:4.390625}},"8.5pt times new roman":{fontSize:8.5,fontMetrics:{height:12,baseline:2.8888888888884,middle:4.53125}},"9pt times new roman":{fontSize:9,fontMetrics:{height:14,baseline:3,middle:6.6875}},"10pt times new roman":{fontSize:10,fontMetrics:{height:15,baseline:3.3333333,middle:6.984375}},"11pt times new roman":{fontSize:11,fontMetrics:{height:17,baseline:4,middle:7.28125}},"12pt times new roman":{fontSize:12,fontMetrics:{height:18,baseline:4.3333333,middle:7.578125}},"13pt times new roman":{fontSize:13,fontMetrics:{height:19,baseline:4.5,middle:8.875}},"14pt times new roman":{fontSize:14,fontMetrics:{height:22,baseline:4.666666030883789,middle:9.171875}},"15pt times new roman":{fontSize:15,fontMetrics:{height:23,baseline:4.6666667938,middle:9.13541793}},"16pt times new roman":{fontSize:16,fontMetrics:{height:25,baseline:5.333333,middle:10.765625}},"18pt times new roman":{fontSize:18,fontMetrics:{height:28,baseline:6,middle:11.375}},"19pt times new roman":{fontSize:19,fontMetrics:{height:29,baseline:6,middle:11.666666603}},"20pt times new roman":{fontSize:20,fontMetrics:{height:31,baseline:6.666666603,middle:12.635416}},"8pt tahoma":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"10pt tahoma":{fontSize:10,fontMetrics:{height:16,baseline:2.6666666,middle:6.30208301}},"11pt tahoma":{fontSize:11,fontMetrics:{height:18,baseline:3.3333333015,middle:7.333333015}},"12pt trebuchet ms":{fontSize:12,fontMetrics:{height:19,baseline:3.333333,middle:7.5208339691}},"14pt trebuchet ms":{fontSize:14,fontMetrics:{height:22,baseline:4,middle:8.875}},"8pt verdana":{fontSize:8,fontMetrics:{height:13,baseline:2,middle:4.90625}},"9pt verdana":{fontSize:9,fontMetrics:{height:15,baseline:3,middle:6.265625}},"10pt verdana":{fontSize:10,fontMetrics:{height:16,baseline:2.66666603,middle:6.302083015}},"14pt webdings":{fontSize:14,fontMetrics:{height:19,baseline:4.000000953674316,middle:8.666667938232422}},"36pt wingdings":{fontSize:36,fontMetrics:{height:53,baseline:10,middle:22.000001907348633}}};function g(e){var t=-1,n=-1,i=-1,o=d,a=u;return s.style.font=e,o.style.verticalAlign="baseline",a.style.verticalAlign="middle",r.trackDuration(r.RenderPerformanceMetric.GetFontMetrics,(function(){t=s.clientHeight,n=h(o),i=h(a)}),!0),{height:t,baseline:n,middle:i}}function h(e){if(!s||!e)throw Error("getFontBaselineHeight: arguments cannot be null or undefined, fontMetricsDiv: "+s+", baselineLocator: "+e);try{var t=s.getBoundingClientRect(),n=e.getBoundingClientRect();return t.bottom-n.bottom}catch(e){return r.setRenderingResultInfo("Error in getFontBaselineHeight: "+e),0}}function f(e,t){var n,r=l.getFontLookupKey(e,t);if(t>=0&&t<1)return c[r]={fontSize:t,fontMetrics:{baseline:0,height:1,middle:0}},c[r].fontMetrics;try{n=g(r)}catch(n){return p(t,e,r,"Exception in getFontMetrics, error:"+n)}return 0===n.height&&t>=1?p(t,e,r,"fontMetricsDivHeight == 0."):(c[r]={fontSize:t,fontMetrics:n},n)}function m(e){return{height:e.height,baseline:e.baseline,middle:e.middle}}function p(e,t,n,o){var a=null!==s.parentNode?"Has Parent":"Parent is null",l=window.getComputedStyle(s).getPropertyValue("display");s.style.display="block",(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(s);var d=g(n),u=window.getComputedStyle(s),h=u.getPropertyValue("display"),f=u.getPropertyValue("height"),m=s.getBoundingClientRect();if(0!==d.height)return c[n]={fontSize:e,fontMetrics:d},d;s.style.overflow="hidden";var p=g(n);if(0!==p.height)return c[n]={fontSize:e,fontMetrics:d},p;var C="\n       "+o+"\n       Font name: "+i.getFontNameForLogging(t)+" }, font size: "+e+".\n       fontMetricsDiv "+a+". fontMetricsDivDisplayMode: "+l+".\n       After another appendChild:\n       FontMetricsDivHeight2: "+d.height+" (getFontMetricsDivHeight), fontMetricsDivDisplayMode: "+h+" (getComputedStyle),\n       fontBoundingClientRect.height: "+m.height+" }, top:"+m.top+" }, bottom:"+m.bottom+".\n       css.height: "+u.height+" }, css.line-height: "+u.lineHeight+" }, computedHeight: "+f+".\n       FontMetricsDiv.scrollWidth: "+s.scrollWidth+" }, fontMetricsDiv.scrollHeight: "+s.scrollHeight;if(r.setRenderingResultInfo(C),!i.isKnownFont(t)){var v=Math.round(e)+"pt calibri";if(c[v])return c[v].fontMetrics}throw Error(C)}function C(e){var t=c[l.getFontLookupKey(a.DefaultFallbackFontName,e)];return m(t?t.fontMetrics:f(a.DefaultFallbackFontName,e))}t.getCachedFontMetrics=function(e,t,n){o.updateFontLoadStatus(i.canonizeFontName(e));var a=l.getFontLookupKey(e,t),s=c[a];if(s)return m(s.fontMetrics);try{return m(f(e,t))}catch(o){r.setRenderingResultInfo("FontName:"+i.getFontNameForLogging(e)+", FontSize:"+t+" is trying to fallback to calibri "+o),n.ClientOnlyCache.FallbackFonts[a]=!0;try{return C(t)}catch(e){var d=Math.max(Math.round(t),1);try{return C(d)}catch(e){var u=13*Math.round((d-72)/13)+72;return C(u=Math.min(u,409))}}throw o}},t.recalculateFontMetrics=function(e){for(var t=Object.getOwnPropertyNames(c),n=e.toLowerCase(),r=0;r<t.length;r++){var i=t[r];if(i.indexOf(n)>=0){var o=c[i].fontSize;try{f(n,o)}catch(e){f(a.DefaultFallbackFontName,o)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFontUsedInModel=t.updateFontLoadStatus=t.doesFontExist=t.setFontLoadStatus=t.getFontLoadStatus=t.isFontLoadFailed=t.isFontLoaded=t.getFontFaceLoadStatus=t.isValidCellFontLoaded=t.setFontLoadDivWithFontFamily=t.isFontValid=t.documentFontsCheck=t.getFontFaceSetReady=t.fontFaceSetSupported=t.FontLoadStatus=void 0;var r,i=n(0),o=n(9);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(r=t.FontLoadStatus||(t.FontLoadStatus={}));var a={};function l(){return void 0!==document.fonts}function s(e){try{return!!document.fonts.check(e)||window.parent.document.fonts.check(e)}catch(e){return o.setRenderingResultInfo("Error in documentFontsCheck"),!1}}function d(e){switch(e){case"inherit":case"initial":case"unset":case"revert":return!1}return!0}function u(e,t){if("function"!=typeof document.fonts.values)return!1;for(var n=document.fonts.values(),i=n.next();!i.done;){if(i.value&&i.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())switch(t){case r.Loaded:if("loaded"===i.value.status)return!0;break;case r.Failed:if("error"===i.value.status)return!0}i=n.next()}return!1}function c(e){if("function"==typeof document.fonts.values)for(var t=document.fonts.values(),n=t.next();!n.done;){if(n.value&&n.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase())return n.value.status;n=t.next()}}function g(e,t){a[e]=t}function h(e){return null!==a[e]&&void 0!==a[e]}t.fontFaceSetSupported=l,t.getFontFaceSetReady=function(){return document.fonts.ready},t.documentFontsCheck=s,t.isFontValid=d,t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t},t.isValidCellFontLoaded=function(e,t){var n;return!!d(null===(n=t.CachedFont)||void 0===n?void 0:n.FontName)&&s(i.getFontCssStringFromCell(t,e))},t.getFontFaceLoadStatus=c,t.isFontLoaded=function(e,t){return t?"loaded"===c(e):u(e,r.Loaded)},t.isFontLoadFailed=function(e){return u(e,r.Failed)},t.getFontLoadStatus=function(e){return a[e]},t.setFontLoadStatus=g,t.doesFontExist=h,t.updateFontLoadStatus=function(e){l()&&!h(e)&&d(e)&&function(e){return s("11pt "+e)}(e)&&g(e,r.Loaded)},t.isFontUsedInModel=function(e,t){return!!(e.Fonts&&e.Fonts[t]&&e.Fonts[t].RefCount)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextRunsForBidiDrawing=t.prepareTextRunsForBidiLayout=t.analyzeBidiText=void 0;var r=n(1),i=n(0),o=n(2);function a(e,t){var n=[d(e,0)];if(1===t.length)return n;for(var r=void 0,i=0;i<t.length;i++){if(c(t[i])){l(i,r)&&n.push(u(e,i));var o=i+1;s(o,t.length)&&n.push(d(e,o)),r=i}}return n}function l(e,t){return e>0&&!(e-1===t)}function s(e,t){return e<t}function d(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function u(e,t){return{FontID:e.FontID||0,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont,IsSpecialCharTextRun:!0}}function c(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}t.analyzeBidiText=function(e,t){for(var n=!1,i=!1,a=0;a<e.length;a++){var l=e[a];if(o.isRtlChar(l)?n=!0:i=!0,i&&n)break}return{HasLtr:i,HasRtl:n,HasBidi:i&&n,BaseDir:function(e,t){if(!e)return"ltr";switch(t){case r.ReadingOrderType.LeftToRight:return"ltr";case r.ReadingOrderType.RightToLeft:return"rtl";case r.ReadingOrderType.Context:return o.isRtlChar(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=a(e[r],i.getTextRunText(r,e,t));n.push.apply(n,o)}return n},t.reorderTextRunsForBidiDrawing=function(e,t,n,r){if(!n.HasRtl||n.HasLtr){for(var a=o.getReOrderDiv(n,r),l=0;l<e.length;l++){var s=i.getTextRunText(l,e,t),d=document.createElement("span");d.innerText=s,d.setAttribute("rid",l.toString()),a.appendChild(d)}document.body.appendChild(a);for(var u=0;u<a.children.length;u++){var c=a.children[u],g=c.getAttribute("rid");if(!g)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var h=c.getBoundingClientRect().left;e[l=parseInt(g,10)].OffsetX=h}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(a)}else e.reverse()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichValueSvgIconBottomSizeRatioPadding=t.RichValueIconUnicodeFontFamily=t.RichValueIconRightHorizontalPadding=t.RichValueIconLeftHorizontalPadding=void 0,t.RichValueIconLeftHorizontalPadding=2,t.RichValueIconRightHorizontalPadding=1,t.RichValueIconUnicodeFontFamily="XLYellow",t.RichValueSvgIconBottomSizeRatioPadding=.1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canCellContainExpandCollapseAndCFIcon=t.isPivotIntersectsRenderingRegion=t.getPivotTableLeftAdjustedForDrawing=t.getPivotTableTopAdjustedForDrawing=void 0;var r=n(1),i=n(7),o=n(0),a=n(10);function l(e,t){if(!t)return e.FirstRow;var n=e.ColumnHeaderRange;return!i.isNullOrUndefined(n)&&n.FirstColumn!==n.LastColumn&&n.FirstRow!==n.LastRow?e.ColumnHeaderRange.FirstRow:e.RowHeaderRange.FirstRow}t.getPivotTableTopAdjustedForDrawing=function(e,t,n){r.verifyArgumentNotNull(e,"model","getPivotTableTopAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var i=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;if(r.verifyArgumentNotNull(i,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),r.verifyArgumentNotNull(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),n&&!t.IsEmptyPivot&&0===t.DeltaYFromOriginPTAdjustedForDrawing){var a=l(t,n);return i[o.getModelRowIndex(e,a)]}return i[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,n){r.verifyArgumentNotNull(e,"model","getPivotTableLeftAdjustedForDrawing"),r.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","getPivotTableTopAdjustedForDrawing");var i=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return r.verifyArgumentNotNull(i,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),r.verifyArgumentNotNull(t,"pivotTable","getPivotTableLeftAdjustedForDrawing"),n||!e.IsRtl?i[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:i[i.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-i[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t,n,i){return r.verifyArgumentNotNull(e,"model","isPivotIntersectsRenderingRegion"),r.verifyArgumentNotNull(t,"pivotTable","isPivotIntersectsRenderingRegion"),r.verifyArgumentNotNull(n,"renderingRegion","isPivotIntersectsRenderingRegion"),!(t.LastRowIndex<n.startRow)&&(!((t.IsEmptyPivot?t.FirstRowIndex:o.getModelRowIndex(e,l(t,i)))>n.endRow)&&(!(t.FirstColIndex<n.startColumn)&&!(t.LastColIndex>n.endColumn)))},t.canCellContainExpandCollapseAndCFIcon=function(e,t,n,i){var l,s;if(!(null===(s=null===(l=t.CondFormat)||void 0===l?void 0:l.Icon)||void 0===s?void 0:s.IconOnly))return!0;var d=t.CachedFont.Size,u=a.getIconHorizontalPadding(d,i),c=a.getIconSize(d,i),g=o.isPivotTablePhase2Enabled(e),h=a.getExpandCollapseButtonPadding(t,g)*i;switch(t.CondFormat.Icon.CFIconHorizontalAlignment){case r.HorizontalAlignment.Left:case r.HorizontalAlignment.Right:return n-c-u-h>0;case r.HorizontalAlignment.Center:return n/2-c/2-h>0;default:return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakToGraphemes=void 0;var r=n(92),i=n(136);function o(e,t){return 55296<=e&&e<=56319&&56320<=t&&t<=57343}t.breakToGraphemes=function(e){if(!e)return[];for(var t=[],n=0,a=e.charCodeAt(n),l=i.classifyChar(e.codePointAt(n)),s=r.CombiningClass.Other,d=1;d<e.length;d++){var u=e.charCodeAt(d);d>=1&&o(a,u)||(s=i.classifyChar(e.codePointAt(d)),r.shouldBreak(l,s)&&(t.push(e.substring(n,d)),n=d),l=s,a=u)}return n<=e.length-1&&t.push(e.substring(n)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillVerticalTextForRTF=t.getVerticalTextMetadata=t.fillVerticalText=void 0;var r=n(1),i=n(6),o=n(51),a=n(29),l=n(11),s=n(93),d=n(64);function u(e,t,n,r,i,o,a,l,s,d,u,g){var f=e.textAlign;"center"!==f&&(e.textAlign="center");var m=h(t,n,r,a,i,g),p=m.graphemes,C=m.maxFontHeight;!function(e,t,n,r,i,o,a,l,s,d,u){for(var g=o,h=r.length-1;h>=0;h--){var f=r[h];" "!==f&&(e.fillText(f,i,g),c(e,t,n,i,g,f,l,s,d,u)),g-=a}}(e,t,n,p,o,m.adjustedOffsetY,C,l,s,d,u),"center"!==f&&(e.textAlign=f)}function c(e,t,n,o,s,u,c,g,h,f){g&&l.shouldRenderVerticalText(n)&&a.cacheTextDecorationLayout(t,n,c,{textPositionX:o,textPositionY:s,textWidth:i.measureTextWidth(e,u,!d.isTestRun(),r.isRenderFlagEnabled(r.RenderFlagsArray.TextWidthClientPhase1,t)),clipRect:f},h)}function g(e,t,n,i,o){var a=function(e,t,n,i){var o=s.getVerticalTextPadding(t);switch(e){case r.VerticalAlignment.Top:return n+i+o;case r.VerticalAlignment.Center:return n+i/2;case r.VerticalAlignment.Bottom:default:return n-o}}(e,t,n,i);return o&&e===r.VerticalAlignment.Distributed&&o<=0?a-o:a}function h(e,t,n,r,a,l){var s,d=o.breakToGraphemes(n),u=r||i.getTextLineHeight(t,e),c=function(e,t){return(e.length-1)*t}(d,u);return{graphemes:d,maxFontHeight:u,adjustedOffsetY:g(t.CachedStyle.VerticalAlignment,(null===(s=t.CachedStyle)||void 0===s?void 0:s.Indentation)||0,a,c,l),textHeight:c}}t.fillVerticalText=function(e,t,n,r,i,o,a,l,s){u(e,t,n,r,o,i,void 0,a,!0===n.CachedFont.StrikeThrough,n.CachedFont,l,s)},t.getVerticalTextMetadata=function(e,t,n,r,i,o){var a=h(e,t,n,r,i,o);return{adjustedOffsetY:a.adjustedOffsetY,textHeight:a.textHeight}},t.fillVerticalTextForRTF=function(e,t,n,r,i,o,a,l,s,d,c,g){u(e,t,n,r,o,i,a,l,s,d,c,g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhoneticTextHeightPx=t.PhoneticRotatedTextAlign=t.PhoneticTextAlign=t.PhoneticTextDirection=t.VerticalDistancePhoneticFromTopCellPx=t.PhoneticFontSizePt=t.PhoneticFontName=void 0,t.PhoneticFontName="Yu Gothic",t.PhoneticFontSizePt=6,t.VerticalDistancePhoneticFromTopCellPx=7,t.PhoneticTextDirection="ltr",t.PhoneticTextAlign="start",t.PhoneticRotatedTextAlign="left",t.PhoneticTextHeightPx=14},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initGridRendererStrings=t.gridRendererStrings=void 0,t.initGridRendererStrings=function(e){t.gridRendererStrings=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircle=t.drawCircleIcon=void 0;var r=n(0),i=n(16),o=n(22),a=n(148),l=n(17);function s(e,t,n,s){var c=t.image,g=t.highContrastScheme,h=function(e){var t=e.left,n=e.bottom,r=e.size/2,i=r-l.ShapeOutlineWidthPx,o=Math.round(t+r),a=Math.round(n-r);return{centerX:o,centerY:a,innerRadius:i,outlineRadius:r}}(t),f=h.outlineRadius;f<=0||(d(e,h.centerX,h.centerY,f,i.Circle0Deg,i.Circle360Deg,n),s&&h.innerRadius>0&&function(e,t,n,l,s){var c=t.centerX,g=t.centerY,h=t.innerRadius;if(s)!function(e,t,n,o){var l=t.centerX,s=t.centerY,c=t.innerRadius,g=a.getHighContrastFillingType(o),h=r.rgbToColorHex(n.BackgroundColor),f=r.rgbToColorHex(n.TextColor);switch(g){case a.FillType.Full:break;case a.FillType.FillPortion:var m=u(o);d(e,l,s,c,m,i.Circle270Deg,h);break;case a.FillType.Empty:d(e,l,s,c,i.Circle0Deg,i.Circle360Deg,h);break;case a.FillType.InnerCircle:d(e,l,s,c,i.Circle0Deg,i.Circle360Deg,h);var p=a.getInnerCircleRadius(o,c);d(e,l,s,p,i.Circle0Deg,i.Circle360Deg,f);break;case a.FillType.Stripes:d(e,l,s,c,i.Circle0Deg,i.Circle360Deg,h),a.drawStripes(e,l,s,c,f);break;default:throw Error("circle-fillHighContrastCircle: unsupported filling type")}}(e,t,s,l);else switch(l){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:var f=u(l);d(e,c,g,h,i.Circle270Deg,f,n),d(e,c,g,h,f,i.Circle270Deg,o.CircleEmptyInnerColor);break;default:d(e,c,g,h,i.Circle0Deg,i.Circle360Deg,n)}}(e,h,s,c,g))}function d(e,t,n,r,i,o,a){e.fillStyle=a,e.beginPath(),e.moveTo(t,n),e.arc(t,n,r,i,o),e.fill()}function u(e){switch(e){case i.CFIconImage.Circle25:return i.Circle0Deg;case i.CFIconImage.CircleHalf:return i.Circle90Deg;case i.CFIconImage.Circle75:return i.Circle180Deg;default:throw Error("getFillAngle: image: "+e+" not supported")}}t.drawCircleIcon=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawCircleIcon"),r.verifyArgumentNotNull(t,"drawingContext","drawCircleIcon");var n=t.image,a=t.highContrastScheme;s(e,t,function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighOuterColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumOuterColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowOuterColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyOuterColor;case i.CFIconImage.CircleFilled:case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledOuterColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighOuterColor;case i.CFIconImage.FourCircleLow:return o.FourCircleLowOuterColor;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1OuterColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2OuterColor;default:throw Error("getCircleOutlineColor: unsupported image type = "+e)}}(n,a),function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleSymbolHigh:return o.CircleHighInnerColor;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:case i.CFIconImage.CircleSymbolMedium:return o.CircleMediumInnerColor;case i.CFIconImage.CircleLow:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:return o.CircleLowInnerColor;case i.CFIconImage.CircleEmpty:return o.CircleEmptyInnerColor;case i.CFIconImage.CircleFilled:return o.CircleFilledInnerColor;case i.CFIconImage.FourCircleHigh:return o.FourCircleHighInnerColor;case i.CFIconImage.FourCircleLow:return;case i.CFIconImage.FourCircleMedium1:return o.FourCircleMedium1InnerColor;case i.CFIconImage.FourCircleMedium2:return o.FourCircleMedium2InnerColor;case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return o.CircleFilledInnerColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(n,a))},t.drawCircle=s},function(e,t,n){"use strict";function r(e,t,n){if(t){var r=window.navigator;if(r&&r.sendBeacon)try{return void r.sendBeacon(t,e)}catch(e){}!function(e,t,n){var r=new XMLHttpRequest;r.readyState!==XMLHttpRequest.UNSENT&&r.readyState!==XMLHttpRequest.DONE||(r.open("POST",t,n),r.send(e))}(e,t,n)}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeArraysTestOnly=t.initializeChangeGatesDataStructure=t.isChangeGateEnabled=t.ChangeGate=void 0;var r,i=n(82);!function(e){e[e.TreatZeroAndUndefinedAsEqual=0]="TreatZeroAndUndefinedAsEqual",e[e.FixTextRunCachedFont=1]="FixTextRunCachedFont",e[e.LogHyperlink=2]="LogHyperlink",e[e.PivotTablePhase2=3]="PivotTablePhase2",e[e.RichValueIconTextSpillsInCenterAlignment=4]="RichValueIconTextSpillsInCenterAlignment",e[e.AdjacentCellsMergeFix=5]="AdjacentCellsMergeFix",e[e.AcctApplicableIfNumFmtIsDefined=6]="AcctApplicableIfNumFmtIsDefined",e[e.IgnoreCaseForDtoProperties=7]="IgnoreCaseForDtoProperties",e[e.FixDiffRenderingRtlBackgroundColorBug=8]="FixDiffRenderingRtlBackgroundColorBug",e[e.AddAutoFilterAndPivotTableContextMenu=9]="AddAutoFilterAndPivotTableContextMenu",e[e.FormulaViewCellComparisonFix=10]="FormulaViewCellComparisonFix",e[e.PhoneticRenderTelemetry=11]="PhoneticRenderTelemetry",e[e.DrawPhoneticCellsExportValidityCheck=12]="DrawPhoneticCellsExportValidityCheck",e[e.TableSelectionDragSelection=13]="TableSelectionDragSelection",e[e.RFMetricPhase2=14]="RFMetricPhase2",e[e.LastChangeGateDontDelete=15]="LastChangeGateDontDelete"}(r=t.ChangeGate||(t.ChangeGate={}));var o=r.LastChangeGateDontDelete,a=g(o,32),l=a.changeGatesNamesArray,s=a.changeGatesBitMap,d=a.cachedChangeGatesBitMap;function u(e,t,n){return 0!=(e[t]&n)}function c(e,t,n){e[t]|=n}function g(e,t){var n=new Array(e),r=Math.ceil(e/t);return{changeGatesNamesArray:n,changeGatesBitMap:h(r),cachedChangeGatesBitMap:h(r)}}function h(e){return Array.apply(null,new Array(e)).map((function(){return 0}))}l[r.TreatZeroAndUndefinedAsEqual]="OfficeVSO:5010362_TreatZeroAndUndefinedAsEqual",l[r.FixTextRunCachedFont]="OfficeVSO:5168981_fixTextRunCachedFont",l[r.LogHyperlink]="OfficeVSO:5681038_AddLogsForHyperlinkHitTest",l[r.PivotTablePhase2]="OfficeVSO:5176377_PivotTable_Phase2",l[r.RichValueIconTextSpillsInCenterAlignment]="OfficeVSO:5470621_RichValueIconsTextSpillsInCenterHA",l[r.AcctApplicableIfNumFmtIsDefined]="OfficeVSO:5272516_AcctApplicableIfNumFmtIsDefined",l[r.AdjacentCellsMergeFix]="OfficeVSO:5230472_adjacentCellsMergeFix2",l[r.IgnoreCaseForDtoProperties]="OfficeVSO:5351608_IgnoreCaseForDtoProperties",l[r.FixDiffRenderingRtlBackgroundColorBug]="OfficeVSO:5470562_IgnoreCaseForDtoProperties",l[r.AddAutoFilterAndPivotTableContextMenu]="OfficeVSO:5468968_addAutoFilterAndPivotTableContextMenu",l[r.FormulaViewCellComparisonFix]="OfficeVSO:5622926_FormulaViewCellComparisonFix",l[r.PhoneticRenderTelemetry]="OfficeVSO:5609491_PhoneticRenderTelemetryFix",l[r.DrawPhoneticCellsExportValidityCheck]="OfficeVSO:5629950_DrawPhoneticCellsExportValidityCheck",l[r.TableSelectionDragSelection]="OfficeVSO:5501896_TableSelectionDragSelection",l[r.RFMetricPhase2]="OfficeVSO:5725432_RFMetricPhase2",t.isChangeGateEnabled=function(e){var t=Math.floor(e/32),n=1<<e%32;return function(e,t,n){if(!u(d,t,n)){i.ewaUtils().isChangeGateEnabled(l[e])&&c(s,t,n),c(d,t,n)}}(e,t,n),u(s,t,n)},t.initializeChangeGatesDataStructure=g,t.initializeArraysTestOnly=function(e){o=e.length,l=e;var t=Math.ceil(o/32);s=new Array(t).fill(0),d=new Array(t).fill(0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.approximateValue=void 0;var r=n(28);t.approximateValue=function(e,t){var n=Math.round(e);if(n<r.MinAllowedFontSize&&e>0&&(n=r.MinAllowedFontSize),n>r.MaxAllowedFontSize&&(n=r.MaxAllowedFontSize),n<0)throw Error("TextLayout.approximateValue: "+n+" in Excel must be between 1pt and 409pt");var i=t[n];if(i)return i;for(var o=n;o>r.MinAllowedFontSize&&!t[o];)o--;for(var a=n;a<r.MaxAllowedFontSize&&!t[a];)a++;return i=function(e,t,n,r,i){var o=(n-r)/(i-r)*(e-t);return Math.round(t+o)}(t[a],t[o],n,o,a),t[n]=i,i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconHorizontalPadding=t.FontSizeToIconSize=t.CalibriTextDecorationLineWidth=t.CalibriRegularPadding=t.CalibriItalicPadding=void 0,t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={1:0,2:0,3:0,4:0,5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:0,3:0,4:0,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(14),i=n(57),o=function(){function e(){this.correlationId=""}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.prototype.getLogMessage=function(t,n,r){var o="tag_"+e.tagIntToString(t)+" ["+i.a[n]+"] "+r;return this.correlationId&&""!==this.correlationId&&(o+="\t\t"+this.correlationId),o},e.prototype.sendTraceTag=function(e,t,n,i){var o=this.logMessage;switch(n){case r.a.Error:o=this.logError;break;case r.a.Warning:o=this.logWarning;break;case r.a.Info:o=this.logInfo;break;case r.a.Verbose:o=this.logVerbose;break;case r.a.Spam:default:o=this.logMessage}try{o(this.getLogMessage(e,t,i))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(e,t,n,r){console.assert(n,this.getLogMessage(e,t,r))},e.prototype.debugAssertTag=function(e,t,n,r){this.shipAssertTag(e,t,n,r)},e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NoIndent=t.ExpandCollapseButtonVerticalPaddingPx=t.PlusMinusLineAdjustment=t.PaddingBetweenExpandCollapseButtonAndTextPx=t.MinusPlusWidthPx=t.MinusPlusPaddingPx=t.ExpandCollapseButtonOuterColor=t.ExpandCollapseButtonInnerColor=t.ExpandCollapseButtonSizePx=t.EmptyPivotTableImageWidthHeightRatio=t.EmptyPivotTableMinimalImageWidthPx=t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableImageMinimalPaddingYPx=t.EmptyPivotTableTitleContainerWidthRatio=t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerHeightPx=t.EmptyPivotTableTitleContainerTopPaddingPx=t.EmptyPivotTableImagePlaceholderThicknessPx=t.EmptyPivotTableTitleContainerBorderThicknessPx=t.EmptyPivotTableTitleTextColor=t.EmptyPivotTableTitleContainerBorderColor=void 0,t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164,t.ExpandCollapseButtonSizePx=9,t.ExpandCollapseButtonInnerColor="#FAFAFA",t.ExpandCollapseButtonOuterColor="#3A3A38",t.MinusPlusPaddingPx=1,t.MinusPlusWidthPx=1,t.PaddingBetweenExpandCollapseButtonAndTextPx=3,t.PlusMinusLineAdjustment=.5,t.ExpandCollapseButtonVerticalPaddingPx=4,t.NoIndent=0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTestRun=void 0,t.isTestRun=function(){return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStartOffset=t.getTextRun=t.reorderTextTokens=t.prepareTextRunsForJustifyAndDistributed=t.getSpaceWidthBetweenWords=t.getJustifyDistributedLine=void 0;var r=n(7),i=n(30),o=n(3),a=n(1),l=n(6),s=n(48),d=n(137),u=n(9);function c(e,t,n,a){if(void 0===a&&(a=0),e.isProcessingLastLine&&e.breakType===i.BreakType.Justify){var l=function(e,t,n){void 0===n&&(n=0);for(var r="",i=0,a=0;a<e.length;a++)r+=e[a].text,i+=e[a].width,a!==e.length-1&&(r+=o.Whitespace,i+=t);return{Start:{Offset:n,Text:r,Width:i},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth,a);return e.lineDirection===i.LineDirection.Vertical&&(l.Start.Offset=e.maxWidth-l.Start.Width),l}if(e.lineDirection===i.LineDirection.Vertical&&function(e){if(e.length>=2){var t=e[0];e[0]=e[e.length-1],e[e.length-1]=t}}(t),t.length>0){var s=a,d=0,c=t[d],g=(l={Start:{Offset:s,Text:c.text,Width:c.width},SpaceWidthBetweenWords:n},Math.floor(n/e.singleSpaceWidth));g<1&&(g=1);var h=function(e,t,n,r){if(e.lineDirection===i.LineDirection.Vertical&&r>3)return n-t*e.singleSpaceWidth>=0?Math.floor((n-t*e.singleSpaceWidth)*(r-3)/2):0;return 0}(e,g,n,t.length);s+=c.width+n+h,d++,(void 0===g||isNaN(g)||g===1/0)&&(u.setRenderingResultInfo("getJustifyDistributedLine: Invalid count variable. numberOfSpaces: "+g+", spaceWidthBetweenTokens: "+n+", singleSpaceWidth: "+e.singleSpaceWidth+" "),g=1);for(var f="",m=s,p=0;d<t.length-1;d++)f+=(c=t[d]).text,p+=c.width,d!==t.length-2&&(f+=o.Whitespace.repeat(g),p+=e.singleSpaceWidth*g);if(""!==f&&(l.Middle={Offset:m,Text:f,Width:p}),t.length>1){var C=t[t.length-1],v=r.isNullOrUndefined(l.Middle)?s:m+p+n+h;l.End={Offset:v,Text:C.text,Width:C.width}}return l}}function g(e,t){var n=e;if(n.length<=1)return 0;if(t.breakType===i.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;for(var r=0,o=0;o<n.length;o++){r+=n[o].width}var a=(t.maxWidth-r)/(n.length-1);return a<t.singleSpaceWidth?t.singleSpaceWidth:a}function h(e,t,n){return e?t[t.length-1-n]:t[n]}function f(e,t){return e.isProcessingLastLine&&e.breakType===i.BreakType.Distributed&&1===t.length&&e.isCompleteTextVisible?(e.maxWidth-t[0].width)/2:0}function m(e,t,n,r,i,o,a){for(var l=[],s=0,d=!1,u=0;u<n.length;u++){var c=n[u];if(C(c,r,i))if(v(c,r,i))l.push(c),s+=c.width;else{var g=y(e,t,c,r,i,o,a);d=o?d||!c.text.startsWith(g.text):T(c.text)?!c.text.startsWith(g.text):!c.text.endsWith(g.text),l.push(g),s+=g.width}}return{currentTextTokens:l,currentTokenWidthPx:s,combinePartialTokens:d}}function p(e){if(e.Start&&e.End){var t={Start:{Offset:e.Start.Offset,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords},n=t.Start.Offset;return e.Middle&&(t.Middle=e.Middle,n=t.Start.Offset+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.Offset=n,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),n=t.Middle.Offset+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,Offset:n+t.SpaceWidthBetweenWords},t}return e}function C(e,t,n){return e.start<n&&e.start+e.text.length>t}function v(e,t,n){return t<=e.start&&e.start+e.text.length<=n}function y(e,t,n,r,i,o,s){var d=n.start<r?r-n.start:0,u=d+i-(r>n.start?r:n.start),c=n.text.substring(d,u);return{text:c,start:n.start>r?n.start:r,width:o?l.measureTextHeightForVerticalText(s,c):l.measureTextWidth(e,c,!0,a.isRenderFlagEnabled(a.RenderFlagsArray.TextWidthClientPhase1,t)),containsThaiCharacters:n.containsThaiCharacters}}function T(e){return!!e&&s.analyzeBidiText(e,a.ReadingOrderType.LeftToRight).HasRtl}function S(e){return{singleSpaceWidth:e.singleSpaceWidth,breakType:e.breakType,isCompleteTextVisible:e.isCompleteTextVisible,isProcessingLastLine:e.isProcessingLastLine,maxWidth:e.maxWidth,lineDirection:e.lineDirection}}function F(e,t,n){return e===i.LineDirection.Vertical?n:t.measureText(" ").width}t.getJustifyDistributedLine=c,t.getSpaceWidthBetweenWords=g,t.prepareTextRunsForJustifyAndDistributed=function(e,t,n,a,l,s){if(0===l.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(0!==a.length){s&&(n.maxWidth=n.maxWidth-2*o.GridLineWidthPx);var d=f(n,a);if(1===l.length){var u=e.font,C=u,v=l[0],y=v.FontCss;C!==y&&(e.font=y,C=y);var x=S(n);x.singleSpaceWidth=F(n.lineDirection,e,v.MaxGlyphHeightPx);var w=c(x,a,g(a,n),d);s||!T(v.Text)||r.isNullOrUndefined(w)||(w=p(w)),v.JustifyDistributedLine=w,v.WidthPx=function(e,t){var n=0;if(t&&e.breakType===i.BreakType.Justify)return n+=null==t?void 0:t.Start.Width,(null==t?void 0:t.Middle)&&(n+=null==t?void 0:t.Middle.Width),(null==t?void 0:t.End)&&(n+=null==t?void 0:t.End.Width),n;return e.maxWidth}(n,w),C!==u&&(e.font=u)}else!function(e,t,n,o,a,l,s){void 0===s&&(s=0);for(var d=g(n,o),u=function(e){for(var t=e[0].start,n=1;n<e.length;n++)e[n].start<t&&(t=e[n].start);return t}(n),f=e.font,C=f,v=s,y=0;y<a.length;y++){var x=h(l,a,y),w=x.FontCss;C!==w&&(e.font=w,C=w);var R=S(o);R.singleSpaceWidth=F(o.lineDirection,e,x.MaxGlyphHeightPx);var b=x.StartIndex+u,I=b+(void 0!==x.Text?x.Text.length:0),A=m(e,t,n,b,I,l,x.MaxGlyphHeightPx),P=A.currentTextTokens,D=A.currentTokenWidthPx,M=A.combinePartialTokens;if(0!==P.length){var O=c(R,P,d,v);l||r.isNullOrUndefined(O)||T(x.Text)&&(O=p(O)),x.JustifyDistributedLine=O,l&&o.lineDirection===i.LineDirection.Vertical?x.HeightPx=D+d*(P.length-1):x.WidthPx=D+d*(P.length-1),M||x.IsSpecialCharTextRun?v+=D+d*(P.length-1):v+=D+d*P.length}}C!==f&&(e.font=f)}(e,t,a,n,l,s,d)}},t.reorderTextTokens=function(e,t,n,r){if(!n.HasRtl||n.HasLtr)d.reorderTextTokensUsingDom(e,t,n,r);else for(var i=0;i<e.tokensPerLine.length;i++)e.tokensPerLine[i].tokens.reverse()},t.getTextRun=h,t.getStartOffset=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testCombineThaiTokensPerLine=t.breakTextToLines=void 0;var r=n(4),i=n(0),o=n(139),a=n(140),l=n(3),s=n(1),d=n(23),u=n(30),c=n(6),g=n(11);function h(e,t){(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth)&&(P(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width);e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function f(e,t,n,r,i,l){if(t.type!==o.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),P(e));for(var s=l?d.substringFormattedText(l,t.start,t.start+t.len):void 0,u=e.isVerticalText?a.breakWideWordVerticalText(t.value,e.maxWidth,e.textLineHeight):a.breakWideWord(r,t.value,e.maxWidth,i,s),c=t.start,g=0;g<u.length-1;g++){var h=u[g],f={text:h.value,width:h.size,underlineWidth:h.size,startIndex:c,endIndex:c+h.value.length};if(c+=h.value.length,e.textLines.push(f),e.isBreakTypeJustifyOrDistributed){var m=M(h.value);e.tokensPerLine.push({tokens:[{text:h.value,width:h.size,start:c,containsThaiCharacters:m}],containsThaiCharacters:m}),O(e,m)}e.isSingleCharTooWide=R(f.width,f.text.length,e.maxWidth,e.isSingleCharTooWide)}var p,C,y,T,S,F=(C=t,y=(p=u)[p.length-1],T=C.start+C.len-y.value.length,S=y.size,{start:T,len:y.value.length,value:y.value,type:o.BreakOpTokenType.Word,width:S});e.lastFittingToken=F,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(F),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else v(e,t,n)}function m(e,t,n){void 0!==e.lastFittingToken&&P(e);var r=function(e){switch(e.type){case o.BreakOpTokenType.HardBreak:return e.len;case o.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==n&&n!==e.tokens.length-1&&r--;for(var i=0;i<r;i++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.textLines.push(p(i,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function p(e,t){var n=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:n,endIndex:n+function(e){return e.type===o.BreakOpTokenType.HardBreakCRLF?l.HardBreakCRLF.length:l.HardBreak.length}(t)}}function C(e,t,n){if(I(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,n){if(w(e.tokens,n),!S(e,n))return!1;return n===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||x(e,t,n)}(e,t,n)?e.curLineWidth+t.width>e.maxWidth||x(e,t,n)?v(e,t,n):(e.curLineWidth+=t.width,e.lastFittingToken=t):F(e,t)}function v(e,t,n){I(t);var r=t.width/t.len,i=e.maxWidth-e.curLineWidth;if(!(i<0)){var o=Math.floor(i/r);t.width=r*o,e.curLineWidth+=t.width,e.lastFittingToken=t,(T(e.tokens,n)||S(e,n))&&F(e,t)}}function y(e,t){if(w(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function T(e,t){return w(e,t),y(e,t),0===t&&e[t].type===o.BreakOpTokenType.Space}function S(e,t){var n=e.tokens;return w(n,t),t>0&&n[t].type===o.BreakOpTokenType.Space&&A(n[t-1])&&void 0===e.lastFittingToken}function F(e,t){if(t.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var n=r.__assign({},l.EmptyLine),i=t.start+t.len;n.underlineWidth=t.width,n.startIndex=t.start,n.endIndex=i,e.textLines.push(n),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.curLineStart=i,e.curLineWidth=0,e.lastFittingToken=void 0}function x(e,t,n){if(I(t),n>=e.tokens.length-1)return!1;var r=e.tokens[n+1];return e.curLineWidth+t.width+r.width>e.maxWidth}function w(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function R(e,t,n,r){if(r)return!0;if(e>n){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return r}function b(e,t){return e.width<t}function I(e){if(e.type!==o.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function A(e){return e.type===o.BreakOpTokenType.HardBreak||e.type===o.BreakOpTokenType.HardBreakCRLF}function P(e,t){void 0===t&&(t=0),i.verifyArgumentNotNull(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var n=e.curLineWidth-t,r=n;if(e.lastFittingToken.type===o.BreakOpTokenType.Space&&(r-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed){var a=function(e){for(var t=[],n=!1,r=0;r<e.length;r++){var i=e[r],o=M(i.value);t.push({text:i.value,width:i.width,start:i.start,containsThaiCharacters:o}),o&&!n&&(n=!0)}return{tokens:t,containsThaiCharacters:n}}(e.unprocessedTokens);e.tokensPerLine.push(a),O(e,a.containsThaiCharacters),e.unprocessedTokens=[]}var l=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e),s=l.text,d=l.start,u=l.end;e.textLines.push({text:s,underlineWidth:n,width:r,startIndex:d,endIndex:u})}function D(e){for(var t,n,r={tokens:[],containsThaiCharacters:!0},i=void 0,o=0;o<e.length;o++){var a=e[o];M(a.text)?i?(n=a,i={text:(t=i).text+n.text,width:t.width+n.width,start:t.start,containsThaiCharacters:t.containsThaiCharacters||n.containsThaiCharacters}):i=a:(i&&(r.tokens.push(i),i=void 0),r.tokens.push(a))}return i&&r.tokens.push(i),r}function M(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n>=l.MinUnicodeThaiRange&&n<=l.MaxUnicodeThaiRange)return!0}return!1}function O(e,t){!e.containsThaiCharacters&&t&&(e.containsThaiCharacters=!0)}t.breakTextToLines=function(e,t,n,r,a,l,d,p,v){if(i.verifyArgumentNotNull(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};for(var S,F=g.shouldRenderVerticalText(d),x=F?c.getTextLineHeight(d,l):0,w=o.tokenizeTextToWrap(e,t,a,l,F,x,p,v),I={text:t,tokens:w,maxWidth:n,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(S=r,S===u.BreakType.Justify||S===u.BreakType.Distributed),containsThaiCharacters:!1,isVerticalText:F,textLineHeight:x},M=0;M<w.length;M++){var O=w[M];if(y(w,M),A(O))m(I,O,M);else if(b(O,n)){if(O.type===o.BreakOpTokenType.Space&&!T(w,M)){C(I,O,M);continue}h(I,O)}else f(I,O,M,e,l,p)}if(void 0!==I.lastFittingToken&&function(e){P(e),e.isSingleCharTooWide=R(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(I),I.isBreakTypeJustifyOrDistributed&&I.textLines.length!==I.tokensPerLine.length)throw new Error("breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = "+I.tokensPerLine.length+", textLineLength = "+I.textLines.length+", MaxWidth = "+n+", Text = "+s.annonymize(I.text));return I.isBreakTypeJustifyOrDistributed&&(null==v?void 0:v.BreakOp)&&I.containsThaiCharacters&&(I.tokensPerLine=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.containsThaiCharacters?t.push(D(r.tokens)):t.push(r)}return t}(I.tokensPerLine)),{textLines:I.textLines,tokensPerLine:I.tokensPerLine,requireClipping:I.isSingleCharTooWide}},t.testCombineThaiTokensPerLine=function(e){return D(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSpaceWidthBetweenLines=t.getOffsetXForVerticalText=t.adjustOrderingOfLinesForVerticalText=t.drawTextLine=void 0;var r=n(1),i=n(23),o=n(11),a=n(52),l=n(13),s=n(5),d=n(6),u=n(10);t.drawTextLine=function(e,t,n,r,l,s,d,u,c,g,h,f,m){g?i.fillRichTextFormat(e,t,n,r,g,d,u,h,f,m):o.shouldRenderVerticalText(r)?a.fillVerticalText(e,n,r,s,d,u,t,h,c):l?e.fillText(s,d,u):e.fillText(s,d,u,c)},t.adjustOrderingOfLinesForVerticalText=function(e,t,n){var i;(null===(i=e.CachedStyle)||void 0===i?void 0:i.ReadingOrder)!==r.ReadingOrderType.RightToLeft&&n.HasLtr&&!n.HasBidi&&(t.textLines=t.textLines.reverse(),t.tokensPerLine=t.tokensPerLine.reverse())},t.getOffsetXForVerticalText=function(e,t,n,i,a,u){return function(e,t,n,i,o){switch(l.getEffectiveHorizontalAlignment(e,t)){case r.HorizontalAlignment.Right:return n-i*(o-1);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return n-i*(o-1)/2;default:case r.HorizontalAlignment.Left:return n}}(e,t,function(e,t,n,i,a){var l;if(1===a&&o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(t)){var u=d.getCellTextHorizontalPadding(t,e,n.zoom,n.devicePixelRatio);switch((null===(l=t.CachedStyle)||void 0===l?void 0:l.HorizontalAlignment)||r.HorizontalAlignment.Automatic){case r.HorizontalAlignment.Distributed:return d.getCellTextCenterX(e,t,n.zoom,n.devicePixelRatio);case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.JustifyDistributed:return s.getCellLeft(e,t,e.BlockWidth)+u}}return i}(e,t,n,i,u),a,u)},t.getSpaceWidthBetweenLines=function(e,t,n,r,i){if(!o.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(t)||1===r)return 0;var a=u.getCellRightVisualElementsPadding(e,t),l=n,c=s.getCellRight(e,t,e.BlockWidth)-d.getCellTextHorizontalPaddingWithoutVisualElements(e,t)-a-l-i*(r-1);return c<0?0:c/(r-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateContextForPhonetic=t.drawPhoneticText=t.drawCellsPhoneticText=void 0;var r=n(6),i=n(19),o=n(1),a=n(0),l=n(5),s=n(40),d=n(2),u=n(53),c=n(69),g=n(70),h=n(23),f=n(11),m=n(9),p=n(3);function C(e,t,n,i,o,a){var l;if(n.PhonInfo&&n.PhonInfo.Text){if(function(e){return e.TextRuns||e.WrapText||f.shouldRenderVerticalText(e)}(n)||n.PhonInfo&&!n.PhonInfo.PhoneticTextRuns){var s=a;s||(n.TextRuns?(e.save(),s=r.getTextWidth(e,t,n),e.restore()):s=r.getTextWidth(e,t,n));var d=y(t,n,s,o),u=g.getNoControlPhoneticText(n.PhonInfo,n.Text);return e.fillText(u,d,i),void m.setRenderingResultMonitorable("drawPhoneticText: Row:"+n.Row.toString()+" Col:"+n.Col.toString())}var c=g.getPhoneticTextRunsForRendering(n),h=c.phoneticTextRuns,p=c.textRuns;e.save();var C=r.measureTextRunsWidth(e,p,n.Text,t,void 0);e.restore();for(var v=y(t,n,C.totalSize,o),T=0;T<h.length;T++){var S=h[T];if(C.textRunsDrawingInformation[T]){if(0!==S.PhoneticLength){var F=n.PhonInfo.Text.substr(S.PhoneticStartIndex,S.PhoneticLength);e.fillText(F,v,i)}v+=null!==(l=C.textRunsDrawingInformation[T].WidthPx)&&void 0!==l?l:0}}}}function v(e,t,n){var r=a.getCellFontWeightStyle(!1,!1);e.font=a.getFontCssString(t,r,u.PhoneticFontSizePt,u.PhoneticFontName);var i=s.getDefaultContextState(n,t.IsRtl);e.fillStyle=i.fontColor,e.direction=u.PhoneticTextDirection,e.textAlign=u.PhoneticTextAlign}function y(e,t,n,o){if(i.shouldDrawRotatedText(e,t.CachedStyle,t.CachedFont))return t.CachedDrawingLayout.TextOrientationLayout.Angle>0?-n:0;if(f.shouldRenderVerticalText(t)||t.WrapText){var a=r.getCellTextHorizontalPadding(t,e,o.zoom,o.devicePixelRatio);return l.getCellLeft(e,t,e.BlockWidth)+a}var s=r.getTextHorizontalPosition(e,t,o);return h.getAdjustedOffsetXforHorizontalAlignment(e,t,s,!1,n,void 0)}function T(e,t){return!!t&&(!!d.cellIntersectsRenderingRegion(t,e.renderingRegion)&&(!c.shouldDrawWrapText(t)&&(!t.PreviewText&&(!t.ShowSkeleton&&(!!t.Text&&!!t.PhonInfo&&t.PhonInfo.Text!==p.EmptyString)))))}function S(e,t,n,o){var a=g.getPhoneticTextVerticalPosition(t,o),s=function(e,t,n,i){var o=c.shouldDrawSpillCell(t),a=c.shouldDrawWrapText(t),s=l.getCellWidth(e,t,!0),d=l.getCellHeight(e,t,!0),u=l.getCellTop(e,t),g=r.getDistanceFromCellStartToIconEnd(e,t,n,i);return c.getCellClippingForPhonetic(e,t,a,o,s,d,g,u)}(t,o,n.zoom,n.devicePixelRatio);d.applyClipping(e,s),function(e,t,n){if(i.shouldDrawRotatedText(t,n.CachedStyle,n.CachedFont)){var r=n.CachedDrawingLayout.TextOrientationLayout;i.applyRotation(e,r.TranslateX,r.TranslateY,r.Angle),e.textAlign=u.PhoneticRotatedTextAlign}}(e,t,o),C(e,t,o,a,n),function(e,t,n){i.shouldDrawRotatedText(t,n.CachedStyle,n.CachedFont)&&(e.restore(),e.textAlign=u.PhoneticTextAlign)}(e,t,o),d.restoreClipping(e,s)}t.drawCellsPhoneticText=function(e,t,n){a.verifyArgumentNotNull(e,"ctx","drawCellsPhoneticText"),a.verifyArgumentNotNull(t,"model","drawCellsPhoneticText"),a.verifyArgumentNotNull(n,"context","drawCellsPhoneticText"),a.verifyArgumentNotNull(t.Cells,"model.Cells","drawCellsPhoneticText");var r=t.ClientOnlyCache.CellsToRender,i=!1;v(e,t,n.highContrastScheme);for(var l=0;l<r.length;l++){var s=r[l];if(o.isChangeGateEnabled(o.ChangeGate.DrawPhoneticCellsExportValidityCheck)){if(T(n,s))try{S(e,t,n,s),i=!0}catch(e){throw m.setRenderingResultMonitorable("Error drawSingleCellPhoneticText: "+e),e}}else{if(!d.cellIntersectsRenderingRegion(s,n.renderingRegion))continue;if(c.shouldDrawWrapText(s))continue;if(s.PreviewText)continue;if(s.ShowSkeleton)continue;if(s&&s.Text&&s.PhonInfo)try{S(e,t,n,s),i=!0}catch(e){throw m.setRenderingResultMonitorable("Error drawSingleCellPhoneticText: "+e),e}}}o.isChangeGateEnabled(o.ChangeGate.PhoneticRenderTelemetry)&&i&&m.setRenderingResultMonitorable("drawCellsPhoneticText: Phonetic rendered")},t.drawPhoneticText=C,t.updateContextForPhonetic=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawWrapText=t.shouldDrawSpillCell=t.getCellClippingForPhonetic=t.shouldClipText=t.getCellClipping=void 0;var r=n(1),i=n(0),o=n(5),a=n(10),l=n(6),s=n(39),d=n(13),u=n(2),c=n(94),g=n(11);function h(e,t,n){return!!t||n||d.isHorizontalAlignmentCenteredAcrossSelection(e)||g.shouldRenderVerticalText(e)||!!e.DisplayFormula||!!e.PreviewText}t.getCellClipping=function(e,t,n,i,a,s,d,u,f,m,p,C){var v,y=o.getCellLeft(e,t,e.BlockWidth),T=o.getCellTop(e,t),S=!!(null===(v=t.CondFormat)||void 0===v?void 0:v.Icon),F=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&!!t.RichValueIcon,x=S||F;return t.Merge||s?function(e,t,n,r,i,a,s,d,u,c,h,f){if(t.Merge&&(o.isCellSpansMultipleRowsOrBlocks(t)||i||l.getTextWidth(n,e,t)>=r||g.shouldRenderVerticalText(t))||f)return l.getCellTextClipMask(e,d,u,a,s,c,h);return}(e,t,n,i,a,u,f,y,T,m,x,s):d?c.getClipMaskForSpillCell(e,t,a,m,C,p,f):h(t,a,C)?l.getCellTextClipMask(e,y,T,u,f,m,x):void 0},t.shouldClipText=h,t.getCellClippingForPhonetic=function(e,t,n,r,s,d,c,g){var h,f=o.getCellLeft(e,t,e.BlockWidth),m=o.getCellTop(e,t),p=void 0!==(null===(h=t.CondFormat)||void 0===h?void 0:h.Icon);if(t.Merge||n)return l.getCellTextClipMask(e,f,m,s,d,c,p);if(r){var C=i.isPivotTablePhase2Enabled(e),v=a.getExpandCollapseButtonPadding(t,C),y=o.getSpillCellWidth(t,e),T=u.getClipMaskWidth(y,c,v);return{x:o.getSpillCellStartOffset(t,e,c,v),y:g,width:T,height:d}}return l.getCellTextClipMask(e,f,m,s,d,c,p)},t.shouldDrawSpillCell=function(e){return!e.DisplayFormula&&!e.PreviewText&&!!e.Spill},t.shouldDrawWrapText=function(e){var t;return!e.DisplayFormula&&!e.PreviewText&&!!e.WrapText&&function(e){if(g.shouldRenderVerticalText(e))return!0;if(d.isHorizontalAlignmentJustifiedAndDistributed(e)||s.isVerticalAlignmentJustifyOrDistributed(e.CachedStyle.VerticalAlignment))return!(e.CachedIsTextWidthExceedsCellWidth&&e.ValueType===r.CellValueType.Number);return!(e.ValueType===r.CellValueType.Number)}(e)&&!((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)===r.HorizontalAlignment.Fill)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPhoneticTextRunsForRendering=t.getNoControlPhoneticText=t.getPhoneticVerticalPosition=t.getPhoneticTextVerticalPosition=void 0;var r=n(1),i=n(5),o=n(52),a=n(11),l=n(6),s=n(53),d=n(19);function u(e,t,n,r,l){var s=n+r-l;return a.shouldRenderVerticalText(t)?function(e,t,n){var r=o.getVerticalTextMetadata(e,t,t.Text,void 0,n,i.getCellHeight(e,t,!0));return r.adjustedOffsetY-r.textHeight}(e,t,s):d.shouldDrawRotatedText(e,t.CachedStyle,t.CachedFont)?r-l:s}t.getPhoneticTextVerticalPosition=function(e,t){var n=l.getTextLineHeight(t,e),o=s.PhoneticTextHeightPx,a=i.getCellHeight(e,t,!0),d=t.DisplayFormula?r.VerticalAlignment.Bottom:t.CachedStyle.VerticalAlignment,c=l.getTextVerticalPosition(t,e,n+o,a,d,void 0);return u(e,t,c.absoluteY,c.lastTextLineAlphabeticBaselineOffset,n)},t.getPhoneticVerticalPosition=u,t.getNoControlPhoneticText=function(e,t){if(!e.PhoneticTextRuns)return e.Text?e.Text:"";for(var n="",r=0,i=0;i<e.PhoneticTextRuns.length;i++){var o=e.PhoneticTextRuns[i];r<o.BaseStartIndex&&(n+=t.substring(r,o.BaseStartIndex)),n+=e.Text.substring(o.PhoneticStartIndex,o.PhoneticStartIndex+o.PhoneticLength),r=o.BaseStartIndex+o.BaseTextLength}return r<t.length&&(n+=t.substring(r)),n},t.getPhoneticTextRunsForRendering=function(e){var t,n,r,i,o,a=[],l=[];if(!e.PhonInfo||!e.PhonInfo.PhoneticTextRuns)return{phoneticTextRuns:a,textRuns:l};for(var s=0,d=0;d<e.PhonInfo.PhoneticTextRuns.length;d++){var u=e.PhonInfo.PhoneticTextRuns[d];if(s<u.BaseStartIndex){var c={FontID:null!==(n=null===(t=e.CachedFont)||void 0===t?void 0:t.ID)&&void 0!==n?n:0,StartIndex:s,EndIndex:u.BaseStartIndex,IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};l.push(c),a.push({BaseStartIndex:s,PhoneticStartIndex:0,BaseTextLength:u.BaseStartIndex-s,PhoneticLength:0})}var g={FontID:null!==(i=null===(r=e.CachedFont)||void 0===r?void 0:r.ID)&&void 0!==i?i:0,StartIndex:u.BaseStartIndex,EndIndex:u.BaseStartIndex+(null!==(o=u.BaseTextLength)&&void 0!==o?o:0),IsSpecialCharTextRun:!1,CachedFont:e.CachedFont};l.push(g),a.push(u),s=u.BaseStartIndex+u.BaseTextLength}return{phoneticTextRuns:a,textRuns:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Position=void 0,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(t.Position||(t.Position={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeCachedObjects=t.updateCellsBeforeDrawing=t.updatePivotTablesInformationBeforeDrawing=t.preprocessAutofitWidth=void 0;var r=n(1),i=n(0),o=n(73),a=n(187),l=n(28),s=n(188),d=n(74);t.preprocessAutofitWidth=function(e,t){var n=[];if(!t.ColMetadata)return n;for(var r=0;r<t.ColMetadata.length;r++){var i=t.ColMetadata[r],o=t.ColumnNumbers[r];i?i.SrvDx&&i.SrvDx>0&&d.getColSrvDx(o)!==i.SrvDx&&d.removeColMetadata(o):d.removeColMetadata(o)}for(r=0;r<t.ColMetadata.length;r++){i=t.ColMetadata[r],o=t.ColumnNumbers[r];if(i&&i.SrvDx&&i.SrvDx>0){var a=d.getColMetadata(o);a&&i.SrvDx===a.SrvDx?a.CachedColWidth&&n.push({colIndex:o,newWidth:a.CachedColWidth,isCacheChanged:!1}):(i.CachedColWidth=s.calculateColWidthForMetadata(e,t,i),n.push({colIndex:o,newWidth:i.CachedColWidth,isCacheChanged:!0}),d.setColMetadata(o,i))}}return n},t.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(var n=0;n<e.length;n++){var r=e[n];r.DeltaXFromOriginPTAdjustedForDrawing=Math.round(r.DeltaXFromOriginPT*t),r.DeltaYFromOriginPTAdjustedForDrawing=Math.round(r.DeltaYFromOriginPT*t),r.OriginPTHeightAdjustedForDrawing=Math.round(r.OriginPTHeight*t),r.OriginPTWidthAdjustedForDrawing=Math.round(r.OriginPTWidth*t)}},t.updateCellsBeforeDrawing=function(e,t,n){for(var s=t.ClientOnlyCache.CellsToRender,d=r.isRenderFlagEnabled(r.RenderFlagsArray.ByExamplePreviewMode,t),u=0;u<s.length;u++){var c=s[u],g=c.CachedFont.Italic,h=c.CachedFont.FontName!==l.DefaultFontName,f=!!c.TextRuns,m=c.CachedFont.Underline!==r.FontUnderline.None||c.CachedFont.StrikeThrough,p=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,t)&&!!c.AutoFilter;if(c.DisplayFormula=i.shouldRenderFormulaOnCell(c,n.isFormulaView),d){var C=t.ClientOnlyCache.PreviewCellsRange;C&&n.isCellsPreviewMode&&r.isModelCellContainedInRange(t,C,c)||(c.PreviewText=void 0)}else c.PreviewText&&(c.PreviewText=void 0);if(c.Text&&(c.CachedDisplayText=i.getDisplayText(c,t)),!c.DisplayFormula&&!c.PreviewText)if(c.Text&&i.cellHasShrinkToFit(c)&&a.updateCellShrinkToFit(e,t,c,n),r.isRenderFlagEnabled(r.RenderFlagsArray.TextWidthClientPhase1,t))if(c.TolType===r.TolType.Autofit)switch(c.ValueType){case r.CellValueType.Number:c.Spill=void 0;break;case r.CellValueType.String:(g||h||m||f||p)&&o.updateCellSpill(e,t,c,n.zoom,n.devicePixelRatio)}else(c.TolType===r.TolType.Spill||p)&&o.updateCellSpill(e,t,c,n.zoom,n.devicePixelRatio);else(g||h||m||f||p)&&o.updateCellSpill(e,t,c,n.zoom,n.devicePixelRatio);c.Merge&&i.updateCellMergeInformation(t,c,n.scaleFactor)}},t.initializeCachedObjects=function(e,t){i.verifyArgumentNotNull(e.Cells,"cells","GridCanvasRenderer.initializeCachedObjects"),i.verifyArgumentNotNull(e.Styles,"styles","GridCanvasRenderer.initializeCachedObjects"),i.verifyArgumentNotNull(e.Fonts,"fonts","GridCanvasRenderer.initializeCachedObjects"),r.initModelClientCache(e),r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&r.cleanHitTestCache(e,i.getRenderingRegionKey(t));for(var n=0;n<e.Cells.length;n++){var o=e.Cells[n];i.initializeCellCachedObjects(e,o,!1)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateClosestNonEmptyCellsSpill=t.updateCellSpill=void 0;var r=n(1),i=n(13),o=n(19),a=n(105),l=n(11),s=n(0),d=n(10),u=n(6);function c(e,t,n,i,d){if(s.verifyArgumentNotNull(n,"cell","spillCell.updateCellSpill"),s.verifyArgumentNotNull(t,"model","spillCell.updateCellSpill"),!(!n.Text||n.WrapText||n.Merge||s.cellHasShrinkToFit(n)||n.ValueType===r.CellValueType.Number||l.shouldRenderVerticalText(n))){s.verifyCellStyleAndFont(t,n,"updateCellSpill"),e.font=s.getFontCssStringFromCell(n,t);var c=u.getTextWidth(e,t,n);o.shouldDrawRotatedText(t,n.CachedStyle,n.CachedFont)&&(c=a.getRotatedTextWidth(t,c,n.CachedStyle,n.CachedFont));var h=g(n,t,c,r.SpillDirection.End,i,d),p=g(n,t,c,r.SpillDirection.Start,i,d),C=h.isSpillingOutsideOfBlock||p.isSpillingOutsideOfBlock,v=h.isBlockedByCellContent||p.isBlockedByCellContent;if(0!==h.spilledOverCellsCount||0!==p.spilledOverCellsCount){var y=f(n,t,r.SpillDirection.Start),T=f(n,t,r.SpillDirection.End),S=m(y,n,t,r.SpillDirection.Start),F=m(T,n,t,r.SpillDirection.End);n.Spill={SpanToStart:Math.min(p.spilledOverCellsCount,S),SpanToEnd:Math.min(h.spilledOverCellsCount,F),IsSpillBlocked:C||p.spilledOverCellsCount>S||h.spilledOverCellsCount>F}}else(C||v)&&(n.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0})}}function g(e,t,n,o,a,l){var c=r.getCellStyle(t,e);s.verifyArgumentNotNull(c,"cell.CachedStyle","spillCell.getNumberOfSpilledOverCells");var g=c.HorizontalAlignment||r.HorizontalAlignment.Automatic,f=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,t),m=y(e,g,o,t.IsRtl,f);return m?function(e,t,n,o,a,l,c){var g=e.Col,f=function(e,t,n,o,a,l,c){var g=s.getColumnWidth(t.Col,e),h=s.isPivotTablePhase2Enabled(e),f=function(e,t){var n;if(!(null===(n=t.PivotTable)||void 0===n?void 0:n.HasExpandCollapseIndicator))return!1;var o=i.getEffectiveHorizontalAlignment(e,t);return!u.doesExpandCollapseButtonShiftText(e,t)||o===r.HorizontalAlignment.Center}(e,t)?d.getExpandCollapseButtonPadding(t,h):0,m=u.getCellTextHorizontalPadding(t,e,l,c)+n+f-g;if(m<=0)return 0;if(o===r.HorizontalAlignment.Center)return m/2;var p=e.IsRtl;if(!v(o,a,p))return 0;return m}(t,e,n,o,a,l,c),m=0,p=!1;if(0===f)return{spilledOverCellsCount:m,isSpillingOutsideOfBlock:p,isBlockedByCellContent:!1};var C=t.ColumnNumbers.length;g+=a;for(;h(g,C)&&f>0;)m++,f-=s.getColumnWidth(g,t),g+=a;return p=!h(g,C)&&f>0,{spilledOverCellsCount:m,isSpillingOutsideOfBlock:p,isBlockedByCellContent:!1}}(e,t,n,g,o,a,l):{spilledOverCellsCount:0,isSpillingOutsideOfBlock:!1,isBlockedByCellContent:!m}}function h(e,t){return e>=0&&e<t}function f(e,t,n){for(var i=e.Row,o=e.Col+n;h(o,t.ColumnNumbers.length);){var a=r.getCell(i,o,t);if(a&&p(a))return a;o+=n}return null}function m(e,t,n,i){return e?Math.abs(e.Col-t.Col)-1:i===r.SpillDirection.End?n.ColumnNumbers.length-t.Col:t.Col}function p(e){var t;return!(!e||!(e.Text&&""!==e.Text||(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula)))}function C(e,t,n,i,o,a,l){var d=m(t,n,i,o);if(t&&t.Spill){var u=r.getCellStyle(i,t);s.verifyArgumentNotNull(u,"blockingCellStyle","spillCell.updateClosestNonEmptyCell");var g=u.HorizontalAlignment||r.HorizontalAlignment.Automatic,h=-o,f=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,i),p=y(t,g,h,i.IsRtl,f),C=v(g,h,i.IsRtl);if(p&&C)if(n&&n.Text&&""!==n.Text){var T=r.getSpilledOverCount(h,t);t.Spill.IsSpillBlocked=d<=T;var S=Math.min(T,d);S!==T&&(s.setCellAndSpannedOverCellsDirty(i,t),h===r.SpillDirection.Start?t.Spill.SpanToStart=S:t.Spill.SpanToEnd=S)}else{n.Spill=void 0;var F=r.getSpilledOverCount(h,t);c(e,i,t,a,l),F!==r.getSpilledOverCount(h,t)&&s.setCellAndSpannedOverCellsDirty(i,t)}}return d}function v(e,t,n){return e===r.HorizontalAlignment.Center||(t===r.SpillDirection.Start?n?e===r.HorizontalAlignment.Left:e===r.HorizontalAlignment.Right:t===r.SpillDirection.End&&(e===r.HorizontalAlignment.Automatic||(n?e===r.HorizontalAlignment.Right:e===r.HorizontalAlignment.Left)))}function y(e,t,n,i,o){return o?function(e,t,n){if(e.RichValueIcon)return t===r.HorizontalAlignment.Left||!n&&t===r.HorizontalAlignment.Automatic;return!0}(e,t,i):function(e,t,n){var i;if(n===r.SpillDirection.Start||t===r.HorizontalAlignment.Center)return!(null===(i=e.LinkedEntity)||void 0===i?void 0:i.IconWidth);return!0}(e,t,n)}t.updateCellSpill=c,t.updateClosestNonEmptyCellsSpill=function(e,t,n,i,o){var a=f(t,n,r.SpillDirection.Start),l=f(t,n,r.SpillDirection.End);C(e,a,t,n,r.SpillDirection.Start,i,o),C(e,l,t,n,r.SpillDirection.End,i,o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetColWidthCacheByCol=t.resetCache=t.setColMetadata=t.getColSrvDx=t.removeColMetadata=t.getColMetadata=void 0;var r={};t.getColMetadata=function(e){return r[e]},t.removeColMetadata=function(e){r[e]=void 0},t.getColSrvDx=function(e){var t=r[e];return t?t.SrvDx:-1},t.setColMetadata=function(e,t){r[e]=t},t.resetCache=function(){r={}},t.resetColWidthCacheByCol=function(e){r[e]=void 0}},function(e,t,n){"use strict";n.r(t);var r=n(76);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);var o=n(108);n.d(t,"UnavailabilityToast",(function(){return o.a})),n.d(t,"UnavailabilityToastFactory",(function(){return o.b})),n.d(t,"UnavailabilityToastManager",(function(){return o.c}));var a=n(44);n.d(t,"startInteractivityTracker",(function(){return a.startInteractivityTracker})),n.d(t,"stopInteractivityTracker",(function(){return a.stopInteractivityTracker})),n.d(t,"trackEventResponseTime",(function(){return a.trackEventResponseTime})),n.d(t,"InteractivityTrackerFactoryGlobal",(function(){return a.InteractivityTrackerFactoryGlobal}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);r.__exportStar(n(113),t),r.__exportStar(n(78),t),r.__exportStar(n(77),t),r.__exportStar(n(196),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererFactory=void 0;var r=n(78),i=n(189),o=n(1),a=n(0),l=n(190),s=n(194),d=n(195),u=function(){function e(){}return e.prototype.getModelAccessor=function(e){return a.verifyArgumentNotNull(e,"model","CanvasRendererFactory.getModelAccessor"),new i.GridBlockModelAccessor(e)},e.prototype.getGridCanvasRenderer=function(){return new r.GridCanvasRenderer},e.prototype.getHeaderCanvasRenderer=function(){return new d.HeaderCanvasRenderer},e.prototype.createRenderingCanvasElement=function(){return new l.InteractableCanvasElement(a.isSubPixelRenderingEnabled())},e.prototype.createHeaderBlockModelAccessor=function(e,t){a.verifyArgumentNotNull(e,"gridModel","CanvasRendererFactory.createHeaderBlockModelAccessor");var n=o.createHeaderBlockModel(e,t);return new s.HeaderBlockModelAccessor(n,t)},e}();t.CanvasRendererFactory=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridCanvasRenderer=void 0;var r=n(4),i=n(1),o=n(37),a=n(133),l=n(134),s=n(9),d=n(87),u=n(95),c=n(0),g=n(90),h=n(91),f=n(29),m=n(147),p=n(158),C=n(159),v=n(160),y=n(161),T=n(163),S=n(164),F=n(99),x=n(100),w=n(101),R=n(26),b=n(166),I=n(167),A=n(169),P=n(171),D=n(68),M=n(172),O=n(173),k=n(175),L=n(104),H=n(72),E=n(2),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderInternal=function(e,t,n){var r=this;try{var F=e.getClippingMaskStatus();s.validateClippingState(F,x.BlockRenderingStage.Start),c.validateRenderingRegion(n.renderingRegion,t,n);var L=n.scaleFactor,H=Math.round(t.BlockWidth*L),E=n.renderingRegion,B=-1*E.startOffsetY*L,N=c.getDrawingOffsetXForRenderingRegion(t,E)*L,W=i.isDifferentialRenderingSupported(t);return W&&(this.setTransform(1,!1,N,B,H),b.maskDifferentialRenderingAreas(t,this.ctx)),this.setTransform(1,!1,0,0,H),this.clearCanvas(t,e.getWidth(),e.getHeight(),n),this.setTransform(1,t.IsRtl,N,B,H),s.trackDuration(s.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return o.drawGridLines(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.ClearGridlinesMs,(function(){s.trackDuration(s.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){h.clearGridLinesForSpannedCells(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.ClearGridLinesForPivotTable,(function(){h.clearGridLinesForPivotTables(r.ctx,t,n)}))})),this.setTransform(1,!1,N,B,H),s.trackDuration(s.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return u.drawGridCellsBackgroundFill(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,(function(){return v.drawEmptyPivotTableTitleContainers(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawEmptyPivotTableImages,(function(){return v.drawEmptyPivotTableImages(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawDataBarsMs,(function(){return y.drawDataBars(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawCFIconsMs,(function(){return m.drawConditionalFormattingIcons(r.ctx,t,n)})),n.modelFromCache||(s.trackDuration(s.RenderPerformanceMetric.DrawSparklines,(function(){T.drawDynamicImages(r.ctx,t,n,R.ImageType.Sparkline)})),s.trackDuration(s.RenderPerformanceMetric.DrawInCellImagesMs,(function(){return T.drawDynamicImages(r.ctx,t,n,R.ImageType.InCellImage)}))),s.trackDuration(s.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){g.clearGridLinesForBorder(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawBordersMs,(function(){return g.drawBorders(r.ctx,t,n)})),this.setTransform(1,t.IsRtl,N,B,H),i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,t)&&(s.trackDuration(s.RenderPerformanceMetric.CellTooltipRegistrationMs,(function(){return M.registerCellsGeneralTooltip(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawCommentsMs,(function(){return I.drawComments(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawRichErrorMs,(function(){return A.drawRichError(r.ctx,t,n)})),i.isRenderFlagEnabled(i.RenderFlagsArray.TableSelectorsHitTest,t)&&s.trackDuration(s.RenderPerformanceMetric.RegisterTableSelectorsMs,(function(){return O.registerTableSelectors(r.ctx,t,n)}))),this.setTransform(n.scaleFactor,!1,N,B,H),s.trackDuration(s.RenderPerformanceMetric.DrawTextDurationMs,(function(){return d.drawText(r.ctx,t,n)})),i.isRenderFlagEnabled(i.RenderFlagsArray.PhoneticSlice1,t)&&s.trackDuration(s.RenderPerformanceMetric.DrawPhoneticTextDurationMs,(function(){return D.drawCellsPhoneticText(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,(function(){return v.drawEmptyPivotTableTitleText(r.ctx,t,n)})),this.setTransform(1,!1,N,B,H),s.trackDuration(s.RenderPerformanceMetric.DrawTextDecoration,(function(){return f.drawTextDecoration(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawExpandCollapseButtonsMs,(function(){return S.drawExpandCollapseButtons(r.ctx,t,n)})),i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,t)&&(s.trackDuration(s.RenderPerformanceMetric.DrawRichValueIcons,(function(){return P.drawRichValueIcons(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawAutoFiltersMs,(function(){return w.drawAutoFilters(r.ctx,t,n)}))),n.skeletonMode&&s.trackDuration(s.RenderPerformanceMetric.DrawSkeletonMs,(function(){return a.drawSkeleton(r.ctx,t,n)})),i.isRenderFlagEnabled(i.RenderFlagsArray.ByExamplePreviewMode,t)&&s.trackDuration(s.RenderPerformanceMetric.DrawSkeletonCellsMs,(function(){return a.drawSkeletonCells(r.ctx,t,n)})),this.setTransform(1,t.IsRtl,N,B,H),n.renderPageLayout&&(s.trackDuration(s.RenderPerformanceMetric.DrawPrintAreasDurationMs,(function(){return C.drawPrintAreas(r.ctx,t,n)})),s.trackDuration(s.RenderPerformanceMetric.DrawPageBreaksDurationMs,(function(){return p.drawPageBreaks(r.ctx,t,n)}))),i.isRenderFlagEnabled(i.RenderFlagsArray.ByExamplePreviewMode,t)&&s.trackDuration(s.RenderPerformanceMetric.DrawPreviewCellsModeOverlayMs,(function(){return k.drawPreviewModeOverlay(t,r.ctx,n)})),W&&this.ctx.restore(),F=e.getClippingMaskStatus(),s.validateClippingState(F,x.BlockRenderingStage.End),n.debugMode&&(this.setTransform(1,t.IsRtl,N,B,H),l.addWatermark(t,this.ctx,n,W),this.setTransform(L,!1,0,0,0),n.isCanvasHitTestDebugHighlight&&i.isRenderFlagEnabled(i.RenderFlagsArray.CanvasHitTest,t)&&l.highlightHitRegions(t,this.ctx,n.renderingRegion)),s.createRenderResult(!0,"finished rendering.")}catch(e){return s.createRenderResult(!1,"exception caught in renderInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},t.prototype.initializeCanvasHitTest=function(e,t,n,r){e.removeAllEventListeners(),F.setHitMapOffsets(e,t,n),e.setAppZoom(r);var o=i.getRenderingRegionHitTestCache(t,c.getRenderingRegionKey(n)),a=o.CellHitRegions;c.registerCanvasHitRegionsFromCache(a,(function(t){e.addRegionEventListener(t)}));var l=o.CellCursorHitRegions;c.registerCanvasHitRegionsFromCache(l,(function(t){e.addCursorRegion(t)}));var s=o.CellTooltipHitRegions;c.registerCanvasHitRegionsFromCache(s,(function(t){e.addTooltipRegion(t)}));var d=o.CellLongPressHitRegions;c.registerCanvasHitRegionsFromCache(d,(function(t){e.addLongPressRegion(t)})),e.optimizeHitMapLookup()},t.prototype.preprocessModel=function(e,t,n){H.initializeCachedObjects(e,t),E.initializeOffsetsForDrawing(e,n.scaleFactor),H.updateCellsBeforeDrawing(this.ctx,e,n),H.updatePivotTablesInformationBeforeDrawing(e.PivotTables,n.scaleFactor)},t.prototype.clearCanvas=function(e,t,n,r){var i=this;r.subPixelRenderingEnabled||c.hasWorkbookBackgroundColor(e.BackgroundColor)?s.trackDuration(s.RenderPerformanceMetric.FillRectDurationMs,(function(){i.ctx.fillStyle=c.getWorkbookBackgroundColor(r.highContrastScheme,e.BackgroundColor),i.ctx.fillRect(0,0,t,n)})):s.trackDuration(s.RenderPerformanceMetric.ClearRectDurationMs,(function(){i.ctx.clearRect(0,0,t,n)}))},t}(L.CanvasRenderer);t.GridCanvasRenderer=B},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getReferencedObjectById=void 0;var r=n(31),i=n(45);t.getReferencedObjectById=function(e,t){var n;switch(e){case r.UniqueStyleID.Default:case r.UniqueStyleID.Hyperlink:n=t[t.length+e];break;default:n=t[e]}if(i.isNullOrUndefined(n))throw Error("RefObject is null or undefined, id: "+e);if((n.ID||0)!==e)throw Error("RefIDs are not sorted as expected");return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CellLookupColumnMod=t.MaxAllowedRowColCount=t.CellLookupRowShift=t.MaxBitsPerRenderFlag=t.NumFmtAccountingStartIndex=void 0,t.NumFmtAccountingStartIndex=32,t.MaxBitsPerRenderFlag=32,t.CellLookupRowShift=5,t.MaxAllowedRowColCount=32,t.CellLookupColumnMod=1<<t.CellLookupRowShift},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpillDirection=void 0,function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(t.SpillDirection||(t.SpillDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var r=n(115);t.utils=r;var i=n(116);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var o=n(117);t.browserSupport=o;var a=n(118);t.perfWatch=a;var l=n(119);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return l.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return l.ewaUtils}});var s=n(123);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});var d=n(124);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return d.TelemetryCollector}});var u=n(125);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return u.getNewGuid}});var c=n(126);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return c.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return c.TextAreaInputMode}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeadersStylesArray=t.HeadersFonts=t.AlphaRadix=t.LetterA=t.DefaultRowHeaderWidth=t.DefaultColHeaderHeight=t.DefaultHeaderFontSize=t.PartialRowColSelectionHCFontColor=t.HoverBackgroundColor=t.WholeRowColSelectionBackgroundColor=t.PartialRowColSelectionBackgroundColor=t.SelectionFontColor=t.DefaultHeaderFontColor=t.DefaultHeaderBackgroundColor=t.DefaultHeaderFont=void 0;var r=n(31);t.DefaultHeaderFont="Calibri",t.DefaultHeaderBackgroundColor="#F1F1F1",t.DefaultHeaderFontColor="#5E5E5E",t.SelectionFontColor="#217346",t.PartialRowColSelectionBackgroundColor="#DAD8D6",t.WholeRowColSelectionBackgroundColor="#D3F0E0",t.HoverBackgroundColor="#9FD5B7",t.PartialRowColSelectionHCFontColor="#000000",t.DefaultHeaderFontSize=11,t.DefaultColHeaderHeight=20,t.DefaultRowHeaderWidth=37,t.LetterA=65,t.AlphaRadix=26,t.HeadersFonts=[{Color:t.SelectionFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Selection,RefCount:1},{Color:t.DefaultHeaderFontColor,FontName:t.DefaultHeaderFont,Size:t.DefaultHeaderFontSize,ID:r.UniqueHeadersFontID.Default,RefCount:1}],t.HeadersStylesArray=[{ID:r.UniqueHeadersStyleID.PartialRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,ShrinkToFit:!1,IsUnlocked:!1,IsHidden:!1,FontID:r.UniqueHeadersFontID.Selection,RefCount:1,BackgroundColor:t.PartialRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.WholeRowColSelection,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,ShrinkToFit:!1,IsUnlocked:!1,IsHidden:!1,FontID:r.UniqueHeadersFontID.Selection,RefCount:1,BackgroundColor:t.WholeRowColSelectionBackgroundColor},{ID:r.UniqueHeadersStyleID.Hover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,ShrinkToFit:!1,IsUnlocked:!1,IsHidden:!1,FontID:r.UniqueHeadersFontID.Default,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.SelectionAndHover,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,ShrinkToFit:!1,IsUnlocked:!1,IsHidden:!1,FontID:r.UniqueHeadersFontID.Selection,RefCount:1,BackgroundColor:t.HoverBackgroundColor},{ID:r.UniqueHeadersStyleID.Default,VerticalAlignment:r.VerticalAlignment.Center,HorizontalAlignment:r.HorizontalAlignment.Center,ShrinkToFit:!1,IsUnlocked:!1,IsHidden:!1,FontID:r.UniqueHeadersFontID.Default,RefCount:1}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.annonymize=t.serializeModel=t.serializeCell=void 0;var r=n(85),i=n(129),o=n(36),a=r.UserContentList.Cell.concat(r.UserContentList.GridBlockModel).concat(r.UserContentList.CellStyle).concat(r.UserContentList.Font).concat(r.UserContentList.BorderStyle).concat(r.UserContentList.AutoFilter).concat(r.UserContentList.PivotFilter).concat(r.UserContentList.MenuItem).concat(r.UserContentList.FormulaInformation).concat(r.UserContentList.NumberFormatInformation);function l(e){return e.toLowerCase().replace(i.DigitReplaceValue,i.CharacterReplaceValue).replace(i.Digit,i.DigitReplaceValue).replace(i.ValueAnnonymizerRegex,i.CharacterReplaceValue)}function s(e){return function(t,n){return n&&e&&e.indexOf(t)>-1?l(n):n}}t.serializeCell=function(e,t){return e&&t?(e.CachedStyle=o.getReferencedObjectToCache(e.StyleID||0,t.Styles),e.CachedBorderStyle=o.getReferencedObjectToCache(e.BorderStyleID||0,t.BorderStyles),e.CachedFont=o.getReferencedObjectToCache(e.CachedStyle.FontID||0,t.Fonts),a?JSON.stringify(e,s(a)):JSON.stringify(e)):""},t.serializeModel=function(e){return e?a?JSON.stringify(e,s(a)):JSON.stringify(e):""},t.annonymize=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SerializationClasses=t.SerializationPropertyKey=t.SerializationProperties=t.UserContentList=t.propertyToClassMap=t.ignoreCaseLists=t.comparisonIgnoreLists=void 0,t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["ColMetadata","RowOutlines","ColumnOutlines","UniqueId","ShowHeaders","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlagsArray","HandleFlagsMismatch","AllRichValueFields","RibbonCommands","ClientOnlyCache","ContainsInteractiveGridFeatures","AdjacentBlocksHiddensInfo"],t.comparisonIgnoreLists.Cell=["StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","ShrunkSize","PivotFilter","CommentID","RichValueType","RichValueFieldsIndexes","ValueType","SrvDx","SrvDy","TolType","CachedDrawingLayout","CachedDisplayText","CachedDisplayTextRuns","CachedIsTextWidthExceedsCellWidth","DisplayFormula","PreviewText","ShowSkeleton","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.AutoFilter=["ID","Menu","CommandData"],t.comparisonIgnoreLists.PivotFilter=["IsPivotPageField","CommandData","IsHeaderSnapped"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount"],t.comparisonIgnoreLists.CellStyle=["IsPattern","NamedStyleId","FontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType","IsArrayRoot"],t.comparisonIgnoreLists.MergeInformation=["IsOrigin","WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.TextRun=["FontID","EndIndex","IsSpecialCharTextRun"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","StyleIndex","IsRefreshableTabularOlap","SlicerConnections","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.DynamicImageInformation=["AltText"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.comparisonIgnoreLists.LinkedEntityInformation=["Domain"],t.comparisonIgnoreLists.PivotTableCellInformation=["ShouldShowExpandCollapseMenu","CanExpandCollapse","SourceIndex","ConfirmRequired"],t.comparisonIgnoreLists.CommentData=["CommentID"],t.ignoreCaseLists={},t.ignoreCaseLists.Font=["Color"],t.propertyToClassMap={},t.propertyToClassMap.ColMetadata=["ColMetadata"],t.propertyToClassMap.PermissionSet=["PermissionSet"],t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines","DynamicImages"],t.propertyToClassMap.InCellImages=["InCellImages","DynamicImages"],t.propertyToClassMap.AllRichValueFields=["RichValueField"],t.propertyToClassMap.RibbonCommands=["RibbonCommands"],t.propertyToClassMap.AdjacentBlocksHiddensInfo=["AdjacentBlocksHiddensInfo"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.PhonInfo=["PhoneticInformation"],t.propertyToClassMap.Comment=["CommentData"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation","DynamicImageInformation"],t.propertyToClassMap.InCellImage=["InCellImageInformation","DynamicImageInformation"],t.propertyToClassMap.LinkedEntity=["LinkedEntityInformation"],t.propertyToClassMap.RichValueIcon=["RichValueIconInformation"],t.propertyToClassMap.PivotTable=["PivotTableCellInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.CachedDisplayTextRuns=["TextRun"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.RenderingContext=["AutoFilterRenderingContext"],t.propertyToClassMap.Cell=["SharedSheetCell"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.PhoneticTextRuns=["PhoneticRun"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.SlicerConnections=["PivotTableSlicerConnectionInfo"],t.propertyToClassMap.InternalLink=["InternalLink","SharedRange"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Domain=["LinkedEntityServiceDomainId"],t.propertyToClassMap.CachedFormattedText=["FormattedText"],t.UserContentList={},t.UserContentList.Cell=["Text","CachedDisplayText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.Font=["FontName"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColMetadata"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.UniqueId"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ShowHeaders"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PermissionSet"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RenderFlagsArray"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.HandleFlagsMismatch"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.InCellImages"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AllRichValueFields"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.RibbonCommands"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.ClientOnlyCache"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["GridBlockModel.ContainsInteractiveGridFeatures"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["GridBlockModel.AdjacentBlocksHiddensInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Col"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Row"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Text"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Ifmt"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Spill"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Merge"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PhonInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Comment"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CommentID"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueFieldsIndexes"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ValueType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.InCellImage"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.LinkedEntity"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.RichValueIcon"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.PivotTable"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.HasIgnorableError"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.SrvDx"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.SrvDy"]={type:"number",ignoreOnSerialize:!0},t.SerializationProperties["Cell.TolType"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableColHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.TableRowHeader"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedDisplayTextRuns"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.DisplayFormula"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PreviewText"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.ShowSkeleton"]={type:"boolean",ignoreOnSerialize:!0},t.SerializationProperties["Cell.Value"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",ignoreOnSerialize:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.HorizontalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalAlignment"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.BackgroundColor"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Gradient"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsPattern"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Indentation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ReadingOrder"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ShrinkToFit"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.NamedStyleId"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.FontID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsUnlocked"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.IsHidden"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.VerticalText"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.Orientation"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["CellStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.Borders"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["BorderStyle.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Size"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.FontName"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Color"]={type:"object",ignoreOnSerialize:!1},t.SerializationProperties["Font.Bold"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.Italic"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.StrikeThrough"]={type:"boolean",ignoreOnSerialize:!1},t.SerializationProperties["Font.VerticalAlign"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.Underline"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.ID"]={type:"number",ignoreOnSerialize:!1},t.SerializationProperties["Font.RefCount"]={type:"number",ignoreOnSerialize:!1},t.SerializationClasses={},t.SerializationClasses.Cell="Cells",t.SerializationClasses.CellStyle="Styles",t.SerializationClasses.Font="Fonts",t.SerializationClasses.BorderStyle="BorderStyles"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateNumFmtFromCell=void 0;var r=n(1),i=n(7);t.updateNumFmtFromCell=function(e){var t,n,o,a;if(r.verifyArgumentNotNull(e.Text,"cell.Text","updateNumFmt"),r.verifyArgumentNotNull(e.NumFmt,"cell.NumFmt","updateNumFmt"),!i.isNullOrUndefined(e.NumFmt.End)&&!i.isNullOrUndefined(e.NumFmt.Separator)){var l=function(e,t){for(var n=0,r=0;r<e.length&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),s=function(e,t){for(var n=0,r=e.length-1;r>0&&e[r]===t;r++)n++;return n}(e.NumFmt.End,e.NumFmt.Separator),d=function(e,t,n){var r=e.length-t,i=e.substring(0,r),o=i.lastIndexOf(n);if(-1===o)return i;return i.substr(o+1)}(e.Text,s,e.NumFmt.Separator);e.NumFmt.End=function(e,t,n,r){return t.repeat(n)+e+t.repeat(r)}(d,e.NumFmt.Separator,l,s),(null===(t=null==e?void 0:e.Text)||void 0===t?void 0:t.endsWith((null===(n=e.NumFmt)||void 0===n?void 0:n.Separator)+e.NumFmt.End))&&(null===(o=null==e?void 0:e.Text)||void 0===o?void 0:o.startsWith((null===(a=e.NumFmt)||void 0===a?void 0:a.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawText=void 0;var r=n(1),i=n(2),o=n(88),a=n(3),l=n(94),s=n(0),d=n(138),u=n(6),c=n(5),g=n(142),h=n(143),f=n(10),m=n(40),p=n(15),C=n(9),v=n(144),y=n(69),T=n(53),S=n(19),F=n(145);function x(e,t,n,a,C,v,x){var w,R,b=n.zoom,I=n.devicePixelRatio,A=a.DisplayFormula?r.VerticalAlignment.Bottom:a.CachedStyle.VerticalAlignment,P=(null===(w=a.CachedStyle)||void 0===w?void 0:w.HorizontalAlignment)===r.HorizontalAlignment.Fill,D=c.getCellWidth(t,a,!1),M=u.getDistanceFromCellStartToIconEnd(t,a,b,I),O=i.getTextDrawingMaxWidth(D,u.getCellTextHorizontalPaddingWithoutVisualElements(t,a),M,f.getExpandCollapseButtonWidth(null===(R=a.PivotTable)||void 0===R?void 0:R.HasExpandCollapseIndicator),p.getAutoFilterPaddingForAdvancedHorizontalAlignment(t,a,b,I));!function(e,t,n,i,o,a,l){m.updateContextForCurrentCell(n,a,t,e,l.highContrastScheme),r.doesNumFmtOverrideText(t)&&g.updateNumberFormattingInformation(n,e,t,i);o&&h.updateCachedDisplayTextForFill(n,e,t,l)}(t,a,e,O,P,C,n);var k=r.isRenderFlagEnabled(r.RenderFlagsArray.PhoneticSlice1,t)&&a.PhonInfo?T.PhoneticTextHeightPx:0,L=s.getDisplayText(a,t),H=s.getFormattedText(L,a,t),E=u.getTextLineHeight(a,t),B=y.shouldDrawSpillCell(a),N=y.shouldDrawWrapText(a),W=y.getCellClipping(t,a,e,O,H,N,B,D,x,M,v,P);S.shouldDrawRotatedText(t,a.CachedStyle,a.CachedFont)?F.drawRotatedText(e,t,a,n,L,O,x,E,k,H,W):function(e,t,n,a,g,h,f,m,p,C,v,T,S,F,x,w,R){var b=u.getTextHorizontalPosition(t,n,a),I=u.getTextVerticalPosition(n,t,m+p,g,T,void 0).absoluteY;if(F){s.verifyArgumentNotNull(R,"clipRect","drawSingleCellText");var A=i.getContainerClipMaskWidth(h),P=c.isCellSpansMultipleRowsOrBlocks(n);d.drawWrapText(e,a,t,n,v,b,f,R,A,g,P,m,w)}else n.Merge?function(e,t,n,i,a,l,s,d,u,c){var g;c?o.fillTextClipped(e,t,l,s,d,c,i,n,(null===(g=i.CachedStyle)||void 0===g?void 0:g.HorizontalAlignment)===r.HorizontalAlignment.Fill,a):o.fillTextUnclipped(e,l,s,d,u,i,n,t)}(e,a,t,n,w,v,b,I,f,R):S?l.drawSpillCellText(e,a,t,n,v,b,I,R,x,C,w):y.shouldClipText(n,w,x)?(s.verifyArgumentNotNull(R,"clipRect","drawSingleCellText"),o.fillTextClipped(e,a,v,b,I,R,n,t,x,w)):o.fillTextUnclipped(e,v,b,I,f,n,t,a)}(e,t,a,n,x,D,O,E,k,M,L,A,B,N,P,H,W)}function w(e,t,n,r){return i.restoreClipping(n,r),m.getDefaultContextState(e,t)}t.drawText=function(e,t,n){!function(e,t,n){var o,l,d,u,g;s.verifyArgumentNotNull(e,"ctx","drawCellsText"),s.verifyArgumentNotNull(t,"model","drawCellsText"),s.verifyArgumentNotNull(n,"context","drawCellsText"),s.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawCellsText"),s.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),s.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawCellsText"),s.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),s.verifyArgumentNotNull(t.Styles,"model.Styles","drawCellsText");for(var h=t.ClientOnlyCache.CellsToRender,f=t.BlockWidth,p=[],C=function(e,t,n){var r=m.getDefaultContextState(t,n.IsRtl);return e.direction=r.direction,e.fillStyle=r.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){e.getLineDash()!==[]&&e.setLineDash([])}(e),r}(e,n.highContrastScheme,t),v=void 0,y=-1,T=0;T<h.length;T++){if((R=h[T])&&(!n.isFormulaView||(null===(o=R.FormulaInfo)||void 0===o?void 0:o.FormulaType)!==r.CellFormulaType.ArrayFormula||R.FormulaInfo.IsArrayRoot)){if(!(R.Text||R.PreviewText)){if(!r.isRenderFlagEnabled(r.RenderFlagsArray.FormulaViewCellImagesFix,t))continue;if(!n.isFormulaView||!R.FormulaInfo)continue}if(0!==R.ShrunkSize&&0!==(null===(l=R.CachedFont)||void 0===l?void 0:l.Size)&&i.cellIntersectsRenderingRegion(R,n.renderingRegion)&&!(R.CondFormat&&(null===(d=R.CondFormat)||void 0===d?void 0:d.Icon)&&(null===(g=null===(u=R.CondFormat)||void 0===u?void 0:u.Icon)||void 0===g?void 0:g.IconOnly)||R.ShowSkeleton)){var S=t.RowHeights[R.Row]-a.GridLineWidthPx,F=t.RowOffsets[R.Row];R.Row!==y&&(-1!==y&&(C=w(n.highContrastScheme,t.IsRtl,e,v)),v={x:0,y:F,width:f,height:S},i.applyClipping(e,v),y=R.Row),c.isCellSpansMultipleRowsOrBlocks(R)?p.push(R):x(e,t,n,R,C,F,S)}}}i.restoreClipping(e,v),C=m.getDefaultContextState(n.highContrastScheme,t.IsRtl);for(T=0;T<p.length;T++){var R=p[T],b=c.getCellHeight(t,R,!1)-a.GridLineWidthPx,I=c.getCellTop(t,R);x(e,t,n,R,C,I,b)}}(e,t,n),r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,t)&&function(e,t,n){C.trackDuration(C.RenderPerformanceMetric.HyperlinkEventRegistrationMs,(function(){return v.registerHyperlinkEventHandlers(e,t,n)}))}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillTextClipped=t.fillTextUnclipped=void 0;var r=n(23),i=n(2),o=n(29),a=n(52),l=n(11);t.fillTextUnclipped=function(e,t,n,r,i,a,l,s){e.fillText(t,n,r,i);var d={textPositionX:n,textPositionY:r};o.measureAndCacheTextDecorationLayout(e,l,a,s,d)},t.fillTextClipped=function(e,t,n,s,d,u,c,g,h,f){if(i.applyClipping(e,u),!f&&l.shouldRenderVerticalText(c))a.fillVerticalText(e,g,c,n,s,d,t,u);else if(!f||h||c.DisplayFormula||c.PreviewText){e.fillText(n,s,d);var m={textPositionX:s,textPositionY:d,clipRect:u};o.measureAndCacheTextDecorationLayout(e,g,c,t,m)}else r.fillRichTextFormat(e,t,g,c,f,s,d,u);i.restoreClipping(e,u)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(58),i=function(){function e(){this.externalLogger=new r.a}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,r){this.externalLogger.sendTraceTag(e,t,n,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.externalLogger.debugAssertTag(e,t,n,r)},e.prototype.shipAssertTag=function(e,t,n,r){this.externalLogger.shipAssertTag(e,t,n,r)},e}(),o=new i;function a(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellHasBottomDoubleBorder=t.drawBorders=t.clearGridLinesForBorder=void 0;var r=n(1),i=n(2),o=n(7),a=n(3),l=n(0),s=n(91),d=n(5),u=n(0),c={},g={};function h(e){l.verifyArgumentNotNull(e,"model","validateModel"),l.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","validateModel"),l.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),l.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","validateModel"),l.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","validateModel")}function f(e,t){return{BorderLineStyle:r.BorderLineType.Thin,Color:t,Weight:a.ThinBorderWeight,BorderPosition:e}}function m(e,t,n,r,i,o){var a=v(e,t,n.BorderPosition,r),l=R(n);l in o||(i.push(n),o[l]=[]),o[l].push(a)}function p(e,t,n,i,o){var l=[],s="",d=a.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=a.ThinBorderWeight}(e),e.beginPath();for(var u=0;u<t.length;u++){var c=t[u],g=o||w(c.Color),h=b(c.BorderLineStyle),f=d!==c.Weight*i,m=s!==g,p=!r.areArraysEqual(l,h,[]).isEqual;(f||m||p)&&(e.stroke(),e.beginPath(),f&&(d=c.Weight*i,e.lineWidth=d),m&&(s=g,e.strokeStyle=g),p&&(e.setLineDash(h),l=h));for(var v=n[R(c)],y=0;y<v.length;y++){var T=v[y];C(e,c.Weight,T,i)}}e.stroke()}function C(e,t,n,r){!function(e){return e.Y1===e.Y2}(n)?i.drawLine(e,x(n.X1,t,r),n.Y1-r,x(n.X2,t,r),n.Y2):i.drawLine(e,n.X1-r,x(n.Y1,t,r),n.X2,x(n.Y2,t,r))}function v(e,t,n,i){if(!e.IsRtl){var o=F(e,t,n)?a.GridLineWidthPx:i;return y(n,{X:d.getCellLeftAdjustedForDrawing(e,t,!1,!1),Y:d.getCellTopAdjustedForDrawing(e,t,!1)},{X:d.getCellRightAdjustedForDrawing(e,t,!1)+o,Y:d.getCellBottomAdjustedForDrawing(e,t)})}var l=F(e,t,n)?i-a.GridLineWidthPx:0,s=y(n,{X:d.getCellRightAdjustedForDrawing(e,t,!1)+i,Y:d.getCellTopAdjustedForDrawing(e,t,!1)},{X:d.getCellLeftAdjustedForDrawing(e,t,!1,!1)+l,Y:d.getCellBottomAdjustedForDrawing(e,t)});if(n===r.BorderPositionType.Top||n===r.BorderPositionType.Bottom){var u=s.X2;s.X2=s.X1,s.X1=u}return s}function y(e,t,n){switch(e){case r.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:n.X,Y2:t.Y};case r.BorderPositionType.Bottom:return{X1:t.X,Y1:n.Y,X2:n.X,Y2:n.Y};case r.BorderPositionType.Right:return{X1:n.X,Y1:t.Y,X2:n.X,Y2:n.Y};case r.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:n.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function T(e){switch(e){case r.BorderLineType.Thin:case r.BorderLineType.Medium:case r.BorderLineType.Hair:case r.BorderLineType.Thick:return!0;default:return!1}}function S(e,t,n){return n.Row===t.RowNumbers.length-1||n.Col===t.ColumnNumbers.length-1||(!!F(t,n,e)||(n.HasError?A(e):e===r.BorderPositionType.Top||e===r.BorderPositionType.Left))}function F(e,t,n){return!(!t.Merge&&!l.isCellAdjacentToMergedCell(t.Row,t.Col,e))&&A(n)}function x(e,t,n){var r=l.getLinePixelTranslation(n);return t===a.MediumBorderWeight&&n%2==1?e:e-r}function w(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,n=c[t];return o.isNullOrUndefined(n)?(n="rgb("+e.Red+","+e.Green+","+e.Blue+")",c[t]=n,n):n}function R(e){return w(e.Color)+"-"+e.Weight+"-"+e.BorderLineStyle}function b(e){var t=g[e];if(!o.isNullOrUndefined(t))return t;switch(e){case r.BorderLineType.Dotted:t=a.DottedLineDash;break;case r.BorderLineType.DashDot:case r.BorderLineType.MediumDashDot:t=a.DashedDotLineDash;break;case r.BorderLineType.DashDotDot:case r.BorderLineType.MediumDashDotDot:t=a.DashedDotDotLineDash;break;case r.BorderLineType.MediumDashed:t=a.MediumDashedLineDash;break;case r.BorderLineType.SlantDashDot:case r.BorderLineType.Dashed:t=a.DashedLineDash;break;default:t=[]}return g[e]=t,t}function I(e){return e.HasError?a.FormulaErrorBorderStyle:e.CachedBorderStyle}function A(e){return e<=r.BorderPositionType.Right}t.clearGridLinesForBorder=function(e,t,n){if(t.ShowGridLines&&i.shouldRenderGridLines(l.isHighContrastMode(n),l.hasWorkbookBackgroundColor(t.BackgroundColor))){h(t),s.setContextForClearingGridLine(e,n,t.BackgroundColor);var o=t.ClientOnlyCache.GridlineOverridingCellsToRender;e.beginPath();for(var d=0;d<o.length;d++){var u=o[d],c=I(u);if(i.cellIntersectsRenderingRegion(u,n.renderingRegion)&&(c&&c.Borders&&0!==c.Borders.length&&!u.CachedStyle.BackgroundColor))for(var g=c.Borders,f=0;f<g.length;f++){var m=g[f];m.BorderLineStyle!==r.BorderLineType.None&&(T(m.BorderLineStyle)||S(m.BorderPosition,t,u)&&C(e,a.ThinBorderWeight,v(t,u,m.BorderPosition,a.GridLineWidthPx),a.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,n){h(t);var o,a,s=i.getDefaultBorderLineWidth(n.scaleFactor),d=l.getWorkbookBackgroundColor(n.highContrastScheme,t.BackgroundColor),c=function(e,t,n,o){for(var a={},l=[],s=[],d={},u=e.ClientOnlyCache.GridlineOverridingCellsToRender,c=0;c<u.length;c++){var g=u[c],h=I(g);if((i.cellIntersectsRenderingRegion(g,o.renderingRegion)||(F=g,x=o.renderingRegion,w=void 0,R=void 0,w=F.Col===x.endColumn+1&&F.Row>=x.startRow&&F.Row<=x.endRow,R=F.Row===x.endRow+1&&F.Col>=x.startColumn&&F.Col<=x.endColumn,w||R))&&(h&&h.Borders&&0!==h.Borders.length))for(var p=h.Borders,C=0;C<p.length;C++){var v=p[C];if(v.BorderLineStyle!==r.BorderLineType.None&&S(v.BorderPosition,e,g)){if(v.BorderLineStyle===r.BorderLineType.Double){var y=g.CachedStyle.BackgroundColor?i.hexToRgb(g.CachedStyle.BackgroundColor):n,T=f(v.BorderPosition,y);m(e,g,T,t,s,d)}m(e,g,v,t,l,a)}}}var F,x,w,R;return{distinctBorderTypes:l,borderTypeToLineMap:a,distinctClearingDoubleBorderTypes:s,clearingDoubleBordersToLineMap:d}}(t,s,i.hexToRgb(d),n);n.highContrastScheme?(a=u.rgbToColorHex(n.highContrastScheme.TextColor),o=u.rgbToColorHex(n.highContrastScheme.BackgroundColor),p(e,c.distinctBorderTypes,c.borderTypeToLineMap,s,a),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,s,o)):(p(e,c.distinctBorderTypes,c.borderTypeToLineMap,s,void 0),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,s,void 0))},t.cellHasBottomDoubleBorder=function(e,t){l.verifyArgumentNotNull(e,"cell","cellHasBottomDoubleBorder");var n=r.getCell(e.Row+1,e.Col,t);if(o.isNullOrUndefined(n)||o.isNullOrUndefined(n.CachedBorderStyle)||o.isNullOrUndefined(n.CachedBorderStyle.Borders))return!1;for(var i=n.CachedBorderStyle.Borders,a=0;a<i.length;a++){var s=i[a];if(s.BorderPosition===r.BorderPositionType.Top&&s.BorderLineStyle===r.BorderLineType.Double)return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearGridLinesForPivotTables=t.setContextForClearingGridLine=t.clearGridLinesForSpannedCells=void 0;var r=n(0),i=n(2),o=n(37),a=n(7),l=n(5),s=n(3),d=n(50);function u(e,t,n){var i=r.getWorkbookBackgroundColor(t.highContrastScheme,n);e.strokeStyle=i,e.lineWidth=s.GridLineWidthPx,e.setLineDash(s.DefaultDash)}function c(e,t,n,r,a){var d=e.Col,u=e.Col,c=n.ClientOnlyCache.ColOffsetsAdjustedForDrawing;e.Merge?(u+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(u=c.length-1)):e.Spill&&(d-=e.Spill.SpanToStart,u+=e.Spill.SpanToEnd),d=Math.max(0,d),u=Math.min(n.ColumnNumbers.length,u);for(var g=l.getCellHeightAdjustedForDrawing(n,e),h=l.getCellTopAdjustedForDrawing(n,e,!1),f=g-s.GridLineWidthPx,m=d;m<u;m++){var p=o.getAdjustedDrawingOffset(c[m],i.getColWidthFromOffsets(m,c),r,a);i.drawLine(t,p,h,p,h+f)}}function g(e,t,n,r,a){var d=e.Row,u=e.Row+e.Merge.Rows,c=n.ClientOnlyCache.RowOffsetsAdjustedForDrawing;d=Math.max(0,d),u=Math.min(n.RowNumbers.length,u),e.Merge.SpansNextBlockVertically&&(u=c.length-1);for(var g=l.getCellLeftAdjustedForDrawing(n,e,n.IsRtl,!1),h=l.getCellWidthAdjustedForDrawing(n,e)-s.GridLineWidthPx,f=d;f<u;f++){var m=o.getAdjustedDrawingOffset(c[f],i.getRowHeightFromOffsets(f,c),r,a);i.drawLine(t,g,m,g+h,m)}}t.clearGridLinesForSpannedCells=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","clearGridLinesForText"),r.verifyArgumentNotNull(e,"ctx","clearGridLinesForText"),r.verifyArgumentNotNull(n,"context","clearGridLinesForText"),t.ShowGridLines&&i.shouldRenderGridLines(r.isHighContrastMode(n),r.hasWorkbookBackgroundColor(t.BackgroundColor))){var d=t.ClientOnlyCache.CellsToRender,h=r.getLinePixelTranslation(s.GridLineWidthPx),f=o.getMaxLineOffset(t.BlockWidth,n.scaleFactor,!1),m=o.getMaxLineOffset(t.BlockHeight,n.scaleFactor,!0);u(e,n,t.BackgroundColor),e.beginPath();for(var p=0;p<d.length;p++){var C=d[p],v=!a.isNullOrUndefined(C)&&!a.isNullOrUndefined(C.Spill),y=!a.isNullOrUndefined(C)&&!a.isNullOrUndefined(C.Merge)&&(a.isNullOrUndefined(C.CachedStyle.BackgroundColor)||!a.isNullOrUndefined(n.highContrastScheme));i.cellIntersectsRenderingRegion(C,n.renderingRegion)&&((v||y)&&(c(C,e,t,h,f),y&&l.isCellSpansMultipleRowsOrBlocks(C)&&g(C,e,t,h,m)))}e.stroke()}},t.setContextForClearingGridLine=u,t.clearGridLinesForPivotTables=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","clearGridLinesForEmptyPivotTables"),r.verifyArgumentNotNull(e,"ctx","clearGridLinesForEmptyPivotTables"),r.verifyArgumentNotNull(n,"context","clearGridLinesForEmptyPivotTables"),t.ShowGridLines&&i.shouldRenderGridLines(r.isHighContrastMode(n),r.hasWorkbookBackgroundColor(t.BackgroundColor))&&t.PivotTables&&0!==t.PivotTables.length){for(var o=!1,l=0;l<t.PivotTables.length;l++){var u=t.PivotTables[l];if(u.HideGridLines&&((u.IsEmptyPivot||!a.isNullOrUndefined(u.RowHeaderRange))&&d.isPivotIntersectsRenderingRegion(t,u,n.renderingRegion,!0))){o||(e.fillStyle=r.getWorkbookBackgroundColor(n.highContrastScheme,t.BackgroundColor),e.beginPath(),o=!0);var c=d.getPivotTableLeftAdjustedForDrawing(t,u,t.IsRtl),g=d.getPivotTableTopAdjustedForDrawing(t,u,!0),h=u.OriginPTWidthAdjustedForDrawing-s.GridLineWidthPx,f=u.OriginPTHeightAdjustedForDrawing-s.GridLineWidthPx;e.rect(c,g,h,f)}}o&&e.fill()}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.shouldBreak=t.CombiningClass=void 0,function(e){e[e.Other=1]="Other",e[e.CR=2]="CR",e[e.LF=4]="LF",e[e.Control=8]="Control",e[e.Extend=16]="Extend",e[e.Regional_Indicator=32]="Regional_Indicator",e[e.SpacingMark=64]="SpacingMark",e[e.L=128]="L",e[e.V=256]="V",e[e.T=512]="T",e[e.LV=1024]="LV",e[e.LVT=2048]="LVT",e[e.Prepend=4096]="Prepend",e[e.ZWJ=8192]="ZWJ"}(r=t.CombiningClass||(t.CombiningClass={}));var i=0|r.Control|r.CR|r.LF,o=0|r.L|r.V|r.LV|r.LVT,a=0|r.V|r.LV,l=0|r.V|r.T,s=0|r.LVT|r.T;function d(e,t){return 0!=(e&t)}t.shouldBreak=function(e,t){return(e!==r.CR||t!==r.LF)&&(!!d(i,e)||(!!d(i,t)||(e!==r.L||!d(o,t))&&((!d(a,e)||!d(l,t))&&((!d(s,e)||t!==r.T)&&((e!==r.Regional_Indicator||t!==r.Regional_Indicator)&&(t!==r.Extend&&t!==r.ZWJ&&(t!==r.SpacingMark&&e!==r.Prepend)))))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalTextPadding=void 0;var r=n(6);t.getVerticalTextPadding=function(e){return r.getIndentationPaddingPx(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClipMaskForSpillCell=t.drawSpillCellText=void 0;var r=n(1),i=n(2),o=n(88),a=n(0),l=n(6),s=n(5),d=n(10);t.drawSpillCellText=function(e,t,n,r,u,c,g,h,f,m,p){a.verifyArgumentNotNull(r.Spill,"cell.Spill","spillCells.drawSpillCellText");var C=s.getSpillCellWidth(r,n);if(h)o.fillTextClipped(e,t,u,c,g,h,r,n,f,p);else{var v=l.getCellTextHorizontalPaddingWithoutVisualElements(n,r),y=a.isPivotTablePhase2Enabled(n),T=i.getTextDrawingMaxWidth(C,v,m,d.getExpandCollapseButtonPadding(r,y),0);o.fillTextUnclipped(e,u,c,g,T,r,n,t)}},t.getClipMaskForSpillCell=function(e,t,n,o,l,u,c){var g,h=s.getSpillCellWidth(t,e),f=t.Spill.IsSpillBlocked||n||(null===(g=t.CachedStyle)||void 0===g?void 0:g.HorizontalAlignment)===r.HorizontalAlignment.CenterAcrossSelection||l,m=a.isPivotTablePhase2Enabled(e);if(f){var p=d.getExpandCollapseButtonPadding(t,m),C=i.getClipMaskWidth(h,o,p);return{x:s.getSpillCellStartOffset(t,e,o,p),y:u,width:C,height:c}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawHeaderCellsBackgroundFill=t.drawGridCellsBackgroundFill=void 0;var r,i=n(1),o=n(2),a=n(5),l=n(0),s=n(7),d=n(3),u=n(146);function c(e,t,n,i,o){var l=a.getCellDimensionsAdjustedForDrawing(t,n,!1);if(i===r.Gradient)return u.fillCellWithGradientBackground(e,n.CachedStyle.Gradient,l,o);var s=function(e,t){if(t===r.FormulaParseError)return d.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}(n,i);return o!==s&&(e.fillStyle=s),e.fillRect(l.x,l.y,l.width,l.height),s}function g(e){return e.HasError?r.FormulaParseError:s.isNullOrUndefined(e.CachedStyle.Gradient)?s.isNullOrUndefined(e.CachedStyle.BackgroundColor)?r.None:r.Solid:r.Gradient}t.drawGridCellsBackgroundFill=function(e,t,n){if(l.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),l.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),l.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawBackgroundFill"),l.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),l.verifyArgumentNotNull(t.Styles,"model.Styles","drawBackgroundFill"),!n.highContrastScheme){for(var i,s=[],d=t.ClientOnlyCache.GridlineOverridingCellsToRender,u=0;u<d.length;u++){(f=g(h=d[u]))!==r.None&&(o.cellIntersectsRenderingRegion(h,n.renderingRegion)&&(a.isCellSpansMultipleRowsOrBlocks(h)?s.push([h,f]):i=c(e,t,h,f,i)))}for(u=0;u<s.length;u++){var h,f,m=s[u];i=c(e,t,h=m[0],f=m[1],i)}}},t.drawHeaderCellsBackgroundFill=function(e,t,n){if(!s.isNullOrUndefined(t.Cells))for(var a,d=t.ClientOnlyCache.CellsToRender,u=0;u<d.length;u++){var h=t.Cells[u];g(h)!==r.None&&(o.cellIntersectsRenderingRegion(h,n.renderingRegion)&&(l.isHighContrastMode(n)&&h.CachedStyle.BackgroundColor!==i.PartialRowColSelectionBackgroundColor||(a=c(e,t,h,r.Solid,a))))}},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIconOutOfCellVerticalBoundaries=t.getIconBottomWhenAlignedWithMiddleBaseline=t.getIconLeftPosition=t.getIconVerticalPosition=void 0;var r=n(1),i=n(6),o=n(5),a=n(10),l=n(16),s=n(0),d=n(39),u=n(13),c=n(50),g=n(32);function h(e,t,n,r,a){var l=i.getTextVerticalPosition(t,e,i.getTextLineHeight(t,e),o.getCellHeight(e,t,!1),a,void 0).absoluteY,d=i.getMiddleBaseline(e,l,t.CachedFont,s.getActualFontSize(t))*n+.5*r;return Math.round(d)}function f(e,t,n,r){return o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding<n||o.getCellTopAdjustedForDrawing(e,t,!1)+l.MinimalIconPadding>n+r}t.getIconVerticalPosition=function(e,t,n,i){var s,u,c=d.getEffectiveVerticalAlignment(t.CachedStyle.VerticalAlignment,d.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),g=h(e,t,n,i,c),m=null===(u=null===(s=t.CondFormat)||void 0===s?void 0:s.Icon)||void 0===u?void 0:u.IconOnly,p=o.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding,C=o.getCellTopAdjustedForDrawing(e,t,!1)+l.MinimalIconPadding+i;switch(c){case r.VerticalAlignment.Bottom:return m?p:a.adjustNumberToRange(g,C,p);case r.VerticalAlignment.Top:return m?C:a.adjustNumberToRange(g,C,p);case r.VerticalAlignment.Center:return m||f(e,t,g,i)?Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)+i/2):g;default:throw Error("getIconVerticalPosition: Vertical alignment "+c+" is not supported in CF Icon!")}},t.getIconLeftPosition=function(e,t,n,i,l){var d,h;return(null===(h=null===(d=t.CondFormat)||void 0===d?void 0:d.Icon)||void 0===h?void 0:h.IconOnly)?function(e,t,n,i,l){var d=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(d){case r.HorizontalAlignment.Right:var u=a.getIconHorizontalPadding(i,l)+function(e,t,n,i){if(!t.PivotTable||!t.PivotTable.HasExpandCollapseIndicator)return 0;if(!c.canCellContainExpandCollapseAndCFIcon(e,t,o.getCellWidthAdjustedForDrawing(e,t),i))return 0;var l=s.isPivotTablePhase2Enabled(e);if(n===r.HorizontalAlignment.Right)return(a.getExpandCollapseButtonPadding(t,l)+g.DistanceBetweenCFIconAndExpandCollapseButton)*i;return 0}(e,t,d,l)+n;return Math.floor(o.getCellRightAdjustedForDrawing(e,t,!1)-u);case r.HorizontalAlignment.Fill:case r.HorizontalAlignment.Justify:case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Distributed:case r.HorizontalAlignment.JustifyDistributed:case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1,!1)+a.getIconHorizontalPadding(i,l));case r.HorizontalAlignment.Center:return Math.floor(o.getCellCenterXAdjustedForDrawing(e,t)-n/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: "+d)}}(e,t,n,i,l):(r.isRenderFlagEnabled(r.RenderFlagsArray.CFIconsWithCAS,e)&&u.isHorizontalAlignmentCenteredAcrossSelection(t)&&t.Spill?o.getSpillCellLeftAdjustedForDrawing(e,t):o.getCellLeftAdjustedForDrawing(e,t,!1,!1))+a.getIconHorizontalPadding(i,l)},t.getIconBottomWhenAlignedWithMiddleBaseline=h,t.isIconOutOfCellVerticalBoundaries=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSymbols=void 0;var r=n(0),i=n(16),o=n(25),a=n(22),l=n(33),s=n(55),d=n(17);function u(e,t,n,r,i,a,l){var s={left:t,bottom:n,outerColor:l,height:r,width:i,innerColor:a};o.drawRectangle(e,s)}t.drawSymbols=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawSymbols"),r.verifyArgumentNotNull(t,"drawingContext","drawSymbols");var n=t.image,c=t.highContrastScheme,g=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case i.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case i.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case i.CFIconImage.CircleSymbolHigh:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = "+e)}}(n,c),h=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = "+e)}}(n,c);switch(n){case i.CFIconImage.SymbolHigh:case i.CFIconImage.CircleSymbolHigh:!function(e,t,n,r){var o,a=t.size,s=t.left,u=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolHigh:var g=s+d.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=e+i.CheckMarkMiddleXRatio*n,a={x:e+i.CheckMarkTopLeftXRatio*n,y:i.CheckMarkTopLeftYRatio*n+r},l={x:e+i.CheckMarkTopMiddleXRatio*n,y:i.CheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CheckMarkBottomYRatio*n+r},d={x:e+n,y:i.CheckMarkMiddleRightYRatio*n+r},u={x:e+i.CheckMarkTopRightXRatio*n,y:i.CheckMarkTopRightYRatio*n+r},c={x:o,y:i.CheckMarkMiddleYRatio*n+r};return[a,l,s,d,u,c,a]}(g,u,a);break;case i.CFIconImage.CircleSymbolHigh:o=function(e,t,n){var r=t-n,o=e+i.CircledCheckMarkMiddleXRatio*n,a={x:e+i.CircledCheckMarkTopLeftXRatio*n,y:i.CircledCheckMarkTopLeftYRatio*n+r},l={x:e+i.CircledCheckMarkTopMiddleXRatio*n,y:i.CircledCheckMarkTopMiddleYRatio*n+r},s={x:o,y:i.CircledCheckMarkBottomYRatio*n+r},d={x:e+i.CircledCheckMarkMiddleRightXRatio*n,y:i.CircledCheckMarkMiddleRightYRatio*n+r},u={x:e+i.CircledCheckMarkTopRightXRatio*n,y:i.CircledCheckMarkTopRightYRatio*n+r},c={x:o,y:i.CircledCheckMarkMiddleYRatio*n+r};return[a,l,s,d,u,c,a]}(s,u,a);break;default:throw Error("drawCheckMark: unsupported image type = "+c)}l.drawIconFromPoints(e,n,r,o)}(e,t,g,h);break;case i.CFIconImage.SymbolMedium:case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r){var a=t.image;switch(a){case i.CFIconImage.SymbolMedium:!function(e,t,n,r){var a=t.size,l=t.left,s=t.bottom,d=Math.floor(a*i.ExclamationMarkTopRectHeightSizeRatio),c=Math.floor(a*i.ExclamationMarkBottomRectHeightSizeRatio),g=Math.floor(a*i.ExclamationMarkWidthRectSizeRatio),h=d+Math.max(i.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(i.ExclamationMarkSpaceBetweenRectanglesRatio*a)),f=Math.floor(i.ExclamationMarkLeftRectanglePaddingRatio*a),m=l+f;u(e,m,s-(a-d),d,g,n,r),function(e,t,n,r,i,a,l,s,d){var u={left:t,bottom:n-(r-d-i),outerColor:s,height:i,width:a,innerColor:l};o.drawRectangle(e,u)}(e,m,s,a,c,g,n,r,h)}(e,t,n,r);break;case i.CFIconImage.CircleSymbolMedium:!function(e,t,n,r){var o=t.size,a=t.left,l=t.bottom,c=t.image,g=o-2*i.CircledExclamationMarkPaddingFromCircle,h=Math.floor(g*i.CircledExclamationMarkTopRectHeightSizeRatio),f=function(e){var t=Math.floor(e*i.CircledExclamationMarkWidthRectSizeRatio);return t%2==0?t-1:t}(h),m=a+o/2,p=Math.round(m-(f+1)/2),C=l-i.CircledExclamationMarkPaddingFromCircle,v=function(e){var t=Math.floor(e*i.CircledExclamationMarkLeftCircleSizeRatio);return t%2==0?t:t-1}(g),y=function(e,t,n){return e+d.ShapeLinesAdjustment-(t-n)/2}(p,v,f),T={image:c,bottom:C,highContrastScheme:void 0,left:y,size:v},S=Math.floor(l-i.CircledExclamationMarkPaddingFromCircle-(v+1));u(e,p,S,h,f,n,r),s.drawCircle(e,T,r,n)}(e,t,n,r);break;default:throw Error("drawExclamationMark: unsupported image type = "+a)}}(e,t,g,h);break;case i.CFIconImage.SymbolLow:case i.CFIconImage.CircleSymbolLow:!function(e,t,n,r){var o,a=t.size,s=t.left,u=t.bottom,c=t.image;switch(c){case i.CFIconImage.SymbolLow:var g=s+d.ShapeLinesAdjustment;o=function(e,t,n){var r=t-n,o=i.CrossMarkOuterSmallPaddingRatio*n,a=o+e,l=o+r,s=i.CrossMarkOuterBigPaddingRatio*n,d=s+e,u=s+r,c=i.CrossMarkInnerSmallPaddingRatio*n,g=c+e,h=c+r,f=i.CrossMarkInnerCenterRatio*n,m=f+e,p=f+r,C=i.CrossMarkInnerBigPaddingRatio*n,v={x:a,y:r};return[v,{x:e,y:l},{x:g,y:p},{x:e,y:u},{x:a,y:n+r},{x:m,y:C+r},{x:d,y:n+r},{x:e+n,y:u},{x:e+C,y:p},{x:e+n,y:l},{x:d,y:r},{x:m,y:h},v]}(g,u,a);break;case i.CFIconImage.CircleSymbolLow:o=function(e,t,n){var r=(S=n,S%2==1?S+1:S),o=t-n,a=i.CircledCrossMarkOuterSmallPaddingRatio*r,l=a+e,s=a+o,d=i.CircledCrossMarkOuterBigPaddingRatio*r,u=d+e,c=d+o,g=i.CircledCrossMarkInnerSmallPaddingRatio*r,h=g+e,f=g+o,m=i.CircledCrossMarkInnerCenterRatio*r,p=m+e,C=m+o,v=i.CircledCrossMarkInnerBigPaddingRatio*r,y=i.CircledCrossMarkPaddingFromCircleRatio*r,T={x:l,y:o+y};var S;return[T,{x:e+y,y:s},{x:h,y:C},{x:e+y,y:c},{x:l,y:r+o-y},{x:p,y:v+o},{x:u,y:r+o-y},{x:e+r-y,y:c},{x:e+v,y:C},{x:e+r-y,y:s},{x:u,y:o+y},{x:p,y:f},T]}(s,u,a);break;default:throw Error("drawCrossMark: unsupported image type = "+c)}l.drawIconFromPoints(e,n,r,o)}(e,t,g,h);break;default:throw Error("drawSymbols: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLineWidth=t.setPageLayoutLine=void 0;var r=n(3),i=n(7),o=n(0);function a(e){return o.isHighContrastMode(e)?r.HighContrastPageLayoutWidthPx:r.GridLineWidthPx}t.setPageLayoutLine=function(e,t){e.lineWidth=a(t),e.setLineDash(r.DefaultDash),e.strokeStyle=i.isNullOrUndefined(t.highContrastScheme)?r.PageLayoutLineColor:""+o.rgbToColorHex(t.highContrastScheme.TextColor)},t.getLineWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultLongPressState=t.getEventCoordinates=t.areTwoHitRegionsSame=t.hitRegionComparer=t.setHitMapOffsets=void 0;var r=n(0),i=n(9);function o(e,t,n,r){if(0===r&&n===e.length-1)return e.slice(0);var o=e.slice(t,n+1);o[0]=0;for(var a=1;a<o.length;a++)o[a]=o[a]-r,o[a]<0&&(i.setRenderingResultInfo("getHitMapAxisOffsets: Unexpected input params: startOffsetPx: "+r+", startOffset: "+t+", offsets: "+e),o.splice(a,1),a--);return o}t.setHitMapOffsets=function(e,t,n){var r=o(t.ColumnOffsets,n.startColumn,n.endColumn,n.startOffsetX),i=o(t.RowOffsets,n.startRow,n.endRow,n.startOffsetY);e.setHitMapOffsets(r,i)},t.hitRegionComparer=function(e,t){return t.zIndex-e.zIndex},t.areTwoHitRegionsSame=function(e,t){return e.zIndex===t.zIndex&&r.areTwoRectsEqual(e.region,t.region)},t.getEventCoordinates=function(e,t){var n=e,r=e;if("touchstart"===t){var i=n.touches[0];return{clientX:i.clientX,clientY:i.clientY}}if("touchend"===t){var o=n.changedTouches.length,a=n.changedTouches[o-1];return{clientX:a.clientX,clientY:a.clientY}}return{clientX:r.clientX,clientY:r.clientY}},t.getDefaultLongPressState=function(){return{callbackScheduled:!1,longPressModeEnabled:!1,callbackId:-1,eventPointerId:-1,lastHitRegion:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockRenderingStage=void 0,function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(t.BlockRenderingStage||(t.BlockRenderingStage={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDrawAutoFilter=t.drawAutoFilters=void 0;var r=n(1),i=n(0),o=n(24),a=n(20),l=n(3),s=n(2),d=n(38),u=n(165),c=n(25),g=n(12),h=n(15),f=n(21),m=n(44);function p(e,t){var n=e.AutoFilter;if(!n&&!e.PivotFilter)return!1;if(!s.cellIntersectsRenderingRegion(e,t.renderingRegion))return!1;if(e.PivotFilter)return e.PivotFilter.DisplayFilter;if(!n.RenderingContext)return!1;var r=n.RenderingContext,i=r.IsHidden,o=r.IsRenderingPermitted;return!(i||!o)&&(!e.PreviewText&&!e.ShowSkeleton)}function C(e,t,n,l,s,p,C){var v=function(e,t,n,r,i){var o=n.devicePixelRatio,a=h.getFilterSizeAdjustedForDrawing(e,t,o,n.zoom);return{bottom:h.getFilterBottomAdjustedForDrawing(e,t,a,o,n.zoom),left:h.getFilterLeftAdjustedForDrawing(e,t,a,o,n.zoom),height:a,width:a,outerColor:r,innerColor:i,radius:d.AutoFilterRectRadius}}(t,n,l,s,p);c.drawRoundRectangle(e,v);var y=n.PivotFilter,T=n.AutoFilter,S=!!y;v.width>d.FilterDrawingThresholdPx&&function(e,t,n,i){switch(e.strokeStyle=i,t){case r.AutoFilterType.Both:case r.AutoFilterType.Filtered:u.drawFilterDownChevronIcon(e,n);break;case r.AutoFilterType.BothAsc:case r.AutoFilterType.BothTop:u.drawSortUpFilterIcon(e,n);break;case r.AutoFilterType.BothDesc:case r.AutoFilterType.BothBottom:u.drawSortDownFilterIcon(e,n);break;case r.AutoFilterType.SortedAsc:case r.AutoFilterType.SortedTop:u.drawSortUpChevronDownIcon(e,n);break;case r.AutoFilterType.SortedDesc:case r.AutoFilterType.SortedBottom:u.drawSortDownChevronDownIcon(e,n);break;default:u.drawDownChevronIcon(e,n)}}(e,S?y.Type:T.Type,v,C);if(function(e,t){var n,r=t.PivotFilter;if(r)return r.DisplayFilter&&!r.IsHeaderSnapped;if(!e.PermissionSet)return!1;var i=e.PermissionSet,o=i.IsAutoFilterDisabled,a=i.IsSortDisabled;return!(o&&a||(null===(n=t.AutoFilter)||void 0===n?void 0:n.RenderingContext.IsHeaderSnapped)||!e.RibbonCommands)}(t,n)){var F=S?function(e){return r.isChangeGateEnabled(r.ChangeGate.AddAutoFilterAndPivotTableContextMenu)&&m.trackEventResponseTime(e,"open_menu_pivot_table"),g.pivotFilterClickHandler(e,y.CommandData,y.IsPivotPageField),!0}:function(e){return g.handleRibbonCommand(e,t.RibbonCommands.ShowAutoFilterMenu,T.CommandData),!0},x=S?y.Title:T.Title;!function(e,t,n,l,s,d){var u=function(e,t,n){var r={x:n.left,y:n.bottom-n.height,width:n.width,height:n.height};return f.getUnadjustedHitRegionFromRect(e,t,r,!1)}(e,n,l),c=r.getRenderingRegionHitTestCache(e,i.getRenderingRegionKey(n.renderingRegion)),g=function(e){return!0};a.registerCursorHitRegion(t,c,u,o.PointerCursorType,r.RenderFeaturesZIndex.AutoFilter),a.registerTooltipHitRegion(t,c,u,d,r.RenderFeaturesZIndex.AutoFilter),a.registerHitRegion(t,c,u,r.RenderFeaturesZIndex.AutoFilter,s,"click"),a.registerHitRegion(t,c,u,r.RenderFeaturesZIndex.AutoFilter,s,"touchend"),a.registerHitRegion(t,c,u,r.RenderFeaturesZIndex.AutoFilter,g,"pointerdown"),a.registerHitRegion(t,c,u,r.RenderFeaturesZIndex.AutoFilter,g,"dblclick"),a.registerHitRegion(t,c,u,r.RenderFeaturesZIndex.AutoFilter,o.TouchCallback,"touchstart")}(t,n,l,v,F,x)}}t.drawAutoFilters=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","drawAutoFilters"),r.verifyArgumentNotNull(t,"model","drawAutoFilters"),r.verifyArgumentNotNull(n,"context","drawAutoFilters");for(var o,a=t.ClientOnlyCache.CellsToRender,s=!1,u=(o=n.highContrastScheme)?i.rgbToColorHex(o.TextColor):d.AutoFilterBorderColor,c=function(e){return e?i.rgbToColorHex(e.BackgroundColor):d.AutoFilterBackgroundColor}(n.highContrastScheme),g=function(e){return e?i.rgbToColorHex(e.TextColor):d.AutoFilterStrokeColor}(n.highContrastScheme),h=0;h<a.length;h++){var f=a[h];p(f,n)&&(s||(e.setLineDash(l.DefaultDash),e.lineWidth=d.AutoFilterLineWidthPx,s=!0),C(e,t,f,n,u,c,g))}},t.shouldDrawAutoFilter=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommentHitRegionProportionConstant=t.CommentWithFilterPaddingPx=t.MinCommentIconSizePx=t.LegacyCommentSizePx=t.LegacyCommentColor=t.ThreadedCommentSizePx=t.ThreadedCommentColor=void 0,t.ThreadedCommentColor="#bd67c9",t.ThreadedCommentSizePx=8,t.LegacyCommentColor="#ff0000",t.LegacyCommentSizePx=8,t.MinCommentIconSizePx=4,t.CommentWithFilterPaddingPx=2,t.CommentHitRegionProportionConstant=1.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initGridRendererCustomCursors=t.gridRendererCustomCursors=void 0,t.initGridRendererCustomCursors=function(e){t.gridRendererCustomCursors=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRenderer=void 0;var r=n(1),i=n(9),o=n(0),a=n(7),l=n(177),s=function(){function e(){this.ctx=null}return e.prototype.render=function(e,t,n){var s=this;if(i.clearPerformanceMetrics(),l.loadPolyFills(),!e)return i.createRenderResult(!1,"render:: canvas is undefined");if(!t)return i.createRenderResult(!1,"render:: model is undefined");if(!n)return i.createRenderResult(!1,"render:: context is undefined");if(t.RowOffsets.length>r.MaxAllowedRowColCount)return i.createRenderResult(!1,"render:: block # of rows = "+t.RowOffsets.length+" > MaxAllowedRowColCount");if(t.ColumnOffsets.length>r.MaxAllowedRowColCount)return i.createRenderResult(!1,"render:: block # of columns = "+t.ColumnOffsets.length+" > MaxAllowedRowColCount");if(i.trackDuration(i.RenderPerformanceMetric.GetContextDurationMs,(function(){s.ctx=e.getContext2d({alpha:!n.subPixelRenderingEnabled})})),!this.ctx)return i.createRenderResult(!1,"render:: ctx is undefined");var d,u=o.extendRenderingContext(n);if(i.trackDuration(i.RenderPerformanceMetric.ModelPreparationsMs,(function(){s.preprocessModel(t,n.renderingRegion,u)})),r.isDifferentialRenderingSupported(t)&&!o.renderingRegionContainsDirtyCells(n.renderingRegion,t))return i.createRenderResult(!0,"skipped rendering since rendering region doesn't have dirty cells");if(i.trackDuration(i.RenderPerformanceMetric.RenderInternalDurationMs,(function(){d=s.renderInternal(e,t,u)})),r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,t)&&i.trackDuration(i.RenderPerformanceMetric.RegisterHitRegionsMs,(function(){s.initializeCanvasHitTest(e,t,u.renderingRegion,u.zoom)})),u.renderingRegion.isRendered=!0,a.isNullOrUndefined(d)&&(d=i.createRenderResult(!0,"")),d.succeeded){var c=i.getRenderingMessage();d.message=a.isNullOrUndefined(d.message)?c.message:d.message+"; "+c.message,d.messageLevel=c.level}return d},e.prototype.setTransform=function(e,t,n,r,i){t?this.ctx.setTransform(-e,0,0,e,i+n,r):this.ctx.setTransform(e,0,0,e,n,r)},e}();t.CanvasRenderer=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRotatedTextWidth=void 0;var r=n(6),i=n(19);t.getRotatedTextWidth=function(e,t,n,o){var a=r.getFontLineHeight(e,o.Size,o.FontName),l=i.degreeToRadians(i.getOrientationInCanvas(e.IsRtl,n.Orientation||0));return i.getRotatedTextBoxWidth(t,a,l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BlockModelAccessor=void 0;var r=n(1),i=n(8),o=n(0),a=function(){function e(t){e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.throwErrorWrapper=function(e,t){o.throwError(e,"BlockModelAccessor."+t)},e.verifyArgumentNotNull=function(e,t,n){o.verifyArgumentNotNull(e,t,"BlockModelAccessor."+n)},e.prototype.getColumnWidth=function(e){return o.getColumnWidth(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&e.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&e.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&e.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getColumnOffsets=function(){var e;return null===(e=this.model.ColumnOffsets)||void 0===e?void 0:e.slice()},e.prototype.setColumnOffsets=function(t){e.verifyArgumentNotNull(t,"newOffsets","setColumnOffsets"),this.model.ColumnOffsets=t,this.setDirty("setColumnOffsets",r.DirtyType.ModelCoreChanges)},e.prototype.getColumnNumbers=function(){var e;return null===(e=this.model.ColumnNumbers)||void 0===e?void 0:e.slice()},e.prototype.setColumnNumbers=function(t){e.verifyArgumentNotNull(t,"newNumbers","setColumnNumbers"),this.model.ColumnNumbers=t,this.setDirty("setColumnNumbers",r.DirtyType.ModelCoreChanges)},e.prototype.getColumnWidths=function(){var e;return null===(e=this.model.ColumnWidths)||void 0===e?void 0:e.slice()},e.prototype.setColumnWidths=function(t){e.verifyArgumentNotNull(t,"newWidths","setColumnWidths"),this.model.ColumnWidths=t,this.setDirty("setColumnWidths",r.DirtyType.ModelCoreChanges)},e.prototype.getRowOffsets=function(){var e;return null===(e=this.model.RowOffsets)||void 0===e?void 0:e.slice()},e.prototype.setRowOffsets=function(t){e.verifyArgumentNotNull(t,"newOffsets","setRowOffsets"),this.model.RowOffsets=t,this.setDirty("setRowOffsets",r.DirtyType.ModelCoreChanges)},e.prototype.getRowNumbers=function(){var e;return null===(e=this.model.RowNumbers)||void 0===e?void 0:e.slice()},e.prototype.setRowNumbers=function(t){e.verifyArgumentNotNull(t,"newNumbers","setRowNumbers"),this.model.RowNumbers=t,this.setDirty("setRowNumbers",r.DirtyType.ModelCoreChanges)},e.prototype.getRowHeights=function(){var e;return null===(e=this.model.RowHeights)||void 0===e?void 0:e.slice()},e.prototype.setRowHeights=function(t){e.verifyArgumentNotNull(t,"newHeights","setRowHeights"),this.model.RowHeights=t,this.setDirty("setRowHeights",r.DirtyType.ModelCoreChanges)},e.prototype.getBlockWidth=function(){return this.model.BlockWidth},e.prototype.setBlockWidth=function(e){this.model.BlockWidth=e,this.setDirty("setBlockWidth",r.DirtyType.ModelCoreChanges)},e.prototype.getBlockHeight=function(){return this.model.BlockHeight},e.prototype.setBlockHeight=function(e){this.model.BlockHeight=e,this.setDirty("setBlockHeight",r.DirtyType.ModelCoreChanges)},e.prototype.setDirty=function(t,n){e.verifyArgumentNotNull(n,"dirtyType","setDirty"),this.setDirtyInternal(n),i.ULS.sendTraceTag(559957857,i.LogCategory.msoulscat_ES_EWAJSGrid,i.TraceLevel.Info,"BlockModelAccessor::setDirty called, caller "+t),r.getModelClientCache(this.model).DisableDiffRendering=!0},e.prototype.setDirtyInternal=function(e){var t=r.getModelClientCache(this.model);t.IsDirty||(t.DirtyTimestamp=Date.now()),t.IsDirty=!0,t.DirtyType|=e},e}();t.BlockModelAccessor=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCollector=t.initPassiveTelemetryManager=void 0;var r,i,o,a=n(12),l=n(43),s=n(198),d=n(8),u=[],c={},g=l.getCurrentTimeInMs(),h=!1;function f(){for(var e=l.getCurrentTimeInMs();l.getCurrentTimeInMs()-e<r&&u.length>0&&!p();){var t=Math.floor(Math.random()*u.length),n=u[t],a=l.getCurrentTimeInMs();if(n.canCollectorExecute())try{var s=n.collect();s.isValid&&c[n.getCollectorName()].push(s.value);var h=l.getCurrentTimeInMs()-a;h>r&&(d.ULS.sendTraceTag(572602177,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"Name: "+n.getCollectorName()+" is disabled because it exceeded execution threshold.\n            Threshold: "+r+", TimeTaken: "+h),n.disable())}catch(e){d.ULS.sendTraceTag(572602178,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,"Name: "+n.getCollectorName()+", Exception encountered in collector, Collector will be disabled. Exception - "+e),n.disable()}u.splice(t,1)}u.length<1&&o.stopTracking(),l.getCurrentTimeInMs()-g>i&&setTimeout(m,0)}function m(){if(c)for(var e=Object.keys(c),t=0;t<e.length;t++){var n=e[t],r=c[n];r&&r.length>0&&d.ULS.sendTraceTag(572602179,d.LogCategory.msoulscat_ES_EWAJSGrid,d.TraceLevel.Info,JSON.stringify({Name:n,Results:r}))}c={},g=l.getCurrentTimeInMs()}function p(){return!(!navigator.scheduling||!navigator.scheduling.isInputPending)&&navigator.scheduling.isInputPending()}t.initPassiveTelemetryManager=function(){if(!h){r=a.getServiceSetting(3,25),i=a.getServiceSetting(5,6e4);var e=a.getServiceSetting(4,1e4);o=new s.IdleTracker({onReportUserIsIdle:function(){window.requestIdleCallback?window.requestIdleCallback(f):setTimeout(f,0)}},e),u.length>0&&o.startTrackingIfApplicable(),h=!0}},t.registerCollector=function(e){u.length<100&&u.push(e);var t=e.getCollectorName();c[t]||(c[t]=[]),h&&o.startTrackingIfApplicable()}},function(e,t,n){"use strict";var r,i=function(){function e(e,t,n,r,i,o){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=null!=o&&o,this.isRTL=r,this.elementsMargin=r?"margin-left: 8px;":"margin-right: 8px;",this.toastElement=this.createToastContainer(i),this.setTitle(t),n&&this.setMessage(n),e.appendChild(this.toastElement)}return e.prototype.setVisibility=function(e){this.toastElement.style.visibility=e?"visible":"hidden"},e.prototype.dispose=function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)},e.prototype.setTitle=function(e){this.toastTitleElement?this.toastTitleElement.innerText=e:(this.toastTitleElement=this.createToastTitle(e),this.toastElement.appendChild(this.toastTitleElement))},e.prototype.setMessage=function(e){this.toastMessageElement?this.toastMessageElement.innerText=e:(this.toastMessageElement=this.createToastMessage(e),this.toastElement.appendChild(this.toastMessageElement))},e.prototype.createToastContainer=function(e){var t=document.createElement("div");return t.id="UnavailabilityToast",t.setAttribute("role","alert"),t.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;'),t.appendChild(this.createToastIcon(e)),t},e.prototype.createToastIcon=function(e){var t=document.createElement("span");if(t.id="UnavailabilityToastIcon",this.hasSpinner)!function(e,t){var n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),t?n.style.marginLeft="7px":n.style.marginRight="7px";var r=document.createElement("style");r.type="text/css";var i=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");r.appendChild(i),n.appendChild(r),e.appendChild(n)}(t,this.isRTL);else{var n=null!=e?e:this.OpenWorkbookIcon;t.setAttribute("style",'display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,'+n+'");'+this.elementsMargin)}return t},e.prototype.createToastTitle=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t},e.prototype.createToastMessage=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t},e}(),o=function(){function e(){}return e.createInstance=function(e,t,n,r,o,a){return new i(e,t,n,r,o,a)},e}(),a=function(){function e(){this.toast=void 0,this.isVisible=!1}return e.getInstance=function(){return r||(r=new e),r},e.prototype.showToast=function(e,t,n,r,i,a){if(!this.isVisible){if(!this.toast){var l=document.createElement("div");l.setAttribute("style",function(e){return"position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: "+(e?"40px":"8px")+";\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;"}(a)),document.body.appendChild(l),this.toast=o.createInstance(l,e,t,n,r,i),requestAnimationFrame((function(){l.style.opacity="1"}))}this.toast.setVisibility(!0),this.isVisible=!0}},e.prototype.dismissToast=function(){var e;null===(e=this.toast)||void 0===e||e.setVisibility(!1),this.isVisible=!1},e}();n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}))},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererFactoryGlobal=void 0;var r=n(77);t.CanvasRendererFactoryGlobal=new r.CanvasRendererFactory},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderFeaturesZIndex=t.HitTestEvents=void 0,t.HitTestEvents=["pointerdown","pointerup","click","mouseenter","mouseleave","touchstart","touchend","dblclick"],function(e){e[e.DebugWatermark=0]="DebugWatermark",e[e.Headers=1]="Headers",e[e.GeneralCellTooltip=2]="GeneralCellTooltip",e[e.DynamicImage=3]="DynamicImage",e[e.Comments=4]="Comments",e[e.RichError=5]="RichError",e[e.DrillIndicator=6]="DrillIndicator",e[e.Hyperlink=7]="Hyperlink",e[e.ColumnOrRowSelector=8]="ColumnOrRowSelector",e[e.TableSelector=9]="TableSelector",e[e.RichValueIcon=10]="RichValueIcon",e[e.AutoFilter=11]="AutoFilter"}(t.RenderFeaturesZIndex||(t.RenderFeaturesZIndex={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,n){return e.reduce((function(e,r){return e.then((function(){return n&&n.stop?Promise.resolve(void 0):t(r,n)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,n){void 0===n&&(n=0);if(n<0||n>5)return t;if(null==t||"object"!=typeof t)return t;var r={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(r[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(r[e]=t[e])}));var o={};return Object.keys(r).forEach((function(t){o[t]=e(r[t],n+1)})),o}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var r=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(r,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var n=Promise.reject(),r=function(t){n=n.catch((function(n){return e(t,n)}))},i=1;i<=t;i+=1)r(i);return n},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var n=t(e[0]),r=function(r){var i=e[r];n=n.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)r(i);return n},t.getQueryParameterByName=function(e,t){var n=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(n)return n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,n=t,r=e.length,i=0;i<r&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==r-1);i+=2)n=4294967295&((n<<5)+n^e.charCodeAt(i+1));var o=t+35685*n+(23896*n<<16)&4294967295;return o<0&&(o+=4294967296),o},t.getCharIndexInTextFromPoint=function(e,t,n){void 0===n&&(n=!1);var r=-1,i=null;if(void 0!==document.caretPositionFromPoint)null!==(o=document.caretPositionFromPoint(e,t))&&(r=o.offset,i=null!=o.offsetNode&&null!=o.offsetNode.parentElement&&"SPAN"===o.offsetNode.parentElement.nodeName?o.offsetNode.parentElement:o.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(o=document.caretRangeFromPoint(e,t))&&(r=o.startOffset,i=null!=o.startContainer&&null!=o.startContainer.parentElement&&"SPAN"===o.startContainer.parentElement.nodeName?o.startContainer.parentElement:o.startContainer)}else try{var o;i=document.elementFromPoint(e,t),(o=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(i),a.setEndPoint("EndToStart",o),r=a.text.length}catch(e){return r}if(n)for(var l=!1;null!=i;)null===i.previousSibling&&null!==i.parentNode&&null!==i.parentNode.parentNode&&i.parentNode.parentNode.childNodes.length>1&&!l?(i=i.parentNode,l=!0):null!=(i=i.previousSibling)&&null!=i.textContent&&(r+=i.textContent.length,l&&(r+=1));else for(;null!=i;)null!=(i=i.previousSibling)&&null!=i.textContent&&(r+=i.textContent.length);return r},t.getBoundingRectForText=function(e,t,n,r){function i(e,t,n){if(!e||!e.textContent)return t;if(r&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return n(e,t),t-e.textContent.length;for(var o=e.childNodes,a=0;a<o.length&&t>=0;a+=1)t=i(o[a],t,n),r&&"DIV"===o[a].nodeName&&(t-=1);return t}void 0===r&&(r=!1);var o=document.createRange();return i(e,t,(function(e,t){return o.setStart(e,t)})),i(e,n,(function(e,t){return o.setEnd(e,t)})),o.getBoundingClientRect()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,n,r){return t.traceTag(0,e,n,r)},traceTag:function(e,n,r,i){return t.traceTag(e,n,r,i)},debugTrace:function(e,n,r){return t.debugTraceTag(0,e,n,r)},debugTraceTag:function(e,n,r,i){return t.debugTraceTag(e,n,r,i)},assert:function(e,n,r){return t.assertTag(0,e,n,r)},assertTag:function(e,n,r,i){return t.assertTag(e,n,r,i)},shipAssert:function(e,n,r){return t.shipAssertTag(0,e,n,r)},shipAssertTag:function(e,n,r,i){return t.shipAssertTag(e,n,r,i)},dnmTrace:function(e,n,r){return t.dnmTraceTag(0,e,n,r)},dnmTraceTag:function(e,n,r,i){return t.dnmTraceTag(e,n,r,i)}}}}};var r=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,n,r){console.assert(n,"shipAssertTag:",e,t,r)},e.prototype.assertTag=function(e,t,n,r){console.assert(n,"assertTag",e,t,r)},e.prototype.traceTag=function(e,t,n,r){console.log("traceTag",e,r,t,n)},e.prototype.dnmTraceTag=function(e,t,n,r){console.log("dnmTraceTag",e,r,t,n)},e.prototype.debugTraceTag=function(e,t,n,r){console.log("debugTraceTag",e,r,t,n)},e}();t.ConsoleLogger=r;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var r={};t.promises=function(){return void 0===r.promises&&(r.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),r.promises}},function(e,t,n){"use strict";function r(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,n){e[t]=r()-n}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=r(),n=e,o=t,a={},l=function(e,t,r){return function(e,t,n,r,o,a){i(e,"end",n);var l={sessionName:t,result:r?"success":"failure",message:a,marks:e},s=JSON.stringify(l);o(s)}(a,n,o,e,t,r)};return a.start=0,{mark:function(e){return function(e){return i(a,e,o)}(e)},end:function(e){return l(!0,e)},success:function(e,t){return l(!0,e,t)},failure:function(e,t){return l(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,n){void 0!==e&&e.success(t,n)},t.failure=function(e,t,n){void 0!==e&&e.failure(t,n)},t.timeStamp=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var r=n(120),i={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return i},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");r.setChangeGatesManager({isChangeGateEnabled:e.isChangeGateEnabled}),i=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);r.__exportStar(n(121),t),r.__exportStar(n(122),t)},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){r=e};t.isChangeGateEnabled=function(e){return!r||r.isChangeGateEnabled(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var r=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(r=function(){return self.performance.now()}),function(n){var i=r(),o=n;return{reset:function(e){null!=e&&(o=e),i=r()},stop:function(n){var a=r()-i,l=JSON.stringify({Target:o,Duration:a.toFixed(t),StopInfo:n});e(l)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var r=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},n="undefined"!=typeof self?self:window,r=n.crypto||n.msCrypto;if(r){t.crypto=!0;try{return r.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var i=!1,o=n.performance;try{o&&o.now&&o.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(i){t.perfNow=!0;var l=Math.floor(100*o.now())%10;(l<0||l>9)&&(l=0);for(var s=0;s<l;s+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=15&e[n];return n+=1,("x"===t?r:3&r|8).toString(16)})),t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcBlockModel=void 0;var r=n(36),i=n(45),o=n(31),a=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,n=void 0,r=o.CellValueType.None,i=o.CellFormulaType.Value;e.Merge&&!e.Merge.IsOrigin||(n=e.Value,r=e.ValueType,i=e.FormulaInfo?e.FormulaInfo.FormulaType:o.CellFormulaType.Value);var a={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:n,ifmt:e.Ifmt||0,formulaType:i};return a.valueType=r,a},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[r.getCellLookupKey(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return i.isNullOrUndefined(this.Cells)?null:this.Cells[r.getCellLookupKey(e,t)]},e.prototype.reset=function(){this.index=0,i.isNullOrUndefined(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if(i.isNullOrUndefined(this.Cells)||i.isNullOrUndefined(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.columnNumberToTitle=t.createHeaderBlockModel=void 0;var r=n(4),i=n(31),o=n(36),a=n(83);function l(e){for(var t=e-1,n=[];t>=0;)n.unshift(String.fromCharCode(a.LetterA+t%a.AlphaRadix)),t=Math.floor(t/a.AlphaRadix)-1;return n.join("")}function s(e,t){var n=e+1;return{Row:t?e:0,Col:t?0:e,StyleID:i.UniqueHeadersStyleID.Default,BorderStyleID:i.UniqueHeadersStyleID.Default,HorizontalAlignmentSet:!1,ValueType:i.CellValueType.String,Text:t?n.toString():l(n)}}function d(e,t){var n=t?e.RowNumbers:e.ColumnNumbers;e.Cells=[];for(var r=0;r<n.length;r++){var i=s(n[r],t);e.Cells.push(i)}}function u(e){return o.verifyArgumentNotNull(e,"array","headerBlockModel.duplicateArray"),r.__spreadArray([],e)}t.createHeaderBlockModel=function(e,t){o.verifyArgumentNotNull(e,"gridModel","headerBlockModel.createHeaderBlockModel");var n={RenderFlagsArray:u(e.RenderFlagsArray),BlockHeight:t?e.BlockHeight:a.DefaultColHeaderHeight,BlockWidth:t?a.DefaultRowHeaderWidth:e.BlockWidth,IsRtl:e.IsRtl,ShowGridLines:!0,Fonts:a.HeadersFonts,Styles:a.HeadersStylesArray,ShowHeaders:e.ShowHeaders};return t?function(e,t){return function(e,t){t.RowNumbers=u(e.RowNumbers),t.RowOffsets=u(e.RowOffsets),t.RowHeights=u(e.RowHeights)}(e,t),d(t,!0),function(e){e.ColumnNumbers=[0],e.ColumnOffsets=[0],e.ColumnWidths=[a.DefaultRowHeaderWidth]}(t),t}(e,n):function(e,t){return function(e,t){t.ColumnNumbers=u(e.ColumnNumbers),t.ColumnOffsets=u(e.ColumnOffsets),t.ColumnWidths=u(e.ColumnWidths)}(e,t),d(t,!1),function(e){e.RowNumbers=[0],e.RowOffsets=[0],e.RowHeights=[a.DefaultColHeaderHeight]}(t),t}(e,n)},t.columnNumberToTitle=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Digit=t.ValueAnnonymizerRegex=t.CharacterReplaceValue=t.DigitPattern=t.DigitReplaceValue=t.AllowedCharactersToLog=t.SetCellOfInterestSymbols=t.CurrencySymbols=void 0,t.CurrencySymbols="$",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\s",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testHelper=t.areArraysEqual=t.areFormattedTextsEqual=t.areStylesEqual=t.areCellsEqual=t.compareGridBlockModels=void 0;var r=n(45),i=n(85),o=n(36),a=n(59),l=i.comparisonIgnoreLists.GridBlockModel.concat(["Cells"]).concat(i.comparisonIgnoreLists.RangeInformation).concat(i.comparisonIgnoreLists.PivotTableRangeInformation).concat(i.comparisonIgnoreLists.DynamicImageInformation).concat(i.comparisonIgnoreLists.Sparklines),s=i.comparisonIgnoreLists.Cell.concat(["Row","Col"]),d=s.concat(["Text"]),u=s.concat(["FormulaInfo"]),c=d.concat(["FormulaInfo"]),g=i.comparisonIgnoreLists.ReferencedObject,h=i.comparisonIgnoreLists.CellStyle.concat(g),f=h.concat(i.comparisonIgnoreLists.AutoFilter).concat(i.comparisonIgnoreLists.FormulaInformation).concat(i.comparisonIgnoreLists.MergeInformation).concat(i.comparisonIgnoreLists.TextRun).concat(i.comparisonIgnoreLists.Hyperlink).concat(i.comparisonIgnoreLists.LinkedEntityInformation).concat(i.comparisonIgnoreLists.PivotTableCellInformation),m=i.comparisonIgnoreLists.ReferencedObject,p=i.comparisonIgnoreLists.TextRun.concat(["Fonts"]);function C(e,t,n,r){e.CachedStyle=o.getReferencedObjectToCache(e.StyleID||0,n.Styles),t.CachedStyle=o.getReferencedObjectToCache(t.StyleID||0,r.Styles),e.CachedBorderStyle=o.getReferencedObjectToCache(e.BorderStyleID||0,n.BorderStyles),t.CachedBorderStyle=o.getReferencedObjectToCache(t.BorderStyleID||0,r.BorderStyles),e.CachedFont=o.getReferencedObjectToCache(e.CachedStyle.FontID||0,n.Fonts),t.CachedFont=o.getReferencedObjectToCache(t.CachedStyle.FontID||0,r.Fonts);var i=o.isAccAndCustomNumFmtApplicable(e)&&o.isAccAndCustomNumFmtApplicable(t);a.isChangeGateEnabled(a.ChangeGate.LastChangeGateDontDelete)?(w(e.TextRuns,n.Fonts),w(t.TextRuns,r.Fonts)):x(e.TextRuns,t.TextRuns,n.Fonts,r.Fonts);var l=y(e,t,function(e,t){var n;n=a.isChangeGateEnabled(a.ChangeGate.FormulaViewCellComparisonFix)?e?t?d:c:t?s:u:e?d:u;return n.concat(f)}(i,t.DisplayFormula));return l.isEqual||(l.message+="\nareCellsEqual: cell1.Row = "+e.Row+", cell1.Col = "+e.Col+", cell2.Row = "+t.Row+", cell2.Col = "+t.Col),l}function v(e,t,n,r){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: "+e.length+", length2: "+t.length};for(var i=0;i<e.length;i++){var o=y(e[i],t[i],n,r);if(!o.isEqual)return o.message+="\nareArraysEqual: array objects are different. index: "+i,o}return{isEqual:!0}}function y(e,t,n,i){if(e===t)return{isEqual:!0};if(r.isNullOrUndefined(e)&&r.isNullOrUndefined(t))return{isEqual:!0};if(null==e||null==t)return{isEqual:!1,message:"areObjectsEqual: one object is null, o1 = "+!e+", o2 = "+!t};if(e!=e)return{isEqual:t!=t,message:"areObjectsEqual: NaN comparison"};var o=function(e,t){if(!e||!t)return e||t;var n=t.filter((function(t){return-1===e.indexOf(t)}));return e.concat(n)}(T(e,n),T(t,n));if(0===o.length)return R(e)&&R(t)?{isEqual:!0}:e instanceof Date||e instanceof Number||e instanceof Boolean?{isEqual:e.valueOf()===t.valueOf(),message:"areObjectsEqual: simple object comparison"}:{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var l=0;l<o.length;l++){var s=o[l],d=e[s],u=t[s],c=typeof d,g=typeof u;if(!r.isNullOrUndefined(d)||!r.isNullOrUndefined(u)){if(c!==g){if(S(d)&&S(u))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = "+s+" type1 = "+c+", type2 = "+g}}switch(c){case"string":if(d!==u){if(!a.isChangeGateEnabled(a.ChangeGate.IgnoreCaseForDtoProperties)||!i||-1===i.indexOf(s))return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+s};if(d.toUpperCase()!==u.toUpperCase())return{isEqual:!1,message:"areObjectsEqual: ignore case comparison, propertyName = "+s}}break;case"undefined":case"boolean":case"number":if(d!==u)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+s};break;case"object":if(d instanceof Array){if(!(u instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+s};var h=F(s),f=a.isChangeGateEnabled(a.ChangeGate.IgnoreCaseForDtoProperties)?h.ignoreCaseList:void 0;if(!(m=v(d,u,h.ignoreList,f)).isEqual)return m.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+s,m}else{var m;h=F(s),f=a.isChangeGateEnabled(a.ChangeGate.IgnoreCaseForDtoProperties)?h.ignoreCaseList:void 0;if(!(m=y(d,u,h.ignoreList,f)).isEqual)return m.message+="\nareObjectsEqual: objects mismatch, propertyName = "+s,m}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: "+c+", propertyName = "+s}}}}return{isEqual:!0}}function T(e,t){if("object"!=typeof e)return[];var n=Object.getOwnPropertyNames(e);return t?n.filter((function(e){return-1===t.indexOf(e)})):n}function S(e){return a.isChangeGateEnabled(a.ChangeGate.TreatZeroAndUndefinedAsEqual)?null==e||""===e||!1===e||0===e:null==e||""===e||!1===e}function F(e){var t={ignoreList:void 0,ignoreCaseList:void 0},n=i.propertyToClassMap[e];if(!n)return t;for(var r=[],o=[],l=0;l<n.length;l++)r=r.concat(i.comparisonIgnoreLists[n[l]]),a.isChangeGateEnabled(a.ChangeGate.IgnoreCaseForDtoProperties)&&(o=o.concat(i.ignoreCaseLists[n[l]]));return t.ignoreList=r,t.ignoreCaseList=o,t}function x(e,t,n,r){if(e&&t&&e.length===t.length)for(var i=0;i<e.length;i++)e[i].CachedFont=o.getReferencedObjectToCache(e[i].FontID||0,n),t[i].CachedFont=o.getReferencedObjectToCache(t[i].FontID||0,r)}function w(e,t){if(e&&0!==e.length&&t)for(var n=0;n<e.length;n++)e[n].CachedFont=o.getReferencedObjectToCache(e[n].FontID||0,t)}function R(e){if("object"==typeof e&&e.constructor===Object){for(var t in e)return!1;return!0}return!1}t.compareGridBlockModels=function(e,t,n){var r=y(e,t,l);return r.isEqual?function(e,t,n){var r=e.Cells,i=t.Cells,l=0;if(r===i)return{isEqual:!0,canDiffRender:!0};var s=r.length,d=i.length,u=0,c=0,g=o.getDefaultCell(-1,-1,e.Styles,e.Fonts),h=[],f=!0,p="";for(;u<s||c<d;){var v,T=g,S=g,F=u,x=c;u>=s?(S=i[c],c++):c>=d||r[u].Row<i[c].Row||r[u].Row===i[c].Row&&r[u].Col<i[c].Col?(T=r[u],u++):r[u].Row!==i[c].Row||r[u].Col!==i[c].Col?(S=i[c],c++):(T=r[u],S=i[c],u++,c++),v=C(T,S,e,t);var w=-1===(null==T?void 0:T.Row)?null==S?void 0:S.Row:T.Row,R=-1===(null==T?void 0:T.Col)?null==S?void 0:S.Col:T.Col;if(!v.isEqual){if(f&&(f=!1,p+=v.message+"\n"),h.push(o.getCellLookupKey(w,R)),!y(T.CachedBorderStyle,S.CachedBorderStyle,m).isEqual||!y(T.HasError,S.HasError,void 0).isEqual){var b=[];a.isChangeGateEnabled(a.ChangeGate.AdjacentCellsMergeFix)?(-1!==T.Row&&(b=o.getAdjacentCellsKeys(e,T)),-1!==S.Row&&(b=b.concat(o.getAdjacentCellsKeys(t,S)))):b=o.getAdjacentCellsKeysOld(t,w,R),h=(h=(h=h.concat(b)).concat(o.getAllSpillingOverCells(r,b))).concat(o.getAllSpillingOverCells(i,b))}if(n&&++l>=n)return{isEqual:f,canDiffRender:!1,changedCellsKeys:void 0,message:p+" \n maxAllowedDiffRenderCells reached"};T!==g&&(h=h.concat(o.getAllSpanningCellsKeys(r,T,F))),S!==g&&(h=h.concat(o.getAllSpanningCellsKeys(i,S,x)))}}return{isEqual:f,canDiffRender:!0,changedCellsKeys:h.filter(o.uniqueValuesFilter),message:p}}(e,t,n):{isEqual:r.isEqual,message:r.message,canDiffRender:!1,changedCellsKeys:void 0}},t.areCellsEqual=C,t.areStylesEqual=function(e,t){return y(e,t,h)},t.areFormattedTextsEqual=function(e,t){if(e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};a.isChangeGateEnabled(a.ChangeGate.LastChangeGateDontDelete)?(w(e.TextRuns,e.Fonts),w(t.TextRuns,t.Fonts)):x(e.TextRuns,t.TextRuns,e.Fonts,t.Fonts)}return y(e,t,p)},t.areArraysEqual=v,t.testHelper={areObjectsEqual:function(e,t,n,r){return y(e,t,n,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellLog=t.getRangeLog=t.getRangeTopLeftCell=t.isModelCellContainedInRange=t.isCellContainedInRange=void 0,t.isCellContainedInRange=function(e,t){return(!e.NamedObjectName&&!t.NamedObjectName||e.NamedObjectName===t.NamedObjectName)&&((!e.SheetName&&!t.SheetName||e.SheetName===t.SheetName)&&(e.FirstColumn<=t.FirstColumn&&e.LastColumn>=t.FirstColumn&&e.FirstRow<=t.FirstRow&&e.LastRow>=t.FirstRow))},t.isModelCellContainedInRange=function(e,t,n){var r=e.ColumnNumbers[n.Col],i=e.RowNumbers[n.Row];return t.FirstColumn<=r&&t.LastColumn>=r&&t.FirstRow<=i&&t.LastRow>=i},t.getRangeTopLeftCell=function(e){return{SheetName:e.SheetName,NamedObjectName:e.NamedObjectName,FirstRow:e.FirstRow,FirstColumn:e.FirstColumn}},t.getRangeLog=function(e){return"("+e.FirstRow+"-"+e.LastRow+", "+e.FirstColumn+"-"+e.LastColumn+")"},t.getCellLog=function(e){return"("+e.FirstRow+","+e.FirstColumn+")"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVerticalAlignmentFontSizeAdjusted=void 0,t.getVerticalAlignmentFontSizeAdjusted=function(e){return 2*e/3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSkeletonCells=t.drawSkeleton=void 0;var r=n(3),i=n(2),o=n(0),a=n(5);function l(e,t,n,r,i){var o=Math.min(r/4,16),a=Math.min(i/4,8),l=t+r/2-o/2,s=n+i/2-a/2;e.fillRect(l,s,o,a)}t.drawSkeleton=function(e,t,n){o.verifyArgumentNotNull(e,"ctx","drawSkeleton"),o.verifyArgumentNotNull(t,"model","drawSkeleton"),o.verifyArgumentNotNull(n,"context","drawSkeleton");var a=t.ClientOnlyCache;if(o.verifyArgumentNotNull(a,"ClientOnlyCache","drawSkeleton"),o.verifyArgumentNotNull(a.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(a.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),o.verifyArgumentNotNull(t.RowHeights,"RowHeights","drawSkeleton"),o.verifyArgumentNotNull(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=r.SkeletonColor;for(var s=0;s<a.RowOffsetsAdjustedForDrawing.length-1;s++)for(var d=a.RowOffsetsAdjustedForDrawing[s],u=i.getRowHeightFromOffsets(s,a.RowOffsetsAdjustedForDrawing),c=0;c<a.ColOffsetsAdjustedForDrawing.length-1;c++){l(e,i.getColOffsetAdjustedForDrawing(c,t),d,i.getColWidthFromOffsets(c,a.ColOffsetsAdjustedForDrawing),u)}}},t.drawSkeletonCells=function(e,t,n){if(o.verifyArgumentNotNull(e,"ctx","drawSkeletonCells"),o.verifyArgumentNotNull(t,"model","drawSkeletonCells"),o.verifyArgumentNotNull(n,"context","drawSkeletonCells"),!(n.scaleFactor<r.MinimalScaleFactorForGridlinesRendering)){var s=t.ClientOnlyCache.CellsToRender;e.fillStyle=r.SkeletonCellsColor;for(var d=0;d<s.length;d++){var u=s[d];if((null==u?void 0:u.ShowSkeleton)&&i.cellIntersectsRenderingRegion(u,n.renderingRegion)){var c=a.getCellTopAdjustedForDrawing(t,u,!0),g=a.getCellHeightAdjustedForDrawing(t,u);l(e,a.getCellLeftAdjustedForDrawing(t,u,!1,!0),c,a.getCellWidthAdjustedForDrawing(t,u),g)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.highlightHitRegions=t.addWatermark=t.hitRegionsToHighlight=void 0;var r=n(1),i=n(0),o=n(20),a={red:{color:"Red",infoString:"Full render"},blue:{color:"Blue",infoString:"Full render from PLT cache"},green:{color:"Green",infoString:"Partial Rendering (Rendering only changed cells)"}};t.hitRegionsToHighlight={general:!1,toolTip:!1,cursor:!1,longPress:!1},t.addWatermark=function(e,t,n,l){var s=1*n.scaleFactor,d=5*n.scaleFactor,u=function(e,t){if(e)return a.blue;if(t)return a.green;return a.red}(n.modelFromCache,l);!function(e,t,n,r){e.beginPath(),e.lineWidth=1,e.setLineDash([]),e.strokeStyle="white",e.rect(t,t,n,n),e.strokeStyle=r.color,e.rect(t,t,n,n),e.stroke()}(t,s,d,u),r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&function(e,t,n,l,s){var d,u=r.getRenderingRegionHitTestCache(e,i.getRenderingRegionKey(t.renderingRegion)),c=2*l,g={isMirrored:e.IsRtl,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:n,y:n,width:c,height:c},isRtl:e.IsRtl,blockWidth:e.BlockWidth},h=null===(d=e.Cells)||void 0===d?void 0:d[0];h||(h=r.getDefaultCell(0,0));o.registerCursorHitRegion(h,u,g,"help",r.RenderFeaturesZIndex.DebugWatermark),o.registerTooltipHitRegion(h,u,g,function(e){var t="",n=e.color+" - "+e.infoString;return Object.keys(a).forEach((function(e){return t+=a[e].color+" - "+a[e].infoString+"\n"})),n+"\n\n"+t}(s),r.RenderFeaturesZIndex.DebugWatermark)}(e,n,s,d,u)},t.highlightHitRegions=function(e,n,o){var a=r.getRenderingRegionHitTestCache(e,i.getRenderingRegionKey(o));[a.CellHitRegions,a.CellCursorHitRegions,a.CellTooltipHitRegions,a.CellLongPressHitRegions].forEach((function(e){e&&Object.values(e).forEach((function(e){for(var r=0;r<e.length;r++){var i=e[r],o=i.region,a=o.x,l=o.y,s=o.width,d=o.height;i.eventType&&t.hitRegionsToHighlight.general&&(n.fillStyle="rgba(255, 255, 0, 0.2)",n.fillRect(a,l,s,d)),i.tooltipText&&t.hitRegionsToHighlight.toolTip&&(n.fillStyle="rgba(0, 255, 51, 0.2)",n.fillRect(a,l,s,d)),i.cursorType&&t.hitRegionsToHighlight.cursor&&(n.fillStyle="rgba(255, 0, 0, 0.2)",n.fillRect(a,l,s,d)),i.onStart&&t.hitRegionsToHighlight.longPress&&(n.fillStyle="rgba(236, 0, 255, 0.2)",n.fillRect(a,l,s,d))}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldAddRichValueIconPadding=void 0;var r=n(1),i=n(15);t.shouldAddRichValueIconPadding=function(e,t){if(!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e))return!1;var n=!!t.RichValueIcon&&!!t.AutoFilter;return e.IsRtl&&n&&!i.isTextAlignedOnButton(e,t.CachedStyle)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.classifyChar=void 0;var r=n(92);t.classifyChar=function(e){return 8205===e?r.CombiningClass.ZWJ:13===e?r.CombiningClass.CR:10===e?r.CombiningClass.LF:function(e){return 0<=e&&e<=9||11<=e&&e<=12||14<=e&&e<=31||127<=e&&e<=159||173===e||1564===e||6158===e||8203===e||8206<=e&&e<=8207||8232===e||8233===e||8234<=e&&e<=8238||8288<=e&&e<=8292||8293===e||8294<=e&&e<=8303||55296<=e&&e<=57343||65279===e||65520<=e&&e<=65528||65529<=e&&e<=65531||113824<=e&&e<=113827||119155<=e&&e<=119162||917504===e||917505===e||917506<=e&&e<=917535||917632<=e&&e<=917759||918e3<=e&&e<=921599}(e)?r.CombiningClass.Control:function(e){return 768<=e&&e<=879||1155<=e&&e<=1159||1160<=e&&e<=1161||1425<=e&&e<=1469||1471===e||1473<=e&&e<=1474||1476<=e&&e<=1477||1479===e||1552<=e&&e<=1562||1611<=e&&e<=1631||1648===e||1750<=e&&e<=1756||1759<=e&&e<=1764||1767<=e&&e<=1768||1770<=e&&e<=1773||1809===e||1840<=e&&e<=1866||1958<=e&&e<=1968||2027<=e&&e<=2035||2070<=e&&e<=2073||2075<=e&&e<=2083||2085<=e&&e<=2087||2089<=e&&e<=2093||2137<=e&&e<=2139||2260<=e&&e<=2273||2275<=e&&e<=2306||2362===e||2364===e||2369<=e&&e<=2376||2381===e||2385<=e&&e<=2391||2402<=e&&e<=2403||2433===e||2492===e||2494===e||2497<=e&&e<=2500||2509===e||2519===e||2530<=e&&e<=2531||2561<=e&&e<=2562||2620===e||2625<=e&&e<=2626||2631<=e&&e<=2632||2635<=e&&e<=2637||2641===e||2672<=e&&e<=2673||2677===e||2689<=e&&e<=2690||2748===e||2753<=e&&e<=2757||2759<=e&&e<=2760||2765===e||2786<=e&&e<=2787||2810<=e&&e<=2815||2817===e||2876===e||2878===e||2879===e||2881<=e&&e<=2884||2893===e||2902===e||2903===e||2914<=e&&e<=2915||2946===e||3006===e||3008===e||3021===e||3031===e||3072===e||3134<=e&&e<=3136||3142<=e&&e<=3144||3146<=e&&e<=3149||3157<=e&&e<=3158||3170<=e&&e<=3171||3201===e||3260===e||3263===e||3266===e||3270===e||3276<=e&&e<=3277||3285<=e&&e<=3286||3298<=e&&e<=3299||3328<=e&&e<=3329||3387<=e&&e<=3388||3390===e||3393<=e&&e<=3396||3405===e||3415===e||3426<=e&&e<=3427||3530===e||3535===e||3538<=e&&e<=3540||3542===e||3551===e||3633===e||3636<=e&&e<=3642||3655<=e&&e<=3662||3761===e||3764<=e&&e<=3769||3771<=e&&e<=3772||3784<=e&&e<=3789||3864<=e&&e<=3865||3893===e||3895===e||3897===e||3953<=e&&e<=3966||3968<=e&&e<=3972||3974<=e&&e<=3975||3981<=e&&e<=3991||3993<=e&&e<=4028||4038===e||4141<=e&&e<=4144||4146<=e&&e<=4151||4153<=e&&e<=4154||4157<=e&&e<=4158||4184<=e&&e<=4185||4190<=e&&e<=4192||4209<=e&&e<=4212||4226===e||4229<=e&&e<=4230||4237===e||4253===e||4957<=e&&e<=4959||5906<=e&&e<=5908||5938<=e&&e<=5940||5970<=e&&e<=5971||6002<=e&&e<=6003||6068<=e&&e<=6069||6071<=e&&e<=6077||6086===e||6089<=e&&e<=6099||6109===e||6155<=e&&e<=6157||6277<=e&&e<=6278||6313===e||6432<=e&&e<=6434||6439<=e&&e<=6440||6450===e||6457<=e&&e<=6459||6679<=e&&e<=6680||6683===e||6742===e||6744<=e&&e<=6750||6752===e||6754===e||6757<=e&&e<=6764||6771<=e&&e<=6780||6783===e||6832<=e&&e<=6845||6846===e||6912<=e&&e<=6915||6964===e||6966<=e&&e<=6970||6972===e||6978===e||7019<=e&&e<=7027||7040<=e&&e<=7041||7074<=e&&e<=7077||7080<=e&&e<=7081||7083<=e&&e<=7085||7142===e||7144<=e&&e<=7145||7149===e||7151<=e&&e<=7153||7212<=e&&e<=7219||7222<=e&&e<=7223||7376<=e&&e<=7378||7380<=e&&e<=7392||7394<=e&&e<=7400||7405===e||7412===e||7416<=e&&e<=7417||7616<=e&&e<=7673||7675<=e&&e<=7679||8204===e||8400<=e&&e<=8412||8413<=e&&e<=8416||8417===e||8418<=e&&e<=8420||8421<=e&&e<=8432||11503<=e&&e<=11505||11647===e||11744<=e&&e<=11775||12330<=e&&e<=12333||12334<=e&&e<=12335||12441<=e&&e<=12442||42607===e||42608<=e&&e<=42610||42612<=e&&e<=42621||42654<=e&&e<=42655||42736<=e&&e<=42737||43010===e||43014===e||43019===e||43045<=e&&e<=43046||43204<=e&&e<=43205||43232<=e&&e<=43249||43302<=e&&e<=43309||43335<=e&&e<=43345||43392<=e&&e<=43394||43443===e||43446<=e&&e<=43449||43452===e||43493===e||43561<=e&&e<=43566||43569<=e&&e<=43570||43573<=e&&e<=43574||43587===e||43596===e||43644===e||43696===e||43698<=e&&e<=43700||43703<=e&&e<=43704||43710<=e&&e<=43711||43713===e||43756<=e&&e<=43757||43766===e||44005===e||44008===e||44013===e||64286===e||65024<=e&&e<=65039||65056<=e&&e<=65071||65438<=e&&e<=65439||66045===e||66272===e||66422<=e&&e<=66426||68097<=e&&e<=68099||68101<=e&&e<=68102||68108<=e&&e<=68111||68152<=e&&e<=68154||68159===e||68325<=e&&e<=68326||69633===e||69688<=e&&e<=69702||69759<=e&&e<=69761||69811<=e&&e<=69814||69817<=e&&e<=69818||69888<=e&&e<=69890||69927<=e&&e<=69931||69933<=e&&e<=69940||70003===e||70016<=e&&e<=70017||70070<=e&&e<=70078||70090<=e&&e<=70092||70191<=e&&e<=70193||70196===e||70198<=e&&e<=70199||70206===e||70367===e||70371<=e&&e<=70378||70400<=e&&e<=70401||70460===e||70462===e||70464===e||70487===e||70502<=e&&e<=70508||70512<=e&&e<=70516||70712<=e&&e<=70719||70722<=e&&e<=70724||70726===e||70832===e||70835<=e&&e<=70840||70842===e||70845===e||70847<=e&&e<=70848||70850<=e&&e<=70851||71087===e||71090<=e&&e<=71093||71100<=e&&e<=71101||71103<=e&&e<=71104||71132<=e&&e<=71133||71219<=e&&e<=71226||71229===e||71231<=e&&e<=71232||71339===e||71341===e||71344<=e&&e<=71349||71351===e||71453<=e&&e<=71455||71458<=e&&e<=71461||71463<=e&&e<=71467||72193<=e&&e<=72198||72201<=e&&e<=72202||72243<=e&&e<=72248||72251<=e&&e<=72254||72263===e||72273<=e&&e<=72278||72281<=e&&e<=72283||72330<=e&&e<=72342||72344<=e&&e<=72345||72752<=e&&e<=72758||72760<=e&&e<=72765||72767===e||72850<=e&&e<=72871||72874<=e&&e<=72880||72882<=e&&e<=72883||72885<=e&&e<=72886||73009<=e&&e<=73014||73018===e||73020<=e&&e<=73021||73023<=e&&e<=73029||73031===e||92912<=e&&e<=92916||92976<=e&&e<=92982||94095<=e&&e<=94098||113821<=e&&e<=113822||119141===e||119143<=e&&e<=119145||119150<=e&&e<=119154||119163<=e&&e<=119170||119173<=e&&e<=119179||119210<=e&&e<=119213||119362<=e&&e<=119364||121344<=e&&e<=121398||121403<=e&&e<=121452||121461===e||121476===e||121499<=e&&e<=121503||121505<=e&&e<=121519||122880<=e&&e<=122886||122888<=e&&e<=122904||122907<=e&&e<=122913||122915<=e&&e<=122916||122918<=e&&e<=122922||125136<=e&&e<=125142||125252<=e&&e<=125258||917536<=e&&e<=917631||917760<=e&&e<=917999}(e)?r.CombiningClass.Extend:function(e){return 127462<=e&&e<=127487}(e)?r.CombiningClass.Regional_Indicator:function(e){return 2307===e||2363===e||2366<=e&&e<=2368||2377<=e&&e<=2380||2382<=e&&e<=2383||2434<=e&&e<=2435||2495<=e&&e<=2496||2503<=e&&e<=2504||2507<=e&&e<=2508||2563===e||2622<=e&&e<=2624||2691===e||2750<=e&&e<=2752||2761===e||2763<=e&&e<=2764||2818<=e&&e<=2819||2880===e||2887<=e&&e<=2888||2891<=e&&e<=2892||3007===e||3009<=e&&e<=3010||3014<=e&&e<=3016||3018<=e&&e<=3020||3073<=e&&e<=3075||3137<=e&&e<=3140||3202<=e&&e<=3203||3262===e||3264<=e&&e<=3265||3267<=e&&e<=3268||3271<=e&&e<=3272||3274<=e&&e<=3275||3330<=e&&e<=3331||3391<=e&&e<=3392||3398<=e&&e<=3400||3402<=e&&e<=3404||3458<=e&&e<=3459||3536<=e&&e<=3537||3544<=e&&e<=3550||3570<=e&&e<=3571||3635===e||3763===e||3902<=e&&e<=3903||3967===e||4145===e||4155<=e&&e<=4156||4182<=e&&e<=4183||4228===e||6070===e||6078<=e&&e<=6085||6087<=e&&e<=6088||6435<=e&&e<=6438||6441<=e&&e<=6443||6448<=e&&e<=6449||6451<=e&&e<=6456||6681<=e&&e<=6682||6741===e||6743===e||6765<=e&&e<=6770||6916===e||6965===e||6971===e||6973<=e&&e<=6977||6979<=e&&e<=6980||7042===e||7073===e||7078<=e&&e<=7079||7082===e||7143===e||7146<=e&&e<=7148||7150===e||7154<=e&&e<=7155||7204<=e&&e<=7211||7220<=e&&e<=7221||7393===e||7410<=e&&e<=7411||7415===e||43043<=e&&e<=43044||43047===e||43136<=e&&e<=43137||43188<=e&&e<=43203||43346<=e&&e<=43347||43395===e||43444<=e&&e<=43445||43450<=e&&e<=43451||43453<=e&&e<=43456||43567<=e&&e<=43568||43571<=e&&e<=43572||43597===e||43755===e||43758<=e&&e<=43759||43765===e||44003<=e&&e<=44004||44006<=e&&e<=44007||44009<=e&&e<=44010||44012===e||69632===e||69634===e||69762===e||69808<=e&&e<=69810||69815<=e&&e<=69816||69932===e||70018===e||70067<=e&&e<=70069||70079<=e&&e<=70080||70188<=e&&e<=70190||70194<=e&&e<=70195||70197===e||70368<=e&&e<=70370||70402<=e&&e<=70403||70463===e||70465<=e&&e<=70468||70471<=e&&e<=70472||70475<=e&&e<=70477||70498<=e&&e<=70499||70709<=e&&e<=70711||70720<=e&&e<=70721||70725===e||70833<=e&&e<=70834||70841===e||70843<=e&&e<=70844||70846===e||70849===e||71088<=e&&e<=71089||71096<=e&&e<=71099||71102===e||71216<=e&&e<=71218||71227<=e&&e<=71228||71230===e||71340===e||71342<=e&&e<=71343||71350===e||71456<=e&&e<=71457||71462===e||72199<=e&&e<=72200||72249===e||72279<=e&&e<=72280||72343===e||72751===e||72766===e||72873===e||72881===e||72884===e||94033<=e&&e<=94078||119142===e||119149===e}(e)?r.CombiningClass.SpacingMark:function(e){return 4352<=e&&e<=4447||43360<=e&&e<=43388}(e)?r.CombiningClass.L:function(e){return 44033<=e&&e<=44059||44061<=e&&e<=44087||44089<=e&&e<=44115||44117<=e&&e<=44143||44145<=e&&e<=44171||44173<=e&&e<=44199||44201<=e&&e<=44227||44229<=e&&e<=44255||44257<=e&&e<=44283||44285<=e&&e<=44311||44313<=e&&e<=44339||44341<=e&&e<=44367||44369<=e&&e<=44395||44397<=e&&e<=44423||44425<=e&&e<=44451||44453<=e&&e<=44479||44481<=e&&e<=44507||44509<=e&&e<=44535||44537<=e&&e<=44563||44565<=e&&e<=44591||44593<=e&&e<=44619||44621<=e&&e<=44647||44649<=e&&e<=44675||44677<=e&&e<=44703||44705<=e&&e<=44731||44733<=e&&e<=44759||44761<=e&&e<=44787||44789<=e&&e<=44815||44817<=e&&e<=44843||44845<=e&&e<=44871||44873<=e&&e<=44899||44901<=e&&e<=44927||44929<=e&&e<=44955||44957<=e&&e<=44983||44985<=e&&e<=45011||45013<=e&&e<=45039||45041<=e&&e<=45067||45069<=e&&e<=45095||45097<=e&&e<=45123||45125<=e&&e<=45151||45153<=e&&e<=45179||45181<=e&&e<=45207||45209<=e&&e<=45235||45237<=e&&e<=45263||45265<=e&&e<=45291||45293<=e&&e<=45319||45321<=e&&e<=45347||45349<=e&&e<=45375||45377<=e&&e<=45403||45405<=e&&e<=45431||45433<=e&&e<=45459||45461<=e&&e<=45487||45489<=e&&e<=45515||45517<=e&&e<=45543||45545<=e&&e<=45571||45573<=e&&e<=45599||45601<=e&&e<=45627||45629<=e&&e<=45655||45657<=e&&e<=45683||45685<=e&&e<=45711||45713<=e&&e<=45739||45741<=e&&e<=45767||45769<=e&&e<=45795||45797<=e&&e<=45823||45825<=e&&e<=45851||45853<=e&&e<=45879||45881<=e&&e<=45907||45909<=e&&e<=45935||45937<=e&&e<=45963||45965<=e&&e<=45991||45993<=e&&e<=46019||46021<=e&&e<=46047||46049<=e&&e<=46075||46077<=e&&e<=46103||46105<=e&&e<=46131||46133<=e&&e<=46159||46161<=e&&e<=46187||46189<=e&&e<=46215||46217<=e&&e<=46243||46245<=e&&e<=46271||46273<=e&&e<=46299||46301<=e&&e<=46327||46329<=e&&e<=46355||46357<=e&&e<=46383||46385<=e&&e<=46411||46413<=e&&e<=46439||46441<=e&&e<=46467||46469<=e&&e<=46495||46497<=e&&e<=46523||46525<=e&&e<=46551||46553<=e&&e<=46579||46581<=e&&e<=46607||46609<=e&&e<=46635||46637<=e&&e<=46663||46665<=e&&e<=46691||46693<=e&&e<=46719||46721<=e&&e<=46747||46749<=e&&e<=46775||46777<=e&&e<=46803||46805<=e&&e<=46831||46833<=e&&e<=46859||46861<=e&&e<=46887||46889<=e&&e<=46915||46917<=e&&e<=46943||46945<=e&&e<=46971||46973<=e&&e<=46999||47001<=e&&e<=47027||47029<=e&&e<=47055||47057<=e&&e<=47083||47085<=e&&e<=47111||47113<=e&&e<=47139||47141<=e&&e<=47167||47169<=e&&e<=47195||47197<=e&&e<=47223||47225<=e&&e<=47251||47253<=e&&e<=47279||47281<=e&&e<=47307||47309<=e&&e<=47335||47337<=e&&e<=47363||47365<=e&&e<=47391||47393<=e&&e<=47419||47421<=e&&e<=47447||47449<=e&&e<=47475||47477<=e&&e<=47503||47505<=e&&e<=47531||47533<=e&&e<=47559||47561<=e&&e<=47587||47589<=e&&e<=47615||47617<=e&&e<=47643||47645<=e&&e<=47671||47673<=e&&e<=47699||47701<=e&&e<=47727||47729<=e&&e<=47755||47757<=e&&e<=47783||47785<=e&&e<=47811||47813<=e&&e<=47839||47841<=e&&e<=47867||47869<=e&&e<=47895||47897<=e&&e<=47923||47925<=e&&e<=47951||47953<=e&&e<=47979||47981<=e&&e<=48007||48009<=e&&e<=48035||48037<=e&&e<=48063||48065<=e&&e<=48091||48093<=e&&e<=48119||48121<=e&&e<=48147||48149<=e&&e<=48175||48177<=e&&e<=48203||48205<=e&&e<=48231||48233<=e&&e<=48259||48261<=e&&e<=48287||48289<=e&&e<=48315||48317<=e&&e<=48343||48345<=e&&e<=48371||48373<=e&&e<=48399||48401<=e&&e<=48427||48429<=e&&e<=48455||48457<=e&&e<=48483||48485<=e&&e<=48511||48513<=e&&e<=48539||48541<=e&&e<=48567||48569<=e&&e<=48595||48597<=e&&e<=48623||48625<=e&&e<=48651||48653<=e&&e<=48679||48681<=e&&e<=48707||48709<=e&&e<=48735||48737<=e&&e<=48763||48765<=e&&e<=48791||48793<=e&&e<=48819||48821<=e&&e<=48847||48849<=e&&e<=48875||48877<=e&&e<=48903||48905<=e&&e<=48931||48933<=e&&e<=48959||48961<=e&&e<=48987||48989<=e&&e<=49015||49017<=e&&e<=49043||49045<=e&&e<=49071||49073<=e&&e<=49099||49101<=e&&e<=49127||49129<=e&&e<=49155||49157<=e&&e<=49183||49185<=e&&e<=49211||49213<=e&&e<=49239||49241<=e&&e<=49267||49269<=e&&e<=49295||49297<=e&&e<=49323||49325<=e&&e<=49351||49353<=e&&e<=49379||49381<=e&&e<=49407||49409<=e&&e<=49435||49437<=e&&e<=49463||49465<=e&&e<=49491||49493<=e&&e<=49519||49521<=e&&e<=49547||49549<=e&&e<=49575||49577<=e&&e<=49603||49605<=e&&e<=49631||49633<=e&&e<=49659||49661<=e&&e<=49687||49689<=e&&e<=49715||49717<=e&&e<=49743||49745<=e&&e<=49771||49773<=e&&e<=49799||49801<=e&&e<=49827||49829<=e&&e<=49855||49857<=e&&e<=49883||49885<=e&&e<=49911||49913<=e&&e<=49939||49941<=e&&e<=49967||49969<=e&&e<=49995||49997<=e&&e<=50023||50025<=e&&e<=50051||50053<=e&&e<=50079||50081<=e&&e<=50107||50109<=e&&e<=50135||50137<=e&&e<=50163||50165<=e&&e<=50191||50193<=e&&e<=50219||50221<=e&&e<=50247||50249<=e&&e<=50275||50277<=e&&e<=50303||50305<=e&&e<=50331||50333<=e&&e<=50359||50361<=e&&e<=50387||50389<=e&&e<=50415||50417<=e&&e<=50443||50445<=e&&e<=50471||50473<=e&&e<=50499||50501<=e&&e<=50527||50529<=e&&e<=50555||50557<=e&&e<=50583||50585<=e&&e<=50611||50613<=e&&e<=50639||50641<=e&&e<=50667||50669<=e&&e<=50695||50697<=e&&e<=50723||50725<=e&&e<=50751||50753<=e&&e<=50779||50781<=e&&e<=50807||50809<=e&&e<=50835||50837<=e&&e<=50863||50865<=e&&e<=50891||50893<=e&&e<=50919||50921<=e&&e<=50947||50949<=e&&e<=50975||50977<=e&&e<=51003||51005<=e&&e<=51031||51033<=e&&e<=51059||51061<=e&&e<=51087||51089<=e&&e<=51115||51117<=e&&e<=51143||51145<=e&&e<=51171||51173<=e&&e<=51199||51201<=e&&e<=51227||51229<=e&&e<=51255||51257<=e&&e<=51283||51285<=e&&e<=51311||51313<=e&&e<=51339||51341<=e&&e<=51367||51369<=e&&e<=51395||51397<=e&&e<=51423||51425<=e&&e<=51451||51453<=e&&e<=51479||51481<=e&&e<=51507||51509<=e&&e<=51535||51537<=e&&e<=51563||51565<=e&&e<=51591||51593<=e&&e<=51619||51621<=e&&e<=51647||51649<=e&&e<=51675||51677<=e&&e<=51703||51705<=e&&e<=51731||51733<=e&&e<=51759||51761<=e&&e<=51787||51789<=e&&e<=51815||51817<=e&&e<=51843||51845<=e&&e<=51871||51873<=e&&e<=51899||51901<=e&&e<=51927||51929<=e&&e<=51955||51957<=e&&e<=51983||51985<=e&&e<=52011||52013<=e&&e<=52039||52041<=e&&e<=52067||52069<=e&&e<=52095||52097<=e&&e<=52123||52125<=e&&e<=52151||52153<=e&&e<=52179||52181<=e&&e<=52207||52209<=e&&e<=52235||52237<=e&&e<=52263||52265<=e&&e<=52291||52293<=e&&e<=52319||52321<=e&&e<=52347||52349<=e&&e<=52375||52377<=e&&e<=52403||52405<=e&&e<=52431||52433<=e&&e<=52459||52461<=e&&e<=52487||52489<=e&&e<=52515||52517<=e&&e<=52543||52545<=e&&e<=52571||52573<=e&&e<=52599||52601<=e&&e<=52627||52629<=e&&e<=52655||52657<=e&&e<=52683||52685<=e&&e<=52711||52713<=e&&e<=52739||52741<=e&&e<=52767||52769<=e&&e<=52795||52797<=e&&e<=52823||52825<=e&&e<=52851||52853<=e&&e<=52879||52881<=e&&e<=52907||52909<=e&&e<=52935||52937<=e&&e<=52963||52965<=e&&e<=52991||52993<=e&&e<=53019||53021<=e&&e<=53047||53049<=e&&e<=53075||53077<=e&&e<=53103||53105<=e&&e<=53131||53133<=e&&e<=53159||53161<=e&&e<=53187||53189<=e&&e<=53215||53217<=e&&e<=53243||53245<=e&&e<=53271||53273<=e&&e<=53299||53301<=e&&e<=53327||53329<=e&&e<=53355||53357<=e&&e<=53383||53385<=e&&e<=53411||53413<=e&&e<=53439||53441<=e&&e<=53467||53469<=e&&e<=53495||53497<=e&&e<=53523||53525<=e&&e<=53551||53553<=e&&e<=53579||53581<=e&&e<=53607||53609<=e&&e<=53635||53637<=e&&e<=53663||53665<=e&&e<=53691||53693<=e&&e<=53719||53721<=e&&e<=53747||53749<=e&&e<=53775||53777<=e&&e<=53803||53805<=e&&e<=53831||53833<=e&&e<=53859||53861<=e&&e<=53887||53889<=e&&e<=53915||53917<=e&&e<=53943||53945<=e&&e<=53971||53973<=e&&e<=53999||54001<=e&&e<=54027||54029<=e&&e<=54055||54057<=e&&e<=54083||54085<=e&&e<=54111||54113<=e&&e<=54139||54141<=e&&e<=54167||54169<=e&&e<=54195||54197<=e&&e<=54223||54225<=e&&e<=54251||54253<=e&&e<=54279||54281<=e&&e<=54307||54309<=e&&e<=54335||54337<=e&&e<=54363||54365<=e&&e<=54391||54393<=e&&e<=54419||54421<=e&&e<=54447||54449<=e&&e<=54475||54477<=e&&e<=54503||54505<=e&&e<=54531||54533<=e&&e<=54559||54561<=e&&e<=54587||54589<=e&&e<=54615||54617<=e&&e<=54643||54645<=e&&e<=54671||54673<=e&&e<=54699||54701<=e&&e<=54727||54729<=e&&e<=54755||54757<=e&&e<=54783||54785<=e&&e<=54811||54813<=e&&e<=54839||54841<=e&&e<=54867||54869<=e&&e<=54895||54897<=e&&e<=54923||54925<=e&&e<=54951||54953<=e&&e<=54979||54981<=e&&e<=55007||55009<=e&&e<=55035||55037<=e&&e<=55063||55065<=e&&e<=55091||55093<=e&&e<=55119||55121<=e&&e<=55147||55149<=e&&e<=55175||55177<=e&&e<=55203}(e)?r.CombiningClass.LVT:function(e){return 4448<=e&&e<=4519||55216<=e&&e<=55238}(e)?r.CombiningClass.V:function(e){return 4520<=e&&e<=4607||55243<=e&&e<=55291}(e)?r.CombiningClass.T:function(e){return 44032===e||44060===e||44088===e||44116===e||44144===e||44172===e||44200===e||44228===e||44256===e||44284===e||44312===e||44340===e||44368===e||44396===e||44424===e||44452===e||44480===e||44508===e||44536===e||44564===e||44592===e||44620===e||44648===e||44676===e||44704===e||44732===e||44760===e||44788===e||44816===e||44844===e||44872===e||44900===e||44928===e||44956===e||44984===e||45012===e||45040===e||45068===e||45096===e||45124===e||45152===e||45180===e||45208===e||45236===e||45264===e||45292===e||45320===e||45348===e||45376===e||45404===e||45432===e||45460===e||45488===e||45516===e||45544===e||45572===e||45600===e||45628===e||45656===e||45684===e||45712===e||45740===e||45768===e||45796===e||45824===e||45852===e||45880===e||45908===e||45936===e||45964===e||45992===e||46020===e||46048===e||46076===e||46104===e||46132===e||46160===e||46188===e||46216===e||46244===e||46272===e||46300===e||46328===e||46356===e||46384===e||46412===e||46440===e||46468===e||46496===e||46524===e||46552===e||46580===e||46608===e||46636===e||46664===e||46692===e||46720===e||46748===e||46776===e||46804===e||46832===e||46860===e||46888===e||46916===e||46944===e||46972===e||47e3===e||47028===e||47056===e||47084===e||47112===e||47140===e||47168===e||47196===e||47224===e||47252===e||47280===e||47308===e||47336===e||47364===e||47392===e||47420===e||47448===e||47476===e||47504===e||47532===e||47560===e||47588===e||47616===e||47644===e||47672===e||47700===e||47728===e||47756===e||47784===e||47812===e||47840===e||47868===e||47896===e||47924===e||47952===e||47980===e||48008===e||48036===e||48064===e||48092===e||48120===e||48148===e||48176===e||48204===e||48232===e||48260===e||48288===e||48316===e||48344===e||48372===e||48400===e||48428===e||48456===e||48484===e||48512===e||48540===e||48568===e||48596===e||48624===e||48652===e||48680===e||48708===e||48736===e||48764===e||48792===e||48820===e||48848===e||48876===e||48904===e||48932===e||48960===e||48988===e||49016===e||49044===e||49072===e||49100===e||49128===e||49156===e||49184===e||49212===e||49240===e||49268===e||49296===e||49324===e||49352===e||49380===e||49408===e||49436===e||49464===e||49492===e||49520===e||49548===e||49576===e||49604===e||49632===e||49660===e||49688===e||49716===e||49744===e||49772===e||49800===e||49828===e||49856===e||49884===e||49912===e||49940===e||49968===e||49996===e||50024===e||50052===e||50080===e||50108===e||50136===e||50164===e||50192===e||50220===e||50248===e||50276===e||50304===e||50332===e||50360===e||50388===e||50416===e||50444===e||50472===e||50500===e||50528===e||50556===e||50584===e||50612===e||50640===e||50668===e||50696===e||50724===e||50752===e||50780===e||50808===e||50836===e||50864===e||50892===e||50920===e||50948===e||50976===e||51004===e||51032===e||51060===e||51088===e||51116===e||51144===e||51172===e||51200===e||51228===e||51256===e||51284===e||51312===e||51340===e||51368===e||51396===e||51424===e||51452===e||51480===e||51508===e||51536===e||51564===e||51592===e||51620===e||51648===e||51676===e||51704===e||51732===e||51760===e||51788===e||51816===e||51844===e||51872===e||51900===e||51928===e||51956===e||51984===e||52012===e||52040===e||52068===e||52096===e||52124===e||52152===e||52180===e||52208===e||52236===e||52264===e||52292===e||52320===e||52348===e||52376===e||52404===e||52432===e||52460===e||52488===e||52516===e||52544===e||52572===e||52600===e||52628===e||52656===e||52684===e||52712===e||52740===e||52768===e||52796===e||52824===e||52852===e||52880===e||52908===e||52936===e||52964===e||52992===e||53020===e||53048===e||53076===e||53104===e||53132===e||53160===e||53188===e||53216===e||53244===e||53272===e||53300===e||53328===e||53356===e||53384===e||53412===e||53440===e||53468===e||53496===e||53524===e||53552===e||53580===e||53608===e||53636===e||53664===e||53692===e||53720===e||53748===e||53776===e||53804===e||53832===e||53860===e||53888===e||53916===e||53944===e||53972===e||54e3===e||54028===e||54056===e||54084===e||54112===e||54140===e||54168===e||54196===e||54224===e||54252===e||54280===e||54308===e||54336===e||54364===e||54392===e||54420===e||54448===e||54476===e||54504===e||54532===e||54560===e||54588===e||54616===e||54644===e||54672===e||54700===e||54728===e||54756===e||54784===e||54812===e||54840===e||54868===e||54896===e||54924===e||54952===e||54980===e||55008===e||55036===e||55064===e||55092===e||55120===e||55148===e||55176===e}(e)?r.CombiningClass.LV:r.CombiningClass.Other}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reorderTextTokensUsingDom=void 0;var r=n(48),i=n(2);t.reorderTextTokensUsingDom=function(e,t,n,o){for(var a=i.getReOrderDiv(n,o),l=0;l<e.textLines.length;l++){var s=e.textLines[l],d=e.tokensPerLine[l],u=r.analyzeBidiText(s.text,t);if(n.HasBidi)if(u.HasRtl&&!u.HasLtr)d.tokens.reverse();else{(f=document.createElement("div")).setAttribute("textLineId",l.toString());for(var c=0;c<d.tokens.length;c++){var g=d.tokens[c].text;(y=document.createElement("span")).innerText=g,y.setAttribute("textTokenId",c.toString()),f.appendChild(y)}a.appendChild(f)}}document.body.appendChild(a);for(var h=0;h<a.children.length;h++){var f,m=(f=a.children[h]).getAttribute("textLineId");if(!m)throw Error("reorderTextTokensUsingDom: textLineIndexAttr is undefined");for(var p=parseInt(m,10),C=e.tokensPerLine[p].tokens,v=0;v<f.children.length;v++){var y,T=(y=f.children[v]).getAttribute("textTokenId");if(!T)throw Error("reorderTextTokensUsingDom: tokenIndexAttr is undefined");var S=y.getBoundingClientRect().left;C[c=parseInt(T,10)].OffsetX=S}C.sort((function(e,t){return e.OffsetX-t.OffsetX}))}document.body.removeChild(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawWrapText=void 0;var r=n(2),i=n(30),o=n(1),a=n(6),l=n(29),s=n(23),d=n(66),u=n(141),c=n(65),g=n(3),h=n(7),f=n(67),m=n(13),p=n(39),C=n(11),v=n(93),y=n(53),T=n(68),S=n(70),F=n(9);function x(e,t,n,r,i,o,a,l){var s=l?e+t-n-r:e-n;return a&&(s=p.getAdvancedVerticalAlignmentOffsetYForWrapText(s,i,o)),s}function w(e,t,n,r){return e&&!t.HasRtl?0===n:n===r-1}t.drawWrapText=function(e,t,n,R,b,I,A,P,D,M,O,k,L){var H,E,B,N=C.shouldRenderVerticalText(R),W=N?r.getTextDrawingMaxHeight(M,v.getVerticalTextPadding((null===(H=R.CachedStyle)||void 0===H?void 0:H.Indentation)||0)):M;if(!(A<=0||W<=0)){var z=N?k:e.measureText(g.Whitespace).width,j=R.WrapText,_=function(e){var t;if(C.shouldRenderVerticalText(e))return function(e){switch(e){case o.VerticalAlignment.Justify:return i.BreakType.Justify;case o.VerticalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}(e.CachedStyle.VerticalAlignment);return function(e){switch(e){case o.HorizontalAlignment.Justify:return i.BreakType.Justify;case o.HorizontalAlignment.JustifyDistributed:case o.HorizontalAlignment.Distributed:return i.BreakType.Distributed;default:return i.BreakType.Wrap}}((null===(t=e.CachedStyle)||void 0===t?void 0:t.HorizontalAlignment)||o.HorizontalAlignment.Automatic)}(R),V=(N?W:A)-a.getWrapTextAdditionalPadding(n,R,t);_===i.BreakType.Distributed&&(V-=a.getIndentationPaddingPx(R.CachedStyle.Indentation||0));var U=d.breakTextToLines(e,b,V,_,z,n,R,L,j),G=a.getBidiContext(R);N&&f.adjustOrderingOfLinesForVerticalText(R,U,G);var q=U.textLines,Y=function(e,t,n,r){var i=[],o=[],l=[];o=[0],l=[0];var d=0;if(n)for(var u=0;u<t.length;u++){var c=t.length-1-u,g=t[c],h=s.substringFormattedText(n,g.startIndex,g.endIndex);i[u]=h;var f=a.getFormattedTextLineFontMetrics(e,h);l[u]=f.baseline;var m=a.getFormattedTextLineHeight(e,h);o[u+1]=o[u]+m,d+=m}else o=function(e,t){for(var n=[],r=0;r<e;r++)n.push(r*t);return n}(t.length,r),d=r*t.length;return{rowsBottomY:o,rowsAlphabeticY:l,textHeight:d,formattedLines:i}}(n,q,L,k),J=Y.rowsBottomY,X=Y.rowsAlphabeticY,K=Y.textHeight,Z=Y.formattedLines,Q=o.isRenderFlagEnabled(o.RenderFlagsArray.PhoneticSlice1,n)&&!h.isNullOrUndefined(R.PhonInfo),$=U.requireClipping||O||Q||function(e,t,n,r){return e&&t<n*r}(N,D,k,q.length),ee=void 0;$&&(ee=P);var te=e.textAlign,ne=e.textBaseline,re=!1;m.isHorizontalAlignmentJustifiedAndDistributed(R)&&!N&&(e.textAlign="left",e.textBaseline="alphabetic",re=!0,G.HasRtl&&c.reorderTextTokens(U,(null===(E=R.CachedStyle)||void 0===E?void 0:E.ReadingOrder)||o.ReadingOrderType.Context,G,V));var ie=Q?y.PhoneticTextHeightPx:0,oe=N?R.CachedStyle.VerticalAlignment:p.getEffectiveVerticalAlignment(R.CachedStyle.VerticalAlignment,p.AdvVerticalAlignmentFormat.WrapText,M,K,k,q.length,R.DisplayFormula),ae=N?C.isVerticalAlignmentJustifiedOrDistributedForVerticalText(R):p.isVerticalAlignmentJustifyOrDistributed(oe),le=ae&&q.length>1&&!N?p.getAdvancedVerticalAlignmentLineGapHeightForWraptext(M,K,q.length):0;!function(e,t){t&&r.applyClipping(e,t)}(e,ee);var se=X[0],de=a.getTextVerticalPosition(R,n,K+ie,M,oe,se),ue=de.absoluteY,ce=N?f.getOffsetXForVerticalText(n,R,t,I,k,q.length):I,ge=0;C.isHorizontalAlignmentJustifiedOrDistributedForVerticalText(R)&&(ge=f.getSpaceWidthBetweenLines(n,R,ce,q.length,k));for(var he=function(e,t,n,r,i){if(e)return a.getTextVerticalPosition(t,n,r,i,t.CachedStyle.VerticalAlignment,void 0).absoluteY;return 0}(N,R,n,k,M),fe=0;fe<q.length;fe++){var me=q.length-1-fe,pe=q[me],Ce=pe.text;N&&fe>0&&(ce+=k+ge);var ve=N?he:x(ue,se,J[fe],X[fe],le,fe,ae,!h.isNullOrUndefined(L));if(_===i.BreakType.Wrap)f.drawTextLine(e,t,n,R,$,Ce,ce,ve,A,Z[fe],P),L||N||l.cacheTextDecorationLayout(n,R,t,{textPositionX:ce,textPositionY:ve,textWidth:pe.underlineWidth,clipRect:P},R.CachedFont);else{var ye={breakType:_,singleSpaceWidth:z,maxWidth:V,isProcessingLastLine:w(N,G,me,q.length),isCompleteTextVisible:K<M,lineDirection:N?i.LineDirection.Vertical:i.LineDirection.Horizontal};u.drawJustifyOrDistributedTextLine(e,t,n,R,U,me,ce,ye,$,ve,V,Z[fe],P,Ce,ve,!h.isNullOrUndefined(L))}}try{if(Q){T.updateContextForPhonetic(e,n,t.highContrastScheme);ve=S.getPhoneticVerticalPosition(n,R,ue,de.lastTextLineAlphabeticBaselineOffset,K);T.drawPhoneticText(e,n,R,ve,t),o.isChangeGateEnabled(o.ChangeGate.PhoneticRenderTelemetry)&&(null===(B=R.PhonInfo)||void 0===B?void 0:B.Text)!==g.EmptyString&&F.setRenderingResultMonitorable("drawWrapText: PhoneticRendered")}}catch(e){throw F.setRenderingResultMonitorable("drawWrapText: Error in drawing phonetic: "+e),e}re&&(e.textAlign=te,e.textBaseline=ne),function(e,t){r.restoreClipping(e,t)}(e,ee)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeTextToWrap=t.BreakOpTokenType=void 0;var r,i=n(3),o=n(1),a=n(23),l=n(6);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(r=t.BreakOpTokenType||(t.BreakOpTokenType={}));var s="1".charCodeAt(0);function d(e,t,n,r,i,s,d,u){return d?r?l.measureTextRunsHeightForVerticalText(e,r.TextRuns,r.Text,t,s,i).totalSize:l.measureTextHeightForVerticalText(u,n):r?a.measureFormattedTextWidth(e,r,t):function(e,t,n,r,i){if(i)return r*n.length;if(o.isRenderFlagEnabled(o.RenderFlagsArray.TextWidthClientPhase1,t))return l.measureTextWidth(e,n,!1,!0);return e.measureText(n).width}(e,t,n,i,s)}function u(e){switch(e){case i.Whitespace:return r.Space;case i.HardBreak:return r.HardBreak;case i.HardBreakCRLF:return r.HardBreakCRLF}return r.Word}function c(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?i.HardBreakCRLF:e[t]}function g(e,t){return t===r.HardBreakCRLF?e+2:e+1}function h(e,t,n){return!(!t||n!==r.Word||e>t.length-1)&&t.charCodeAt(e)===s}t.tokenizeTextToWrap=function(e,t,n,i,o,l,s,f){for(var m=[],p=0,C=n,v=null==f?void 0:f.BreakOp;p<t.length;){for(var y=u(c(t,p)),T=g(p,y),S=c(t,T),F=u(S);T<t.length&&y===F&&!h(T,v,y);)F=u(S=c(t,T=g(T,y)));var x=T-p,w=t.substring(p,T),R=s?a.substringFormattedText(s,p,T):void 0,b=0;switch(y){case r.Word:case r.Space:b=d(e,i,w,R,C,y===r.Space,o,l);break;case r.HardBreak:case r.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}m.push({start:p,len:x,value:w,type:y,width:b}),p=T}return m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakWideWordVerticalText=t.breakWideWord=void 0;var r=n(0),i=n(23),o=n(51),a=function(){function e(e,t,n,r,i){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=n,this.wordFormattedText=i,this.model=r}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=i.measureFormattedTextWidth(this.ctx,this.formattedValue,this.model)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=i.substringFormattedText(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!1,configurable:!0}),e}(),l=function(){function e(e,t,n,r){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=r,this.model=n}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new a(this.ctx,this.word,e+1,this.model,this.formattedText),this.cachedItems[e]=t),t},e}();function s(e,t,n,o,a){if(0!==t.length){var s=new l(e,t,o,a),d={width:n,value:"IGNORED"},u=r.binarySearch(s,0,t.length,d,(function(e,t){return e.width-t.width}));u<0&&0!==(u=~u)&&(u-=1);var c=s.item(u);return{width:c.width,value:c.value,remaining:t.substring(c.value.length),formattedRemaining:a?i.substringFormattedText(a,c.value.length):void 0}}}t.breakWideWord=function(e,t,n,r,i){for(var o=[],a=s(e,t,n,r,i);a;)o.push({value:a.value,size:a.width}),a=s(e,a.remaining,n,r,a.formattedRemaining);return o},t.breakWideWordVerticalText=function(e,t,n){for(var r=[],i=o.breakToGraphemes(e),a=n,l=i[0],s=1;s<i.length;s++)a+n>t?(r.push({value:l,size:a}),a=n,l=i[s]):(a+=n,l+=i[s]);return l&&a>0&&r.push({value:l,size:a}),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawJustifyOrDistributedTextLine=void 0;var r=n(30),i=n(13),o=n(67),a=n(65),l=n(29);function s(e,t,n,i,o){var a=n,l=i;return e.lineDirection===r.LineDirection.Horizontal?a=o+t.Offset:e.lineDirection===r.LineDirection.Vertical&&(l=o-t.Offset),{textPortionOffsetX:a,textPortionOffsetY:l}}t.drawJustifyOrDistributedTextLine=function(e,t,n,d,u,c,g,h,f,m,p,C,v,y,T,S){var F=u.tokensPerLine[c].tokens,x=h.lineDirection===r.LineDirection.Horizontal?i.adjustXForHorizontalAlignment(n,d,g,p):m;if(C)o.drawTextLine(e,t,n,d,f,y,g,m,p,C,v,F,h);else{var w=a.getStartOffset(h,F),R=a.getJustifyDistributedLine(h,F,a.getSpaceWidthBetweenWords(F,h),w);if(R){var b=s(h,R.Start,g,m,x),I=b.textPortionOffsetX,A=b.textPortionOffsetY;if(o.drawTextLine(e,t,n,d,f,R.Start.Text,I,A,p,C,v),R.Middle){var P=s(h,R.Middle,g,m,x),D=P.textPortionOffsetX,M=P.textPortionOffsetY;o.drawTextLine(e,t,n,d,f,R.Middle.Text,D,M,p,C,v)}if(R.End){var O=s(h,R.End,g,m,x),k=O.textPortionOffsetX,L=O.textPortionOffsetY;o.drawTextLine(e,t,n,d,f,R.End.Text,k,L,p,C,v)}if(!S&&h.lineDirection!==r.LineDirection.Vertical){var H=u.textLines[c],E=function(e,t,n,i,o){switch(e){case r.BreakType.Justify:return i?t.underlineWidth:n;case r.BreakType.Distributed:return i&&1===o?t.underlineWidth:n;case r.BreakType.Wrap:default:return t.underlineWidth}}(h.breakType,H,h.maxWidth,h.isProcessingLastLine,F.length);l.cacheTextDecorationLayout(n,d,t,{textPositionX:h.lineDirection===r.LineDirection.Horizontal?x+w:g,textPositionY:T,textWidth:E,clipRect:v},d.CachedFont)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateNumberFormattingInformation=void 0;var r=n(1),i=n(0),o=n(6),a=n(7),l=n(0),s=n(47),d=n(11),u=n(18),c=n(9),g=n(64);function h(e,t,n,r){var i=o.getNumFmtHashWidth(e,r,t);i<0&&c.setRenderingResultInfo("buildNumFmtHashesString:: Invalid hashWidth. hashWidth: "+i+" MeasuredWidth: "+u.getFontNameForLogging(t.CachedFont.FontName)+", FontSize:"+t.CachedFont.Size);var a=m(e,r,t,n,i,!0),l="";return l+="#".repeat(a)}function f(e,t,n,o){var a,l,d,c,g,h=s.isFontValid(null===(a=n.CachedFont)||void 0===a?void 0:a.FontName),f=!!h&&s.documentFontsCheck(i.getFontCssStringFromCell(n,t));return r.annonymize(null===(l=n.NumFmt)||void 0===l?void 0:l.Separator)+" CachedWidth: "+o+" MeasuredWidth: "+e.measureText(null===(d=n.NumFmt)||void 0===d?void 0:d.Separator).width+", IsSpace: "+(" "===(null===(c=n.NumFmt)||void 0===c?void 0:c.Separator))+", FontName:"+u.getFontNameForLogging(n.CachedFont.FontName)+", FontSize:"+n.CachedFont.Size+", Length: "+(null===(g=n.NumFmt)||void 0===g?void 0:g.Separator.length)+", MLetterWidth: "+e.measureText("M").width+", IsDocumentAttached: "+function(e){try{return document.contains(e.canvas)}catch(e){return!1}}(e)+", isFontValid: "+h+", FontLoadCheck: "+f}function m(e,t,n,r,i,l){var s=0;if(n.CachedFont.Italic&&l){var d=o.getOverhangHashWidth(e,t,n);s=Math.max(Math.floor((r-d)/i),0)}else s=Math.max(Math.floor(r/i),0);return(a.isNullOrUndefined(s)||isNaN(s)||s===1/0)&&(c.setRenderingResultInfo("calculateSeparatorCountInMaxWidth: Invalid count variable. hashCount: "+s+", cellWidth: "+r+", hashWidth: "+i+" "),s=0),s}t.updateNumberFormattingInformation=function(e,t,n,u){var p,C,v;i.verifyArgumentNotNull(n,"cell","updateNumberFormattingInformation"),i.verifyArgumentNotNull(n.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),i.verifyArgumentNotNull(t,"model","updateNumberFormattingInformation");var y=r.isRenderFlagEnabled(r.RenderFlagsArray.TextWidthClientPhase1,t);if(!(r.isRenderFlagEnabled(r.RenderFlagsArray.TextWidthClientPhase1,t)&&n.TolType!==r.TolType.Autofit||d.shouldRenderVerticalText(n))){var T=!g.isTestRun();if(a.isNullOrUndefined(n.NumFmt)||a.isNullOrUndefined(n.NumFmt.Separator)||""===n.NumFmt.Separator){if(Math.round(o.getTextWidth(e,t,n))>u&&!l.cellHasShrinkToFit(n))(x=h(e,n,u,t))!==n.CachedDisplayText&&(n.CachedIsTextWidthExceedsCellWidth=!0,i.setCellCachedDisplayText(n,x),o.cacheLegacyTextWidthOnCell(e,t,n))}else{var S=o.measureTextWidth(e,null===(p=n.NumFmt)||void 0===p?void 0:p.Start,T,y),F=o.measureTextWidth(e,null===(C=n.NumFmt)||void 0===C?void 0:C.End,T,y);if(S+F>u&&!l.cellHasShrinkToFit(n)){var x=h(e,n,u,t);i.setCellCachedDisplayText(n,x),o.cacheLegacyTextWidthOnCell(e,t,n)}else{var w=o.getNumFmtSeparatorWidth(e,t,n);if(!s.fontFaceSetSupported())return;var R=s.isValidCellFontLoaded(t,n);if(0===w&&!R)return;if(0===w)return void c.setRenderingResultInfo("updateNumberFormattingInformation:: Invalid SeparatorWidth."+f(e,t,n,w));var b=m(e,t,n,u-S-F,w,"#"===(null===(v=n.NumFmt)||void 0===v?void 0:v.Separator)),x=function(e,t,n,r,i,o){var a=r.Start||"";try{a+=r.Separator.repeat(i),a+=r.End||""}catch(i){return c.setRenderingResultInfo("buildNumFmtText:: Invalid separatorCount."+f(e,t,n,o)),r.Start||""+r.End||""}return a}(e,t,n,n.NumFmt,b,w);i.setCellCachedDisplayText(n,x)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCachedDisplayTextForFill=void 0;var r=n(1),i=n(2),o=n(0),a=n(6),l=n(5),s=n(9),d=n(10),u=n(15);t.updateCachedDisplayTextForFill=function(e,t,n,c){var g=n.Text;if(g){var h=function(e,t,n){var r=n.zoom,s=n.devicePixelRatio,c=t.Spill?l.getSpillCellWidth(t,e):l.getCellWidth(e,t,!1),g=o.isPivotTablePhase2Enabled(e);return i.getTextDrawingMaxWidth(c,a.getCellTextHorizontalPadding(t,e,r,s),a.getDistanceFromCellStartToIconEnd(e,t,r,s),d.getExpandCollapseButtonPadding(t,g),u.getAutoFilterPaddingForAdvancedHorizontalAlignment(e,t,r,s))}(t,n,c),f=a.measureTextWidth(e,g,!1,r.isRenderFlagEnabled(r.RenderFlagsArray.TextWidthClientPhase1,t)),m=Math.floor(h/f);m<1&&(m=1),(void 0===m||isNaN(m)||m===1/0)&&(s.setRenderingResultInfo("updateCachedDisplayTextForFill: Invalid count variable. repeatCount: "+m+", maxTextWidth: "+h+", textWidth: "+f+" "),m=1);var p=g.repeat(m);o.setCellCachedDisplayText(n,p)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerHyperlinkEventHandlers=void 0;var r=n(1),i=n(0),o=n(12),a=n(20),l=n(5),s=n(6),d=n(7),u=n(39),c=n(13),g=n(3),h=n(2),f=n(21),m=n(54),p=n(24),C=n(8),v=!1,y=!1;function T(e,t){return!d.isNullOrUndefined(e.Hyperlink)&&!!h.cellIntersectsRenderingRegion(e,t.renderingRegion)}function S(e,t,n,u){!function(e,t,n,l){var s=f.getUnadjustedHitRegionFromRect(e,n,l,!1),u=r.getRenderingRegionHitTestCache(e,i.getRenderingRegionKey(n.renderingRegion));a.registerCursorHitRegion(t,u,s,"pointer",r.RenderFeaturesZIndex.Hyperlink),a.registerTooltipHitRegion(t,u,s,function(e){var t,n,r;if(null===(t=e.Hyperlink)||void 0===t?void 0:t.Tooltip)return null===(n=e.Hyperlink)||void 0===n?void 0:n.Tooltip;if(m.gridRendererStrings.hyperlinkToolTip)return d.stringFormat(m.gridRendererStrings.hyperlinkToolTip,null===(r=e.Hyperlink)||void 0===r?void 0:r.Text);return g.EmptyString}(t),r.RenderFeaturesZIndex.Hyperlink),a.registerHitRegion(t,u,s,r.RenderFeaturesZIndex.Hyperlink,(function(e){var n,r,i;if(!v)if(null===(n=t.Hyperlink)||void 0===n?void 0:n.IsValidHyperlink){if(null===(r=t.Hyperlink)||void 0===r?void 0:r.IsHyperlinkExternal)o.followHyperlink(e,null===(i=t.Hyperlink)||void 0===i?void 0:i.Text);else if(t.Hyperlink.InternalLink){var a=t.Hyperlink.InternalLink;o.handleGoTo(e,a.ObjectName,a.SheetName,a.FirstRow,a.FirstColumn,a.LastRow,a.LastColumn)}}else o.invalidHyperlinkCallback();return v=!1,!1}),"click"),a.registerLongPressHitRegion(t,u,s,r.RenderFeaturesZIndex.Hyperlink,(function(){r.isChangeGateEnabled(r.ChangeGate.LogHyperlink)&&C.ULS.sendTraceTag(539550493,C.LogCategory.msoulscat_ES_EWAJSGrid,C.TraceLevel.Info,"HyperlinkEvents: Long press started"),y=!0}),(function(){y&&(v=!0),y=!1})),a.registerHitRegion(t,u,s,r.RenderFeaturesZIndex.Hyperlink,p.EmptyFalseCallback,"touchend")}(t,n,u,function(e,t,n,i){var o=function(e,t,n,i){if(F(n)||n.Spill)return{leftX:l.getCellLeftAdjustedForDrawing(t,n,!1,!1),width:l.getCellWidthAdjustedForDrawing(t,n)};var o=s.getTextWidth(e,t,n),a=function(e,t,n,i){var o,a=s.getTextHorizontalPosition(e,t,n),l=(null===(o=t.CachedStyle)||void 0===o?void 0:o.HorizontalAlignment)||r.HorizontalAlignment.Automatic;switch(l){case r.HorizontalAlignment.Right:return a-i;case r.HorizontalAlignment.Center:return a-i/2;case r.HorizontalAlignment.Automatic:case r.HorizontalAlignment.Left:return a;default:throw Error("getHyperlinkBoundsOnTextRectLeftX: unsupported horizontalAlignment for hyperlinks on text rect: "+l)}}(t,n,i,o);return{leftX:Math.max(l.getCellLeftAdjustedForDrawing(t,n,!1,!1),a*i.scaleFactor),width:Math.min(l.getCellWidthAdjustedForDrawing(t,n),o*i.scaleFactor)}}(e,t,n,i),a=o.leftX,d=o.width,u=function(e,t,n){var i;if(F(t)){var o=l.getCellHeightAdjustedForDrawing(e,t);return{topY:l.getCellTopAdjustedForDrawing(e,t,!1),height:o}}var a=s.getTextLineHeight(t,e)*n.scaleFactor,d=function(e,t,n){var i,o=null===(i=t.CachedStyle)||void 0===i?void 0:i.VerticalAlignment;switch(o){case r.VerticalAlignment.Bottom:return l.getCellBottomAdjustedForDrawing(e,t)-n-g.GridLineWidthPx;case r.VerticalAlignment.Center:return l.getCellCenterYAdjustedForDrawing(e,t)-n/2;case r.VerticalAlignment.Top:return l.getCellTopAdjustedForDrawing(e,t,!1);default:throw Error("getHyperlinkBoundsOnTextRectTopY: unsupported verticalAlignment: "+o)}}(e,t,a),u=a,c=null===(i=t.CachedDrawingLayout)||void 0===i?void 0:i.UnderlineRuns;c&&c.length>0&&(u=c[0].Y+c[0].LineWidth-d);return{topY:Math.max(d,l.getCellTopAdjustedForDrawing(e,t,!1)),height:Math.min(u,l.getCellHeightAdjustedForDrawing(e,t))}}(t,n,i),c=u.topY,h=u.height;return{x:a,y:c,width:d,height:h}}(e,t,n,u))}function F(e){var t,n=e.CachedStyle;if(d.isNullOrUndefined(n))throw Error("shouldHyperlinkEventsBeRegisteredOnFullCell: cell.CachedStyle is null");return!!(e.WrapText||n.ShrinkToFit||n.Indentation||n.VerticalText||u.isVerticalAlignmentJustifyOrDistributed(n.VerticalAlignment)||c.isHorizontalAlignmentAdvance(n.HorizontalAlignment)||e.ValueType===r.CellValueType.Number||e.TextRuns||(null===(t=e.LinkedEntity)||void 0===t?void 0:t.IconWidth)||e.RichValueIcon||e.HasIgnorableError||d.isNullOrUndefined(e.Text))}t.registerHyperlinkEventHandlers=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","registerHyperlinkEventHandlers"),r.verifyArgumentNotNull(t,"model","registerHyperlinkEventHandlers"),r.verifyArgumentNotNull(n,"context","registerHyperlinkEventHandlers");for(var o=t.ClientOnlyCache.CellsToRender,a="",l=0;l<o.length;l++){var s=o[l];if(T(s,n)){var d=i.getFontCssStringFromCell(s,t);a!==d&&(a=d,e.font=d),S(e,t,s,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRotatedText=void 0;var r=n(1),i=n(0),o=n(6),a=n(2),l=n(46),s=n(19),d=n(5),u=n(23),c=n(69),g=n(66),h=n(30),f=n(3),m=n(67),p=n(29),C=n(7),v=n(9),y=n(68);function T(e,t,n,r,i,a,l,u){var c,g=s.getEffectiveHorizontalAlignmentForRotatedText(null===(c=t.CachedStyle)||void 0===c?void 0:c.HorizontalAlignment,e.IsRtl),h=o.getCellAdornmentPadding(e,t,l,u),f=s.getUnderlinePadding(t.CachedFont,a),m=d.getCellLeft(e,t,e.BlockWidth),p=d.getCellRight(e,t,e.BlockWidth);return s.getRotatedTextHorizontalPosition(g,m,p,i,h,f,r,a,n)}function S(e,t,n,r,o){i.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","cacheOrientationLayout");var a={TranslateX:t,TranslateY:n,Angle:r,IsCellClipped:o};e.CachedDrawingLayout.TextOrientationLayout=a}t.drawRotatedText=function(e,t,n,F,x,w,R,b,I,A,P){var D,M=s.degreeToRadians(s.getOrientationInCanvas(t.IsRtl,null===(D=n.CachedStyle)||void 0===D?void 0:D.Orientation)),O=A?o.getLargestFont(t,A.TextRuns):n.CachedFont,k=i.getActualFontSizeFromFont(n,O,!0);c.shouldDrawWrapText(n)?function(e,t,n,c,F,x,w,R,b,I,A,P,D){var M,O=c.zoom,k=c.devicePixelRatio,L=s.getRotatedTextVerticalPadding(n,x),H=b-f.GridLineWidthPx-f.RotatedTextPaddingMultiplier*L,E=H/R,B=Math.atan(E),N=0;N=Math.abs(w)>=B?Math.round(H/Math.abs(Math.sin(w))):Math.round(R/Math.abs(Math.cos(w)));if(N<=0)return;var W=o.measureTextWidth(e,f.Whitespace,!1,!0),z=n.WrapText,j=g.breakTextToLines(e,F,N,h.BreakType.Wrap,W,t,n,P,z).textLines,_=function(e,t,n,r,a,s){var d=[],c=[],g=[],h=0;if(s){for(var f=0;f<n.length;f++){var m=n[f],p=u.substringFormattedText(s,m.startIndex,m.endIndex);d[f]=p;var C=o.getFormattedTextLineFontMetrics(e,p);g[f]=C.baseline,h=o.getFormattedTextLineHeight(e,p),c[f]=h+a}return{textLinesHeight:c,linesAlphabeticOffset:g,formattedLines:d}}var v=t.CachedFont,y=i.getActualFontSize(t),T=l.getCachedFontMetrics(v.FontName,y,e).baseline;for(f=0;f<n.length;f++)c.push(r+a),g.push(T);return{textLinesHeight:c,linesAlphabeticOffset:g,formattedLines:d}}(t,n,j,I,A,P),V=_.textLinesHeight,U=_.linesAlphabeticOffset,G=_.formattedLines,q=function(e,t,n,r,i,o,a,l,d){var u=s.getRotatedWrapTextWidth(n,r,a),c=r[0]-i[0];return T(e,t,o,u,c,a,l,d)}(t,n,j,V,U,R,w,O,k),Y=function(e,t,n,r,i,o,a,l,u){var c=s.getIndexOfMaxLineWidth(n),g=s.getRotatedTextBoxHeight(n[c].width,r[c],a),h=d.getCellTop(e,t),f=d.getCellBottom(e,t);return s.getRotatedTextVerticalPosition(t.CachedStyle.VerticalAlignment,l,u,g,o,h,f)-i[c]*Math.abs(Math.cos(a))}(t,n,j,V,U,b,w,L,o.isCellBottomPaddingRequired(t,n)),J=e.textAlign,X=e.textBaseline;a.applyClipping(e,D),s.applyRotation(e,q,Y,w),S(n,q,Y,w,!!D);for(var K=0,Z=0,Q=Math.abs(Math.cos(w))/Math.abs(Math.sin(w)),$=0;$<j.length;$++)$>0&&(Z=Z+U[$-1]+V[$]-U[$],K=Z*Q*(w<0?1:-1)),m.drawTextLine(e,c,t,n,!0,j[$].text,K,Z,R,G[$],D),P||p.cacheTextDecorationLayout(t,n,c,{textPositionX:K,textPositionY:Z,textWidth:j[$].underlineWidth,clipRect:D},n.CachedFont);var ee=r.isRenderFlagEnabled(r.RenderFlagsArray.PhoneticSlice1,t)&&!C.isNullOrUndefined(n.PhonInfo);try{if(ee&&j.length>0){y.updateContextForPhonetic(e,t,c.highContrastScheme);var te=-(V[0]-A-U[0]);e.textAlign="left",y.drawPhoneticText(e,t,n,te,c,j[0].width),r.isChangeGateEnabled(r.ChangeGate.PhoneticRenderTelemetry)&&(null===(M=n.PhonInfo)||void 0===M?void 0:M.Text)!==f.EmptyString&&v.setRenderingResultMonitorable("drawWrapText: RotatedPhoneticRendered")}}catch(e){throw v.setRenderingResultMonitorable("drawWrapText: Error in drawing rotated phonetic: "+e),e}e.restore(),e.textAlign=J,e.textBaseline=X,a.restoreClipping(e,D)}(e,t,n,F,x,k,M,w,R,b,I,A,P):function(e,t,n,r,i,c,g,h,f,m,C,v){var y,F=r.zoom,x=r.devicePixelRatio,w=o.getTextWidth(e,t,n),R=l.getCachedFontMetrics(null===(y=n.CachedFont)||void 0===y?void 0:y.FontName,c,t).baseline,b=function(e,t,n,r,i,o,a,l,d){var u=s.getRotatedTextBoxWidth(n,i,a);return T(e,t,r,u,i-o,a,l,d)}(t,n,w,h,m,R,g,F,x),I=function(e,t,n,r,i,o,a,l,u){var c,g=s.getRotatedTextVerticalPadding(t,r),h=s.getRotatedTextBoxHeight(i,o,l),f=d.getCellTop(e,t),m=d.getCellBottom(e,t);return s.getRotatedTextVerticalPosition(null===(c=t.CachedStyle)||void 0===c?void 0:c.VerticalAlignment,g,u,h,n,f,m)-a*Math.abs(Math.cos(l))}(t,n,f,c,w,m,R,g,o.isCellBottomPaddingRequired(t,n));a.applyClipping(e,v),s.applyRotation(e,b,I,g),S(n,b,I,g,!!v),C&&!n.DisplayFormula?u.fillRichTextFormat(e,r,t,n,C,0,0,v):(e.fillText(i,0,0),p.cacheTextDecorationLayout(t,n,r,{textPositionX:0,textPositionY:0,textWidth:w,clipRect:v},n.CachedFont));e.restore(),a.restoreClipping(e,v)}(e,t,n,F,x,k,M,w,R,b+I,A,P)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fillCellWithGradientBackground=void 0;var r=n(1),i=n(0);function o(e,t,n,o){i.verifyArgumentNotNull(n,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var a=function(e,t){var n=t.x,i=t.y,o=t.width,a=t.height;switch(e){case r.GradientShadingStyle.Vertical:case r.GradientShadingStyle.Center:case r.GradientShadingStyle.TopRightCorner:return{x0:n,y0:0,x1:n+o,y1:0};case r.GradientShadingStyle.ReversedVertical:case r.GradientShadingStyle.TopLeftCorner:return{x0:n+o,y0:0,x1:n,y1:0};case r.GradientShadingStyle.Horizontal:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:i,x1:0,y1:i+a};case r.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:i+a,x1:0,y1:i};case r.GradientShadingStyle.DiagonalUp:case r.GradientShadingStyle.DiagonalDown:case r.GradientShadingStyle.ReversedDiagonalUp:case r.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var n=t.width*t.width,i=t.height*t.height,o=n+i,a=t.x+t.width/2,l=t.y+t.height/2,s=t.width*i/o,d=n*t.height/o;switch(e){case r.GradientShadingStyle.DiagonalUp:break;case r.GradientShadingStyle.DiagonalDown:s=-s;break;case r.GradientShadingStyle.ReversedDiagonalUp:d=-d;break;case r.GradientShadingStyle.ReversedDiagonalDown:s=-s,d=-d;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:a-s,y0:l-d,x1:a+s,y1:l+d}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,o),l=e.createLinearGradient(a.x0,a.y0,a.x1,a.y1),s=0;s<n.length;s++)l.addColorStop(n[s].Position,n[s].Color);return l}t.fillCellWithGradientBackground=function(e,t,n,i){var a=o(e,t.ShadingStyle,t.Stops,n);return a!==i&&(e.fillStyle=a),e.fillRect(n.x,n.y,n.width,n.height),function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:case r.GradientShadingStyle.BottomRightCorner:case r.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(a=e.fillStyle=o(e,function(e){switch(e){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.TopRightCorner:return r.GradientShadingStyle.ReversedHorizontal;case r.GradientShadingStyle.BottomLeftCorner:return r.GradientShadingStyle.ReversedVertical;case r.GradientShadingStyle.BottomRightCorner:return r.GradientShadingStyle.Vertical;case r.GradientShadingStyle.Center:return r.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,n),function(e,t,n){var i=n.x,o=n.y,a=n.width,l=n.height;switch(e.beginPath(),e.moveTo(i,o),e.lineTo(i+a,o),t){case r.GradientShadingStyle.TopLeftCorner:case r.GradientShadingStyle.BottomRightCorner:e.lineTo(i+a,o+l);break;case r.GradientShadingStyle.TopRightCorner:case r.GradientShadingStyle.BottomLeftCorner:e.lineTo(i,o+l);break;case r.GradientShadingStyle.Center:e.lineTo(i,o+l),e.lineTo(i+a,o+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(i,o)}(e,t.ShadingStyle,n),e.fill()),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawConditionalFormattingIcons=void 0;var r=n(0),i=n(2),o=n(16),a=n(55),l=n(3),s=n(149),d=n(96),u=n(10),c=n(150),g=n(151),h=n(152),f=n(153),m=n(154),p=n(155),C=n(97),v=n(156),y=n(157),T=n(42),S=n(17);function F(e,t,n,l,S){var F=function(e,t,n,i){var a=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:r.getActualFontSize(t),l=u.getIconSize(a,n),s=t.CondFormat.Icon,c=o.IconImageLookup[s.Set][s.Index],g=d.getIconLeftPosition(e,t,l,a,n),h=d.getIconVerticalPosition(e,t,n,l);return{size:l,image:c,left:g,bottom:h,highContrastScheme:i}}(t,n,l,S),x=T.getClipRect(t,n,F.left,F.bottom,F.size,!1);if(!(F.size<=o.MinimalIconSize)){switch(i.applyClipping(e,x),F.image){case o.CFIconImage.CircleLow:case o.CFIconImage.CircleMedium:case o.CFIconImage.CircleHigh:case o.CFIconImage.CircleEmpty:case o.CFIconImage.CircleFilled:case o.CFIconImage.FourCircleHigh:case o.CFIconImage.FourCircleLow:case o.CFIconImage.FourCircleMedium1:case o.CFIconImage.FourCircleMedium2:case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:a.drawCircleIcon(e,F);break;case o.CFIconImage.CircleSymbolHigh:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolLow:y.drawCircledSymbols(e,F);break;case o.CFIconImage.TrafficHigh:case o.CFIconImage.TrafficMedium:case o.CFIconImage.TrafficLow:s.drawTrafficLightRimmed(e,F);break;case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:case o.CFIconImage.SignalBarMedium1:case o.CFIconImage.SignalBarMedium2:case o.CFIconImage.SignalBarHigh:c.drawSignalBar(e,F);break;case o.CFIconImage.QuadrantEmpty:case o.CFIconImage.Quadrant25:case o.CFIconImage.QuadrantHalf:case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:g.drawQuadrantBoxes(e,F);break;case o.CFIconImage.FlagHigh:case o.CFIconImage.FlagMedium:case o.CFIconImage.FlagLow:h.drawFlag(e,F);break;case o.CFIconImage.TriangleHigh:case o.CFIconImage.TriangleMedium:case o.CFIconImage.TriangleLow:f.drawTriangleSet(e,F);break;case o.CFIconImage.StarHigh:case o.CFIconImage.StarMedium:case o.CFIconImage.StarLow:m.drawStarIcon(e,F);break;case o.CFIconImage.SignLow:case o.CFIconImage.SignMedium:p.drawSigns(e,F);break;case o.CFIconImage.SymbolHigh:case o.CFIconImage.SymbolMedium:case o.CFIconImage.SymbolLow:C.drawSymbols(e,F);break;case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowDownRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:v.drawArrows(e,F);break;default:throw Error("drawConditionalFormattingIcon: imageType: "+F.image+" not supported")}i.restoreClipping(e,x)}}t.drawConditionalFormattingIcons=function(e,t,n){var o;r.verifyArgumentNotNull(e,"ctx","drawConditionalFormattingIcons"),r.verifyArgumentNotNull(t,"model","drawConditionalFormattingIcons"),r.verifyArgumentNotNull(n,"context","drawConditionalFormattingIcons");var a=t.ClientOnlyCache.CellsToRender;a.length>0&&(e.lineWidth=S.ShapeOutlineWidthPx,e.setLineDash(l.DefaultDash));for(var s=null!==n.highContrastScheme?n.highContrastScheme:void 0,d=0;d<a.length;d++){var u=a[d];(null===(o=null==u?void 0:u.CondFormat)||void 0===o?void 0:o.Icon)&&(u.PreviewText||u.ShowSkeleton||i.cellIntersectsRenderingRegion(u,n.renderingRegion)&&F(e,t,u,n.scaleFactor,s))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStripes=t.getInnerCircleRadius=t.getHighContrastFillingType=t.FillType=void 0;var r,i=n(16),o=n(2),a=n(17);!function(e){e[e.Empty=0]="Empty",e[e.Stripes=1]="Stripes",e[e.InnerCircle=2]="InnerCircle",e[e.FillPortion=3]="FillPortion",e[e.Full=4]="Full"}(r=t.FillType||(t.FillType={})),t.getHighContrastFillingType=function(e){switch(e){case i.CFIconImage.Circle25:case i.CFIconImage.CircleHalf:case i.CFIconImage.Circle75:return r.FillPortion;case i.CFIconImage.CircleLow:case i.CFIconImage.CircleEmpty:case i.CFIconImage.FourCircleHigh:case i.CFIconImage.TrafficLow:case i.CFIconImage.CircleSymbolLow:case i.CFIconImage.CircleSymbolMedium:case i.CFIconImage.CircleSymbolHigh:return r.Empty;case i.CFIconImage.CircleHigh:case i.CFIconImage.TrafficHigh:case i.CFIconImage.CircleFilled:return r.Full;case i.CFIconImage.CircleMedium:case i.CFIconImage.TrafficMedium:return r.Stripes;case i.CFIconImage.FourCircleLow:case i.CFIconImage.FourCircleMedium1:case i.CFIconImage.FourCircleMedium2:return r.InnerCircle;default:throw Error("getHighContrastFillingType: image: "+e+" not supported")}},t.getInnerCircleRadius=function(e,t){switch(e){case i.CFIconImage.FourCircleMedium2:return t*i.CircleHighContrastSmallRadiusPortion;case i.CFIconImage.FourCircleMedium1:return t*i.CircleHighContrastMediumRadiusPortion;case i.CFIconImage.FourCircleLow:return t*i.CircleHighContrastLargeRadiusPortion;default:throw Error("highContrastCircles::getInnerRadius: unsupported image for drawing inner circle")}},t.drawStripes=function(e,t,n,r,l){e.strokeStyle=l,e.beginPath();var s={p1:{x:t+r*Math.cos(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleUpperLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleUpperLineAngle)+a.ShapeLinesAdjustment}},d={p1:{x:t+r*Math.cos(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleMiddleLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleMiddleLineAngle)+a.ShapeLinesAdjustment}},u={p1:{x:t+r*Math.cos(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment,y:n+r*Math.sin(i.StripedCircleLowerLineAngle)-a.ShapeLinesAdjustment},p2:{x:t+r*Math.cos(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment,y:n+r*Math.sin(i.Circle270Deg-i.StripedCircleLowerLineAngle)+a.ShapeLinesAdjustment}};o.drawLine(e,s.p1.x,s.p1.y,s.p2.x,s.p2.y),o.drawLine(e,d.p1.x,d.p1.y,d.p2.x,d.p2.y),o.drawLine(e,u.p1.x,u.p1.y,u.p2.x,u.p2.y),e.stroke()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTrafficLightRimmed=void 0;var r=n(0),i=n(16),o=n(25),a=n(55),l=n(22);t.drawTrafficLightRimmed=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawTrafficLightRimmed"),r.verifyArgumentNotNull(t,"drawingContext","drawTrafficLightRimmed");var n=t.size,s=n;n%2==0&&(s=n-1);var d={left:t.left,bottom:t.bottom,outerColor:function(e){return e?r.rgbToColorHex(e.TextColor):l.TrafficHighRimmedRectColor}(t.highContrastScheme),height:s,width:s,innerColor:void 0};o.drawRectangle(e,d),t.size=s;var u=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.highContrastScheme,a=e.size-2*i.CirclePaddingFromBoundariesPx,l=n+i.CirclePaddingFromBoundariesPx+.5,s=r-i.CirclePaddingFromBoundariesPx-.5;return{size:a,left:l,bottom:s,image:t,highContrastScheme:o}}(t);a.drawCircleIcon(e,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSignalBar=void 0;var r=n(0),i=n(25),o=n(16),a=n(22),l=n(2),s=n(17);function d(e,t,n,i){var o=i.left,l=i.bottom;return{innerColor:t,outerColor:function(e){if(e)return r.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(i.highContrastScheme),bottom:l,left:o+n*(e+1),height:n*(e+2),width:n}}t.drawSignalBar=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawSignalBar"),r.verifyArgumentNotNull(t,"drawingContext","drawSignalBar");for(var n=t.image,u=t.size,c=t.highContrastScheme,g=Math.floor(u/5),h=function(e,t){var n=function(e){if(e)return r.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t),i=function(e){if(e)return r.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t);switch(e){case o.CFIconImage.SignalBarEmpty:return[n,n,n,n];case o.CFIconImage.SignalBarLow:return[i,n,n,n];case o.CFIconImage.SignalBarMedium1:return[i,i,n,n];case o.CFIconImage.SignalBarMedium2:return[i,i,i,n];case o.CFIconImage.SignalBarHigh:return[i,i,i,i];default:throw Error("getBarsColors: image: "+e+" not supported")}}(n,c),f=0;f<h.length;f++){var m=d(f,h[f],g,t);i.drawRectangle(e,m)}c&&function(e,t,n,i){var a=n.left,d=n.bottom,u=n.highContrastScheme,c=function(e,t,n,r){for(var i=function(e){switch(e){case o.CFIconImage.SignalBarEmpty:case o.CFIconImage.SignalBarLow:return 0;case o.CFIconImage.SignalBarMedium1:return 1;case o.CFIconImage.SignalBarMedium2:return 2;case o.CFIconImage.SignalBarHigh:return 3;default:throw Error("getSeperators: image: "+e+" not supported")}}(e),a=[],l=n-2*r+s.ShapeLinesAdjustment,d=t+2*r+s.ShapeLinesAdjustment,u=0;u<i;u++)a.push({X:d,startY:l,endY:n-1.5}),l-=r,d+=r;return a}(e,a,d,i);t.strokeStyle=r.rgbToColorHex(u.BackgroundColor),t.beginPath();for(var g=0;g<c.length;g++)l.drawLine(t,c[g].X,c[g].startY,c[g].X,c[g].endY);t.stroke()}(n,e,t,g)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawQuadrantBoxes=void 0;var r=n(0),i=n(25),o=n(16),a=n(22),l=n(2),s=n(17);function d(e,t,n,i,o){var l=o.left,s=o.bottom;return{innerColor:n,outerColor:function(e){if(e)return r.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(o.highContrastScheme),bottom:s-e*i,left:l+t*i,height:i,width:i}}t.drawQuadrantBoxes=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawQuadrantBoxes"),r.verifyArgumentNotNull(t,"drawingContext","drawQuadrantBoxes");for(var n=t.image,u=t.size,c=t.highContrastScheme,g=Math.floor(u/2),h=function(e,t){var n=function(e){if(e)return r.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t),i=function(e){if(e)return r.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t);switch(e){case o.CFIconImage.QuadrantEmpty:return[[i,i],[i,i]];case o.CFIconImage.Quadrant25:return[[n,i],[i,i]];case o.CFIconImage.QuadrantHalf:return[[n,n],[i,i]];case o.CFIconImage.Quadrant75:return[[n,n],[n,i]];case o.CFIconImage.QuadrantFull:return[[n,n],[n,n]];default:throw Error("getBoxesColors: image: "+e+" not supported")}}(n,c),f=0;f<h.length;f++)for(var m=0;m<h.length;m++){var p=d(f,m,h[f][m],g,t);i.drawRectangle(e,p)}c&&function(e,t,n,i){var a=t.left,d=t.bottom,u=t.highContrastScheme,c=a+n+s.ShapeLinesAdjustment,g=d-n-s.ShapeLinesAdjustment,h=function(e,t,n,r){switch(e){case o.CFIconImage.QuadrantEmpty:return[];case o.CFIconImage.Quadrant25:return[{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];case o.CFIconImage.QuadrantHalf:return[{x:t+r,y:n},{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];case o.CFIconImage.Quadrant75:case o.CFIconImage.QuadrantFull:return[{x:t,y:n-r+s.ShapeLinesAdjustment},{x:t+r-s.ShapeLinesAdjustment,y:n},{x:t,y:n+r-s.ShapeLinesAdjustment},{x:t-r+s.ShapeLinesAdjustment,y:n}];default:throw Error("getSeparatorsCoordinates: image: "+e+" not supported")}}(i,c,g,n);e.strokeStyle=r.rgbToColorHex(u.BackgroundColor),e.beginPath();for(var f=0;f<h.length;f++)l.drawLine(e,c,g,h[f].x,h[f].y);e.stroke()}(e,t,g,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawFlag=void 0;var r=n(0),i=n(16),o=n(25),a=n(22),l=n(2),s=n(3),d=n(17);function u(e,t){r.verifyArgumentNotNull(t.outerColor,"outerColor","drawFlags");var n,o,a,s,u,c,g,h,f,m=t.outerColor,p=(o=(n=t).left,a=n.bottom,s=n.width,u=n.height,c=u/2,g={x:o+s+d.ShapeLinesAdjustment,y:a-c-d.ShapeLinesAdjustment},h=o+s-c/i.QuarterPiTan+d.ShapeLinesAdjustment,f=a-u-d.ShapeLinesAdjustment,{p1:g,p2:{x:h,y:f}}),C=function(e){var t=e.left,n=e.bottom,r=e.width/2,o={x:t+r+d.ShapeLinesAdjustment,y:n-d.ShapeLinesAdjustment},a=n-r*i.QuarterPiTan-d.ShapeLinesAdjustment,l={x:t+d.ShapeLinesAdjustment,y:a};return{p1:o,p2:l}}(t);e.strokeStyle=m,e.beginPath(),l.drawLine(e,p.p1.x,p.p1.y,p.p2.x,p.p2.y),l.drawLine(e,C.p1.x,C.p1.y,C.p2.x,C.p2.y),e.stroke()}t.drawFlag=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawFlags"),r.verifyArgumentNotNull(t,"drawingContext","drawFlags");var n=t.image,c=t.size,g=t.left,h=t.bottom,f=t.highContrastScheme,m=Math.floor(c/2),p=Math.floor(c/3),C=function(e,t){if(t)return function(e,t){if(e===i.CFIconImage.FlagHigh)return r.rgbToColorHex(t.TextColor);return}(e,t);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case i.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case i.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(n,f),v=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case i.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case i.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(n,f);!function(e,t,n,r,a,l){var s=l.left,d=l.bottom,c=l.image,g=l.highContrastScheme,h={left:s,bottom:d-t,outerColor:a,height:t,width:n,innerColor:r};o.drawRectangle(e,h),c===i.CFIconImage.FlagMedium&&g&&u(e,h)}(e,m,p,C,v,t),function(e,t,n,r,a,l){var s=l.left,d=l.bottom,c=l.size,g=l.image,h=l.highContrastScheme,f=Math.floor(c/8),m={left:s+n,bottom:d-t+f,outerColor:a,height:t,width:n,innerColor:r};o.drawRectangle(e,m),g===i.CFIconImage.FlagMedium&&h&&u(e,m)}(e,m,p,C,v,t),function(e,t,n,o,u){var c=o-d.ShapeLinesAdjustment,g=c-n,h=t+d.ShapeLinesAdjustment;e.lineWidth=i.FlagPoleWidth,e.setLineDash(s.DefaultDash),e.strokeStyle=function(e){return e?r.rgbToColorHex(e.TextColor):a.FlagPoleColor}(u),e.beginPath(),l.drawLine(e,h,c,h,g),e.stroke()}(e,g,2*m,h,f)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawTriangleSet=void 0;var r=n(0),i=n(16),o=n(22),a=n(41),l=n(25),s=n(17);function d(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowOuterColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumOuterColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighOuterColor;default:throw Error("getTriangleOuterColor: unsupported image type = "+e)}}function u(e,t){if(t)return r.rgbToColorHex(t.BackgroundColor);switch(e){case i.CFIconImage.TriangleLow:return o.TriangleLowInnerColor;case i.CFIconImage.TriangleMedium:return o.TriangleMediumInnerColor;case i.CFIconImage.TriangleHigh:return o.TriangleHighInnerColor;default:throw Error("getTriangleInnerColor: unsupported image type = "+e)}}t.drawTriangleSet=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawTriangleSet"),r.verifyArgumentNotNull(t,"drawingContext","drawTriangleSet");var n=t.image,o=t.size,c=t.left,g=t.bottom,h=t.highContrastScheme;switch(n){case i.CFIconImage.TriangleHigh:case i.CFIconImage.TriangleLow:var f=function(e){var t=e.image,n=e.left,r=e.bottom,o=e.size,a=e.highContrastScheme,l=Math.floor(o/2),c=Math.floor(o/4),g=r-c-s.ShapeLinesAdjustment,h=n+s.ShapeLinesAdjustment;switch(t){case i.CFIconImage.TriangleHigh:return{outerColor:d(t,a),innerColor:u(t,a),left:h,bottom:g,height:l,width:o};case i.CFIconImage.TriangleLow:return{outerColor:d(t,a),innerColor:u(t,a),left:n+s.ShapeLinesAdjustment,bottom:r-c-l-s.ShapeLinesAdjustment,height:l,width:o};default:throw Error("getTriangleDrawingContext: unsupported image type = "+t)}}(t);a.drawTriangle(e,f,n===i.CFIconImage.TriangleLow);break;case i.CFIconImage.TriangleMedium:var m=Math.floor(o/3),p={left:c,outerColor:d(n,h),innerColor:u(n,h),bottom:g-m,height:m,width:o};l.drawRectangle(e,p);break;default:throw Error("drawTriangleSet: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawStarIcon=void 0;var r=n(0),i=n(16),o=n(22),a=n(33),l=n(17);t.drawStarIcon=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawStarIcon"),r.verifyArgumentNotNull(t,"drawingContext","drawStarIcon");var n=t.image,s=t.size,d=t.left,u=t.bottom,c=t.highContrastScheme,g=Math.floor(s/2);if(!(g<=1)){var h=function(e,t,n){var r=n*i.StarInset,o=e+n+.5,a=t-n,s=r*i.StarRotationSin,d=r*i.StarRotationCos,u=n*i.StarRotation2Sin,c=r*i.StarRotation2Sin,g=r*i.StarRotation2Cos,h=n*i.StarRotationSin,f=n*i.StarRotationCos,m=Math.floor(d)+l.ShapeLinesAdjustment,p=a+(d-m),C=p-d,v=p+g,y=p+f;return{topOuter:{x:o,y:p-n},topRightInner:{x:o+s,y:C},topRightOuter:{x:o+u,y:C},middleRightInner:{x:o+c,y:v},bottomRightOuter:{x:o+h,y:y},bottomInner:{x:o,y:p+r},bottomLeftOuter:{x:o-h,y:y},middleLeftInner:{x:o-c,y:v},topLeftOuter:{x:o-u,y:C},topLeftInner:{x:o-s,y:C}}}(d,u,g),f=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return r.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:return;default:throw Error("getStarLeftInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledInnerColor;case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = "+e)}}(n,c),m=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:case i.CFIconImage.StarMedium:return o.StarFilledOuterColor;case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = "+e)}}(n,c),p=function(e,t){if(t)return function(e,t){switch(e){case i.CFIconImage.StarHigh:return r.rgbToColorHex(t.TextColor);case i.CFIconImage.StarLow:case i.CFIconImage.StarMedium:return;default:throw Error("getStarRightInnerColorHighContrast: unsupported image type = "+e)}}(e,t);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledInnerColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = "+e)}}(n,c),C=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.StarHigh:return o.StarFilledOuterColor;case i.CFIconImage.StarMedium:case i.CFIconImage.StarLow:return o.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = "+e)}}(n,c),v=n===i.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,h),v&&(a.fillAndStroke(e,p,C),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,h),a.fillAndStroke(e,f,m)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSigns=void 0;var r=n(0),i=n(16),o=n(22),a=n(41),l=n(33),s=n(17);function d(e,t){if(!t)switch(e){case i.CFIconImage.SignLow:return o.SignLowInnerColor;case i.CFIconImage.SignMedium:return o.SignMediumInnerColor;default:throw Error("getInnerColor: unsupported image type = "+e)}}function u(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case i.CFIconImage.SignLow:return o.SignLowOuterColor;case i.CFIconImage.SignMedium:return o.SignMediumOuterColor;default:throw Error("getOuterColor: unsupported image type = "+e)}}t.drawSigns=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawSigns"),r.verifyArgumentNotNull(t,"drawingContext","drawSigns");var n=t.image;switch(n){case i.CFIconImage.SignLow:!function(e,t){var n=t.image,r=t.highContrastScheme,i=d(n,r),o=u(n,r),a=function(e){var t=e.size,n=e.left,r=e.bottom,i=Math.floor(t/2),o=n+i+s.ShapeLinesAdjustment,a=r-i-s.ShapeLinesAdjustment;return{top:{x:o,y:a-i},right:{x:o+i,y:a},bottom:{x:o,y:a+i},left:{x:o-i,y:a}}}(t);e.beginPath(),e.moveTo(a.top.x,a.top.y),e.lineTo(a.right.x,a.right.y),e.lineTo(a.bottom.x,a.bottom.y),e.lineTo(a.left.x,a.left.y),e.lineTo(a.top.x,a.top.y),l.fillAndStroke(e,i,o)}(e,t);break;case i.CFIconImage.SignMedium:var o=function(e){var t=e.left,n=e.bottom,r=e.size,i=e.highContrastScheme,o=e.image,a=t+s.ShapeLinesAdjustment,l=n-s.ShapeLinesAdjustment,c=d(o,i);return{outerColor:u(o,i),innerColor:c,left:a,bottom:l,height:r,width:r}}(t);a.drawTriangle(e,o,!1);break;default:throw Error("drawSigns: unsupported image type = "+n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawArrows=void 0;var r=n(0),i=n(22),o=n(16),a=n(33),l=n(17);function s(e){var t=Math.round(o.ArrowWidthRatio*e);return t=t%2!=0?t+1:t}function d(e){var t=Math.round(o.ArrowHeightRatio*e);return t=t%2!=0?t+1:t}t.drawArrows=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawArrows"),r.verifyArgumentNotNull(t,"drawingContext","drawArrows");var n=t.image,u=t.size,c=t.left,g=t.bottom,h=t.highContrastScheme,f=function(e,t){if(t)return r.rgbToColorHex(t.TextColor);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayOuterColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpOuterColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownOuterColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightOuterColor;default:throw Error("getArrowOuterColor: unsupported image type = "+e)}}(n,h),m=function(e,t){if(t)return function(e,t){switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return r.rgbToColorHex(t.TextColor);case o.CFIconImage.ColoredArrowUp:case o.CFIconImage.ColoredArrowDown:case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return r.rgbToColorHex(t.BackgroundColor);default:throw Error("getArrowHighContrastInnerColor: unsupported image type = "+e)}}(e,t);switch(e){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.GrayArrowRight:case o.CFIconImage.GrayArrowUp:case o.CFIconImage.GrayArrowUpRight:return i.ArrowGrayInnerColor;case o.CFIconImage.ColoredArrowUp:return i.ArrowUpInnerColor;case o.CFIconImage.ColoredArrowDown:return i.ArrowDownInnerColor;case o.CFIconImage.ColoredArrowUpRight:case o.CFIconImage.ColoredArrowRight:case o.CFIconImage.ColoredArrowDownRight:return i.ArrowRightInnerColor;default:throw Error("getArrowInnerColor: unsupported image type = "+e)}}(n,h),p=[];switch(n){case o.CFIconImage.GrayArrowDown:case o.CFIconImage.ColoredArrowDown:p=function(e,t,n){var r=o.ArrowHeightRatio*n,i=s(n),a=Math.floor(n/2+e)+l.ShapeLinesAdjustment,d=Math.round(t),u=a+r*Math.cos(-3*o.ArrowAngle),c=d+r*Math.sin(-3*o.ArrowAngle),g=u+i*Math.cos(-o.ArrowAngle),h=c+i*Math.sin(-o.ArrowAngle),f=a-i/2,m=h+r/2*Math.sin(o.ArrowAngle),p=m-r,C=f+i,v=p,y=C,T=m,S=a+(a-g),F=h,x=a+(a-u),w=c,R={x:a,y:d},b={x:u,y:c},I={x:g,y:h},A={x:f,y:m},P={x:f,y:Math.round(p)-l.ShapeLinesAdjustment},D={x:C,y:Math.round(v)-l.ShapeLinesAdjustment};return[R,b,I,A,P,D,{x:y,y:T},{x:S,y:F},{x:x,y:w},R]}(c,g,u);break;case o.CFIconImage.GrayArrowUp:case o.CFIconImage.ColoredArrowUp:p=function(e,t,n){var r=t-n,i=o.ArrowHeightRatio*n,a=s(n),d=Math.floor(n/2+e)+l.ShapeLinesAdjustment,u=Math.round(r),c=d+i*Math.cos(3*o.ArrowAngle),g=u+i*Math.sin(3*o.ArrowAngle),h=c+a*Math.cos(o.ArrowAngle),f=g+a*Math.sin(o.ArrowAngle),m=d-a/2,p=f+i/2*Math.sin(-o.ArrowAngle),C=p+i,v=m+a,y=C,T=v,S=p,F=d+(d-h),x=f,w=d+(d-c),R=g,b={x:d,y:u},I={x:c,y:g},A={x:h,y:f},P={x:m,y:p},D={x:m,y:Math.round(C)-l.ShapeLinesAdjustment},M={x:v,y:Math.round(y)-l.ShapeLinesAdjustment};return[b,I,A,P,D,M,{x:T,y:S},{x:F,y:x},{x:w,y:R},b]}(c,g,u);break;case o.CFIconImage.GrayArrowRight:case o.CFIconImage.ColoredArrowRight:p=function(e,t,n){var r=t-n,i=o.ArrowHeightRatio*n,a=s(n),d=Math.round(e+n),u=Math.floor(n/2+r)+l.ShapeLinesAdjustment,c=d+i*Math.cos(-3*o.ArrowAngle),g=u+i*Math.sin(-3*o.ArrowAngle),h=c+a*Math.cos(3*o.ArrowAngle),f=g+a*Math.sin(3*o.ArrowAngle),m=h+i/2*Math.cos(o.ArrowAngle),p=u-a/2,C=m-i,v=p,y=C,T=v+a,S=m,F=u+(u-p),x=h,w=u+(u-f),R=c,b=u+(u-g),I={x:d,y:u},A={x:c,y:g},P={x:h,y:f},D={x:m,y:p},M={x:Math.round(C)+l.ShapeLinesAdjustment,y:v},O={x:Math.round(y)+l.ShapeLinesAdjustment,y:T};return[I,A,P,D,M,O,{x:S,y:F},{x:x,y:w},{x:R,y:b},I]}(c,g,u);break;case o.CFIconImage.GrayArrowDownRight:case o.CFIconImage.ColoredArrowDownRight:p=function(e,t,n){var r=t-n,i=Math.round(o.ArrowWidthRatio*n),a=d(n),s=Math.floor(o.ArrowDownRightTipXRatio*n+e)+l.ShapeLinesAdjustment,u=Math.floor(o.ArrowDownRightTipYRatio*n+r)+l.ShapeLinesAdjustment,c=s,g=u-a,h=c-i,f=g,m=h,p=u-i-i/Math.sqrt(2),C=m+a*Math.cos(-3*o.ArrowAngle),v=p+a*Math.sin(-3*o.ArrowAngle),y=C+i*Math.cos(3*o.ArrowAngle),T=v+i*Math.sin(3*o.ArrowAngle),S=s-a,F=u,x=S,w=F-i,R=s-i-i/Math.sqrt(2),b={x:s,y:u};return[b,{x:c,y:g},{x:h,y:f},{x:m,y:p},{x:C,y:v},{x:y,y:T},{x:R,y:w},{x:x,y:w},{x:S,y:F},b]}(c,g,u);break;case o.CFIconImage.GrayArrowUpRight:case o.CFIconImage.ColoredArrowUpRight:p=function(e,t,n){var r=t-n,i=Math.round(o.ArrowWidthRatio*n),a=d(n),s=Math.floor(o.ArrowUpRightTipXRatio*n+e)+l.ShapeLinesAdjustment,u=Math.floor(o.ArrowUpRightTipYRatio*n+r)+l.ShapeLinesAdjustment,c=s-a,g=u,h=c,f=g+i,m=s-i-i/Math.sqrt(2),p=f,C=m+a*Math.cos(3*o.ArrowAngle),v=p+a*Math.sin(3*o.ArrowAngle),y=C+i*Math.cos(o.ArrowAngle),T=v+i*Math.sin(o.ArrowAngle),S=s,F=u+a,x=S-i,w=F,R=x,b=u+i+i/Math.sqrt(2),I={x:s,y:u};return[I,{x:c,y:g},{x:h,y:f},{x:m,y:p},{x:C,y:v},{x:y,y:T},{x:R,y:b},{x:x,y:w},{x:S,y:F},I]}(c,g,u);break;default:throw Error("drawArrows: unsupported image type = "+n)}a.drawIconFromPoints(e,m,f,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawCircledSymbols=void 0;var r=n(0),i=n(55),o=n(97);t.drawCircledSymbols=function(e,t){r.verifyArgumentNotNull(e,"ctx","drawCircleSymbols"),r.verifyArgumentNotNull(t,"drawingContext","drawCircleSymbols"),t.size>0&&(i.drawCircleIcon(e,t),o.drawSymbols(e,function(e){var t=e.left,n=e.bottom,r=e.image,i=e.highContrastScheme,o=e.size,a=Math.round(t),l=Math.round(n);return{size:Math.round(o),left:a,bottom:l,image:r,highContrastScheme:i}}(t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPageBreaks=void 0;var r=n(2),i=n(37),o=n(0),a=n(98);function l(e,t,n,i,o,a,l){var s=i.Index,g=i.Min,h=i.Max;if(d(s,g,h,n.renderingRegion,!0)){var f=t.ClientOnlyCache,m=c(f.RowOffsetsAdjustedForDrawing,s,o,l),p=-1===i.Min?0:u(f.ColOffsetsAdjustedForDrawing,g,o,a),C=-1===i.Max?t.BlockWidth*n.scaleFactor:u(f.ColOffsetsAdjustedForDrawing,h,o,a);r.drawLine(e,p,m,C,m)}}function s(e,t,n,i,o,a,l){var s=i.Index,g=i.Min,h=i.Max;if(d(s,g,h,n.renderingRegion,!1)){var f=t.ClientOnlyCache,m=u(f.ColOffsetsAdjustedForDrawing,s,o,a),p=-1===i.Min?0:c(f.RowOffsetsAdjustedForDrawing,g,o,l),C=-1===i.Max?t.BlockHeight*n.scaleFactor:c(f.RowOffsetsAdjustedForDrawing,h,o,l);r.drawLine(e,m,p,m,C)}}function d(e,t,n,r,i){var o,a,l=i?r.startRow:r.startColumn,s=i?r.endRow:r.endColumn;return a=s,l<=(o=e)&&o<=a&&(s=i?r.endColumn:r.endRow,!(-1!==t&&t>s)&&(l=i?r.startColumn:r.startRow,!(-1!==n&&n<l)))}function u(e,t,n,o){return t>=0?i.getAdjustedDrawingOffset(e[t],r.getColWidthFromOffsets(t,e),n,o):0}function c(e,t,n,o){return t>=0?i.getAdjustedDrawingOffset(e[t],r.getRowHeightFromOffsets(t,e),n,o):0}t.drawPageBreaks=function(e,t,n){if(null!=t.PageBreaks){a.setPageLayoutLine(e,n);var r=o.getLinePixelTranslation(a.getLineWidth(n)),d=i.getMaxLineOffset(t.BlockWidth,n.scaleFactor,!1),u=i.getMaxLineOffset(t.BlockHeight,n.scaleFactor,!0);e.beginPath(),function(e,t,n,r,i,o){var a,s=null===(a=t.PageBreaks)||void 0===a?void 0:a.Row;if(null==s)return;for(var d=0;d<s.length;++d)l(e,t,n,s[d],r,i,o)}(e,t,n,r,d,u),function(e,t,n,r,i,o){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Col;if(null==l)return;for(var d=0;d<l.length;++d)s(e,t,n,l[d],r,i,o)}(e,t,n,r,d,u),e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPrintAreas=void 0;var r=n(37),i=n(0),o=n(98),a=n(2);function l(e,t){return!(e.startRow>t.LastRow)&&(!(e.startColumn>t.LastColumn)&&(!(e.endRow+1<t.FirstRow)&&(!(e.endColumn+1<t.FirstColumn)&&!(e.startRow>t.FirstRow&&e.startColumn>t.FirstColumn&&e.endRow<t.LastRow&&e.endColumn<t.LastColumn))))}function s(e,t,n,i,o,l,s){var d=t.ClientOnlyCache,u=s.FirstColumn<=0?-1:r.getAdjustedDrawingOffset(d.ColOffsetsAdjustedForDrawing[s.FirstColumn],0,i,l),c=s.FirstRow<=0?-1:r.getAdjustedDrawingOffset(d.RowOffsetsAdjustedForDrawing[s.FirstRow],0,i,o),g=s.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*n.scaleFactor+1:r.getAdjustedDrawingOffset(d.ColOffsetsAdjustedForDrawing[s.LastColumn],a.getColWidthFromOffsets(s.LastColumn,d.ColOffsetsAdjustedForDrawing),i,l),h=s.LastRow>=t.RowNumbers.length?t.BlockHeight*n.scaleFactor+1:r.getAdjustedDrawingOffset(d.RowOffsetsAdjustedForDrawing[s.LastRow],a.getRowHeightFromOffsets(s.LastRow,d.RowOffsetsAdjustedForDrawing),i,o);e.rect(u,c,g-u,h-c)}t.drawPrintAreas=function(e,t,n){var a;if(function(e){i.verifyArgumentNotNull(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),i.verifyArgumentNotNull(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),i.verifyArgumentNotNull(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache,"ClientOnlyCache","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawPrintAreas"),i.verifyArgumentNotNull(e.ClientOnlyCache.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),t.PrintAreas){o.setPageLayoutLine(e,n);var d=i.getLinePixelTranslation(o.getLineWidth(n)),u=r.getMaxLineOffset(t.BlockWidth,n.scaleFactor,!1),c=r.getMaxLineOffset(t.BlockHeight,n.scaleFactor,!0);e.beginPath();for(var g=0;g<(null===(a=t.PrintAreas)||void 0===a?void 0:a.length);g++)l(n.renderingRegion,t.PrintAreas[g])&&s(e,t,n,d,c,u,t.PrintAreas[g]);e.stroke()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawEmptyPivotTableTitleText=t.drawEmptyPivotTableImages=t.drawEmptyPivotTableTitleContainers=void 0;var r=n(1),i=n(2),o=n(3),a=n(63),l=n(50),s=n(0),d=n(26),u=n(6),c=n(32);function g(e,t,n){var r=a.EmptyPivotTableImagePlaceholderThicknessPx,i=s.getLinePixelTranslation(r);e.lineWidth=r,e.fillStyle=e.strokeStyle=n?s.rgbToColorHex(n.TextColor):a.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+i,t.y+i,t.width,t.height)}function h(e,t,n,r){var i=n?s.rgbToColorHex(n.TextColor):a.EmptyPivotTableTitleTextColor;e.font=s.getFontCssStringFromFont(t,void 0,r),e.fillStyle=i,e.textBaseline=c.DefaultTextBaseline,e.textAlign="center"}function f(e,t,n){var r=m(e,t,n),i=l.getPivotTableLeftAdjustedForDrawing(e,t,!1),o=l.getPivotTableTopAdjustedForDrawing(e,t,!1),s=t.OriginPTWidthAdjustedForDrawing,d=t.OriginPTHeightAdjustedForDrawing,u=r.y+r.height,c=o+d,g=r.width,h=c-u-2*a.EmptyPivotTableImageMinimalPaddingYPx*n,f=Math.min(g,a.EmptyPivotTableImageWidthHeightRatio*h),p=Math.min(h,g/a.EmptyPivotTableImageWidthHeightRatio),C=(u+c)/2;return{x:i+Math.round((s-f)/2),y:Math.round(C-p/2),width:f,height:p}}function m(e,t,n){var r=Math.round(t.OriginPTWidthAdjustedForDrawing*a.EmptyPivotTableTitleContainerWidthRatio);return{x:y(e,t,r),y:C(e,t,n),width:r,height:Math.round(a.EmptyPivotTableTitleContainerHeightPx*n)}}function p(e,t){var n=Math.round(t.OriginPTWidth*a.EmptyPivotTableTitleContainerWidthRatio);return{x:T(e,t,n),y:v(e,t),width:n-a.EmptyPivotTableTitleContainerBorderThicknessPx,height:a.EmptyPivotTableTitleContainerHeightPx-a.EmptyPivotTableTitleContainerBorderThicknessPx}}function C(e,t,n){return l.getPivotTableTopAdjustedForDrawing(e,t,!1)+Math.round(a.EmptyPivotTableTitleContainerTopPaddingPx*n)}function v(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+a.EmptyPivotTableTitleContainerTopPaddingPx+a.EmptyPivotTableTitleContainerBorderThicknessPx}function y(e,t,n){var r=Math.floor((t.OriginPTWidthAdjustedForDrawing-n)/2);return l.getPivotTableLeftAdjustedForDrawing(e,t,!1)+r}function T(e,t,n){var r=(t.OriginPTWidth-n)/2+a.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){var n=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-n[t.FirstColIndex]-t.OriginPTWidth:n[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+r}t.drawEmptyPivotTableTitleContainers=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleContainers"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleContainers"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableTitleContainers"),t.PivotTables&&0!==t.PivotTables.length){for(var i=Math.max(Math.round(a.EmptyPivotTableTitleContainerBorderThicknessPx*n.scaleFactor),1),d=s.getLinePixelTranslation(i),u=!1,c=0;c<t.PivotTables.length;c++){var g=t.PivotTables[c];if(g.IsEmptyPivot&&(!(g.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingTitle)&&l.isPivotIntersectsRenderingRegion(t,g,n.renderingRegion,!1))){u||(e.strokeStyle=n.highContrastScheme?s.rgbToColorHex(n.highContrastScheme.TextColor):a.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=i,e.setLineDash(o.DefaultDash),e.beginPath(),u=!0);var h=m(t,g,n.scaleFactor);e.rect(d+h.x,d+h.y,h.width,h.height)}}u&&e.stroke()}},t.drawEmptyPivotTableImages=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableImages"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableImages"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(var i=0;i<t.PivotTables.length;i++){var o=t.PivotTables[i];if(o.IsEmptyPivot&&(!(o.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingImage)&&l.isPivotIntersectsRenderingRegion(t,o,n.renderingRegion,!1))){var s=f(t,o,n.scaleFactor);if(!(s.width<a.EmptyPivotTableMinimalImageWidthPx)){var u=d.getOrLoadStaticImage(0,n.blockIdentifier);u?e.drawImage(u,s.x,s.y,s.width,s.height):g(e,s,n.highContrastScheme)}}}},t.drawEmptyPivotTableTitleText=function(e,t,n){if(r.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleText"),r.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleText"),r.verifyArgumentNotNull(n,"context","drawEmptyPivotTableTitleText"),t.PivotTables&&0!==t.PivotTables.length)for(var o=!1,s=void 0,d=0;d<t.PivotTables.length;d++){var c=t.PivotTables[d];if(c.IsEmptyPivot&&(!(c.OriginPTHeight<a.EmptyPivotTableMinimalHeightForDrawingTitle)&&l.isPivotIntersectsRenderingRegion(t,c,n.renderingRegion,!1)&&c.PivotTableName)){if(!o){var g=r.getReferencedObjectById(r.UniqueStyleID.Default,t.Styles);h(e,s=r.getReferencedObjectById(g.FontID||0,t.Fonts),n.highContrastScheme,t),o=!0}var f=p(t,c),m=f.x+f.width/2,C=u.getTextOffsetYAlphabeticBaseline(t,f.y+f.height,f.height,s.Size,s.FontName,r.VerticalAlignment.Center);i.applyClipping(e,f),e.fillText(c.PivotTableName,m,C),i.restoreClipping(e,f)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDataBars=void 0;var r=n(1),i=n(5),o=n(2),a=n(162),l=n(3),s=n(0),d=n(7);function u(e,t,n){return function(e,t,n){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return n?t-e:e}(Math.round(t*e/100),t,n)}function c(e,t,n,r){if(function(e){return e>0&&e<100}(e))return{X:t+n-s.getLinePixelTranslation(l.GridLineWidthPx),startY:r.y+l.GridLineWidthPx,endY:r.y+r.height-l.GridLineWidthPx}}function g(e,t,n,r,i){var o=Math.round(t.width*e/100);r&&(o=-o);var l=i&&o<0?a.DataBarAxisWidth:0,s=Math.min(n,n+o),d=t.x+s,u=Math.max(Math.abs(o)-l,0);return{x:d,y:t.y,width:u,height:t.height}}function h(e,t){return t.information.GradientColor?function(e,t){var n=function(e){var t,n=e.bar,r=n.x,i=r+n.width,o=null===(t=e.axis)||void 0===t?void 0:t.X;if(d.isNullOrUndefined(o)?e.isRtl:r<o)return{startX:i,endX:r,Y:n.y};return{startX:r,endX:i,Y:n.y}}(t),r=e.createLinearGradient(n.startX,n.Y,n.endX,n.Y);return r.addColorStop(a.GradientStartingPositing,t.information.Color),r.addColorStop(a.GradientEndingPositing,t.information.GradientColor),r}(e,t):t.information.Color}function f(e,t,n,r){e.lineWidth=t,e.setLineDash(n),e.strokeStyle=r}function m(e,t,n){n!==t&&(e.stroke(),e.beginPath(),e.strokeStyle=t)}function p(e,t){var n=C(a.DataBarHorizontalPadding,t),r=C(a.DataBarTopPadding,t),i=C(a.DataBarBottomPadding,t);return{x:e.x+n+l.GridLineWidthPx,y:e.y+n+l.GridLineWidthPx,width:Math.max(0,e.width-2*n-2*l.GridLineWidthPx),height:Math.max(0,e.height-r-i-2*l.GridLineWidthPx)}}function C(e,t){return Math.max(e,Math.round(e*t))}t.drawDataBars=function(e,t,n){r.verifyArgumentNotNull(t,"model","drawDataBars"),r.verifyArgumentNotNull(e,"ctx","drawDataBars"),r.verifyArgumentNotNull(n,"context","drawDataBars");var l=function(e,t){for(var n,a=e.ClientOnlyCache.CellsToRender,l=[],s=0;s<a.length;s++){var h=a[s];if(o.cellIntersectsRenderingRegion(h,t.renderingRegion)){var f=null===(n=h.CondFormat)||void 0===n?void 0:n.DataBar;if(f&&!h.PreviewText&&!h.ShowSkeleton){var m=f.Direction===r.ReadingOrderType.RightToLeft||e.IsRtl&&f.Direction===r.ReadingOrderType.Context,C=i.getCellDimensionsAdjustedForDrawing(e,h,!1),v=p(C,t.scaleFactor),y=u(f.AxisPostion,v.width,m),T=c(f.AxisPostion,v.x,y,C),S=!d.isNullOrUndefined(T),F=g(f.Length,v,y,m,S);l.push({information:f,axis:T,bar:F,isRtl:m})}}}return l}(t,n),C=function(e){if(d.isNullOrUndefined(e))return;return""+s.rgbToColorHex(e.TextColor)}(n.highContrastScheme);!function(e,t,n){for(var r,i=!1,l=!d.isNullOrUndefined(n),s=0;s<t.length;s++){var u=t[s].axis;if(!d.isNullOrUndefined(u)){if(i||(r=l?n:t[s].information.AxisColor,f(e,a.DataBarAxisWidth,a.DataBarAxisLineDash,r),e.beginPath(),i=!0),!l){var c=t[s].information.AxisColor;m(e,c,r),r=c}o.drawLine(e,u.X,u.startY,u.X,u.endY)}}i&&e.stroke()}(e,l,C),d.isNullOrUndefined(C)&&function(e,t){for(var n,r=0;r<t.length;r++){var i=t[r],o=i.bar,a=h(e,i);n!==a&&(e.fillStyle=a,n=a),e.fillRect(o.x,o.y,o.width,o.height)}}(e,l),function(e,t,n){for(var r,i=!1,o=!d.isNullOrUndefined(n),l=0;l<t.length;l++){var u=t[l].information.BorderColor;if(!d.isNullOrUndefined(n)||!d.isNullOrUndefined(u)){var c=(g=t[l].bar,h=void 0,p=void 0,C=void 0,v=void 0,h=g.x+s.getLinePixelTranslation(a.DataBarBorderWidth),p=g.y+s.getLinePixelTranslation(a.DataBarBorderWidth),C=Math.max(g.width-a.DataBarBorderWidth,0),v=Math.max(g.height-a.DataBarBorderWidth,0),{x:h,y:p,width:C,height:v});i||(r=o?n:u,f(e,a.DataBarBorderWidth,[],r),e.beginPath(),i=!0),o||(m(e,u,r),r=u),c.width>0&&e.rect(c.x,c.y,c.width,c.height)}}var g,h,p,C,v;i&&e.stroke()}(e,l,C)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarAxisLineDash=t.GradientEndingPositing=t.GradientStartingPositing=t.DataBarBorderWidth=t.DataBarAxisWidth=t.DataBarBottomPadding=t.DataBarTopPadding=t.DataBarHorizontalPadding=void 0,t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarBorderWidth=1,t.GradientStartingPositing=0,t.GradientEndingPositing=1,t.DataBarAxisLineDash=[3,1]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawDynamicImages=void 0;var r=n(1),i=n(0),o=n(26),a=n(5),l=n(7),s=n(20),d=n(24),u=n(3),c=n(2),g=n(21);function h(e,t,n,l,c,h,f){var m,p,C,v,y=function(e){switch(e){case o.ImageType.Sparkline:return 0;case o.ImageType.InCellImage:return u.GridLineWidthPx;default:throw Error("paddingForImageType: unsupported image type = "+e)}}(f),T=n.scaleFactor*(null!==(p=null===(m=l.Merge)||void 0===m?void 0:m.OriginDeltaX)&&void 0!==p?p:0),S=n.scaleFactor*(null!==(v=null===(C=l.Merge)||void 0===C?void 0:C.OriginDeltaY)&&void 0!==v?v:0),F=0===T?y:0,x=0===S?y:0,w=h.ClusterOffsetX,R=h.ClusterOffsetY,b=a.getCellWidth(t,l,!1)-F,I=a.getCellHeight(t,l,!1)-x,A=a.getCellLeftAdjustedForDrawing(t,l,!1,!0)-T,P=a.getCellTopAdjustedForDrawing(t,l,!0)-S,D=a.getCellWidthAdjustedForDrawing(t,l)-F,M=a.getCellHeightAdjustedForDrawing(t,l)-x,O={x:A,y:P,width:D,height:M};e.drawImage(c,w,R,b,I,A,P,D,M),function(e,t,n,o){if(!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)||!r.isRenderFlagEnabled(r.RenderFlagsArray.ShowDynamicImageCardOnHover,e))return;var a=r.getRenderingRegionHitTestCache(e,i.getRenderingRegionKey(n.renderingRegion)),l=g.getUnadjustedHitRegionFromRect(e,n,o,e.IsRtl);s.registerCursorHitRegion(t,a,l,d.DefaultCursorType,r.RenderFeaturesZIndex.DynamicImage);var u=g.createDynamicImageCallback(e,t,!0,!0),c=g.createDynamicImageCallback(e,t,!1,!1);s.registerHitRegion(t,a,l,r.RenderFeaturesZIndex.DynamicImage,u,"mouseenter"),s.registerHitRegion(t,a,l,r.RenderFeaturesZIndex.DynamicImage,c,"mouseleave")}(t,l,n,O)}t.drawDynamicImages=function(e,t,n,r){i.verifyArgumentNotNull(e,"ctx","drawDynamicImages"),i.verifyArgumentNotNull(t,"model","drawDynamicImages"),i.verifyArgumentNotNull(n,"context","drawDynamicImages");var a=i.getDynamicImages(t,r);if(!l.isNullOrUndefined(a)){var s=t.ClientOnlyCache.CellsToRender,d=o.getOrLoadVersionedImage(r,a.Version,a.ImageUrl,n.blockIdentifier,n.blockIdentifier);if(d)for(var u=0;u<s.length;u++){var g=s[u];if(c.cellIntersectsRenderingRegion(g,n.renderingRegion)){var f=i.getDynamicImageInformationFromCell(g,r);l.isNullOrUndefined(f)||n.isFormulaView&&!l.isNullOrUndefined(g.FormulaInfo)||g.PreviewText||g.ShowSkeleton||h(e,t,n,g,d,f,r)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawExpandCollapseButtons=void 0;var r=n(1),i=n(3),o=n(5),a=n(13),l=n(63),s=n(2),d=n(6),u=n(17),c=n(42),g=n(25),h=n(0),f=n(11),m=n(50),p=n(10),C=n(20),v=n(12),y=n(24);function T(e,t,n){var i,a;if(r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)){if(!(null==n?void 0:n.PivotTable)||!(null==n?void 0:n.PivotTable.CanExpandCollapse))return!1}else if(!(null==n?void 0:n.PivotTable)||!(null==n?void 0:n.PivotTable.HasExpandCollapseIndicator))return!1;return!!s.cellIntersectsRenderingRegion(n,t.renderingRegion)&&(!n.PreviewText&&(!n.ShowSkeleton&&(!((null===(a=null===(i=n.CondFormat)||void 0===i?void 0:i.Icon)||void 0===a?void 0:a.IconOnly)&&!m.canCellContainExpandCollapseAndCFIcon(e,n,o.getCellWidthAdjustedForDrawing(e,n),t.scaleFactor))&&(!(!h.isPivotTablePhase2Enabled(e)&&n.CachedIsTextWidthExceedsCellWidth)&&!(!h.isPivotTablePhase2Enabled(e)&&p.cellTextReplacedWithHashes(n))))))}function S(e,t,n,r){var i=r.width,o=c.getClipRect(t,n,r.left,r.bottom,i,!0);s.applyClipping(e,o),g.drawRectangle(e,r);var a=r.bottom-i;n.PivotTable.IsExpanded?F(e,r,a,i):function(e,t,n,r){F(e,t,n,r),function(e,t,n,r){var i=t+Math.round(r/2)+l.PlusMinusLineAdjustment,o=n+l.MinusPlusPaddingPx,a=n+r-l.MinusPlusPaddingPx-l.MinusPlusWidthPx;e.beginPath(),s.drawLine(e,i,o,i,a),e.stroke()}(e,t.left,n,r)}(e,r,a,i),s.restoreClipping(e,o)}function F(e,t,n,r){var i=Math.round(n+r/2)-l.PlusMinusLineAdjustment,o=t.left+l.MinusPlusPaddingPx+l.MinusPlusWidthPx,a=t.left+r-l.MinusPlusWidthPx;e.strokeStyle=t.outerColor,e.beginPath(),s.drawLine(e,o,i,a,i),e.stroke()}function x(e,t,n,a,s){var u;if(s)return Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)-a/2);var c=null===(u=t.CachedStyle)||void 0===u?void 0:u.VerticalAlignment;if(h.isPivotTablePhase2Enabled(e)){if(c===r.VerticalAlignment.Justify)return Math.floor(Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)-a/2));var g=function(e,t,n,r){var a=d.getTextLineHeight(t,e),l=o.getCellHeight(e,t,!1)-i.GridLineWidthPx,s=d.getTextVerticalPosition(t,e,a,l,n,void 0).absoluteY*r,u=a*r/2;return s+i.InCellBottomAndCenterVerticalPaddingPx-u/2}(e,t,c,n);return Math.round(g-a/2)}var f=l.ExpandCollapseButtonVerticalPaddingPx*n;switch(c){case r.VerticalAlignment.Top:case r.VerticalAlignment.Justify:return Math.floor(o.getCellTopAdjustedForDrawing(e,t,!1)+f);case r.VerticalAlignment.Bottom:return Math.floor(o.getCellBottomAdjustedForDrawing(e,t)-a-f);case r.VerticalAlignment.Center:case r.VerticalAlignment.Distributed:return Math.floor(o.getCellCenterYAdjustedForDrawing(e,t)-a/2);default:throw Error("getAdjustedButtonTop: unsupported verticalAlignment: "+c)}}function w(e,t,n,i,s,u){var c=n.scaleFactor,g=l.PaddingBetweenExpandCollapseButtonAndTextPx*c;if(u)return e.IsRtl?Math.floor(o.getCellRightAdjustedForDrawing(e,t,!1)-g)-i:Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1,!1)+g);var h=d.getDistanceFromCellStartToIconEnd(e,t,n.zoom,n.devicePixelRatio),f=t.CachedStyle.Indentation||l.NoIndent,m=d.getCellHorizontalIndentationPaddingPx(t,f),p=a.getEffectiveHorizontalAlignment(e,t);if(function(e,t,n,r,i){if(!t.WrapText)return!1;var o=R(e,t,n,i);return t.WrapText&&o<r}(e,t,h,s,c))return function(e,t,n,i,a,s,u,c){var g=function(e,t){if(t)return e===r.HorizontalAlignment.Right;return e===r.HorizontalAlignment.Center||e===r.HorizontalAlignment.Left}(n,e.IsRtl)?d.getCellHorizontalIndentationPaddingPx(t,i)*c:l.NoIndent;if(e.IsRtl){var h=o.getCellRightAdjustedForDrawing(e,t,!1);return t.WrapText&&g===l.NoIndent&&n===r.HorizontalAlignment.Left&&u<=0?Math.floor(h):Math.min(Math.floor(h-a-s-g),h)}return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1,!1)+a+g)}(e,t,p,f,g,i,R(e,t,h,c),c);var C=d.getTextHorizontalPosition(e,t,n)*c;switch(p){case r.HorizontalAlignment.Left:if(e.IsRtl)return Math.floor(C+s+g);var v=(m+h+l.PaddingBetweenExpandCollapseButtonAndTextPx)*c;return Math.floor(o.getCellLeftAdjustedForDrawing(e,t,!1,!1)+v);case r.HorizontalAlignment.CenterAcrossSelection:case r.HorizontalAlignment.Center:return e.IsRtl?Math.floor(C+s/2+g):Math.max(Math.floor(C-s/2-g)-i,o.getCellLeftAdjustedForDrawing(e,t,!1,!1));case r.HorizontalAlignment.Right:return e.IsRtl?Math.floor(o.getCellRightAdjustedForDrawing(e,t,!1)-g-m*c)-i:Math.max(Math.floor(C-s-g)-i,o.getCellLeftAdjustedForDrawing(e,t,!1,!1));default:throw Error("getAdjustedButtonLeft: unsupported horizontalAlignment: "+p)}}function R(e,t,n,r){var i=o.getCellWidth(e,t,!1),a=h.isPivotTablePhase2Enabled(e);return s.getTextDrawingMaxWidth(i,d.getCellTextHorizontalPaddingWithoutVisualElements(e,t),n,p.getExpandCollapseButtonPadding(t,a),0)*r}function b(e,t,n,i){var a=t.PivotTable,l=!!a.ConfirmRequired,s=e.RowNumbers[t.Row]-1,d=e.ColumnNumbers[t.Col]-1,u=function(e){return v.togglePivotDrill(e,l,s,d,a.SourceIndex),!0},c=o.getAdjustedCellArea(e,t,!0),g=function(e,t,n){return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:n,isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,c),f=r.getRenderingRegionHitTestCache(e,h.getRenderingRegionKey(n.renderingRegion));if(I(t,f,g,y.DoubleClickEventType,u),i&&function(e,t){if(e.x+e.width<t.left)return!1;if(e.x>t.left+t.width)return!1;if(e.y>t.bottom)return!1;if(e.y+e.height<t.bottom-t.height)return!1;return!0}(c,i)){var m=function(e,t,n,r){var i=n.width,o=n.left,a=n.bottom-i,l=i,s=i,d=Math.min(l,r.x+r.width-o),u=Math.max(a,r.y),c=Math.min(a+s,r.y+r.height)-u;return{isMirrored:!1,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:{x:Math.max(o,r.x),y:u,width:d,height:c},isRtl:e.IsRtl,blockWidth:e.BlockWidth}}(e,n,i,c);I(t,f,m,y.ClickEventType,u);var p=a.ECButtonTitle;C.registerTooltipHitRegion(t,f,m,p,r.RenderFeaturesZIndex.DrillIndicator),C.registerCursorHitRegion(t,f,m,y.PointerCursorType,r.RenderFeaturesZIndex.DrillIndicator)}}function I(e,t,n,i,o){C.registerHitRegion(e,t,n,r.RenderFeaturesZIndex.DrillIndicator,o,i),C.registerHitRegion(e,t,n,r.RenderFeaturesZIndex.DrillIndicator,y.TouchCallback,"touchstart")}function A(e,t,n,r){var i=n.scaleFactor,o=function(e){var t=Math.floor(l.ExpandCollapseButtonSizePx*e);return t%2==0?t:t-1}(i),a=function(e,t,n,r){return function(e){return!!(e.CachedDrawingLayout&&e.CachedDrawingLayout.CellTextLayout&&e.CachedDrawingLayout.CellTextLayout.Width)}(n)?Math.ceil(n.CachedDrawingLayout.CellTextLayout.Width*r):Math.ceil(d.getTextWidthNoCaching(e,t,n)*r)}(e,t,r,i),s=f.shouldRenderVerticalText(r),u=w(t,r,n,o,a,s),c=x(t,r,i,o,s),g=n.highContrastScheme;return{outerColor:g?h.rgbToColorHex(g.TextColor):l.ExpandCollapseButtonOuterColor,innerColor:g?h.rgbToColorHex(g.BackgroundColor):l.ExpandCollapseButtonInnerColor,left:u,bottom:c+o,height:o,width:o}}function P(e,t,n,r){return d.getDistanceFromCellStartToIconEnd(e,t,n.zoom,n.devicePixelRatio)*n.scaleFactor+(t.Spill?o.getSpillCellLeftAdjustedForDrawing(e,t):o.getCellLeftAdjustedForDrawing(e,t,!1,!1))>r.left}t.drawExpandCollapseButtons=function(e,t,n){var o,a;if(r.verifyArgumentNotNull(e,"ctx","drawExpandCollapseButtons"),r.verifyArgumentNotNull(t,"model","drawExpandCollapseButtons"),r.verifyArgumentNotNull(n,"context","drawExpandCollapseButtons"),t.PivotTables)for(var l=t.ClientOnlyCache.CellsToRender,s=!1,d=0;d<l.length;d++){var c=l[d];if(T(t,n,c)){var g=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,t),f=void 0;if(null===(o=c.PivotTable)||void 0===o?void 0:o.HasExpandCollapseIndicator){if(s||(e.lineWidth=u.ShapeOutlineWidthPx,e.setLineDash(i.DefaultDash),s=!0),e.font=h.getFontCssStringFromFont(c.CachedFont,void 0,t),f=A(e,t,n,c),h.isPivotTablePhase2Enabled(t)&&(null===(a=c.CondFormat)||void 0===a?void 0:a.Icon)&&P(t,c,n,f))continue;S(e,t,c,f)}g&&b(t,c,n,f)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawSortDownChevronDownIcon=t.drawSortUpChevronDownIcon=t.drawSortUpFilterIcon=t.drawSortDownFilterIcon=t.drawFilterDownChevronIcon=t.drawDownChevronIcon=void 0;var r=n(0),i=n(38);function o(e,t,n){var r=t.left,o=t.bottom-t.height;e.beginPath(),l(e,r,o,n,!0,t),s(e,t,i.MiniChevronPoints),e.stroke()}function a(e,t,n){var r=t.left,o=t.bottom-t.height;e.beginPath(),s(e,t,i.FilterPoints),l(e,r,o,n,!1,t),e.stroke()}function l(e,t,n,o,a,l){var s=l.width,c=a?i.RightArrowPosition:i.LeftArrowPosition,g=r.getLinePixelTranslation(i.AutoFilterLineWidthPx),h=d(t,c.x,g,s),f=d(n,o?c.y+i.ArrowLengthPx:c.y,g,s),m=u(f,o?-i.ArrowLengthPx:i.ArrowLengthPx,s),p=u(h,-1,s),C=u(h,1,s),v=u(m,o?1:-1,s);e.moveTo(h,f),e.lineTo(h,m),e.moveTo(p,v),e.lineTo(C,v)}function s(e,t,n){if(n&&0!==n.length){var o=t.left,a=t.bottom-t.height,l=n[0],s=r.getLinePixelTranslation(i.AutoFilterLineWidthPx);e.moveTo(d(o,l.x,s,t.width),d(a,l.y,s,t.width));for(var u=1;u<n.length;u++){var c=n[u];e.lineTo(d(o,c.x,s,t.width),d(a,c.y,s,t.width))}}}function d(e,t,n,r){return Math.round(u(e,t,r))+n}function u(e,t,n){return e+t/i.AutoFilterIconRectPx*n}t.drawDownChevronIcon=function(e,t){e.beginPath(),s(e,t,i.ChevronPoints),e.stroke()},t.drawFilterDownChevronIcon=function(e,t){e.beginPath(),s(e,t,i.MiniChevronPoints),s(e,t,i.FilterPoints),e.stroke()},t.drawSortDownFilterIcon=function(e,t){a(e,t,!1)},t.drawSortUpFilterIcon=function(e,t){a(e,t,!0)},t.drawSortUpChevronDownIcon=function(e,t){o(e,t,!0)},t.drawSortDownChevronDownIcon=function(e,t){o(e,t,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maskDifferentialRenderingAreas=void 0;var r=n(1),i=n(3),o=n(2);function a(e,t){var n=t.x,r=t.y,i=t.width,o=t.height;e.moveTo(n,r),e.lineTo(n+i,r),e.lineTo(n+i,r+o),e.lineTo(n,r+o),e.lineTo(n,r)}function l(e,t){var n=r.getRowColFromCellKey(t),a=n.row,l=n.column,s=o.getColOffsetAdjustedForDrawing(l,e);return{x:r.isChangeGateEnabled(r.ChangeGate.FixDiffRenderingRtlBackgroundColorBug)&&e.IsRtl?s:s-i.GridLineWidthPx,y:e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[a]-i.GridLineWidthPx,width:o.getColWidthFromOffsets(l,e.ClientOnlyCache.ColOffsetsAdjustedForDrawing)+i.GridLineWidthPx,height:o.getRowHeightFromOffsets(a,e.ClientOnlyCache.RowOffsetsAdjustedForDrawing)+i.GridLineWidthPx}}t.maskDifferentialRenderingAreas=function(e,t){t.save(),t.beginPath();for(var n=0;n<e.ClientOnlyCache.DirtyCellsKeys.length;n++){var r=l(e,e.ClientOnlyCache.DirtyCellsKeys[n]);r&&a(t,r)}t.strokeStyle="transparent",t.stroke(),t.clip()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawComments=void 0;var r=n(1),i=n(2),o=n(5),a=n(0),l=n(102),s=n(168),d=n(42),u=n(41),c=n(20),g=n(21),h=n(71),f=n(24);function m(e,t){return!!i.cellIntersectsRenderingRegion(e,t)}function p(e,t,n,i,d,u,h){var m=function(e,t,n,r,i){var a=function(e,t,n,r,i){var a=s.shouldAddFilterPaddingToComment(e,t,n,r,i)?s.getFilterWithCommentPadding(e,t,r,i):0;return o.getCellRightAdjustedForDrawing(e,t,e.IsRtl)-(n+a)}(e,t,n,r,i),l=function(e,t,n){return o.getCellTopAdjustedForDrawing(e,t,!1)+n}(e,t,n);return{left:a,bottom:l,width:n,height:n,outerColor:void 0,innerColor:void 0}}(t,n,d,i.devicePixelRatio,i.zoom);u(e,m,h),function(e,t,n,i){var d=r.getRenderingRegionHitTestCache(e,a.getRenderingRegionKey(n.renderingRegion)),u=i.width,h=Math.min(o.getCellWidthAdjustedForDrawing(e,t),o.getCellHeightAdjustedForDrawing(e,t),u*l.CommentHitRegionProportionConstant),m={x:s.getCommentHitRegionLeft(e,t,i.left,i.width,h),y:i.bottom-i.height,width:h,height:h},p=g.getUnadjustedHitRegionFromRect(e,n,m,e.IsRtl),C=g.createCommentsCallback(e,t,!0,!0),v=g.createCommentsCallback(e,t,!1,!1);c.registerCursorHitRegion(t,d,p,f.DefaultCursorType,r.RenderFeaturesZIndex.Comments),c.registerHitRegion(t,d,p,r.RenderFeaturesZIndex.Comments,C,"mouseenter"),c.registerHitRegion(t,d,p,r.RenderFeaturesZIndex.Comments,v,"mouseleave")}(t,n,i,m)}function C(e,t){var n=t.left,r=t.bottom,i=t.width,o=t.height,a=function(e,t,n,r){return[{x:e,y:t},{x:e+n,y:t},{x:e+n,y:t+r},{x:e+n/2,y:t+r/2},{x:e,y:t+r/2},{x:e,y:t}]}(n,r-o,i,o);d.createShapePath(e,a)}t.drawComments=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","drawComments"),r.verifyArgumentNotNull(t,"model","drawComments"),r.verifyArgumentNotNull(n,"context","drawComments"),function(e,t,n){for(var r=!1,i=t.ClientOnlyCache.CellsToRender,o=0;o<i.length;o++){var d=i[o];if(d.Comment&&!d.Comment.IsThreadedComment){if(!m(d,n.renderingRegion))continue;var c=s.getLegacyCommentNotchSize(t,d,l.LegacyCommentSizePx,n.devicePixelRatio,n.zoom);if(c<l.MinCommentIconSizePx)continue;r||(r=!0,e.fillStyle=(g=n.highContrastScheme)?a.rgbToColorHex(g.TextColor):l.LegacyCommentColor,e.beginPath()),p(e,t,d,n,c,u.createTrianglePathOnCellCorner,h.Position.Right)}}var g;r&&e.fill()}(e,t,n),function(e,t,n){for(var r=!1,i=t.ClientOnlyCache.CellsToRender,o=0;o<i.length;o++){var d=i[o];if(d.Comment&&d.Comment.IsThreadedComment){if(!m(d,n.renderingRegion))continue;var u=s.getThreadedCommentNotchSize(t,d,n.devicePixelRatio,n.zoom);if(u<l.MinCommentIconSizePx)continue;r||(r=!0,e.fillStyle=(c=n.highContrastScheme)?a.rgbToColorHex(c.TextColor):l.ThreadedCommentColor,e.beginPath()),p(e,t,d,n,u,C)}}var c;r&&e.fill()}(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommentHitRegionLeft=t.shouldAddFilterPaddingToComment=t.getCommentNotchSizeWithFilter=t.getLegacyCommentNotchSize=t.getThreadedCommentNotchSize=t.getFilterWithCommentPadding=void 0;var r=n(1),i=n(5),o=n(102),a=n(2),l=n(15),s=n(38),d=n(21),u=n(41);function c(e,t,n,r){var i=s.AutoFilterHorizontalPaddingPx+o.CommentWithFilterPaddingPx;return l.getFilterSizeAdjustedForDrawing(e,t,n,r)+Math.round(i*n*r)}function g(e,t,n,r,o){var l=c(e,t,r,o),s=a.getDefaultBorderLineWidth(o*r),d=i.getCellWidthAdjustedForDrawing(e,t)-s-l;return Math.min(n,d)}function h(e,t,n,o,a){var s,d;if(!t.Comment)return!1;if(!r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e))return!1;var u=i.getCellTopAdjustedForDrawing(e,t,!1);if(t.AutoFilter&&!(null===(s=t.AutoFilter.RenderingContext)||void 0===s?void 0:s.IsHidden)||(null===(d=t.PivotFilter)||void 0===d?void 0:d.DisplayFilter)){var c=l.getFilterSizeAdjustedForDrawing(e,t,o,a);if(l.getFilterBottomAdjustedForDrawing(e,t,c,o,a)-c-n<u)return!0}return!1}t.getFilterWithCommentPadding=c,t.getThreadedCommentNotchSize=function(e,t,n,r){var i=d.getInteractiveIconMaxSizeAdjustedForDrawing(o.ThreadedCommentSizePx,e,t,n,r,!0,!0);return h(e,t,i,n,r)&&(i=g(e,t,i,n,r)),i%2==1?i-1:i},t.getLegacyCommentNotchSize=function(e,t,n,r,i){var o=u.getRightAngledTriangleSize(e,t,n,r,i);return h(e,t,o,r,i)&&(o=g(e,t,o,r,i)),o},t.getCommentNotchSizeWithFilter=g,t.shouldAddFilterPaddingToComment=h,t.getCommentHitRegionLeft=function(e,t,n,r,o){var a=i.getCellLeftAdjustedForDrawing(e,t,e.IsRtl,!1),l=i.getCellRightAdjustedForDrawing(e,t,e.IsRtl),s=n+r-o,d=n+o;return(a>s||d>l)&&a-s>=d-l?n:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichError=void 0;var r=n(1),i=n(20),o=n(5),a=n(3),l=n(71),s=n(2),d=n(41),u=n(170),c=n(21),g=n(0),h=n(24);function f(e,t,n,a){var l=r.getRenderingRegionHitTestCache(e,g.getRenderingRegionKey(n.renderingRegion)),s=Math.min(o.getCellWidthAdjustedForDrawing(e,t),o.getCellHeightAdjustedForDrawing(e,t),u.RichErrorHitRegionMaxSizePx*n.scaleFactor),d={x:a.left,y:a.bottom-a.height,width:s,height:s},f=c.getUnadjustedHitRegionFromRect(e,n,d,e.IsRtl),m=c.createRichErrorCallback(e,t,e.RibbonCommands.CardViewShowTemporaryErrorCard,!0),p=c.createRichErrorCallback(e,t,e.RibbonCommands.CardViewHideTemporaryCard,!1);i.registerCursorHitRegion(t,l,f,h.DefaultCursorType,r.RenderFeaturesZIndex.RichError),i.registerHitRegion(t,l,f,r.RenderFeaturesZIndex.RichError,m,"mouseenter"),i.registerHitRegion(t,l,f,r.RenderFeaturesZIndex.RichError,p,"mouseleave")}function m(e,t){return!!e.HasIgnorableError&&!!s.cellIntersectsRenderingRegion(e,t.renderingRegion)}function p(e,t,n){return{left:o.getCellLeftAdjustedForDrawing(e,t,e.IsRtl,!1),bottom:o.getCellTopAdjustedForDrawing(e,t,!1)+n,width:n,height:n,outerColor:void 0,innerColor:void 0}}t.drawRichError=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","drawErrorNotch"),r.verifyArgumentNotNull(t,"model","drawErrorNotch"),r.verifyArgumentNotNull(n,"context","drawErrorNotch");for(var i=!1,o=!1,s=t.ClientOnlyCache.CellsToRender,c=0;c<s.length;c++){var h=s[c];if(m(h,n)){i||(o=!!t.RibbonCommands,r.verifyArgumentNotNull(t.RowNumbers,"model.RowNumbers","RowNumbers"),r.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","ColumnNumbers"),e.setLineDash(a.DefaultDash),e.beginPath(),i=!0);var C=p(t,h,d.getRightAngledTriangleSize(t,h,u.RichErrorTriangleSizePx,n.devicePixelRatio,n.zoom));d.createTrianglePathOnCellCorner(e,C,l.Position.Left),o&&f(t,h,n,C)}}i&&(e.fillStyle=n.highContrastScheme?g.rgbToColorHex(n.highContrastScheme.TextColor):u.RichErrorColor,e.fill())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RichErrorHitRegionMaxSizePx=t.RichErrorTriangleSizePx=t.RichErrorColor=void 0,t.RichErrorColor="#156712",t.RichErrorTriangleSizePx=8,t.RichErrorHitRegionMaxSizePx=25},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRichValueIcons=void 0;var r=n(1),i=n(12),o=n(54),a=n(0),l=n(24),s=n(20),d=n(5),u=n(96),c=n(26),g=n(2),h=n(21),f=n(49),m=n(42),p=n(3),C=n(39),v=n(101),y=n(15);function T(e,t){return!!e.RichValueIcon&&(!!g.cellIntersectsRenderingRegion(e,t.renderingRegion)&&(!e.DisplayFormula&&(!e.PreviewText&&!e.ShowSkeleton)))}function S(e,t,n,u,g){n.RichValueIcon.Type===r.RichValueIconType.LinkedEntity?function(e,t,n){if(!t.RichValueIcon.Unicode)throw Error("drawUnicodeIcon: RichValueIconInformation does not have a char code value.");var r=String.fromCharCode(t.RichValueIcon.Unicode);!function(e,t,n){var r=n.x,i=n.y,o=n.height,a=i+o;e.fillText(t,r,a)}(e,r,n)}(e,n,g):function(e,t,n,i){var o=t.RichValueIcon.Type===r.RichValueIconType.Disambiguation?1:2,a=c.getOrLoadStaticImage(o,n.blockIdentifier);a&&e.drawImage(a,i.x,i.y,i.width,i.height)}(e,n,u,g),function(e,t,n,u){var c,g=u.y+u.height;if(m.shouldClipHorizontally(e,t,u.x,u.width,!1)||m.shouldClipVertically(e,t,g,u.width)){var f=function(e,t,n,r){var i=r.x,o=r.y,a=r.width,l=r.height,s=p.GridLineWidthPx*n.scaleFactor,u=d.getCellLeftAdjustedForDrawing(e,t,!1,!1),c=d.getCellRightAdjustedForDrawing(e,t,!1),g=d.getCellTopAdjustedForDrawing(e,t,!1),h=d.getCellBottomAdjustedForDrawing(e,t)-s,f=w(i,u,c),m=w(o,g,h),C=i+a,v=(C=w(C,u,c))-i,y=o+l;return y=w(y,g,h),{x:f,y:m,width:v,height:y-m}}(e,t,n,u);c=h.getUnadjustedHitRegionFromRect(e,n,f,!1)}else c=h.getUnadjustedHitRegionFromRect(e,n,u,!1);var C=r.getRenderingRegionHitTestCache(e,a.getRenderingRegionKey(n.renderingRegion)),v=function(e){var t,n=e.RichValueIcon.Type;n===r.RichValueIconType.Disambiguation?t=o.gridRendererStrings.richValueIconDisambigTooltip:n!==r.RichValueIconType.Sync&&(t=o.gridRendererStrings.richValueIconShowCard);return t}(t),y=function(t){return i.handleRibbonCommand(t,e.RibbonCommands.CardViewShowDataCardOrDisambiguationPane,""),!0};s.registerCursorHitRegion(t,C,c,l.PointerCursorType,r.RenderFeaturesZIndex.RichValueIcon),s.registerHitRegion(t,C,c,r.RenderFeaturesZIndex.RichValueIcon,y,"click"),s.registerHitRegion(t,C,c,r.RenderFeaturesZIndex.RichValueIcon,l.TouchCallback,"touchstart"),s.registerHitRegion(t,C,c,r.RenderFeaturesZIndex.RichValueIcon,l.EmptyFalseCallback,"touchend"),v&&s.registerTooltipHitRegion(t,C,c,v,r.RenderFeaturesZIndex.RichValueIcon)}(t,n,u,g)}function F(e,t,n,i){var o=Math.round(i*n.scaleFactor),a=v.shouldDrawAutoFilter(t,n);return{x:(e.IsRtl&&a?y.getAutoFilterButtonPadding(e,t,n.devicePixelRatio,n.zoom):0)+f.RichValueIconLeftHorizontalPadding+d.getCellLeftAdjustedForDrawing(e,t,!1,!1),y:function(e,t,n,i){var o=C.getEffectiveVerticalAlignment(t.CachedStyle.VerticalAlignment,C.AdvVerticalAlignmentFormat.CFIcon,void 0,void 0,void 0,void 0,t.DisplayFormula),a=u.getIconBottomWhenAlignedWithMiddleBaseline(e,t,n,i,o),l=t.RichValueIcon.Type!==r.RichValueIconType.LinkedEntity?Math.round(i*f.RichValueSvgIconBottomSizeRatioPadding):0;switch(o){case r.VerticalAlignment.Bottom:case r.VerticalAlignment.Top:return a-l;case r.VerticalAlignment.Center:return u.isIconOutOfCellVerticalBoundaries(e,t,a,i)?Math.floor(d.getCellCenterYAdjustedForDrawing(e,t)+i/2):a-l;default:throw Error("getIconVerticalPosition: Vertical alignment "+o+" is not supported in RV Icon!")}}(e,t,n.scaleFactor,o)-o,width:o,height:o}}function x(e,t,n,r){var i,o;if(!n.highContrastScheme){var a=null!==(o=null===(i=t.CachedFont)||void 0===i?void 0:i.Color)&&void 0!==o?o:"";e.fillStyle!==a&&(e.fillStyle=a)}var l=r.width+"px "+f.RichValueIconUnicodeFontFamily;e.font!==l&&(e.font=l)}function w(e,t,n){return e>n?n:e<t?t:e}t.drawRichValueIcons=function(e,t,n){var i;r.verifyArgumentNotNull(e,"ctx","drawRichValueIcons"),r.verifyArgumentNotNull(t,"model","drawRichValueIcons"),r.verifyArgumentNotNull(n,"context","drawRichValueIcons");var o=t.ClientOnlyCache.CellsToRender;!function(e,t){var n=t.highContrastScheme;e.fillStyle=n?a.rgbToColorHex(n.TextColor):p.DefaultCellFontColor,e.textAlign="left",e.textBaseline="alphabetic"}(e,n);for(var l=0;l<o.length;l++){var s=o[l];if(T(s,n)){var d=F(t,s,n,s.RichValueIcon.Width),u=d.x,c=d.y,h=d.width,f=c+h,C=m.getClipRect(t,s,u,f,h,!0);(null===(i=s.RichValueIcon)||void 0===i?void 0:i.Type)===r.RichValueIconType.LinkedEntity&&x(e,s,n,d),C&&g.applyClipping(e,C),S(e,t,s,n,d),C&&g.restoreClipping(e,C)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellsGeneralTooltip=void 0;var r=n(1),i=n(54),o=n(0),a=n(20),l=n(5),s=n(10),d=n(2);function u(e,t){return!!d.cellIntersectsRenderingRegion(e,t.renderingRegion)&&(!e.PreviewText&&(!e.ShowSkeleton&&!(!e.HasError&&!s.cellTextReplacedWithHashes(e))))}function c(e,t,n){var d=r.getRenderingRegionHitTestCache(e,o.getRenderingRegionKey(t.renderingRegion)),u=l.getCellWidthAdjustedForDrawing(e,n),c=l.getCellHeightAdjustedForDrawing(e,n),g=e.IsRtl,h={x:l.getCellLeftAdjustedForDrawing(e,n,g,!1),y:l.getCellTopAdjustedForDrawing(e,n,!1),width:u,height:c},f={isMirrored:g,renderingRegion:t.renderingRegion,scaleFactor:t.scaleFactor,rect:h,isRtl:g,blockWidth:e.BlockWidth};a.registerTooltipHitRegion(n,d,f,function(e){if(r.verifyArgumentNotNull(i.gridRendererStrings,"gridRendererStrings","getGeneralTooltipStringForCell"),e.HasError)return i.gridRendererStrings.formulaErrorTooltip;if(s.cellTextReplacedWithHashes(e))return e.OriginalText;throw"getGeneralTooltipStringForCell: unexpected tooltip string"}(n),r.RenderFeaturesZIndex.GeneralCellTooltip)}t.registerCellsGeneralTooltip=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","registerCellsTooltip"),r.verifyArgumentNotNull(t,"model","registerCellsTooltip"),r.verifyArgumentNotNull(n,"context","registerCellsTooltip");for(var i=t.ClientOnlyCache.CellsToRender,o=0;o<i.length;o++){var a=i[o];u(a,n)&&c(t,n,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTableSelectors=void 0;var r=n(1),i=n(0),o=n(12),a=n(20),l=n(5),s=n(2),d=n(21),u=n(25),c=n(103),g=n(174),h=n(24);function f(e,t){return!(!e.TableColHeader&&!e.TableRowHeader)&&!!s.cellIntersectsRenderingRegion(e,t.renderingRegion)}function m(e,t,n,r){n.TableColHeader&&n.TableRowHeader&&p(e,t,n,r,2),n.TableColHeader&&p(e,t,n,r,0),n.TableRowHeader&&p(e,t,n,r,1)}function p(e,t,n,s,f){var m=function(e,t,n,r){var i=l.getCellLeftAdjustedForDrawing(e,n,e.IsRtl,!1),o=l.getCellWidthAdjustedForDrawing(e,n),a=l.getCellTopAdjustedForDrawing(e,n,!1),s=l.getCellHeightAdjustedForDrawing(e,n),d=Math.min(g.MaxColumnSelectorHeight,s*g.ColumnSelectorScalingFactor*t.scaleFactor),u=Math.min(g.MaxRowSelectorWidth,o*g.RowSelectorScalingFactor*t.scaleFactor);switch(r){case 0:return{x:i,y:a,width:o,height:d};case 1:return{x:i,y:a,width:u,height:s};case 2:return{x:i,y:a,width:u,height:d};default:throw Error("getTableSelectorRectInfo: unsupported selector type for table selector event: "+r)}}(t,s,n,f);s.debugMode&&function(e,t){var n={outerColor:"#00FF00",innerColor:"",left:t.x,bottom:t.y+t.height,width:t.width,height:t.height};u.drawRectangle(e,n)}(e,m);var p=d.getUnadjustedHitRegionFromRect(t,s,m,t.IsRtl),C=r.getRenderingRegionHitTestCache(t,i.getRenderingRegionKey(s.renderingRegion)),v=function(e,t){switch(e){case 0:return{cursor:c.gridRendererCustomCursors.columnSelectCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector};case 1:return t?{cursor:c.gridRendererCustomCursors.rowSelectRTLCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector}:{cursor:c.gridRendererCustomCursors.rowSelectLTRCursor,zIndex:r.RenderFeaturesZIndex.ColumnOrRowSelector};case 2:return t?{cursor:c.gridRendererCustomCursors.tableSelectRTLCursor,zIndex:r.RenderFeaturesZIndex.TableSelector}:{cursor:c.gridRendererCustomCursors.tableSelectLTRCursor,zIndex:r.RenderFeaturesZIndex.TableSelector};default:throw Error("getCursorAndZIndex: unsupported selector type for table selector event: "+e)}}(f,t.IsRtl),y=v.cursor,T=v.zIndex;a.registerCursorHitRegion(n,C,p,y,T),r.isChangeGateEnabled(r.ChangeGate.TableSelectionDragSelection)?(a.registerHitRegion(n,C,p,T,(function(e){var r=t.RowNumbers[n.Row],i=t.ColumnNumbers[n.Col];return o.tableSelectorsCallback(e,r,i,f),2===f}),"pointerdown"),2===f&&a.registerHitRegion(n,C,p,T,h.EmptyTrueCallback,"pointerup")):(a.registerHitRegion(n,C,p,T,(function(e){var r=t.RowNumbers[n.Row],i=t.ColumnNumbers[n.Col];return o.tableSelectorsCallback(e,r,i,f),!0}),"click"),a.registerHitRegion(n,C,p,T,h.EmptyTrueCallback,"pointerdown")),a.registerHitRegion(n,C,p,T,h.EmptyTrueCallback,"dblclick")}t.registerTableSelectors=function(e,t,n){r.verifyArgumentNotNull(e,"ctx","registerTableSelectors"),r.verifyArgumentNotNull(t,"model","registerTableSelectors"),r.verifyArgumentNotNull(n,"context","registerTableSelectors"),r.verifyArgumentNotNull(t.RowNumbers,"model.RowNumbers","registerTableSelectors"),r.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","registerTableSelectors");for(var i=t.ClientOnlyCache.CellsToRender,o=0;o<i.length;o++){var a=i[o];f(a,n)&&m(e,t,a,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxRowSelectorWidth=t.MaxColumnSelectorHeight=t.DPI=t.RowSelectorScalingFactor=t.ColumnSelectorScalingFactor=void 0,t.ColumnSelectorScalingFactor=.25,t.RowSelectorScalingFactor=.25,t.DPI=96,t.MaxColumnSelectorHeight=t.DPI*t.ColumnSelectorScalingFactor,t.MaxRowSelectorWidth=t.DPI*t.RowSelectorScalingFactor},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawPreviewModeOverlay=void 0;var r=n(1),i=n(0),o=n(2),a=n(176);t.drawPreviewModeOverlay=function(e,t,n){var l;if(n.isCellsPreviewMode&&(null===(l=e.ClientOnlyCache)||void 0===l?void 0:l.PreviewCellsRange)&&function(e,t){if(r.verifyArgumentNotNull(e,"previewRange","isOverlayIntersectsRenderingRegion"),r.verifyArgumentNotNull(t,"renderingRegion","isOverlayIntersectsRenderingRegion"),e.LastRow<t.startRow)return!1;if(e.FirstRow>t.endRow)return!1;if(e.FirstColumn<t.startColumn)return!1;if(e.LastColumn>t.endColumn)return!1;return!0}(e.ClientOnlyCache.PreviewCellsRange,n.renderingRegion)){var s=function(e,t){var n=e.ClientOnlyCache.PreviewCellsRange,r=function(e,t){if(t.FirstRow<e.RowNumbers[0])return-100;var n=i.getModelRowIndex(e,t.FirstRow);return e.ClientOnlyCache.RowOffsetsAdjustedForDrawing[n]}(e,n),a=function(e,t,n){if(t.LastRow>e.RowNumbers[e.RowNumbers.length-1])return o.getBlockDimensionsAdjustedForDrawing(e.BlockHeight,n)+100;var r=i.getModelRowIndex(e,t.LastRow),a=e.ClientOnlyCache.RowOffsetsAdjustedForDrawing;return a[r]+o.getRowHeightFromOffsets(r,a)}(e,n,t.scaleFactor),l=function(e,t){if(t.FirstColumn<e.ColumnNumbers[0])return-100;var n=i.getModelColumnIndex(e,t.LastColumn);return e.ClientOnlyCache.ColOffsetsAdjustedForDrawing[n]}(e,n),s=function(e,t,n){if(t.LastColumn>e.ColumnNumbers[e.ColumnNumbers.length])return o.getBlockDimensionsAdjustedForDrawing(e.BlockWidth,n)+100;var r=i.getModelColumnIndex(e,t.LastColumn),a=e.ClientOnlyCache.ColOffsetsAdjustedForDrawing;return a[r]+o.getColWidthFromOffsets(r,a)}(e,n,t.scaleFactor);return{x:l,y:r,width:s-l,height:a-r}}(e,n),d=n.highContrastScheme;d||(t.fillStyle=a.PreviewStyleBackgroundColor,t.globalAlpha=a.PreviewBackgroundGlobalAlpha,t.fillRect(s.x,s.y,s.width,s.height),t.globalAlpha=a.PreviewBorderGlobalAlpha,t.shadowColor=a.PreviewBorderShadowColor,t.shadowBlur=a.PreviewBorderShadowBlur,t.shadowOffsetY=a.PreviewBorderShadowOffsetY),t.strokeStyle=d?i.rgbToColorHex(d.TextColor):a.PreviewBorderColor,t.lineWidth=d?a.PreviewBorderHighContrastWidthPx:a.PreviewBorderWidthPx,t.strokeRect(s.x,s.y,s.width,s.height),t.globalAlpha=1,t.shadowColor="transparent"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewBorderHighContrastWidthPx=t.PreviewBorderWidthPx=t.PreviewBorderShadowOffsetY=t.PreviewBorderShadowBlur=t.PreviewBorderShadowColor=t.PreviewBorderGlobalAlpha=t.PreviewBorderColor=t.PreviewBackgroundGlobalAlpha=t.PreviewStyleBackgroundColor=void 0,t.PreviewStyleBackgroundColor="#edebe9",t.PreviewBackgroundGlobalAlpha=.4,t.PreviewBorderColor="#000000",t.PreviewBorderGlobalAlpha=.35,t.PreviewBorderShadowColor="#000000",t.PreviewBorderShadowBlur=4,t.PreviewBorderShadowOffsetY=4,t.PreviewBorderWidthPx=1,t.PreviewBorderHighContrastWidthPx=3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPolyFills=void 0;var r=n(178),i=n(179),o=n(180),a=n(181),l=n(182),s=n(183),d=n(184),u=n(185),c=n(186),g=!1;t.loadPolyFills=function(){g||(r.loadStringRepeat(),i.loadStringTrimRight(),o.loadStringStartsWith(),a.loadStringEndsWith(),d.loadGetLineDash(),l.loadSetLineDash(),s.loadStringCodeAtPoint(),u.loadArrayMap(),c.loadDateNow(),g=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringRepeat=void 0;var r=n(7);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,n=0;if(r.isNullOrUndefined(e)&&(n=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(n=Math.floor(e),0===t.length||0===n)return"";if(t.length*n>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var i=t.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)t+=t,n--;return t+=t.substring(0,i-t.length)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=void 0,t.loadStringTrimRight=function(){var e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringStartsWith=void 0,t.loadStringStartsWith=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=t>0?0|t:0;return this.substring(n,n+e.length)===e}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringEndsWith=void 0,t.loadStringEndsWith=function(){String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadSetLineDash=void 0,t.loadSetLineDash=function(){try{CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(e){})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringCodeAtPoint=void 0,t.loadStringCodeAtPoint=function(){
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||(String.prototype.codePointAt=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;if(!(r<0||r>=n)){var i,o=t.charCodeAt(r);return o>=55296&&o<=56319&&n>r+1&&(i=t.charCodeAt(r+1))>=56320&&i<=57343?1024*(o-55296)+i-56320+65536:o}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadGetLineDash=void 0,t.loadGetLineDash=function(){try{CanvasRenderingContext2D.prototype.getLineDash||(CanvasRenderingContext2D.prototype.getLineDash=function(){return[]})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadArrayMap=void 0,t.loadArrayMap=function(){try{Array.prototype.map||(Array.prototype.map=function(e){if(null==this)throw new TypeError("this is null or not defined");var t,n=Object(this),r=n.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");arguments.length>1&&(t=arguments[1]);for(var i=new Array(r),o=0;o<r;){if(o in n){var a=n[o],l=e.call(t,a,o,n);i[o]=l}o++}return i})}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadDateNow=void 0,t.loadDateNow=function(){Date.now||(Date.now=function(){return(new Date).getTime()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCellShrinkToFit=void 0;var r=n(6),i=n(5),o=n(2),a=n(1),l=n(0),s=n(10),d=n(28),u=n(11),c=n(7),g=n(15),h=n(9);function f(e,t,n,r,i,o){return e+i<t?n:n*function(e,t,n,r,i){var o=e+r;if(i){return Math.max(t-r,0)/(e+n)}return t/(o+n)}(e,t,r,i,o)}function m(e,t,n){return r.getFontLineHeight(e,n,t.CachedFont.FontName)*t.CachedDisplayText.length}t.updateCellShrinkToFit=function(e,t,n,p){u.shouldRenderVerticalText(n)?function(e,t){var n=t.CachedFont.Size,r=m(e,t,n),o=i.getCellHeight(e,t,!1),a=f(r,o,n,0,0,!1);t.ShrunkSize=a===n?a:function(e,t,n,r){var i=Math.floor(r);if(i<d.MinAllowedFontSize)return d.MinAllowedFontSize;var o=m(e,t,i);for(;o<n&&i<d.MaxAllowedFontSize;)o=m(e,t,i+=1);for(;o>n&&i>d.MinAllowedFontSize;)o=m(e,t,i-=1);return i}(e,t,o,a)}(t,n):function(e,t,n,d){var u,m=d.zoom,p=d.devicePixelRatio,C=l.getFontCssStringFromFont(n.CachedFont,void 0,t);e.font=C;var v=r.getTextWidthNoCaching(e,t,n),y=i.getCellWidth(t,n,!1),T=n.CachedStyle.Indentation||0,S=n.CachedFont.Size,F=g.shouldAddAutoFilterPadding(t,n)?g.getAutoFilterButtonPadding(t,n,m,p):0,x=r.getHorizontalPadding(t,n,S,n.CachedFont.Italic,T||0,!0,F),w=!c.isNullOrUndefined(null===(u=n.LinkedEntity)||void 0===u?void 0:u.IconWidth)||a.isRenderFlagEnabled(a.RenderFlagsArray.CanvasHitTest,t)&&!!n.RichValueIcon,R=s.getIconSizeAndPadding(t,n,S,m,p),b=o.getTextDrawingMaxWidth(y,x,0,0,g.getAutoFilterButtonPaddingForShrinkToFit(t,n,m,p));n.ShrunkSize=f(v,b,S,x,R,w),n.ShrunkSize<0&&h.setRenderingResultInfo("\n    ShrinkSize was calculated to be negative: "+n.ShrunkSize+",\n    textWidth: "+v+",\n    cellWidth: "+y+",\n    cellIndentation "+T+",\n    maxTextWidth: "+b+",\n    originalFontSize: "+S+",\n    padding: "+x+"\n    ");if(n.ShrunkSize&&n.ShrunkSize>0){var I=l.getFontCssStringFromFont(n.CachedFont,n.ShrunkSize,t);e.font=I,r.getTextWidth(e,t,n)}}(e,t,n,p)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontMargin=t.calculateColWidthForMetadata=void 0;var r=n(1),i=n(0),o=n(6),a=n(3),l=n(10),s=n(49),d=n(15),u=n(38),c=n(23),g=n(19),h=n(105);function f(e){var t=o.measureTextWidth(e,"1234567890",!0,!0);return Math.ceil(t/10)}t.calculateColWidthForMetadata=function(e,t,n){if(n.CachedStyle=r.getReferencedObjectById(n.CellStyleId||0,t.Styles),n.CachedFont=r.getReferencedObjectById(n.CachedStyle.FontID||0,t.Fonts),n.TextRuns){n.CachedFormattedText=i.getFormattedTextForMetadata(n.Text,n,t);for(var m=n.CachedFormattedText,p=0;p<n.CachedFormattedText.TextRuns.length;p++)m.TextRuns[p].CachedFont=r.getReferencedObjectById(m.TextRuns[p].FontID||0,t.Fonts)}return function(e,t,n){r.verifyArgumentNotNull(n.CachedStyle,"CachedStyle","Preproccessor::Helper"),r.verifyArgumentNotNull(n.CachedFont,"CachedFont","Preproccessor::Helper");var m=0;n.TextRuns&&(m=c.measureFormattedTextWidth(e,n.CachedFormattedText,t));var p=i.getFontCssStringFromFont(n.CachedFont,n.CachedFont.Size,t);e.font!==p&&(e.font=p);n.TextRuns||(m=o.measureTextWidth(e,n.Text,!0,!0));g.shouldDrawRotatedText(t,n.CachedStyle,n.CachedFont)&&(m=h.getRotatedTextWidth(t,m,n.CachedStyle,n.CachedFont));var C=function(e,t){var n,i=t.CachedStyle.VerticalText,c=t.CachedStyle.Indentation||0,g=i?0:o.getIndentationPaddingPx(c),h=(null===(n=t.CachedStyle)||void 0===n?void 0:n.VerticalText)?o.getFontLineHeight(e,t.CachedFont.Size,t.CachedFont.FontName):0,f=function(e,t){var n;if(t.CondWidthIcon){var i=null===(n=t.CachedFont)||void 0===n?void 0:n.Size,o=l.getIconSize(i,1),c=l.getIconHorizontalPadding(i,1);return o+c+a.GridLineWidthPx}if(r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e)&&t.RichValueIcon){var g=d.shouldAddAutoFilterPaddingForMetadata(e,t)?Math.round(u.AutoFilterIconRectPx+u.AutoFilterTextHorizontalPaddingPx):0;return t.IconWidth||0+s.RichValueIconRightHorizontalPadding+g}return 0}(e,t)||0,m=l.getExpandCollapseButtonWidth(t.ExpandColButton),p=d.shouldAddAutoFilterPaddingForMetadata(e,t)?u.AutoFilterIconRectPx+u.AutoFilterTextHorizontalPaddingPx:0;return g+h+m+f+p}(t,n),v=f(e);return Math.round(m+C+v)}(e,t,n)},t.getFontMargin=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestableGridBlockModelAccessor=t.GridBlockModelAccessor=void 0;var r=n(4),i=n(0),o=n(1),a=n(73),l=n(7),s=n(5),d=n(86),u=n(26),c=n(2),g=n(6),h=n(10),f=n(15),m=n(8),p=n(70),C=n(12),v=n(106),y=n(74),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canvasInstance=null,t}return r.__extends(t,e),t.verifyArgumentNotNull=function(e,t,n){i.verifyArgumentNotNull(e,t,"GridBlockModelAccessor."+n)},t.prototype.getCell=function(e,t){return o.getCell(e,t,this.model)},t.prototype.shouldCellExistInModel=function(e,t){if(!this.getCell(e,t))try{o.validateCellShouldExistInModelUnsafe(this.model,e,t)}catch(e){return!1}return!0},t.prototype.getOrCreateCell=function(e,t){return o.getOrCreateCell(this.model,e,t)},t.prototype.getUniqueId=function(){return this.model.UniqueId},t.prototype.getCellStyle=function(e){return o.getCellStyle(this.model,e)},t.prototype.getCellFont=function(e){return i.getCellFont(e,this.model)},t.prototype.hasRichText=function(e){return t.verifyArgumentNotNull(e,"cell","hasRichText"),!l.isNullOrUndefined(null==e?void 0:e.TextRuns)},t.prototype.cloneCellFont=function(e){var t=i.getCellFont(e,this.model);return t?i.duplicateFont(t,t.ID||0,t.RefCount||0):t},t.prototype.getBorderStyle=function(e){return t.verifyArgumentNotNull(e,"cell","getBorderStyle"),t.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","getBorderStyle"),l.isNullOrUndefined(e.CachedBorderStyle)&&(e.CachedBorderStyle=o.getReferencedObjectById(e.BorderStyleID||0,this.model.BorderStyles)),e.CachedBorderStyle},t.prototype.removeBorder=function(e){t.verifyArgumentNotNull(e,"cell","removeBorder"),t.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),e.BorderStyleID=o.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=o.getReferencedObjectById(e.BorderStyleID||0,this.model.BorderStyles)},t.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},t.prototype.isRtl=function(){return this.model.IsRtl},t.prototype.setIsRtl=function(e){this.model.IsRtl=e,this.setDirty("isRtl",o.DirtyType.ModelCoreChanges)},t.prototype.replaceCellInModel=function(e,n){t.verifyArgumentNotNull(e,"cell","replaceCellInModel"),t.verifyArgumentNotNull(n,"immediateModel","replaceCellInModel"),t.verifyArgumentNotNull(n.Styles,"immediateModel!.Styles","replaceCellInModel");var r=n.Styles[0];t.verifyArgumentNotNull(r,"style","replaceCellInModel"),t.verifyArgumentNotNull(n.Fonts,"immediateModel!.Fonts","replaceCellInModel");var a=this.duplicateAndSetFontsInModel(n.Fonts);e.TextRuns&&(e.TextRuns=this.duplicateTextRuns(e.TextRuns,a)),r.FontID=a[r.FontID||0],e.CachedFont=this.model.Fonts[r.FontID||0];var s=this.getLastNonUniqueStyleID()+1;if(r.ID=s,this.model.Styles.splice(s,0,r),e.StyleID=s,e.CachedStyle=r,!l.isNullOrUndefined(n.BorderStyles)){var d=n.BorderStyles[0];!l.isNullOrUndefined(d)&&!l.isNullOrUndefined(d.Borders)&&d.Borders.length>0&&(d.RefCount=1,this.setBorders(e,d))}if(this.getCell(e.Row,e.Col)){var u=i.getCellPositionInArray(e,this.model.Cells);this.model.Cells[u]=e,this.model.ClientOnlyCache.CellLookup[o.getCellLookupKey(e.Row,e.Col)]=e}else this.attachCellToModel(e);r.RefCount=1},t.prototype.attachCellToModel=function(e){if(t.verifyArgumentNotNull(e,"cell","attachCellToModel"),t.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","attachCellToModel"),!this.getCell(e.Row,e.Col)){var n=o.getModelClientCache(this.model),r=i.getCellPositionInArray(e,this.model.Cells);this.model.Cells.splice(r,0,e),n.CellLookup[o.getCellLookupKey(e.Row,e.Col)]=e;var a=this.getCellStyle(e);t.verifyArgumentNotNull(a,"style","attachCellToModel"),a.RefCount=i.incrementNumericVal(a.RefCount||0);var l=this.getBorderStyle(e);t.verifyArgumentNotNull(l,"borderStyle","attachCellToModel"),l.RefCount=i.incrementNumericVal(l.RefCount||0),e.CachedBorderStyle=l}},t.prototype.prepareCellStyleForEdit=function(e){t.verifyArgumentNotNull(e,"cell","prepareCellStyleForEdit");var n=this.getCellStyle(e);if(!this.isStyleUnique(n.ID||0)&&(n.RefCount||0)<=1)return!0;var r=this.getLastNonUniqueStyleID()+1,o=i.duplicateStyle(this.model,n,r,1);return n.RefCount=Math.max(0,(n.RefCount||0)-1),this.model.Styles.splice(r,0,o),e.CachedStyle=o,e.StyleID=r,!1},t.prototype.setDefaultHyperlinkStyleOnCell=function(e){t.verifyArgumentNotNull(e,"cell","setDefaultHyperlinkStyleOnCell");var n=o.getReferencedObjectById(o.UniqueStyleID.Hyperlink,this.model.Styles);e.StyleID=o.UniqueStyleID.Hyperlink,e.CachedStyle=n,n.RefCount=i.incrementNumericVal(n.RefCount||0)},t.prototype.editCellFontAttributes=function(e,n){if(t.verifyArgumentNotNull(e,"cell","editFont"),t.verifyArgumentNotNull(e,"editFontAction","editFont"),this.attachCellToModel(e),this.prepareFontForEdit(e),e.TextRuns)for(var r=0;r<e.TextRuns.length;r++){var i=e.TextRuns[r];l.isNullOrUndefined(i.CachedFont)&&(i.CachedFont=o.getReferencedObjectById(i.FontID||0,this.model.Fonts)),n(i.CachedFont)}n(e.CachedFont)},t.prototype.copyCacheItemsToModel=function(e){i.verifyArgumentNotNull(e,"sourceModel","copyClientOnlyCacheToNewModel"),(null==e?void 0:e.ClientOnlyCache)&&(this.model.ClientOnlyCache||(this.model.ClientOnlyCache={}),this.model.ClientOnlyCache.RenderingRegionsHitTestCache=e.ClientOnlyCache.RenderingRegionsHitTestCache)},t.prototype.prepareFontForEdit=function(e){if(null==e?void 0:e.TextRuns)for(var t=0;t<e.TextRuns.length;t++){var n=e.TextRuns[t],r=l.isNullOrUndefined(n.CachedFont)?o.getReferencedObjectById(n.FontID||0,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(r,n)}this.prepareCellFontForEdit(e)},t.prototype.prepareBorderStyleForEdit=function(e){t.verifyArgumentNotNull(e,"cell","prepareBorderStyleForEdit");var n=this.getBorderStyle(e);if(!((n.ID||0)!==o.UniqueStyleID.DefaultBorder&&(n.RefCount||0)<=1)){var r=i.duplicateBorderStyle(n,0,1);this.setBorders(e,r)}},t.prototype.cloneBorderStyle=function(e){t.verifyArgumentNotNull(e,"cell","cloneBorderStyle");var n=this.getBorderStyle(e);return i.duplicateBorderStyle(n,n.ID||0,1)},t.prototype.setBorders=function(e,n){t.verifyArgumentNotNull(e,"cell","setBorders"),t.verifyArgumentNotNull(n,"BorderStyle","setBorders");var r=this.getBorderStyle(e),i=this.getLastBorderStyleID()+1;n.ID=i,r.RefCount=Math.max(0,(r.RefCount||0)-1),this.model.BorderStyles.splice(i,0,n),e.BorderStyleID=i,e.CachedBorderStyle=n},t.prototype.getCellCssFont=function(e){return i.verifyCellStyleAndFont(this.model,e,"getCellCssFont"),i.getFontCssStringFromCell(e,this.model)},t.prototype.isDirty=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.IsDirty)&&void 0!==t&&t},t.prototype.setCellAndSpannedOverCellsDirty=function(e){e&&(i.setCellAndSpannedOverCellsDirty(this.model,e),this.setDirtyInternal(o.DirtyType.ModelCellChanges))},t.prototype.setAdjacentCellsDirty=function(e){if(e){var t=o.isChangeGateEnabled(o.ChangeGate.AdjacentCellsMergeFix)?o.getAdjacentCellsKeys(this.model,e):o.getAdjacentCellsKeysOld(this.model,e.Row,e.Col);this.setCellsDirty(t)}},t.prototype.isDirtyDueToViewportChangeOnly=function(){var e;return!!(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyType)&&this.model.ClientOnlyCache.DirtyType===o.DirtyType.ViewportChange},t.prototype.setCellsDirty=function(e){if(e){this.verifyDirtyCellsKeysInitialized();var t=o.getModelClientCache(this.model);t.DirtyCellsKeys=t.DirtyCellsKeys.concat(e),this.setDirtyInternal(o.DirtyType.ModelCellChanges)}},t.prototype.getDirtyCellsCount=function(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsKeys)?this.model.ClientOnlyCache.DirtyCellsKeys.filter(o.uniqueValuesFilter).length:0},t.prototype.getDirtyCellsKeys=function(){var e;return(null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyCellsKeys)?this.model.ClientOnlyCache.DirtyCellsKeys:[]},t.prototype.onRenderingCompleted=function(){var e=o.getModelClientCache(this.model);e.DirtyCellsKeys=void 0,e.DisableDiffRendering=!1,e.IsDirty=!1,e.DirtyTimestamp=void 0,e.DirtyType=o.DirtyType.None},t.prototype.isDifferentialRenderingSupported=function(){var e,t=o.isDifferentialRenderingSupported(this.model),n=o.getModelClientCache(this.model);return m.ULS.sendTraceTag(559957858,m.LogCategory.msoulscat_ES_EWAJSGrid,m.TraceLevel.Info,"GridBlockModelAccessor::isDifferentialRenderingSupported result: "+t+", isDisabled: "+n.DisableDiffRendering+", isDirty: "+n.IsDirty+", dirtyCellsCount: "+(null===(e=n.DirtyCellsKeys)||void 0===e?void 0:e.length)),t},t.prototype.getCalcBlockModel=function(){var e=new o.CalcBlockModel,t=this.model.RowNumbers.slice(),n=this.model.ColumnNumbers.slice();e.addHeaders(t,n);for(var r=0;r<this.model.Cells.length;r++){var i=this.model.Cells[r],a=e.createCell(i);e.addCell(a)}return e},t.prototype.getDirtyTimestamp=function(){var e,t;return null!==(t=null===(e=this.model.ClientOnlyCache)||void 0===e?void 0:e.DirtyTimestamp)&&void 0!==t?t:-1},t.prototype.updateCellSpillInformation=function(e,t,n){var r,s;i.verifyCellStyleAndFont(this.model,e,"updateCellSpillInformation");var d=t*n;if(c.isAdjustedForDrawingOffsetsInitialized(this.model)||c.initializeOffsetsForDrawing(this.model,d),l.isNullOrUndefined(null===(r=null==e?void 0:e.CachedDrawingLayout)||void 0===r?void 0:r.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),!e.Merge&&(null===(s=null==e?void 0:e.CachedStyle)||void 0===s?void 0:s.HorizontalAlignment)!==o.HorizontalAlignment.CenterAcrossSelection){this.setCellAndSpannedOverCellsDirty(e),e.Spill=void 0;var u;u=this.getOrCreateCanvasContext(),this.setContextCellFont(u,e),a.updateCellSpill(u,this.model,e,t,n),void 0!==e.Spill&&this.removeBordersWithinASpillCell(e),this.setCellAndSpannedOverCellsDirty(e)}},t.prototype.updateTolType=function(e){if(i.verifyCellStyleAndFont(this.model,e,"updateTolType"),o.isRenderFlagEnabled(o.RenderFlagsArray.TextWidthClientPhase1,this.model)){var t;t=this.getOrCreateCanvasContext(),this.setContextCellFont(t,e);var n=s.getCellWidth(this.model,e,!0),r=g.measureTextWidth(t,e.Text,!0,!0);if(e.ValueType===o.CellValueType.Number)r/n*100>C.getServiceSetting(9,80)&&(e.TolType=o.TolType.Autofit);else if(null==e?void 0:e.Spill){var a=s.getSpillCellWidth(e,this.model),l=r/(a-this.model.ColumnWidths[s.getSpillCellEndCol(e,this.model)])*100;r/a*100>C.getServiceSetting(10,80)&&(e.TolType=o.TolType.Spill),l<C.getServiceSetting(11,120)&&(e.TolType=o.TolType.Spill)}}},t.prototype.updateClosestNonEmptyCellsSpillInformation=function(e,n,r){t.verifyArgumentNotNull(e,"cell","updateClosestNonEmptyCellsSpillInformation"),i.verifyCellStyleAndFont(this.model,e,"updateClosestNonEmptyCellsSpillInformation");var o;o=this.getOrCreateCanvasContext(),this.setContextCellFont(o,e),a.updateClosestNonEmptyCellsSpill(o,e,this.model,n,r)},t.prototype.getUserInput=function(e){return t.verifyArgumentNotNull(e,"cell","getUserInput"),e.UserInput},t.prototype.setUserInput=function(e,n){t.verifyArgumentNotNull(e,"cell","setUserInput"),t.verifyArgumentNotNull(n,"userInput","setUserInput"),e.UserInput=n},t.prototype.clearCellFormat=function(e){var t=o.getReferencedObjectById(o.UniqueStyleID.Default,this.model.Styles);e.StyleID=o.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=o.getReferencedObjectById(t.FontID||0,this.model.Fonts),e.BorderStyleID=o.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=o.getReferencedObjectById(o.UniqueStyleID.DefaultBorder,this.model.BorderStyles)},t.prototype.getRowIndex=function(e){return i.getModelRowIndex(this.model,e)},t.prototype.getColumnIndex=function(e){return t.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),i.binarySearch(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,i.numbersComparer)},t.prototype.getCellWidth=function(e,n){return t.verifyArgumentNotNull(e,"cell","getCellWidth"),s.getCellWidth(this.model,e,n)},t.prototype.getHorizontalPadding=function(e,n,r){t.verifyArgumentNotNull(e,"cell","getHorizontalPadding");var i=n*r;return this.ensureCachedObjectsInitialized(this.model,e,i),g.getCellTextHorizontalPadding(e,this.model,n,r)},t.prototype.getCellHeight=function(e){return t.verifyArgumentNotNull(e,"cell","getCellHeight"),s.getCellHeight(this.model,e,!0)},t.prototype.getTextMaxWidth=function(e,n,r){if(t.verifyArgumentNotNull(e,"cell","getTextDrawingMaxWidth"),o.isRenderFlagEnabled(o.RenderFlagsArray.TextMaxWidthEwaJsFix,this.model)){var a=n*r;this.ensureCachedObjectsInitialized(this.model,e,a)}var l=i.isPivotTablePhase2Enabled(this.model);return c.getTextDrawingMaxWidth(this.getCellWidth(e,!0),g.getCellTextHorizontalPadding(e,this.model,n,r),g.getDistanceFromCellStartToIconEnd(this.model,e,n,r),h.getExpandCollapseButtonPadding(e,l),0)},t.prototype.getFormattedText=function(e){var n=this;if(t.verifyArgumentNotNull(e,"cell","getFormattedText"),t.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText"),!o.isRenderFlagEnabled(o.RenderFlagsArray.GetFormattedTextFix,this.model))return this.getFormattedTextUsingSet(e);var r=[],a=[],l=function(e){if(!a[e])if(e<n.model.Fonts.length){var t=n.model.Fonts[e];a[e]=i.duplicateFont(t,t.ID||0,t.RefCount||0)}else v.BlockModelAccessor.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")};if(e.TextRuns)e.TextRuns.forEach((function(e){l(e.FontID||0),r.push(n.duplicateTextRun(e))}));else{var s=e.CachedStyle?e.CachedStyle:this.getCellStyle(e),d={FontID:s.FontID||0,StartIndex:0};l(s.FontID||0),r.push(d)}return{Text:e.Text||"",TextRuns:r,Fonts:a}},t.prototype.getNoControlPhoneticText=function(e,n){return t.verifyArgumentNotNull(e,"phoneticInfo","getNoControlPhoneticText"),t.verifyArgumentNotNull(n,"cellText","getNoControlPhoneticText"),p.getNoControlPhoneticText(e,n)},t.prototype.prepareTextRunFontForEdit=function(e,t){(e.RefCount||0)<=1||this.duplicateAndSetNewFontOnTextRun(e,t)},t.prototype.prepareCellFontForEdit=function(e){var t=this.getCellFont(e);this.prepareCellStyleForEdit(e)&&(t.RefCount||0)<=1||this.duplicateAndSetNewFontOnCell(t,e)},t.prototype.getFormattedTextUsingSet=function(e){var t=this,n=new Set,r=[];if(e.TextRuns)e.TextRuns.forEach((function(e){n.add(e.FontID||0),r.push(t.duplicateTextRun(e))}));else{var o=e.CachedStyle?e.CachedStyle:this.getCellStyle(e),a={FontID:o.FontID||0,StartIndex:0};n.add(o.FontID||0),r.push(a)}var l=[];return n.forEach((function(e){if(e<t.model.Fonts.length){var n=t.model.Fonts[e];l[e]=i.duplicateFont(n,n.ID||0,n.RefCount||0)}else v.BlockModelAccessor.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")})),{Text:e.Text||"",TextRuns:r,Fonts:l}},t.prototype.setFormattedText=function(e,n){t.verifyArgumentNotNull(e,"cell","setFormattedText"),t.verifyArgumentNotNull(n,"formattedText","setFormattedText"),t.verifyArgumentNotNull(n.TextRuns,"formattedText.TextRuns","setFormattedText"),t.verifyArgumentNotNull(n.Fonts,"formattedText.Fonts","setFormattedText"),t.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","setFormattedText"),this.attachCellToModel(e),e.Text=n.Text;for(var r=this.duplicateAndSetFontsInModel(n.Fonts),i=e.TextRuns=this.duplicateTextRuns(n.TextRuns,r),a=0;a<i.length;a++)i[a].CachedFont=o.getReferencedObjectToCache(i[a].FontID||0,this.model.Fonts)},t.prototype.discardFormattedText=function(e){t.verifyArgumentNotNull(e,"cell","discardFormattedText"),e.TextRuns=void 0},t.prototype.serializeCell=function(e){return o.serializeCell(e,this.model)},t.prototype.getOutlineState=function(e,t){var n=e?this.model.RowOutlines:this.model.ColumnOutlines;return n?n[t]:o.OutlineState.None},t.prototype.compareCells=function(e,t,n){return o.areCellsEqual(e,t,n,this.model)},t.prototype.updateNumFmt=function(e){t.verifyArgumentNotNull(e,"cell","updateNumFmt"),o.isAccAndCustomNumFmtApplicable(e)?d.updateNumFmtFromCell(e):e.NumFmt=void 0},t.prototype.updateCellText=function(e,n){t.verifyArgumentNotNull(e,"cell","updateCellText"),t.verifyArgumentNotNull(n,"text","updateCellText"),e.TextRuns=void 0,e.DisplayFormula=!1,i.updateCellText(this.model,e,n)},t.prototype.hasPageLayout=function(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas},t.prototype.hasIntersectingPrintArea=function(e){var n=this.model.PrintAreas;if(t.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","hasIntersectingPrintArea"),t.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","hasIntersectingPrintArea"),n&&e)for(var r=this.model.RowNumbers.length,o=this.model.ColumnNumbers.length,a=0;a<n.length;a++){var l=n[a];if(l.FirstRow!==r&&l.FirstColumn!==o){var s=this.getRowNumber(l.FirstRow),d=l.LastRow>=r?this.getRowNumber(r-1):this.getRowNumber(l.LastRow),u={FirstRow:s,FirstColumn:this.getColumnNumber(l.FirstColumn),LastRow:d,LastColumn:l.LastColumn>=o?this.getColumnNumber(o-1):this.getColumnNumber(l.LastColumn)};if(i.doRangesIntersect(e,u))return!0}}return!1},t.prototype.setPrintArea=function(e){e&&0!==e.length&&(this.model.PrintAreas=e,this.setDirty("setPrintArea",o.DirtyType.ModelCoreChanges))},t.prototype.addToPrintArea=function(e){e&&0!==e.length&&(this.model.PrintAreas=(this.model.PrintAreas||[]).concat(e),this.setDirty("addToPrintArea",o.DirtyType.ModelCoreChanges))},t.prototype.clearPrintArea=function(){this.model.PrintAreas&&(this.model.PrintAreas=void 0,this.setDirty("clearPrintArea",o.DirtyType.ModelCoreChanges))},t.prototype.hasPrintArea=function(){return!!this.model.PrintAreas&&this.model.PrintAreas.length>0},t.prototype.getPrintArea=function(){if(!this.model.PrintAreas)return[];for(var e=[],t=0;t<this.model.PrintAreas.length;t++){var n=this.model.PrintAreas[t];e.push({FirstRow:n.FirstRow,FirstColumn:n.FirstColumn,LastRow:n.LastRow,LastColumn:n.LastColumn})}return e},t.prototype.insertPageBreak=function(e){((null==e?void 0:e.Row)&&0!==e.Row.length||(null==e?void 0:e.Col)&&0!==e.Col.length)&&(this.insertRowBreak(null==e?void 0:e.Row),this.insertColBreak(null==e?void 0:e.Col),this.setDirty("insertPageBreak",o.DirtyType.ModelCoreChanges))},t.prototype.removePageBreak=function(e){var t=this.removeRowBreak(null==e?void 0:e.Row),n=this.removeColBreak(null==e?void 0:e.Col);!this.model.PageBreaks||this.model.PageBreaks.Row||this.model.PageBreaks.Col||(this.model.PageBreaks=void 0),(t||n)&&this.setDirty("removePageBreak",o.DirtyType.ModelCoreChanges)},t.prototype.resetAllPageBreak=function(){this.model.PageBreaks&&(this.model.PageBreaks=void 0,this.setDirty("resetAllPageBreak",o.DirtyType.ModelCoreChanges))},t.prototype.getPivotTableRanges=function(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)},t.prototype.getSparklineRanges=function(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)},t.prototype.getSparklinesUrl=function(){var e,t;return null!==(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)&&void 0!==t?t:""},t.prototype.getAllRichValueFields=function(){return this.duplicateRichValueFields(this.model.AllRichValueFields)},t.prototype.disposeBlock=function(e){l.isNullOrUndefined(e)||""===e||u.clearImageFromCache(u.ImageType.Sparkline,e)},t.prototype.getAutoFilterButtonTotalSize=function(e,n,r){t.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart");var i=n*r;this.ensureCachedObjectsInitialized(this.model,e,i),c.isAdjustedForDrawingOffsetsInitialized(this.model)||c.initializeOffsetsForDrawing(this.model,i);var o=f.getFilterSizeAdjustedForDrawing(this.model,e,r,n),a=c.getDefaultBorderLineWidth(i);return Math.round((o+a)/i)},t.prototype.getAutoFilterMenuOffsetsFromCellStart=function(e,n,r){t.verifyArgumentNotNull(e,"cell","getAutoFilterMenuOffsetsFromCellStart");var i=n*r;this.ensureCachedObjectsInitialized(this.model,e,i),c.isAdjustedForDrawingOffsetsInitialized(this.model)||c.initializeOffsetsForDrawing(this.model,i);var o=!this.model.IsRtl,a=s.getCellLeftAdjustedForDrawing(this.model,e,!1,o),l=s.getCellTopAdjustedForDrawing(this.model,e,!0),d=f.getFilterSizeAdjustedForDrawing(this.model,e,r,n),u=f.getFilterLeftAdjustedForDrawing(this.model,e,d,r,n)-a,g=f.getFilterBottomAdjustedForDrawing(this.model,e,d,r,n)-l;return{x:Math.round(u/i),y:Math.round(g/i)}},t.prototype.setPreviewRange=function(e){var t=o.getModelClientCache(this.model);t.PreviewCellsRange&&this.setPreviewRangeCellsDirty(t.PreviewCellsRange),e&&this.setPreviewRangeCellsDirty(e),t.PreviewCellsRange=e||void 0},t.prototype.getPreviewText=function(e){return t.verifyArgumentNotNull(e,"cell","getPreviewText"),e.PreviewText},t.prototype.setPreviewText=function(e,n){t.verifyArgumentNotNull(e,"cell","setPreviewText"),e.PreviewText=n},t.prototype.isSkeletonCell=function(e){return t.verifyArgumentNotNull(e,"cell","isSkeletonCell"),!!e.ShowSkeleton},t.prototype.setShowSkeleton=function(e,n){t.verifyArgumentNotNull(e,"cell","setShowSkeleton"),e.ShowSkeleton=n},t.prototype.hasFilters=function(){for(var e=0;e<this.model.Cells.length;e++){var t=this.model.Cells[e];if(t.AutoFilter||t.PivotFilter)return!0}return!1},t.prototype.updatePivotTablesAfterColWidthProcessing=function(){var e=this.model.PivotTables;if(e&&0!==e.length)for(var t=0;t<e.length;t++)for(var n=e[t],r=n.FirstColumn;r<=n.LastColumn;r++){var i=y.getColMetadata(r+1);i&&i.SrvDx&&i.CachedColWidth&&(n.OriginPTWidth=n.OriginPTWidth-i.SrvDx+i.CachedColWidth)}},t.prototype.insertRowBreak=function(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)&&this.model.PageBreaks.Row.length>0?this.model.PageBreaks.Row=this.model.PageBreaks.Row.concat(e):this.model.PageBreaks?this.model.PageBreaks.Row=e:this.model.PageBreaks={Row:e})},t.prototype.insertColBreak=function(e){var t;e&&0!==e.length&&((null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)&&this.model.PageBreaks.Col.length>0?this.model.PageBreaks.Col=this.model.PageBreaks.Col.concat(e):this.model.PageBreaks?this.model.PageBreaks.Col=e:this.model.PageBreaks={Col:e})},t.prototype.removeRowBreak=function(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Row)||0===this.model.PageBreaks.Row.length)return!1;var n=this.model.PageBreaks.Row.filter((function(t){return e.every((function(e){return e.Index!==t.Index}))})),r=this.model.PageBreaks.Row.length!==n.length;return this.model.PageBreaks.Row=n.length>0?n:void 0,r},t.prototype.removeColBreak=function(e){var t;if(!e||0===e.length||!(null===(t=this.model.PageBreaks)||void 0===t?void 0:t.Col)||0===this.model.PageBreaks.Col.length)return!1;var n=this.model.PageBreaks.Col.filter((function(t){return e.every((function(e){return e.Index!==t.Index}))})),r=this.model.PageBreaks.Col.length!==n.length;return this.model.PageBreaks.Col=n.length>0?n:void 0,r},t.prototype.isStyleUnique=function(e){return e===o.UniqueStyleID.Default||e===o.UniqueStyleID.Hyperlink},t.prototype.getLastNonUniqueStyleID=function(){return this.model.Styles.length-2-1},t.prototype.getLastBorderStyleID=function(){return this.model.BorderStyles.length-1},t.prototype.removeBordersWithinASpillCell=function(e){for(var t=1;t<=e.Spill.SpanToEnd;t++){var n=this.getCell(e.Row,e.Col+t);if(n){var r=o.getReferencedObjectById(n.BorderStyleID||0,this.model.BorderStyles);r&&r.Borders&&r.Borders.length>0&&this.removeCellLeftBorder(n,r)}}},t.prototype.removeCellLeftBorder=function(e,t){var n=i.duplicateBorderStyle(t,t.ID||0,1);if(n&&n.Borders)for(var r=n.Borders.length,a=0;a<r;a++){var l=n.Borders[a];l&&l.BorderPosition===o.BorderPositionType.Left&&(n.Borders.splice(a),this.setBorders(e,n))}},t.prototype.duplicateTextRun=function(e,t){return{FontID:null!=t?t:e.FontID||0,StartIndex:e.StartIndex,CachedFont:e.CachedFont}},t.prototype.duplicateAndSetNewFontOnTextRun=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=n.newFontId,t.CachedFont=n.newFont},t.prototype.duplicateAndSetNewFontOnCell=function(e,t){var n=this.duplicateAndSetNewFontInModel(e,!1),r=n.newFontId,i=n.newFont;t.CachedFont=i,t.CachedStyle.FontID=r},t.prototype.duplicateAndSetFontsInModel=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++){var i=e[parseInt(n[r],10)||0],o=this.duplicateAndSetNewFontInModel(i,!0).newFontId;t[i.ID||0]=o}return t},t.prototype.duplicateTextRuns=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];n[r]=this.duplicateTextRun(i,t[i.FontID||0])}return n},t.prototype.duplicatePivotTableRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableRangeInformation(e[n]));return t}},t.prototype.duplicatePivotTableRangeInformation=function(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,StyleIndex:e.StyleIndex,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,IsRefreshableTabularOlap:e.IsRefreshableTabularOlap,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid,SlicerConnections:e.SlicerConnections}},t.prototype.duplicateRangeInformation=function(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}},t.prototype.duplicatePivotTableFieldInfos=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicatePivotTableFieldInfo(e[n]));return t}},t.prototype.duplicatePivotTableFieldInfo=function(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop,SortInfo:e.SortInfo,LabelOrDateFilterType:e.LabelOrDateFilterType,ValueFilterType:e.ValueFilterType,MeasureType:e.MeasureType,HasManualFilter:e.HasManualFilter,IsDateField:e.IsDateField,IsImplicitMeasure:e.IsImplicitMeasure,IsNumeric:e.IsNumeric}},t.prototype.duplicateAndSetNewFontInModel=function(e,t){var n=this.model.Fonts.length,r=t?e.RefCount||0:1,o=i.duplicateFont(e,n,r);return t||(e.RefCount=Math.max(0,(e.RefCount||0)-1)),this.model.Fonts.splice(n,0,o),{newFontId:n,newFont:o}},t.prototype.duplicateSparklineRangeInformations=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateSparklineRangeInformation(e[n]));return t}},t.prototype.duplicateSparklineRangeInformation=function(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}},t.prototype.duplicateRichValueFields=function(e){if(e){for(var t=[],n=0;n<e.length;n++)t.push(this.duplicateRichValueField(e[n]));return t}},t.prototype.duplicateRichValueField=function(e){return{Index:e.Index,Value:e.Value}},t.prototype.setContextCellFont=function(e,t){e.font=i.getFontCssStringFromCell(t,this.model)},t.prototype.verifyDirtyCellsKeysInitialized=function(){var e=o.getModelClientCache(this.model);e.DirtyCellsKeys||(e.DirtyCellsKeys=[])},t.prototype.ensureCachedObjectsInitialized=function(e,n,r){var a,l,s;if(t.verifyArgumentNotNull(e,"model","ensureCachedObjectsInitialized"),t.verifyArgumentNotNull(n,"cell","ensureCachedObjectsInitialized"),c.isAdjustedForDrawingOffsetsInitialized(this.model)||c.initializeOffsetsForDrawing(this.model,r),n.CachedStyle&&n.CachedBorderStyle&&n.CachedFont&&(null===(a=n.CachedDrawingLayout)||void 0===a?void 0:a.UnderlineRuns)&&(null===(l=n.CachedDrawingLayout)||void 0===l?void 0:l.StrikethroughRuns)&&(null===(s=n.CachedDrawingLayout)||void 0===s?void 0:s.CellTextLayout)||i.initializeCellCachedObjects(e,n,!0),o.isRenderFlagEnabled(o.RenderFlagsArray.CanvasHitTest,e)){var d=n.Merge;!d||d.HeightAdjustedForDrawing&&d.OriginDeltaXAdjustedForDrawing&&d.WidthAdjustedForDrawing&&d.OriginDeltaYAdjustedForDrawing||i.updateCellMergeInformation(e,n,r)}},t.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},t.prototype.setPreviewRangeCellsDirty=function(e){var t={FirstColumn:Math.max(e.FirstColumn-1,0),FirstRow:Math.max(e.FirstRow-1,0),LastColumn:e.LastColumn+1,LastRow:e.LastRow+1};this.setCellsInRangeDirty(t)},t.prototype.setCellsInRangeDirty=function(e){for(var t=0;t<this.model.Cells.length;t++){var n=this.model.Cells[t];o.isModelCellContainedInRange(this.model,e,n)&&this.setCellAndSpannedOverCellsDirty(n)}},t}(v.BlockModelAccessor);t.GridBlockModelAccessor=T;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.duplicateAndSetFontsInModel=function(t){return e.prototype.duplicateAndSetFontsInModel.call(this,t)},t.prototype.duplicateTextRuns=function(t,n){return e.prototype.duplicateTextRuns.call(this,t,n)},t}(T);t.TestableGridBlockModelAccessor=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractableCanvasElement=void 0;var r=n(4),i=n(191),o=n(0),a=n(24),l=n(99),s=n(193),d=n(12),u=function(e){function t(t){var n=e.call(this,t)||this;return n.isHitMapSorted=!0,n.isRegisteredToEvents=!1,n.isListeningToPointerMove=!1,n.lastPointerPosition=a.OutsideCanvasPoint,n.lastPointerDownClickHitRegions=[],n.lastPointerDownTouchEndHitRegions=[],n.lastCursorType=a.UnsetCursorType,n.lastTooltip=a.DefaultTooltip,n.longPressState=l.getDefaultLongPressState(),n.zoom=1,n.registeredEventsHitRegions={},n.setDefaultHitMapAxes(),n.pointerDownEventHandler=n.onPointerDown.bind(n),n.pointerUpEventHandler=n.onPointerUp.bind(n),n.pointerMoveEventHandler=n.onPointerMove.bind(n),n.clickEventHandler=n.onClick.bind(n),n.dblClickEventHandler=n.ondblclick.bind(n),n.touchStartEventHandler=n.onTouchStart.bind(n),n.touchEndEventHandler=n.onTouchEnd.bind(n),n}return r.__extends(t,e),t.prototype.addRegionEventListener=function(e){this.cacheRegionAndRegisterEvents(e,e.eventType)},t.prototype.removeAllEventListeners=function(){this.isRegisteredToEvents&&(this.registeredEventsHitRegions.pointerdown&&this.canvas.removeEventListener("pointerdown",this.pointerDownEventHandler),this.registeredEventsHitRegions.pointerup&&this.canvas.removeEventListener("pointerup",this.pointerUpEventHandler),this.registeredEventsHitRegions.click&&(this.canvas.removeEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.removeEventListener("click",this.clickEventHandler)),this.registeredEventsHitRegions.touchstart&&this.canvas.removeEventListener("touchstart",this.touchStartEventHandler),this.registeredEventsHitRegions.dblclick&&this.canvas.removeEventListener("dblclick",this.dblClickEventHandler),this.registeredEventsHitRegions.touchend&&this.canvas.removeEventListener("touchend",this.touchEndEventHandler),this.isListeningToPointerMove&&(this.canvas.removeEventListener("pointermove",this.pointerMoveEventHandler),this.isListeningToPointerMove=!1),this.registeredEventsHitRegions={},this.isRegisteredToEvents=!1,this.isHitMapSorted=!0)},t.prototype.addCursorRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.CursorEventType)},t.prototype.addTooltipRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.TooltipEventType)},t.prototype.addLongPressRegion=function(e){this.cacheRegionAndRegisterEvents(e,a.LongPressEventType)},t.prototype.dispose=function(){this.removeAllEventListeners(),e.prototype.dispose.call(this)},t.prototype.setHitMapOffsets=function(e,n){if(e.length>a.MaxHitMapOffsetCount||n.length>a.MaxHitMapOffsetCount)throw Error("setHitMapOffsets:: offsets.length exceeds max allowed offsets length. x: "+e.length+", y: "+n.length);var r=t.doOffsetsHaveEqualDistances(e),i=t.doOffsetsHaveEqualDistances(n);this.hitMapAxisX={areOffsetsEqual:r,equalOffsetsSize:t.getFirstOffsetSize(e,this.canvas.width),offsets:e},this.hitMapAxisY={areOffsetsEqual:i,equalOffsetsSize:t.getFirstOffsetSize(n,this.canvas.height),offsets:n}},t.prototype.optimizeHitMapLookup=function(){this.isHitMapSorted||this.sortHitMap()},t.prototype.setAppZoom=function(e){this.zoom=e},t.prototype.setDimensions=function(t,n,r){e.prototype.setDimensions.call(this,t,n,r),this.setDefaultHitMapAxes()},t.prototype.cancelLongPressTimer=function(e,t){this.longPressState.callbackScheduled&&!this.longPressState.longPressModeEnabled&&clearTimeout(this.longPressState.callbackId);var n=this.canvas;n&&n.releasePointerCapture&&-1!==this.longPressState.eventPointerId&&n.releasePointerCapture(this.longPressState.eventPointerId),this.longPressState.longPressModeEnabled&&this.handleMouseLongPressEnd(this.longPressState.lastHitRegion),this.longPressState=l.getDefaultLongPressState();var r=l.getEventCoordinates(e,t),i=this.getEventCoordinatesInCanvas(r.clientX,r.clientY);this.handlePointerMove(e,i)},t.prototype.getHitMapOffsetsX=function(){return this.hitMapAxisX},t.prototype.getHitMapOffsetsY=function(){return this.hitMapAxisY},t.prototype.getAppZoom=function(){return this.zoom},t.prototype.getIsHitMapSorted=function(){return this.isHitMapSorted},t.prototype.getEventTypeRegisteredEventsHitRegions=function(e){return this.registeredEventsHitRegions[e]},t.prototype.getIntersectingHitMapAreasKeys=function(e){for(var n=t.getOffsetPosition(e.x,this.hitMapAxisX),r=t.getOffsetPosition(e.x+e.width,this.hitMapAxisX),i=t.getOffsetPosition(e.y,this.hitMapAxisY),o=t.getOffsetPosition(e.y+e.height,this.hitMapAxisY),a=[],l=n;l<=r;l++)for(var s=i;s<=o;s++)a.push(t.getHitMapAreaKeyFromOffsetPosition(l,s));return a},t.prototype.getHitMapAreaKeyFromOffset=function(e,n){var r=t.getOffsetPosition(e,this.hitMapAxisX),i=t.getOffsetPosition(n,this.hitMapAxisY);return t.getHitMapAreaKeyFromOffsetPosition(r,i)},t.prototype.isEventStartAndEndInSameRegion=function(e,t,n){if(0===n.length)return!1;var r=l.getEventCoordinates(e,t),i=r.clientX,o=r.clientY,a=this.getEventCoordinatesInCanvas(i,o),s=this.getIntersectingHitRegions(t,a);return s.length>0&&l.areTwoHitRegionsSame(n[0],s[0])},t.getHitMapAreaKeyFromOffsetPosition=function(e,t){return(e<<a.HitMapKeyXShift)+t},t.getOffsetPosition=function(e,t){if(t.areOffsetsEqual)return Math.floor(e/t.equalOffsetsSize);var n=o.binarySearch(t.offsets,0,t.offsets.length,e,o.numbersComparer);return n<0?~n-1:n},t.doOffsetsHaveEqualDistances=function(e){if(e.length<2)return!0;for(var t=e[1],n=2;n<e.length;n++)if(e[n]-e[n-1]!==t)return!1;return!0},t.getDefaultHitMapAxis=function(e){for(var t=Math.floor(e/a.DefaultHitMapSectionsCount),n=[],r=0;r<a.DefaultHitMapSectionsCount;r++)n.push(r*t);return{areOffsetsEqual:!0,equalOffsetsSize:t,offsets:n}},t.getFirstOffsetSize=function(e,t){return e.length<2?t:e[1]},t.prototype.onPointerDown=function(e){if(!d.shouldHitTestHandleEvent())return!1;var t=this.getEventCoordinatesInCanvas(e.clientX,e.clientY);return this.lastPointerDownClickHitRegions=this.getIntersectingHitRegions("click",t),this.handleMouseLongPress(e,"pointerdown"),this.onBasicPointerEvent(e,"pointerdown",this.pointerDownEventHandler)},t.prototype.onPointerUp=function(e){return this.longPressState.callbackScheduled&&this.cancelLongPressTimer(e,"pointerup"),this.onBasicPointerEvent(e,"pointerup",this.pointerUpEventHandler)},t.prototype.onClick=function(e){return!(!d.shouldHitTestHandleEvent()||!this.isEventStartAndEndInSameRegion(e,"click",this.lastPointerDownClickHitRegions))&&this.onBasicPointerEvent(e,"click",this.clickEventHandler)},t.prototype.ondblclick=function(e){if(!d.shouldHitTestHandleEvent())return!1;return this.onBasicPointerEvent(e,"dblclick",this.dblClickEventHandler)},t.prototype.onTouchStart=function(e){var t,n,r,i;if(!d.shouldHitTestHandleEvent())return!1;var o=this.getEventCoordinatesInCanvas(null===(n=null===(t=e.touches)||void 0===t?void 0:t[0])||void 0===n?void 0:n.clientX,null===(i=null===(r=e.touches)||void 0===r?void 0:r[0])||void 0===i?void 0:i.clientY);this.lastPointerDownTouchEndHitRegions=this.getIntersectingHitRegions("touchend",o);return this.onBasicPointerEvent(e,"touchstart",this.touchStartEventHandler)},t.prototype.onTouchEnd=function(e){return!(!d.shouldHitTestHandleEvent()||!this.isEventStartAndEndInSameRegion(e,"touchend",this.lastPointerDownTouchEndHitRegions))&&this.onBasicPointerEvent(e,"touchend",this.touchEndEventHandler)},t.prototype.onBasicPointerEvent=function(e,t,n){var r=this;return s.trackEventCallbackDuration((function(){return r.isEventHasRegisteredHandlers(t)?r.handleBasicPointerEvents(t,e):(r.removeUnnecessaryEventListeners(t,n),!0)}),t)},t.prototype.removeUnnecessaryEventListeners=function(e,t){this.isEventHasRegisteredHandlers("longpress")||(e!==a.PointerDownEvent||this.isEventHasRegisteredHandlers("click")?e===a.PointerUpEvent&&this.canvas.removeEventListener(e,t):this.canvas.removeEventListener(e,t))},t.prototype.onPointerMove=function(e){var t=this;if(d.shouldHitTestHandleEvent()){s.trackEventCallbackDuration((function(){var n=t.getEventCoordinatesInCanvas(e.clientX,e.clientY);t.handlePointerMove(e,n)}),a.PointerMoveEvent)}},t.prototype.handleBasicPointerEvents=function(e,t){var n=l.getEventCoordinates(t,e),r=this.getEventCoordinatesInCanvas(n.clientX,n.clientY),i=this.getIntersectingHitRegions(e,r);return this.propagateEventToHandlers(t,i,e,(function(){return!0}))},t.prototype.handlePointerMove=function(e,t){this.longPressState.longPressModeEnabled||(this.handleMouseLeaveEventTriggering(e,t),this.handleMouseEnterEventTriggering(e,t),this.handleCursorType(t),this.handleTooltipChange(t)),this.lastPointerPosition=t},t.prototype.handleMouseLeaveEventTriggering=function(e,t){if(this.lastPointerPosition!==a.OutsideCanvasPoint){var n=this.getIntersectingHitRegions("mouseleave",this.lastPointerPosition);this.propagateEventToHandlers(e,n,"mouseleave",(function(e){return t===a.OutsideCanvasPoint||!o.isPointInRect(e.region,t)}))}},t.prototype.handleMouseEnterEventTriggering=function(e,t){var n=this;if(t!==a.OutsideCanvasPoint){var r=this.getIntersectingHitRegions("mouseenter",t);this.propagateEventToHandlers(e,r,"mouseenter",(function(e){return n.lastPointerPosition===a.OutsideCanvasPoint||!o.isPointInRect(e.region,n.lastPointerPosition)}))}},t.prototype.propagateEventToHandlers=function(e,t,n,r){for(var i=Number.MAX_SAFE_INTEGER,o=0;o<t.length;o++){var a=t[o];if(a.zIndex>i)throw Error("handleEventPropagationToHandlers: expected handlers to be sorted by z-index, highest first. latestZIndex="+i+", currentZIndex="+a.zIndex+", eventType: "+n+", totalHandlersCount="+t.length);if(r(a))if(a.callback(e))return e.stopPropagation(),e.preventDefault(),!1;i=a.zIndex}return!0},t.prototype.handleCursorType=function(e){var t=a.UnsetCursorType;if(e!==a.OutsideCanvasPoint){var n=this.getIntersectingHitRegions(a.CursorEventType,e);n&&n.length>0&&(t=n[0].cursorType)}this.lastCursorType!==t&&(this.lastCursorType=t,this.canvas.style.cursor=t)},t.prototype.handleTooltipChange=function(e){var t=this,n=a.DefaultTooltip,r=void 0;if(e!==a.OutsideCanvasPoint){var i=this.getIntersectingHitRegions(a.TooltipEventType,e);if(i&&i.length>0){var o=i[0],l=o.region;n=o.tooltipText,r=this.getHitMapAreaKeyFromOffset(l.x,l.y)}}var s=this.lastTooltipHitRegionKey!==r,d=this.lastTooltip!==n;if(d||s){if(this.lastTooltip=n,this.lastTooltipHitRegionKey=r,s&&!d)return this.canvas.setAttribute("title",a.DefaultTooltip),void setTimeout((function(){t.canvas.setAttribute("title",n)}),0);this.canvas.setAttribute("title",n)}},t.prototype.handleMouseLongPressStart=function(e){e&&e.onStart()},t.prototype.handleMouseLongPressEnd=function(e){e&&e.onEnd()},t.prototype.getLongPressHitRegion=function(e){if(e!==a.OutsideCanvasPoint){var t=this.getIntersectingHitRegions(a.LongPressEventType,e);if(t&&t.length>0)return t[0]}},t.prototype.cacheRegionAndRegisterEvents=function(e,t){this.registeredEventsHitRegions[t]||this.registerHandlersForEvent(t);var n=this.getEventHitAreaMap(t);this.addHitRegion(e,n)},t.prototype.registerHandlersForEvent=function(e){switch(e){case"pointerdown":this.canvas.addEventListener(e,this.pointerDownEventHandler);break;case"pointerup":this.canvas.addEventListener(e,this.pointerUpEventHandler);break;case"click":this.canvas.addEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(e,this.clickEventHandler);break;case"dblclick":this.canvas.addEventListener(e,this.dblClickEventHandler);break;case"touchstart":this.canvas.addEventListener(e,this.touchStartEventHandler);break;case"touchend":this.canvas.addEventListener(e,this.touchEndEventHandler);break;case"longpress":this.canvas.addEventListener(a.PointerDownEvent,this.pointerDownEventHandler),this.canvas.addEventListener(a.PointerUpEvent,this.pointerUpEventHandler);break;case"cursor":case"tooltip":case"mouseenter":case"mouseleave":this.isListeningToPointerMove||(this.canvas.addEventListener(a.PointerMoveEvent,this.pointerMoveEventHandler),this.isListeningToPointerMove=!0)}this.isRegisteredToEvents=!0},t.prototype.getEventHitAreaMap=function(e){return this.registeredEventsHitRegions[e]||(this.registeredEventsHitRegions[e]={}),this.registeredEventsHitRegions[e]},t.prototype.addHitRegion=function(e,t){for(var n=this.getIntersectingHitMapAreasKeys(e.region),r=0;r<n.length;r++){var i=n[r];t[i]||(t[i]=[]),t[i].push(e)}this.isHitMapSorted=!1},t.prototype.setDefaultHitMapAxes=function(){this.hitMapAxisX=t.getDefaultHitMapAxis(this.canvas.width),this.hitMapAxisY=t.getDefaultHitMapAxis(this.canvas.height)},t.prototype.getEventCoordinatesInCanvas=function(e,t){var n=Math.round(e/this.zoom),r=Math.round(t/this.zoom),i=this.canvas.getBoundingClientRect();return{x:n-i.left,y:r-i.top}},t.prototype.getIntersectingHitRegions=function(e,t){var n=[];if(this.registeredEventsHitRegions[e]){var r=this.getHitMapAreaKeyFromOffset(t.x,t.y);this.optimizeHitMapLookup();var i=this.registeredEventsHitRegions[e][r];if(i&&i.length>0)for(var a=0;a<i.length;a++){var l=i[a];o.isPointInRect(l.region,t)&&n.push(l)}}return n},t.prototype.isEventHasRegisteredHandlers=function(e){return!!this.registeredEventsHitRegions&&!!this.registeredEventsHitRegions[e]},t.prototype.sortHitMap=function(){for(var e=Object.keys(this.registeredEventsHitRegions),t=0;t<e.length;t++)for(var n=this.registeredEventsHitRegions[e[t]],r=Object.keys(n),i=0;i<r.length;i++){var o=parseInt(r[i],10);n[o]=n[o].sort(l.hitRegionComparer)}this.isHitMapSorted=!0},t.prototype.handleMouseLongPress=function(e,t){var n=this,r=1===e.button,i="touch"===e.pointerType;if((!this.longPressState.callbackScheduled||e.target&&r)&&!i){var o=l.getEventCoordinates(e,t),s=this.getEventCoordinatesInCanvas(o.clientX,o.clientY),d=this.getLongPressHitRegion(s);if(d){var u=e.target,c=e.pointerId;u&&u.setPointerCapture&&-1!==c&&u.setPointerCapture(c),this.longPressState.callbackId=window.setTimeout((function(){n.onLongPress()}),a.MinLongPressDurationMs),this.longPressState.callbackScheduled=!0,this.longPressState.eventPointerId=c,this.longPressState.lastHitRegion=d}}},t.prototype.onLongPress=function(){this.canvas.style.cursor=a.UnsetCursorType,this.lastCursorType=a.UnsetCursorType,this.longPressState.longPressModeEnabled=!0,this.handleMouseLongPressStart(this.longPressState.lastHitRegion)},t}(i.RenderingCanvasElement);t.InteractableCanvasElement=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RenderingCanvasElement=void 0;var r=n(192),i=function(){function e(e){this.renderingRegion=void 0,this.canvas=document.createElement("canvas"),this.parentElement=null,this.ctxOptions={alpha:!e};var t=this.canvas.getContext("2d",this.ctxOptions);t&&(this.clippingTracker=new r.Canvas2DClipStateTracker(t))}return e.prototype.dispose=function(){var e;this.parentElement&&(this.parentElement.removeChild(this.canvas),this.parentElement=null),this.canvas.style.width="0px",this.canvas.style.height="0px",this.canvas.width=0,this.canvas.height=0,null===(e=this.clippingTracker)||void 0===e||e.dispose(),this.clippingTracker=null,this.renderingRegion&&(this.renderingRegion.isRendered=!1)},e.prototype.appendToParent=function(e){e&&(e.appendChild(this.canvas),this.parentElement=e)},e.prototype.getContext2d=function(e){return this.canvas.getContext("2d",this.ctxOptions)},e.prototype.getWidth=function(){return this.canvas.width},e.prototype.getHeight=function(){return this.canvas.height},e.prototype.getStyle=function(){return this.canvas.style},e.prototype.setClassName=function(e){this.canvas.className=null!=e?e:""},e.prototype.updatePosition=function(e,t,n,r){if(this.canvas){var i=e+"px",o=t+"px",a=this.canvas.style;if(n||(r?a.right!==i:a.left!==i)||a.top!==o)return r?a.right=i:a.left=i,a.top=o,!0}return!1},e.prototype.setDimensions=function(e,t,n){var i=Math.round(e*n),o=Math.round(t*n);this.setStyleDimensions(i,o,n),this.canvas.width=i,this.canvas.height=o;var a=this.getContext2d();a&&(this.clippingTracker=new r.Canvas2DClipStateTracker(a))},e.prototype.setRenderingRegion=function(e){e&&(this.renderingRegion=e)},e.prototype.getRenderingRegion=function(){return this.renderingRegion},e.prototype.getClippingMaskStatus=function(){return this.clippingTracker?this.clippingTracker.getClippingMaskStatus():{isClear:!0,clippedWithoutSave:!1}},e.prototype.setStyleDimensions=function(e,t,n){this.canvas.style.width=e/n+"px",this.canvas.style.height=t/n+"px"},e}();t.RenderingCanvasElement=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas2DClipStateTracker=void 0;var r,i=function(){function e(e){this.clippingMasksState=r.Clean,this.contextSaveCounter=0,this.clippingMaskAppliedWithoutSavedContext=!1,this.ctx=e,this.originalCtxSaveMethod=this.ctx.save.bind(this.ctx),this.originalCtxClipMethod=this.ctx.clip.bind(this.ctx),this.originalCtxRestoreMethod=this.ctx.restore.bind(this.ctx),this.ctx.save=this.ctxSave.bind(this),this.ctx.clip=this.ctxClip.bind(this),this.ctx.restore=this.ctxRestore.bind(this)}return e.prototype.dispose=function(){this.contextSaveCounter=0,this.clippingMasksState=r.Clean,this.ctx&&(this.ctx.save=this.originalCtxSaveMethod,this.ctx.clip=this.originalCtxClipMethod,this.ctx.restore=this.originalCtxRestoreMethod,this.ctx=null)},e.prototype.getClippingMaskStatus=function(){return{isClear:this.clippingMasksState===r.Clean,clippedWithoutSave:this.clippingMaskAppliedWithoutSavedContext}},e.prototype.ctxSave=function(){this.originalCtxSaveMethod(),this.clippingMasksState=r.Saved,this.contextSaveCounter++},e.prototype.ctxClip=function(){this.originalCtxClipMethod(),this.clippingMasksState!==r.Clean||(this.clippingMaskAppliedWithoutSavedContext=!0)},e.prototype.ctxRestore=function(){this.originalCtxRestoreMethod(),this.clippingMasksState===r.Saved&&(this.contextSaveCounter--,0===this.contextSaveCounter&&(this.clippingMasksState=r.Clean))},e}();t.Canvas2DClipStateTracker=i,function(e){e[e.Clean=0]="Clean",e[e.Saved=1]="Saved"}(r||(r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackEventCallbackDuration=void 0;var r,i,o=n(9),a=n(8),l=n(12);!function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Cooldown=2]="Cooldown"}(r||(r={})),function(e){e[e.Inactive=0]="Inactive",e[e.Cooldown=1]="Cooldown"}(i||(i={}));var s=r.Inactive,d=i.Inactive,u={};function c(){var e=l.getServiceSetting(1,4e3);s=r.Cooldown,function(){if(d===i.Inactive){d=i.Cooldown;var e=l.getServiceSetting(2,6e4);setTimeout((function(){var e;e=JSON.stringify(u),a.ULS.sendTraceTag(574648710,a.LogCategory.msoulscat_ES_EWAJSGrid,a.TraceLevel.Info,"HitTest::Telemetry::sendMeasurementResults: "+e),u={},d=i.Inactive}),e)}}(),setTimeout((function(){s=r.Inactive}),e)}t.trackEventCallbackDuration=function(e,t){return function(){if(s===r.Inactive){var e=l.getServiceSetting(0,1e3);s=r.Active,setTimeout(c,e)}return s===r.Active}()?function(e,t){var n=o.perf?o.perf.now():-1,r=e();if(o.perf){var i=o.perf.now()-n;u[t]||(u[t]=[]),u[t].push(i.toFixed(4))}return r}(e,t):e()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderBlockModelAccessor=void 0;var r=n(4),i=n(1),o=n(106),a=n(0),l=function(e){function t(t,n){var r=e.call(this,t)||this;return r.isRow=n,r}return r.__extends(t,e),t.verifyArgumentNotNull=function(e,t,n){a.verifyArgumentNotNull(e,t,"HeaderBlockModelAccessor."+n)},t.prototype.getHeaderBlockModel=function(){return this.model},t.prototype.setStyleId=function(e,n){t.verifyArgumentNotNull(n,"styleId","setStyleId");var r=this.getCell(e);if(!r)throw Error("HeaderBlockModelAccessor.setStyleId: Cell not in model");r.StyleID=n},t.prototype.getCell=function(e){return i.getCell(this.getRowIndex(e),this.getColumnIndex(e),this.model)},t.prototype.getRowIndex=function(e){return this.isRow?e:0},t.prototype.getColumnIndex=function(e){return this.isRow?0:e},t}(o.BlockModelAccessor);t.HeaderBlockModelAccessor=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderCanvasRenderer=void 0;var r=n(4),i=n(1),o=n(37),a=n(9),l=n(87),s=n(95),d=n(0),u=n(100),c=n(72),g=n(104),h=n(2),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderInternal=function(e,t,n){var r=this;try{var i=e.getClippingMaskStatus();a.validateClippingState(i,u.BlockRenderingStage.Start),d.validateRenderingRegion(n.renderingRegion,t,n),d.isHighContrastMode(n)&&d.extendHighContrastScheme(n,n.highContrastScheme);var c=n.scaleFactor,g=Math.round(t.BlockWidth*c),h=n.renderingRegion,f=-1*h.startOffsetY*c,m=d.getDrawingOffsetXForRenderingRegion(t,h)*c;return this.setTransform(1,!1,0,0,g),this.clearHeaderCanvas(e.getWidth(),e.getHeight(),n),this.setTransform(1,!1,m,f,g),a.trackDuration(a.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return s.drawHeaderCellsBackgroundFill(r.ctx,t,n)})),this.setTransform(1,t.IsRtl,m,f,g),a.trackDuration(a.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return o.drawGridLines(r.ctx,t,n)})),this.setTransform(n.scaleFactor,!1,m,f,g),a.trackDuration(a.RenderPerformanceMetric.DrawTextDurationMs,(function(){return l.drawText(r.ctx,t,n)})),i=e.getClippingMaskStatus(),a.validateClippingState(i,u.BlockRenderingStage.End),a.createRenderResult(!0,"finished rendering.")}catch(e){return a.createRenderResult(!1,"exception caught in renderInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},t.prototype.preprocessModel=function(e,t,n){c.initializeCachedObjects(e,t),h.initializeOffsetsForDrawing(e,n.scaleFactor)},t.prototype.initializeCanvasHitTest=function(e,t,n,r){},t.prototype.clearHeaderCanvas=function(e,t,n){var r=this;a.trackDuration(a.RenderPerformanceMetric.FillRectDurationMs,(function(){r.ctx.fillStyle=d.isHighContrastMode(n)?d.rgbToColorHex(n.highContrastScheme.BackgroundColor):i.DefaultHeaderBackgroundColor,r.ctx.fillRect(0,0,e,t)}))},t}(g.CanvasRenderer);t.HeaderCanvasRenderer=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRendererGlobals=void 0;var r=n(9),i=n(6),o=n(1),a=n(0),l=n(197),s=n(26),d=n(47),u=n(18),c=n(12),g=n(8),h=n(107),f=n(200),m=n(201),p=n(202),C=n(203),v=n(204),y=n(82),T=n(54),S=n(205),F=n(103),x=n(72),w=n(74),R=n(206),b=function(){function e(){}return e.lookupPerfMetricName=function(e){return r.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,n,r,o){var a=e.canvasContext();if(!a)throw Error("calculateTextWidth: ctx is undefined");return a.font=n,i.measureTextWidth(a,t,r,o)},e.compareFormattedTexts=function(e,t){return o.areFormattedTextsEqual(e,t)},e.compareGridBlockModels=function(e,t,n){return o.compareGridBlockModels(e,t,n)},e.serializeCell=function(e,t){return o.serializeCell(e,t)},e.registerActionOnFontLoad=function(e,t,n){var r;null===(r=l.registerActionOnFontLoadIfRequired(e,t,n))||void 0===r||r.catch((function(e){throw e}))},e.registerExternalCallbacks=function(e){c.registerExternalCallbacks(e)},e.initializeLogger=function(e){e&&g.initializeLogger(e)},e.initializeEwaUtils=function(e){e&&y.initEwaUtils(e)},e.initializeGridRendererImageLoader=function(e,t){s.initializeGridRendererImageLoader(e,t)},e.setStaticImageUrl=function(e,t){s.setStaticImageUrl(e,t)},e.loadPreviewFont=function(e){l.loadPreviewFont(e)},e.isFontLoadApiSupported=function(){return d.fontFaceSetSupported()},e.getFontNameForLogging=function(e){return u.getFontNameForLogging(e)},e.initPassiveTestManager=function(){h.initPassiveTelemetryManager()},e.initGridRendererStrings=function(e){T.initGridRendererStrings(e)},e.initGridRendererCustomCursors=function(e){F.initGridRendererCustomCursors(e)},e.registerForOffScreenCanvasTelemetryCollector=function(t){var n=e.canvasContext();n&&f.registerOffscreenCanvasTelemetryCollector(n,t)},e.registerForCompressedTextTelemetryCollector=function(t){var n=e.canvasContext();n&&m.registerCompressedTextTelemetryCollector(n,t)},e.registerForSpillCellTelemetryCollector=function(t){var n=e.canvasContext();n&&p.registerSpillCellTelemetryCollector(n,t)},e.registerForAutoFitWidthTelemetryCollector=function(t){var n=e.canvasContext();n&&C.registerAutoFitWidthTelemetryCollector(n,t)},e.registerForAutofitHeightTelemetryCollector=function(t){var n=e.canvasContext();n&&v.registerAutoFitHeightTelemetryCollector(n,t)},e.registerCellHashDisplayCollector=function(e){S.registerCellHashDisplayCollector(e)},e.preprocessModel=function(t){return x.preprocessAutofitWidth(e.canvasContext(),t)},e.getProcessedColumnWidth=function(e,t){var n=w.getColMetadata(e);return n&&n.SrvDx===t&&n.CachedColWidth||t},e.resetColWidthCache=function(){w.resetCache()},e.resetColWidthCacheByCol=function(e){w.resetColWidthCacheByCol(e)},e.analyzeLowRenderingFidelity=function(e){return R.analyzeModelFidelity(e)},e.renderingRegionContainsDirtyCells=function(e,t){return a.renderingRegionContainsDirtyCells(e,t)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e.canvasContext=function(){return e.canvasInstance().getContext("2d")},e}();t.CanvasRendererGlobals=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadPreviewFont=t.registerActionOnFontLoadIfRequired=void 0;var r=n(1),i=n(46),o=n(47),a=n(0),l=n(18),s=n(49),d=n(12),u=n(8),c=d.getServiceSetting(8,7),g=d.getServiceSetting(6,100),h=d.getServiceSetting(7,3e3),f=document.createElement("div");function m(e,t){a.isDefined(e)&&a.isDefined(t)&&(t("API_Failure"),e(2))}function p(e){return new Promise((function(t){setTimeout((function(){return C(e,c,t)}),g)}))}function C(e,t,n){var r=c-t+1;switch(o.getFontFaceLoadStatus(e)){case"loaded":u.ULS.sendTraceTag(542722120,u.LogCategory.msoulscat_ES_EWAJSGrid,u.TraceLevel.Info,"FontLoader::handleFontIsStillLoading: "+l.getFontNameForLogging(e)+" was loaded successfully after "+r+" retries."),n({font:e,isSuccessful:!0});break;case"loading":if(t>1){var i=function(e){var t=1<<c-e+1;return Math.min(t*g,h)}(t);setTimeout(C,i,e,t-1,n)}else u.ULS.sendTraceTag(542722121,u.LogCategory.msoulscat_ES_EWAJSGrid,u.TraceLevel.Info,"FontLoader::handleFontIsStillLoading: "+l.getFontNameForLogging(e)+" failed to load after "+r+" retries."),n({font:e,isSuccessful:!1});break;default:n({font:e,isSuccessful:!1})}}function v(e,t){!t&&o.doesFontExist(e)||(o.setFontLoadDivWithFontFamily(f,e),o.setFontLoadStatus(e,o.FontLoadStatus.Pending))}function y(e,t){return!o.doesFontExist(e)&&!o.isFontLoaded(e,t)}f.innerText=".",f.style.visibility="hidden",(null===document||void 0===document?void 0:document.body)&&document.body.appendChild(f),t.registerActionOnFontLoadIfRequired=function(e,t,n){if(o.fontFaceSetSupported()&&a.isDefined(t)){var d=r.isRenderFlagEnabled(r.RenderFlagsArray.CanvasHitTest,e),u=[];return(d?(u=function(e){var t=[];if(e.Fonts)for(var n=0;n<e.Fonts.length;n++)if(e.Fonts[n]){var r=l.canonizeFontName(e.Fonts[n].FontName);!o.isFontUsedInModel(e,n)||o.doesFontExist(r)&&o.getFontLoadStatus(r)!==o.FontLoadStatus.Pending||t.push(r)}(function(e){var t;if(!o.doesFontExist(s.RichValueIconUnicodeFontFamily)||o.getFontLoadStatus(s.RichValueIconUnicodeFontFamily)===o.FontLoadStatus.Pending){var n=null===(t=e.ClientOnlyCache)||void 0===t?void 0:t.CellsToRender;if(n)for(var r=0;r<n.length;r++){if(n[r].RichValueIcon)return!0}}return!1})(e)&&t.push(s.RichValueIconUnicodeFontFamily);return t}(e)).length>0:function(e){if(!e.Fonts||0===e.Fonts.length)return!1;for(var t=0;t<e.Fonts.length;t++)if(e.Fonts[t]){var n=l.canonizeFontName(e.Fonts[t].FontName);if(o.isFontUsedInModel(e,t)&&(!o.doesFontExist(n)||o.getFontLoadStatus(n)===o.FontLoadStatus.Pending))return!0}return!1}(e))?(t(0),function(e,t,n){if(n)for(var r=0;r<t.length;r++)y(t[r],n)&&v(t[r],n);else for(r=0;r<e.Fonts.length;r++){v(l.canonizeFontName(e.Fonts[r].FontName),n)}}(e,u,d),function(e,t,n,r,s){if(s){var d=[],u=[];return o.getFontFaceSetReady().then((function(){return function(e,t,n){for(var r=[],i=0;i<e.length;i++){var a=e[i];switch(o.getFontFaceLoadStatus(a)){case"loaded":t.push(a);break;case"loading":r.push(p(a));break;default:n.push(a)}}return Promise.all(r)}(t,d,u)})).then((function(e){if(a.isDefined(n)){var t=function(e){for(var t=[],n=[],r=0;r<e.length;r++){var i=e[r];i.isSuccessful?t.push(i.font):n.push(i.font)}return[t,n]}(e),s=t[0],c=t[1];!function(e){for(var t=0;t<e.length;t++){var n=e[t];o.getFontLoadStatus(n)!==o.FontLoadStatus.Loaded&&(i.recalculateFontMetrics(n),o.setFontLoadStatus(n,o.FontLoadStatus.Loaded))}}(d.concat(s)),function(e,t){for(var n=a.isDefined(t),r=0;r<e.length;r++){var i=e[r];o.setFontLoadStatus(i,o.FontLoadStatus.Failed),n&&l.isKnownFont(i)&&t(l.sanitizeFontName(i))}}(u.concat(c),r),(d.length>0||s.length>0)&&n(1),n(2)}})).catch((function(e){m(n,r)}))}return o.getFontFaceSetReady().then((function(){a.isDefined(n)&&(function(e,t,n){if(!e.Fonts)return!1;for(var r=!1,s=0;s<e.Fonts.length;s++)if(e.Fonts[s]){var d=l.canonizeFontName(e.Fonts[s].FontName);o.isFontLoaded(d,n)?(o.getFontLoadStatus(d)!==o.FontLoadStatus.Loaded&&(i.recalculateFontMetrics(d),o.setFontLoadStatus(d,o.FontLoadStatus.Loaded)),r=!0):(o.setFontLoadStatus(d,o.FontLoadStatus.Failed),a.isDefined(t)&&l.isKnownFont(d)&&t(l.sanitizeFontName(d)))}return r}(e,r,s)&&n(1),n(2))}),(function(){m(n,r)}))}(e,u,t,n,d)):void 0}},t.loadPreviewFont=function(e){o.setFontLoadDivWithFontFamily(f,"msofp"),o.getFontFaceSetReady().then((function(){o.isFontLoadFailed("msofp")&&e("ERROR")}),(function(){e("API_Failure")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdleTracker=void 0;var r=n(4),i=n(43),o=function(e){function t(t,n){var r=e.call(this,t)||this;return r.isScheduled=!1,r.maxTimeAfterIdle=n,r.lastActiveTime=i.getCurrentTimeInMs(),r}return r.__extends(t,e),t.prototype.startTrackingIfApplicable=function(){this.isScheduled||(this.isScheduled=!0,this.lastActiveTime=i.getCurrentTimeInMs(),setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec))},t.prototype.stopTracking=function(){this.isScheduled=!1},t.prototype.onTimerTick=function(){e.prototype.onTimerTick.call(this);var t=i.getCurrentTimeInMs()-this.lastActiveTime;this.isScheduled&&t<this.maxTimeAfterIdle?setTimeout(this.onTimerTick.bind(this),1e3*this.activityReportInSec):this.isScheduled=!1},t.prototype.reportActivity=function(){e.prototype.reportActivity.call(this),this.lastActiveTime=i.getCurrentTimeInMs()},t}(n(199).Idle);t.IdleTracker=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Idle=void 0;var r=["keypress","keydown","click","contextmenu","dblclick","mousemove","scroll","touchmove","touchstart"],i=function(){function e(e){var t=this;this.userReportedActive=!1,this.userIsActive=!1,this.userMouseIsInFrame=!1,this.attachedFrames=[],this.activityReportMode=1,this.activityReportInSec=5,this.detectFramesInSec=-1,this.onActivity=function(){},this.onEnterFrame=function(){},this.onReportUserIsActive=function(){},this.onReportUserIsIdle=function(){},this.attachListenerToNewFrames=function(){for(var e=Array.prototype.slice.call(window.document.getElementsByTagName("frame")),n=Array.prototype.slice.call(window.document.getElementsByTagName("iframe")),r=0,i=e.concat(n);r<i.length;r++){var o=i[r];t.attachedFrames.indexOf(o)<0&&(o.addEventListener("mouseenter",t.onMouseEntersFrame.bind(t),t,!1),t.attachedFrames.push(o),t.userMouseIsInFrame=!0)}},this.onUserActivity=function(){t.onActivity(),t.userIsActive=!0,2!==t.activityReportMode||t.userReportedActive||t.reportActivity(),t.userMouseIsInFrame=!1},this.overrideDefaultsWithOptions(e),r.forEach((function(e){window.addEventListener(e,t.onUserActivity,!0)})),e.scheduleByDefault&&(setInterval(this.onTimerTick.bind(this),1e3*this.activityReportInSec),this.detectFramesInSec>0&&setInterval(this.attachListenerToNewFrames,1e3*this.detectFramesInSec)),this.reportActivity()}return e.prototype.onMouseEntersFrame=function(){this.onEnterFrame(),this.userMouseIsInFrame=!0},e.prototype.onTimerTick=function(){this.userReportedActive=!1,1===this.activityReportMode&&this.userIsActive||this.userMouseIsInFrame&&this.isPageVisible()?this.reportActivity():this.onReportUserIsIdle()},e.prototype.reportActivity=function(){this.onReportUserIsActive(),this.userReportedActive=!0,this.userIsActive=!1},e.prototype.overrideDefaultsWithOptions=function(e){this.activityReportInSec=e.activityReportInSec||this.activityReportInSec,this.activityReportMode=e.activityReportMode||this.activityReportMode,this.detectFramesInSec=e.detectFramesInSec||this.detectFramesInSec,this.onActivity=e.onActivity||this.onActivity,this.onEnterFrame=e.onEnterFrame||this.onEnterFrame,this.onReportUserIsActive=e.onReportUserIsActive||this.onReportUserIsActive,this.onReportUserIsIdle=e.onReportUserIsIdle||this.onReportUserIsIdle},e.prototype.isPageVisible=function(){return"hidden"!==document.visibilityState},e}();t.Idle=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerOffscreenCanvasTelemetryCollector=void 0;var r,i=n(4),o=n(0),a=n(34),l=n(43),s=n(35);function d(){return"undefined"!=typeof OffscreenCanvas}t.registerOffscreenCanvasTelemetryCollector=function(e,t){d()&&(r||(r=new u(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++)if(e.Cells[t].Text)return!0;return!1}(t)&&r.register(t))};var u=function(e){function t(t){var n=e.call(this,"OffscreenCanvasCollector")||this;return n.canvasContext=t,n.offscreenCanvas=new OffscreenCanvas(a.CanvasWidth,a.CanvasWidth),n.offscreenCanvasContext=n.offscreenCanvas.getContext("2d"),n}return i.__extends(t,e),t.prototype.canCollectorExecute=function(){return e.prototype.canCollectorExecute.call(this)&&d()},t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:a.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:a.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++)e.Cells[n].Text&&t.push(e.Cells[n]);if(t.length<1)return{isValid:!1,value:a.ResultMessageInsufficientData};var r=t[Math.floor(Math.random()*t.length)],i=o.getFontCssStringFromCell(r,e);return{isValid:!0,value:{normal:this.measureTextWidth(this.canvasContext,i,r.Text),offscreen:this.measureTextWidth(this.offscreenCanvasContext,i,r.Text)}}},t.prototype.measureTextWidth=function(e,t,n){e.font=t;var r=e.measureText(n),i=r.actualBoundingBoxRight+r.actualBoundingBoxLeft;return{eps:this.calculateExecutionsPerSecond(e,n),width:c(r.width,2),advWidth:c(i,2)}},t.prototype.calculateExecutionsPerSecond=function(e,t){return l.calculateExecutionsPerSecond((function(n){return e.measureText(t+n)}),a.PeriodToEvalInMs)},t}(s.AbstractPassiveTelemetryCollector);function c(e,t){return parseFloat(e.toFixed(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCompressedTextTelemetryCollector=void 0;var r,i=n(4),o=n(2),a=n(40),l=n(12),s=n(18),d=n(0),u=n(5),c=n(10),g=n(6),h=n(34),f=n(43),m=n(35);t.registerCompressedTextTelemetryCollector=function(e,t){r||(r=new p(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&!f.shouldTextBeClipped(e,n))return!0}return!1}(t)&&r.register(t)};var p=function(e){function t(t){var n=e.call(this,"CompressedTextCollector")||this;return n.canvasContext=t,n}return i.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:h.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:h.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&!f.shouldTextBeClipped(e,r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:h.ResultMessageInsufficientData};var i=t[Math.floor(Math.random()*t.length)];i.CachedDisplayText||(i.CachedDisplayText=d.getDisplayText(i,e));var m=a.getDefaultContextState(void 0,e.IsRtl);a.updateContextForCurrentCell(this.canvasContext,m,i,e,void 0);var p=l.getAppZoom(),C=l.getDevicePixelRatio(),v=o.getTextDrawingMaxWidth(u.getCellWidth(e,i,!0),g.getCellTextHorizontalPadding(i,e,p,C),g.getDistanceFromCellStartToIconEnd(e,i,p,C),c.getExpandCollapseButtonPadding(i,d.isPivotTablePhase2Enabled(e)),0),y=g.getTextWidth(this.canvasContext,e,i);return{isValid:!0,value:{isCompressed:y>v,textWidth:y,maxWidth:v,len:i.CachedDisplayText.length,font:{name:s.getFontNameForLogging(i.CachedFont.FontName),size:i.CachedFont.Size,italic:!!i.CachedFont.Italic,bold:!!i.CachedFont.Bold}}}},t}(m.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerSpillCellTelemetryCollector=void 0;var r,i=n(4),o=n(1),a=n(12),l=n(18),s=n(73),d=n(34),u=n(35);t.registerSpillCellTelemetryCollector=function(e,t){r||(r=new c(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Spill&&n.Text)return!0}return!1}(t)&&r.register(t)};var c=function(e){function t(t){var n=e.call(this,"SpillCellCollector")||this;return n.canvasContext=t,n}return i.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:d.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:d.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&r.Spill&&t.push(r)}if(t.length<1)return{isValid:!1,value:d.ResultMessageInsufficientData};var i=t[Math.floor(Math.random()*t.length)],u=JSON.parse(JSON.stringify(i));return s.updateCellSpill(this.canvasContext,e,u,a.getAppZoom(),a.getDevicePixelRatio()),{isValid:!0,value:{isEqual:o.areCellsEqual(i,u,e,e).isEqual,font:{name:l.getFontNameForLogging(i.CachedFont.FontName),italic:!!i.CachedFont.Italic,bold:!!i.CachedFont.Bold}}}},t}(u.AbstractPassiveTelemetryCollector)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitWidthTelemetryCollector=void 0;var r,i=n(4),o=n(15),a=n(2),l=n(40),s=n(12),d=n(18),u=n(0),c=n(10),g=n(6),h=n(34),f=n(43),m=n(35);t.registerAutoFitWidthTelemetryCollector=function(e,t){r||(r=new p(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&!f.shouldTextBeClipped(e,n))return!0}return!1}(t)&&r.register(t)};var p=function(e){function t(t){var n=e.call(this,"AutoFitWidthCollector")||this;return n.canvasContext=t,n}return i.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:h.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:h.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&!f.shouldTextBeClipped(e,r)&&C(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:h.ResultMessageInsufficientData};var i=t[Math.floor(Math.random()*t.length)];i.CachedDisplayText||(i.CachedDisplayText=u.getDisplayText(i,e));var m=l.getDefaultContextState(void 0,e.IsRtl);l.updateContextForCurrentCell(this.canvasContext,m,i,e,void 0);var p=s.getAppZoom(),v=s.getDevicePixelRatio(),y=a.getTextDrawingMaxWidth(i.SrvDx||0,g.getCellTextHorizontalPaddingWithoutVisualElements(e,i),g.getDistanceFromCellStartToIconEnd(e,i,p,v),c.getExpandCollapseButtonPadding(i,u.isPivotTablePhase2Enabled(e)),o.getAutoFilterPaddingForAdvancedHorizontalAlignment(e,i,p,v)),T=g.getTextWidth(this.canvasContext,e,i);return{isValid:!0,value:{tooWide:T>y,tooNarrow:y>T+this.canvasContext.measureText(" ").width,textWidth:T,maxWidth:y,len:i.CachedDisplayText.length,font:{name:d.getFontNameForLogging(i.CachedFont.FontName),size:i.CachedFont.Size,italic:!!i.CachedFont.Italic,bold:!!i.CachedFont.Bold}}}},t}(m.AbstractPassiveTelemetryCollector);function C(e){return!!e.SrvDx}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerAutoFitHeightTelemetryCollector=void 0;var r,i=n(4),o=n(66),a=n(30),l=n(40),s=n(18),d=n(0),u=n(6),c=n(34),g=n(35);t.registerAutoFitHeightTelemetryCollector=function(e,t){r||(r=new h(e)),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&n.WrapText&&f(n))return!0}return!1}(t)&&r.register(t)};var h=function(e){function t(t){var n=e.call(this,"AutoFitHeightCollector")||this;return n.canvasContext=t,n}return i.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:c.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:c.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&r.WrapText&&f(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:c.ResultMessageInsufficientData};var i=t[Math.floor(Math.random()*t.length)],g=l.getDefaultContextState(void 0,e.IsRtl);l.updateContextForCurrentCell(this.canvasContext,g,i,e,void 0);var h=u.getTextWidth(this.canvasContext,e,i),m=u.getTextLineHeight(i,e),p=d.getFormattedText(i.CachedDisplayText,i,e),C=o.breakTextToLines(this.canvasContext,i.CachedDisplayText,h,a.BreakType.Wrap,this.canvasContext.measureText(" ").width,e,i,p,i.WrapText),v=C.textLines.length*m,y=i.SrvDy||0;return{isValid:!0,value:{tooLong:v>y,tooShort:y-v>m,textHeight:v,SrvDy:y,numLines:C.textLines.length,isRichText:!!p,font:{name:s.getFontNameForLogging(i.CachedFont.FontName),size:i.CachedFont.Size,italic:!!i.CachedFont.Italic,bold:!!i.CachedFont.Bold}}}},t}(g.AbstractPassiveTelemetryCollector);function f(e){return!!e.SrvDy}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCellHashDisplayCollector=void 0;var r,i=n(4),o=n(1),a=n(18),l=n(0),s=n(34),d=n(35);t.registerCellHashDisplayCollector=function(e){r||(r=new u),function(e){if(!e||!e.Cells)return!1;for(var t=0;t<e.Cells.length;t++){var n=e.Cells[t];if(n.Text&&g(n))return!0}return!1}(e)&&r.register(e)};var u=function(e){function t(){return e.call(this,"CellHashDisplayCollector")||this}return i.__extends(t,e),t.prototype.collect=function(){if(!this.canCollectorExecute())return{isValid:!1,value:s.ResultMessageCollectorDisabled};var e=this.data.pop(),t=[];if(!e||!(null==e?void 0:e.Cells))return{isValid:!1,value:s.ResultMessageInsufficientData};for(var n=0;n<e.Cells.length;n++){var r=e.Cells[n];r.Text&&g(r)&&t.push(r)}if(t.length<1)return{isValid:!1,value:s.ResultMessageInsufficientData};var i,o,d,u=0,h={};for(n=0;n<t.length;n++){var f=t[n],m=f.CachedDisplayText||l.getDisplayText(f,e),p=f.Text,C=c(m);if(C!==c(p)&&C&&(u++,f.CachedFont)){var v=(i=f.CachedFont,o=void 0,d=void 0,void 0,o=a.getFontNameForLogging(i.FontName),d=i.Size,l.getCellFontWeightStyle(i.Bold||!1,i.Italic||!1)+" "+o+" "+d+"pt");h[v]||(h[v]=0),h[v]+=1}}return{isValid:!0,value:{updatedCells:u,totalCells:t.length,fontWise:h}}},t}(d.AbstractPassiveTelemetryCollector);function c(e){for(var t=0;t<e.length;t++)if("#"!==e[t])return!1;return!0}function g(e){return e.ValueType===o.CellValueType.Number}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeModelFidelity=void 0;var r=n(1),i=n(19),o=n(18),a=n(207);function l(e,t){var n=t.CachedBorderStyle;if(n)for(var r=0;r<n.Borders.length;r++){var i=n.Borders[r];2===i.Weight?f(e,a.LowFidelityProblemType.MediumBorder):3===i.Weight&&f(e,a.LowFidelityProblemType.ThickBorder)}}function s(e,t,n){var r=n.CachedStyle,o=n.CachedFont;r&&o&&r.Orientation&&(i.shouldDrawRotatedText(t,n.CachedStyle,n.CachedFont)||f(e,a.LowFidelityProblemType.CellTextOrientation))}function d(e,t){var n,r;if(t.Text){var i=t.CachedDisplayTextRuns;if(i){for(var o=0;o<i.length;o++)if(null===(n=i[o].CachedFont)||void 0===n?void 0:n.Bold){f(e,a.LowFidelityProblemType.BoldText);break}}else(null===(r=t.CachedFont)||void 0===r?void 0:r.Bold)&&f(e,a.LowFidelityProblemType.BoldText)}}function u(e,t){if(t.Text){var n=t.CachedDisplayTextRuns;if(n){for(var r=0;r<n.length;r++)if(n[r].CachedFont&&!o.isKnownFont(n[r].CachedFont.FontName)){f(e,a.LowFidelityProblemType.CustomFont);break}}else t.CachedFont&&!o.isKnownFont(t.CachedFont.FontName)&&f(e,a.LowFidelityProblemType.CustomFont)}}function c(e,t){var n=t.CachedFont;n&&(n.Underline!==r.FontUnderline.SingleAccounting&&n.Underline!==r.FontUnderline.DoubleAccounting||f(e,a.LowFidelityProblemType.AccountingUnderline))}function g(e,t){var n=t.CachedStyle;n&&n.IsPattern&&f(e,a.LowFidelityProblemType.PatternStyle)}function h(e,t){var n=t.CachedDisplayTextRuns;if(t.WrapText&&n)for(var i=0;i<n.length;i++){var o=n[i].CachedFont;if(o&&(o.VerticalAlign===r.FontVerticalAlignment.Subscript||o.VerticalAlign===r.FontVerticalAlignment.Superscript))return void f(e,a.LowFidelityProblemType.SubScriptSuperScriptInWrapText)}}function f(e,t){var n=a.LowFidelityProblemType[t];e[n]?e[n]+=1:e[n]=1}t.analyzeModelFidelity=function(e){for(var t={},n=0;n<e.Cells.length;n++){var i=e.Cells[n];i&&(d(t,i),u(t,i),l(t,i),s(t,e,i),r.isChangeGateEnabled(r.ChangeGate.RFMetricPhase2)&&(c(t,i),g(t,i),h(t,i)))}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LowFidelityProblemType=void 0,function(e){e[e.ThickBorder=0]="ThickBorder",e[e.MediumBorder=1]="MediumBorder",e[e.BoldText=2]="BoldText",e[e.CustomFont=3]="CustomFont",e[e.CellHashText=4]="CellHashText",e[e.CellTextOrientation=5]="CellTextOrientation",e[e.AccountingUnderline=6]="AccountingUnderline",e[e.SubScriptSuperScriptInWrapText=7]="SubScriptSuperScriptInWrapText",e[e.PatternStyle=8]="PatternStyle"}(t.LowFidelityProblemType||(t.LowFidelityProblemType={}))},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"setupDefaultRumShepherd",(function(){return ee})),n.d(r,"RumShepherdFactoryGlobal",(function(){return te})),n.d(r,"SubComponentInitEventName",(function(){return c})),n.d(r,"SubComponentSetLoadStateEventName",(function(){return g})),n.d(r,"AppLoadMetricReportEventName",(function(){return h})),n.d(r,"dispatchRumShepherdEvent",(function(){return f})),n.d(r,"VISUALLY_READY",(function(){return i})),n.d(r,"FUNCTIONALLY_READY",(function(){return o})),n.d(r,"VISUALLY_PERCEIVED",(function(){return a}));var i="visually-ready",o="functionally-ready",a="visually-perceived";var l=n(4);function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,Object(l.__spreadArray)(["[RumShepherd]"+e],t))}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.info.apply(console,Object(l.__spreadArray)(["[RumShepherd]"+e],t))}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.debug.apply(console,Object(l.__spreadArray)(["[RumShepherd]"+e],t))}var c="Wac-SubComponentsInit",g="Wac-SubComponentSetLoadState",h="Wac-AppLoadMetricReport",f=function(e,t){try{var n=new CustomEvent(e,{detail:t});self.dispatchEvent(n)}catch(e){s("dispatchRumShepherdEvent failed with exception:",e)}};function m(){var e=window.performance;return e&&e.timeOrigin?e.timeOrigin:e&&e.timing&&e.timing.navigationStart?e.timing.navigationStart:0}function p(){var e=window.performance;return e&&e.now?e.now():(new Date).getDate()-m()}function C(){var e=window.performance;return e&&e.now?m()+e.now():(new Date).getDate()}function v(e){return m()+e}function y(e){return e===i||e===o||e===a}function T(e,t){var n;for(var r in e)if(!(null===(n=e[r].states[t])||void 0===n?void 0:n.final))return!1;return!0}function S(e,t){return t&&e&&y(t)&&e.states[t]}var F=[];function x(e,t,n,r){var i,o="[rum:"+Number(p().toFixed())+"]"+t+" "+(n?JSON.stringify(n):"");F.push({level:e,message:o}),r&&(i={traces:Object(l.__spreadArray)([],F)},F=[],f("Wac-AppLoadTrace",i))}function w(e){return e?Object(l.__assign)({},e):{}}function R(e){var t=[];for(var n in e){var r=e[n];t.push({id:r.id,rootElementId:r.rootElementId,subComponents:b(r.subComponents)})}return t}function b(e){var t=[];for(var n in e){var r=e[n];t.push({id:r.id,initTime:v(r.initTime),optional:r.optional,unused:r.unused,states:I(r.states)})}return t}function I(e){var t={};for(var n in e){var r=e[n];(null==r?void 0:r.time)&&(t[n]=v(r.time))}return t}function A(e,t){var n=e.subComponents;for(var r in n){var i=n[r];if(!(i.states[t]||i.unused))return!1}return!0}function P(e){var t=Number.POSITIVE_INFINITY;for(var n in e.subComponents){var r=e.subComponents[n];t=Math.min(t,r.initTime)}return t}function D(e,t){if(!e)return!1;var n=e.states[t];return e.optional||(null==n?void 0:n.time)&&n.promotedFromPreviousState}function M(e,t){return t===i&&S(e,a)}function O(e,t){return{start:e.start,time:null!=t?t:e.time,error:e.error,monitor:e.monitor,measures:w(e.measures),data:w(e.data)}}function k(e,t,n,r){"then"in e?e.then((function(e){r(e)})).catch((function(e){var i="Error in invokeMonitor ["+n+"}]";s(i,e),r({start:t,time:t,monitor:"",error:i+": "+e})})):r(e)}var L=function(){function e(e){this._settings=null!=e?e:{}}return e.prototype.getBooleanSetting=function(e,t){var n=this._settings[e];if(!n)return t;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return t}},e.prototype.getStringSetting=function(e,t){var n=this._settings[e];return n||t},e}(),H=n(56);var E=function(){function e(e){var t=this;this.timeoutInMs=e,this._reason="",this._cancel=function(e){t._reason||(t._reason=e?"timeout":"cancelled",t._onCancelled&&t._onCancelled())},this.cancel=function(){t._cancel(!1)},e>0&&window.setTimeout((function(){return t._cancel(!0)}),e)}return Object.defineProperty(e.prototype,"timeout",{get:function(){return this.timeoutInMs},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this._reason},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCancelled",{set:function(e){this._onCancelled=e},enumerable:!1,configurable:!0}),e}();function B(e){return new E(null!=e?e:0)}var N=n(14),W=function(){function e(e){var t=this;this._metrics={},this._monitoredMetrics={},this._firstTabHiddenTime=0,this._shepherdInit=e,function(e){var t="hidden"===document.visibilityState?0:1/0;e(t),document.addEventListener("visibilitychange",(function(n){t=Math.min(t,n.timeStamp),e(t)}),{once:!0})}((function(e){return t._firstTabHiddenTime=e}))}return Object.defineProperty(e.prototype,"tabHideTime",{get:function(){return this._firstTabHiddenTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._metrics},enumerable:!1,configurable:!0}),e.prototype.startMonitors=function(e,t){var n=this;x(N.a.Verbose,"startMonitors",{appState:e});var r=function(e,r){if(x(N.a.Verbose,"onCompleteWithInputCheck",{metric:e}),r){if(!r.error){var i=n._metrics["first-input"]?n._metrics["first-input"].time:0,o=n._metrics["first-interaction"]?n._metrics["first-interaction"].time:0;i>0&&i<r.time&&(0===o||i<=o)&&(r.error="first-input"),o>0&&o<r.time&&(r.error="first-interaction")}t(e,r)}};e===i&&(this.monitorMetric("first-input",t),this.monitorMetric("first-interaction",t),this.monitorMetric("first-idle",r),this.monitorMetric("stable-interactivity",r,12e4))},e.prototype.cancelMonitors=function(e){var t=this;if(e===i){x(N.a.Info,"cancelAppStateMonitors",e);var n=function(e){var n;null===(n=t._monitoredMetrics[e])||void 0===n||n.cancel(),t._monitoredMetrics[e]=void 0,t._metrics[e]=void 0};n("stable-interactivity"),n("first-idle")}},e.prototype.monitorMetric=function(e,t,n){if(x(N.a.Verbose,"monitorMetric",e),this._monitoredMetrics[e])x(N.a.Verbose,"monitorMetric:already-running",e);else{var r=B(n);this._monitoredMetrics[e]=r;var i=p();k((0,this._shepherdInit.monitors[e])(i,r),i,e,(function(n){x(N.a.Verbose,"monitorMetric:complete",e),t(e,n)}))}},e}();function z(e,t,n){e.states[t]={result:O(n),monitoring:void 0,final:A(e,t)}}var j=function(){function e(e){var t=this;this._components={},this._reportedMetrics={},this._canAppStateMetricBeReported=function(e){if(t._reportedMetrics[e])return!1;var n=T(t._components,e);return x(N.a.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:e,isFinal:n}),n},this._canMonitorMetricBeReported=function(e){if("stable-interactivity"===e||"first-idle"===e){var n=t._monitorMetrics.metrics[e],r=T(t._components,i);return x(N.a.Verbose,"canMonitorMetricBeReported:si-error:",{metric:e,error:null==n?void 0:n.error,vrStateFinal:r}),!!n&&"cancelled"!==n.error&&r}return!0},this._reportMonitorMetricIfReady=function(e){var n=t._reportedMetrics[e],r=t._canMonitorMetricBeReported(e);!n&&r?t._reportMetricInternal(e):x(N.a.Info,"reportMonitorMetricIfReady:not-ready",{metric:e,isReported:n,canMetricBeReported:r})},this._reportAppStateIfReady=function(e){t._canAppStateMetricBeReported(e)&&t._reportMetricInternal(e)},this._reportMetricInternal=function(e){try{var n=t._monitorMetrics.metrics[e],r={metric:e,timeOrigin:t._timeOrigin,time:n.time,error:n.error||(t._monitorMetrics.tabHideTime<n.time?"tab-switch":void 0),monitor:n.monitor,measures:w(n.measures),data:w(n.data),auxMetrics:[],componentsData:R(t._components)},a=r.measures;if(a.tabsSwitch=t._monitorMetrics.tabHideTime<n.time?t._monitorMetrics.tabHideTime:0,a.start=n.start,a.reportedTime=p(),"stable-interactivity"===e){var l=t._monitorMetrics.metrics[i];a[i]=l?l.time:0;var d=t._monitorMetrics.metrics[o];a[o]=d?d.time:0}if(y(e)){for(var u in t._components){var c=t._components[u],g=c.states[e].result;a[u]=g.time,r.error=r.error||g.error;var h={metric:e+"-"+u,time:g.time,monitor:g.monitor,error:g.error,measures:w(g.measures)};h.measures.start=g.start,h.measures.init=P(c),r.auxMetrics.push(h)}var f=t._monitorMetrics.metrics["stable-interactivity"];f&&f.error&&"cancelled"!==f.error&&!r.error&&(r.error="si-error")}t._shepherdInit.appLoadMetricReportCallback&&(t._reportedMetrics[e]=!0,x(N.a.Info,"reportMetric:reporting",e,!0),t.sendTraceViaRemoteTelemetry("Reporting app report with: "+JSON.stringify(r)),t._shepherdInit.appLoadMetricReportCallback(r))}catch(e){x(N.a.Error,"reportMetric:error",e),s("_reportMetricIfReady:",e)}},this._flushRumShepherdState=function(){var e,n={time:C(),allMetricsReported:(e=t._reportedMetrics,!!(e[i]&&e[o]&&e["stable-interactivity"]&&e["first-input"]&&e["first-interaction"]&&e["first-idle"])),metrics:t._monitorMetrics.metrics,components:R(t._components),timeOrigin:m()};t.sendTraceViaRemoteTelemetry("Reporting app load state with: "+JSON.stringify(n)),t._shepherdInit.appLoadStateLoggingCallback(n)},this._processSubComponentState=function(e,n,r,i,o){if(S(n,o)){var a=n.states[o];n.states[r]={time:a.time,promotedFromPreviousState:!0}}else n.states[r]={time:i,promotedFromPreviousState:!1};if(x(N.a.Verbose,"processSubComponentState",{component:e.id,subComponent:n.id,state:r}),function(e,t){var n=e.subComponents;for(var r in n){var i=n[r].states[t];if(!((null==i?void 0:i.time)||n[r].optional||M(n[r],t)))return!1}return!0}(e,r)){var l=function(e,n){n&&(x(N.a.Info,"processSubComponentState:complete-monitor-metric",e),t.metrics[e]=O(n),t._reportMonitorMetricIfReady(e))},s=function(e,n){var r=function(e,t){var n,r,i=0;for(var o in e){var a=null===(r=null===(n=e[o].states[t])||void 0===n?void 0:n.result)||void 0===r?void 0:r.time;if(!a)return;i=Math.max(i,a)}return i}(t._components,e);x(N.a.Verbose,"processSubComponentState:appStateTime",{time:r,state:e}),r&&(!function(e,n,r){n&&(x(N.a.Info,"processSubComponentState:complete-appstate-metric",e),t.metrics[e]=O(n,r),t._reportAppStateIfReady(e))}(e,n,r),t._monitorMetrics.startMonitors(e,l))};if(t._monitorMetrics.cancelMonitors(r),S(n,o)&&function(e,t){if(t&&e&&e.states[t]){var n=e.states[t];return(null==n?void 0:n.result)&&(null==n?void 0:n.final)}return!1}(e,o)&&function(e,t){if(!e||!t)return!1;var n=e.subComponents;for(var r in n)if(!D(n[r],t))return!1;return!0}(e,r)){var d=e.states[o];return z(e,r,d.result),void s(r,d.result)}var u=t._shepherdInit.monitors[r];x(N.a.Verbose,"processSubComponentState:start-monitor",{state:r}),function(e,t,n,r){var i=e.states[t];if(!(null==i?void 0:i.final)){(null==i?void 0:i.monitoring)&&(null==i||i.monitoring.cancel());var o=p(),a=B(5e3);e.states[t]={monitoring:a,final:A(e,t)},k(n(o,a,e),o,t,r)}}(e,r,u,(function(t){x(N.a.Verbose,"processSubComponentState:monitor-complete",{state:r}),z(e,r,t),s(r,t)}))}else x(N.a.Verbose,"processSubComponentState:component-not-ready",{component:e.id,state:r})},this._processSubComponentUnused=function(e,n){for(var r in x(N.a.Verbose,"processSubComponentUnused",{subComponent:n.id}),n.unused=!0,e.states){var i=r,o=e.states[i];!o.final&&A(e,i)&&(x(N.a.Verbose,"processSubComponentUnused:unused-final",{component:e.id,state:i}),u("Unused set final:",e.id,i),o.final=!0,t._reportAppStateIfReady(i))}t._reportMonitorMetricIfReady("stable-interactivity"),t._reportMonitorMetricIfReady("first-idle")},this._addSubComponent=function(e,t,n,r){n?e.ignoredSubComponents[t]=!0:e.subComponents[t]||(e.subComponents[t]={id:t,initTime:p(),optional:r,unused:!1,states:{}})},x(N.a.Info,"initialize"),d("RumShepherd:initialize"),this._timeOrigin=Number(m().toFixed()),this._shepherdInit=Object(l.__assign)({},e),this._monitorMetrics=new W(this._shepherdInit),this._settingsManager=new L(this._shepherdInit.appSettings),this.sendTraceViaRemoteTelemetry("Initializing RumShepherd");for(var n=0,r=e.components;n<r.length;n++){var a=r[n];this._components[a.id]={id:a.id,rootElementId:a.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}}}window.setTimeout((function(){return t._flushRumShepherdState()}),12e4)}return e.prototype.sendTraceViaRemoteTelemetry=function(e){if(this._settingsManager.getBooleanSetting("RumShepherdRemoteTelemetryLoggingIsEnabled",!1)){var t=this._settingsManager.getStringSetting("RemoteTelemetryUrl","");!function(e,t){var n={type:"RUM_TRACE",payloadJson:JSON.stringify(e)};Object(H.a)(JSON.stringify(n),t,!0)}({time:C(),sessionId:this._settingsManager.getStringSetting("SessionId",""),message:e},t)}},e.prototype.addSubComponents=function(e){if(e&&e.component&&e.subComponents){var t=this._components[e.component];if(t){var n=t.ignoreNewSubComponents;if(function(e){for(var t in e.states)if(e.states[t].final)return!1;return!0}(t)||n){x(N.a.Verbose,"addSubComponents",{ignore:n,data:e}),u("addSubComponents:",n,e);try{for(var r=Array.isArray(e.subComponents)?e.subComponents:[e.subComponents],i=0;i<r.length;i+=1)this._addSubComponent(t,r[i],n,!1);if(e.optionalSubComponents)for(i=0;i<e.optionalSubComponents.length;i+=1)this._addSubComponent(t,e.optionalSubComponents[i],n,!0)}catch(e){s("addSubComponents",e)}}else s("Component cannot be modified",e)}else s("Invalid component",e)}else s("Invalid data",e)},e.prototype.setSubComponentState=function(e){var t,n=p();if(e&&e.subComponent&&e.component&&e.state){var r=this._components[e.component];if(r){if(!r.ignoredSubComponents[e.subComponent]){r.ignoreNewSubComponents=r.ignoreNewSubComponents||!!e.ignoreNewSubComponents;var i=r.subComponents[e.subComponent];if(i)if(u("setSubComponentState:",e),"unused"!==e.state){var o=e.state;if(y(o))if(null===(t=r.states[o])||void 0===t?void 0:t.final)s("Component state final. Can't set",e);else if(i.unused||i.states[o])s("SubComponent unused or set",e);else{var a=e.promoteStateFrom;this._settingsManager.getBooleanSetting("RumShepherdStagePromotionIsEnabled",!1)&&a?this._processSubComponentState(r,i,o,n,a):this._processSubComponentState(r,i,o,n)}else s("Unknown state reported",e)}else this._processSubComponentUnused(r,i);else s("Unexpected sub-component",e)}}else s("Invalid component",e)}else s("Invalid data",e)},Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metrics",{get:function(){return this._monitorMetrics.metrics},enumerable:!1,configurable:!0}),e}();function _(e){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(e)}function V(e,t,n,r){if(_("element")){var i="testimg-"+n,o=function(e){var t=document.createElement("img");if(e){if(!("elementTiming"in t))return;t.elementTiming=e}return t.style.position="absolute",t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",t}(i);if(o){var a=null!=r?r:document.documentElement;return new Promise((function(n){var r=function(t,r){void 0===t&&(t=0),l&&l.disconnect(),n({start:e,time:t,monitor:"image-paint-api",error:r})},l=new PerformanceObserver((function(e){for(var t=0,n=e.getEntries();t<n.length;t++){var l=n[t];if(l.identifier===i){try{a.removeChild(o)}catch(e){s("measureImagePaintTime",e)}return void r(l.renderTime)}}}));t.onCancelled=function(){return r(0,t.reason)},l.observe({type:"element",buffered:!0}),a.appendChild(o)}))}}}function U(e,t){return window.requestAnimationFrame?new Promise((function(n){var r,i=function(i){void 0===i&&(i=0),cancelAnimationFrame(r),n({start:e,time:i,monitor:"rAF",error:t.reason})};t.onCancelled=i,r=requestAnimationFrame((function(){i(p())}))})):Promise.resolve({start:e,time:0,monitor:"",error:"rAF Unsupported"})}function G(e,t){return new Promise((function(n){var r,i,o=function(o){void 0===o&&(o=0),cancelAnimationFrame(r),clearTimeout(i),n({start:e,time:o,monitor:"rAF-setTimeout",error:t.reason})};t.onCancelled=function(){return o()},r=requestAnimationFrame((function(){i=window.setTimeout((function(){o(p())}),0)}))}))}function q(e,t,n){void 0===n&&(n=1e3);var r=t||B(12e3);if(!_("longtask"))return function(e,t){var n=p();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});var r=p(),i=0,o=r,a=0,l=0,s=r;return new Promise((function(r){var d,u=function(t){void 0===t&&(t=0),cancelAnimationFrame(d);var o={start:n,time:t,monitor:"long-frames",error:e.reason,measures:{longTasksCount:i,longestTaskDuration:l,longTasksDuration:a}};r(o)};e.onCancelled=u;var c=function(e){var n=e-o,r=e-s;s=e,r>=50&&(n=0,a+=r,i+=1,o=e,l=Math.max(l,r)),n>=t?u(o):d=window.requestAnimationFrame(c)};d=window.requestAnimationFrame(c)}))}(r,n);var i=performance.now(),o=0,a=i,l=0,s=0;return new Promise((function(t){var i,d=function(){clearTimeout(i),u&&u.disconnect();var n=p()-e,d={start:e,time:a,monitor:"longtask-api",error:r.reason,measures:{longTasksDuration:l,longTasksCount:o,longestTaskDuration:s,monitoredTime:n}};t(d)};r.onCancelled=d;var u=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){o+=1,l+=e.duration;var t=e.startTime+e.duration;a=Math.max(t,a),s=Math.max(s,e.duration)}))}));u.observe({entryTypes:["longtask"]});var c=function(){var e=performance.now()-a;if(e>=n)d();else{var t=n-e;i=window.setTimeout(c,t)}};i=window.setTimeout(c,n)}))}function Y(e,t){return _("first-input")?new Promise((function(n){var r,i=function(t,i,o){r&&r.disconnect(),n({start:e,time:t,monitor:"first-input-api",error:o,measures:{fid:i}})};try{t.onCancelled=function(){return i(0,0,t.reason)};(r=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){return function(e){var t=e.processingStart,n=t-e.startTime;i(t,n)}(e)}))}))).observe({type:"first-input",buffered:!0})}catch(e){i(0,0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"FID unsupported"})}function J(e,t){var n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],r={passive:!0,capture:!0},i=C();return new Promise((function(o){var a=function(n,r,i){s(removeEventListener);var a={start:e,time:n,monitor:"first-interaction",error:t.reason,data:{eventName:r},measures:{delay:i}};o(a)};t.onCancelled=function(){return a(0,"",0)};var l=function(e){if(e.cancelable){var t=C(),n=e.timeStamp>1e12,r=(n?C():performance.now())-e.timeStamp;(r<0||r>t-i)&&(r=0),a(n?e.timeStamp-m():e.timeStamp,e.type,r)}},s=function(e){n.forEach((function(t){e(t,l,r)}))};s(addEventListener)}))}function X(e,t){return window.requestIdleCallback?new Promise((function(n){var r,i=function(t,i){window.cancelIdleCallback(r),n({start:e,time:t,monitor:"first-idle",error:i})};try{r=window.requestIdleCallback((function(e){return i(p(),e.didTimeout?"timeout":"")}),{timeout:t.timeout}),t.onCancelled=function(){return i(0,t.reason)}}catch(e){i(0,"exception")}})):Promise.resolve({start:e,time:0,monitor:"",error:"requestIdleCallback unsupported"})}var K=0,Z=function(e){d("report "+e.metric+":"+e.time+"ms",e);var t=new CustomEvent(h,{detail:e});self.dispatchEvent(t)},Q=function(e){d("reporting the application load state at epoch time: "+e.time+"; with the status of all metrics reported as "+e.allMetricsReported);var t=new CustomEvent("Wac-AppLoadStateReport",{detail:e});self.dispatchEvent(t)},$=function(e,t,n){if(n){var r="vr-"+n.id+"-"+K;K+=1;var i=document.documentElement;return function(e,t,n,r){var i=r?V(e,t,n,r):void 0;return i||(i=U(e,t)),i}(e,t,r,null!=i?i:void 0)}return U(e,t)};function ee(e,t){var n=new j({appLoadMetricReportCallback:Z,appLoadStateLoggingCallback:Q,appSettings:t,monitors:{"visually-ready":$,"visually-perceived":$,"functionally-ready":G,"stable-interactivity":q,"first-input":Y,"first-interaction":J,"first-idle":X},components:e});window.addEventListener(c,(function(e){var t=e.detail;n.addSubComponents(t)})),window.addEventListener(g,(function(e){var t=e.detail;n.setSubComponentState(t)}))}var te=new(function(){function e(){}return e.prototype.setupDefault=function(e){if(e)return ee(e),null},e}()),ne=n(75),re=n(44);n.d(t,"rumShepherd",(function(){return r})),n.d(t,"gridRenderer",(function(){return ne})),n.d(t,"interactivity",(function(){return re}))}])}));
//# sourceMappingURL=gridRenderer.min.js.map