typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.n=function(){};Common.App.Enrichment.n.registerInterface("Common.App.Enrichment.n");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.o=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.o.prototype={requestId:null,cellId:null};Common.App.Enrichment.i=function(){this.messageType=type};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.prototype={Query:null,TelemetryJson:null,DomainId:0,DomainIdString:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={DomainId:0,DomainIdString:null};Common.App.Enrichment.j=function(n){this.messageType=n};Common.App.Enrichment.j.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.j;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.g=function(){};Common.App.Enrichment.g.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.t=Function.createDelegate(this,this.R);this.r=Function.createDelegate(this,this.O);this.p=Function.createDelegate(this,this.M);this.q=Function.createDelegate(this,this.N);this.y=Function.createDelegate(this,this.J);this.s=Function.createDelegate(this,this.P);this.o=Function.createDelegate(this,this.L);this.h=n;this.k=t;this.z=i;this.j=r;this.u=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.h()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={h:null,k:null,d:null,e:null,z:null,j:null,u:null,v:null,w:null,l:null,g:null,i:null,x:!1,C:function(){return!0},m:function(){return Common.a.a.b("EnrichmentPaneUrl")},dispose:function(){this.C()&&this.g&&(this.h.b("click",this.g,this.o),this.k.b("keyup",this.g,this.s));this.g=null;this.e&&(this.T(),this.e.parentNode.removeChild(this.e),this.e=null);var n=this.j.a("EnrichmentPaneId");n.b(this.i)},b:function(n,t,i){this.d=n;this.x||(this.l=this.F(),this.B().appendChild(this.l),this.Q(),this.u.a(1520278933,2147483648,this.y),this.S(),this.x=!0);this.e.src=this.m()&&this.m().length?this.m()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.v=t;this.w=i;this.E()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.n(i)},S:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.h.d("EnrichmentPaneId",this.l,!1);n.c(this.i,1520278933)},R:function(){if(this.e){Common.q.b(this.e.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.n(n)}},L:function(){return this.A(),!0},P:function(n){var t=n.a.keyCode;return t===13||t===32?(this.A(),!0):!1},A:function(){this.a();this.d&&this.d.a()},F:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.C()&&n.appendChild(this.G()),this.K(n),n},G:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.bj,i.title=$a.bj,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.e,"ClosePaneGlyph_16x16x32",!1),this.h.a("click",n,this.o),this.k.a("keyup",n,this.s),t.appendChild(i),t.appendChild(n),this.g=n,t},K:function(n){this.e=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.e);this.e.id="EnrichmentContentFrame";this.e.setAttribute("role","presentation")},Q:function(){Common.m.b(this.e,"load",this.q);Common.m.b(this.e,"error",this.p);$addHandler(window,"message",this.r)},T:function(){Common.m.c(this.e,"load",this.q);Common.m.c(this.e,"error",this.p);$removeHandler(window,"message",this.r)},H:function(){this.e.src="about:blank"},a:function(){this.D();this.H()},J:function(n,t,i){return i!==1&&(this.a(),this.d&&this.d.a()),32},N:function(){},M:function(){},O:function(n){var u=n.rawEvent,t,f,e,o,s,i,h,c,l,a,v,y,p,r;if(!this.e||this.e.src.indexOf(u.origin)!==-1){try{t=JSON.parse(u.data)}catch(d){return}if(!CommandUI.a.a(t.messageType)){f=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.n(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.v),this.w));break;case 1:this.n(new(Common.App.Enrichment.c.$$(String))(0,this.I()));break;case 3:e=t;this.d&&this.d.k(e.messageContent);break;case 5:o=t;this.d&&this.d.g(o.messageContent);break;case 8:s=t;this.d&&(i=JSON.parse(s.messageContent),i.DomainId>0?this.d.i(i.Query,i.TelemetryJson,i.DomainId,i.DomainIdString):this.d.h(i.Query,i.TelemetryJson));break;case 6:this.d&&this.d.c();break;case 11:var w=t,b=JSON.parse(w.messageContent),k=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,b,!0,!1,!1);this.e&&this.e.dispatchEvent(k);break;case 12:h=t;c=JSON.parse(h.messageContent);c.keyCode===27&&(l=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.e&&(this.e.dispatchEvent(l),this.a(),this.d&&this.d.a()));break;case 13:a=t;this.d&&this.d.j(a.messageContent);break;case 14:v=t;this.d&&this.d.l(v.messageContent);break;case 15:y=t;this.d&&this.d.m(y.messageContent);break;case 16:p=t;this.d&&(r=JSON.parse(p.messageContent),this.d.e(r.DomainId,r.DomainIdString))}window.g_badCastCallback=f}}},I:function(){return JSON.stringify([2,1,3,5,8,6])},n:function(n){var t=JSON.stringify(n);this.e.contentWindow.postMessage(t,Common.k.h(this.m()))}};Common.App.Enrichment.h=function(n){this.o=n};Common.App.Enrichment.h.prototype={o:null,n:null,f:function(n,t,i){this.n=n;this.o&&this.o.b(this,t,i)},b:function(n,t){this.o&&this.o.c(n,t)},d:function(){this.o&&this.o.a()},dispose:function(){this.o&&(this.o.dispose(),this.o=null)},k:function(n){return this.n?this.n.r(n):!1},h:function(n,t){this.n&&this.n.o(n,t)},i:function(n,t,i,r){this.n&&this.n.p(n,t,i,r);return},g:function(n){return this.n?this.n.m(n):!1},a:function(){this.n&&this.n.n()},c:function(){this.n&&this.n.k()},j:function(n){this.n&&this.n.q(n)},l:function(n){this.n&&this.n.s(n)},m:function(n){this.n&&this.n.t(n)},e:function(n,t){this.n&&this.n.l(n,t)}};Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.j.registerClass("Common.App.Enrichment.j");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.m,Sys.IDisposable);Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h",null,Common.App.Enrichment.l,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bfo=function(){};_Ewa.bfp=function(){};_Ewa.bfp.registerInterface("_Ewa.bfp");_Ewa.Iv=function(n,t){this.b=t;this.a=n};_Ewa.Iv.prototype={b:null,a:null,z:function(n,t){switch(t){case-1203788282:case 48568533:case-1662108744:var i=_Ewa.c.a(this.b),r=this.a.B()||7e3;return i&&i.a()&&i.a().a().c().y()>r?!0:!1;default:return!1}},x:function(n,t,i){var u=_Ewa.g.c(),r=t.a;switch(r){case-1203788282:this.a.y(i.MenuItemId.toString());break;case 311599363:this.a.w();break;case 439914789:this.a.i();break;case 2127195269:this.a.H();break;case-1662108744:this.a.I(i.MenuItemId.toString());break;case 1266950951:this.a.G(!0);break;case 49813714:this.a.z();break;case-1081442996:_Ewa.a.b(717)&&this.a.A();break;case 1702917262:_Ewa.a.b(717)&&this.a.O("DT_PBI_IMGSEC");break;case-90814711:_Ewa.a.b(717)&&this.a.P();break;case 325814869:this.a.J();break;case 48568533:case-1027730316:(r===48568533||i.launcherId&&i.launcherId.toString()==="ConvertToLinkedEntityGallery")&&(Diag.a.a(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),Common.A.a("ExpandDataTypeGallery",!0,0,null));break;default:u=_Ewa.Y.a(r)}return u},w:function(n,t){switch(t.a){case-1203788282:case 439914789:case 2127195269:case 49813714:return _Ewa.a.b(133);case-1081442996:case 1702917262:case-90814711:return _Ewa.a.b(717);case 48568533:case-1027730316:case-1662108744:case 311599363:case 1266950951:return!0;case 325814869:return this.a.e();default:return!1}},y:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&_Ewa.a.b(133)?this.a.L(n,t,i):!1}};_Ewa.wa=function(n){_Ewa.wa.initializeBase(this,[n])};_Ewa.wa.a=function(n){_Ewa.bh.a(273,new _Ewa.wa(n))};_Ewa.wa.prototype={n:function(){var n=this;_Ewa.gi.a(_Ewa.dN,this.h,271,272,this.j,function(t){n.m([new _Ewa.Iv(t,n.h)],null)},null)}};_Ewa.IA=function(n){this.campaignId=n;this.commentQuestion=_Ewa.ClientStringManager.a().c(188);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=_Ewa.ClientStringManager.a().c(184);this.ratingValuesAscending=[_Ewa.ClientStringManager.a().c(185),_Ewa.ClientStringManager.a().c(186),_Ewa.ClientStringManager.a().c(187)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=_Ewa.ClientStringManager.a().c(183)};_Ewa.IA.prototype={commentQuestion:null,campaignId:null,isZeroBased:!1,aditionalDataRequested:null,ratingQuestion:null,ratingValuesAscending:null,showEmailRequest:!1,showPrompt:!1,surveyType:0,title:null};_Ewa.Iw=function(n,t,i,r,u){var f,e;this.w=Function.createDelegate(this,this.N);this.m=Function.createDelegate(this,this.X);this.k=Function.createDelegate(this,this.P);this.x=Function.createDelegate(this,this.O);this.y=Function.createDelegate(this,this.R);this.z=Function.createDelegate(this,this.S);this.p=Function.createDelegate(this,this.U);this.A=Function.createDelegate(this,this.W);this.o=Function.createDelegate(this,this.Q);this.q=Function.createDelegate(this,this.V);this.a=n;this.b=_Ewa.c.a(this.a);this.b.a().o(this.q);this.b.C(this.o);this.n=r;this.r=u;_Ewa.s.a(this.a)||i.f(_Ewa.rN,t);f=new _Ewa.Iy(t);this.g=new _Ewa.Iz(f);e=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(n){n.a("mso_sendASmile",!0).then(function(n){return e.h=n,null})})};_Ewa.Iw.prototype={a:null,s:!1,c:!1,h:!0,e:!0,j:!1,i:!1,f:null,l:0,n:null,b:null,g:null,r:null,dispose:function(){this.a&&(this.b.a().s(this.q),this.b.I(this.o))},bb:function(n){var i=_Ewa.h.c(this.b.a().a().a(),this.a),t=this,r=function(r,u,f){return _Ewa.dw.s(t.a.c().a(),i,n,_Ewa.n.a(r,t.A),u,f,null,null)},f=this,u=function(){return new _Ewa.fP},e=this;return _Ewa.H.a(this.a.f(),r,function(n){return new _Ewa.v(109,0,n,0,u)},null),!0},C:function(n,t,i,r,u){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var e=_Ewa.h.c(this.b.a().a().a(),this.a),f=this,o=function(t,o,s){return _Ewa.dw.m(f.a.c().a(),e,n,f.h,i,r,u,_Ewa.n.a(t,f.p),o,s,null,null)},s=this;_Ewa.H.a(this.a.f(),o,function(n){return new _Ewa.v(110,0,n,16,null)},null);return},M:function(n){var t=_Ewa.h.c(this.b.a().a().a(),this.a);!t;this.e=!1;var i=this,r=function(r,u,f){return _Ewa.dw.o(i.a.c().a(),t,n,_Ewa.n.a(r,i.z),u,f,null,null)},u=this;return _Ewa.H.a(this.a.f(),r,function(n){return new _Ewa.v(111,0,n,16,null)},null),!0},T:function(){this.c=!1;this.s=!0;this.l=0;this.i=!1},E:function(){var n=this.v();if(n){var t=this,i=function(i,r,u){return _Ewa.dw.b(t.a.c().a(),n,_Ewa.n.a(i,t.p),r,u,null,null)},r=this;_Ewa.H.a(this.a.f(),i,function(n){return new _Ewa.v(112,0,n,16,null)},null);return}},Z:function(n){var t,i;if(Diag.a.a(591005634,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane"),this.d(),!n||!n.length){Diag.a.a(593282251,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane");return}if(t=JSON.parse(n),!t){Diag.a.a(593282250,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");return}if(!(t.domainId!=null)){Diag.a.a(593282249,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");return}i={};i.Id=t.domainId;i.StringId=t.stringId;this.r.x(i)},bc:function(n){var t=new _Ewa.L(-859308420,_Ewa.K.a,this.a.p(),9,null),i={CommandValueId:"HelpID="+n,InputMethod:_Ewa.K.a,ShouldCanvasTakeFocus:!0,MenuItemId:"HelpArticle"};this.a.i().a(t,i,null)},bd:function(n){Fdbk.a.l(new _Ewa.IA(n))},H:function(n,t){var i=this.v();if(i){var r=this,u=function(u,f,e){return _Ewa.dw.k(r.a.c().a(),i,n,t,_Ewa.n.a(u,r.y),f,e,null,null)},f=this;_Ewa.H.a(this.a.f(),u,function(n){return new _Ewa.v(259,0,n,1,null)},null);return}},Q:function(){(this.e||this.c)&&this.l!==2&&(this.i||this.t(!1))},X:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},t:function(n){this.L(n)},J:function(){var n;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.ba(),n){var t=this,i=function(i,r,u){return _Ewa.dw.a(t.a.c().a(),n,!0,t.h,!1,null,_Ewa.n.a(i,t.x),r,u,1,null)},r=this;_Ewa.H.a(this.a.f(),i,function(n){return new _Ewa.v(114,0,n,16,null)},null)}},K:function(n,t){var i=this,r=function(r,u,f){return _Ewa.dw.e(i.a.c().a(),n,t,_Ewa.n.a(r,i.k),u,f,2,null)},u=this;_Ewa.H.a(this.a.f(),r,function(n){return new _Ewa.v(233,0,n,16,null)},null)},I:function(n,t){if(n){var i=this,r=function(r,u,f){return _Ewa.dw.a(i.a.c().a(),n,!1,!1,!0,t,_Ewa.n.a(r,i.k),u,f,2,null)},u=this;_Ewa.H.a(this.a.f(),r,function(n){return new _Ewa.v(257,0,n,16,null)},null)}},N:function(n){var t,i;if(_Ewa.i.c(n.Errors)){t=_Ewa.i.a(n.Errors,",");_Ewa.f.c(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(this.a.b().h(this.m),this.a.b().g(this.m),i=n.Result,this.f=i.SkydanceFeatureBitmask,this.u(i),this.j=!0)},V:function(){(this.e||this.c)&&this.t(!1)},P:function(n,t){var i,r;if(_Ewa.i.c(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.i.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.j=!1;this.D(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005633,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.i=!1;this.B(r)}return},O:function(n,t){var i,r;if(_Ewa.i.c(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.i.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.D(t);this.f=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;Diag.a.a(591005632,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane");this.i=!0;this.B(r)}return},D:function(n){if(n){var t=n;this.l=t}},B:function(n){var r,t,i;_Ewa.a.b(717)&&(r=new _Ewa.L(-90814711,_Ewa.K.a,0,10,null),this.a.i().a(r,null,null));this.c?this.g.b(n,null):(t=3,this.f!=null?t=this.f:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set"),i=this.G(n,t),i||Diag.a.a(577528395,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.n||Diag.a.a(577528394,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.g.f(this.n,i,null),this.c=!0);return},d:function(){this.c&&(Diag.a.a(591005602,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.g.d(),this.c=!1,this.l=0,this.i=!1)},S:function(n){if(_Ewa.i.c(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.i.a(n.Errors,","));this.e=!0;return}if(n.Result){var t=n.Result;this.f=t.SkydanceFeatureBitmask;this.u(t);this.j=!0}return},u:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){Diag.a.a(591005601,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane");this.d();this.a.b().h(this.m);return}r=new _Ewa.p(t,i,t,i,!0,!1);this.b.a().d(r,r,60,0,!0,"",!1,!0,!0);this.e=!0},G:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.m,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.j,i.appCorrelationId=Common.u.a().a,r=Common.e.b(Common.a.n),u=r?r.a:null,i.uiLanguage=u,i.market=this.F(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},F:function(n){var t=n.split("-");return t[t.length-1]},L:function(n){var t=this.b.a().a().a();if(!this.v()||!t){this.d();return}if(this.b.e().j(t)){if(this.s&&!n&&!this.j)return;if(this.b.m())return;n&&(this.e=!0);var r=_Ewa.h.e(t,this.a),i=this,u=function(n,t,u){return _Ewa.dw.a(i.a.c().a(),r,!1,i.h,!1,null,_Ewa.n.a(n,i.k),t,u,1,null)},f=this;_Ewa.H.a(this.a.f(),u,function(n){return new _Ewa.v(114,0,n,16,null)},null)}else this.d();return},Y:function(){var n;if(this.c){if(n=this.b.a().a().a(),!n){this.d();return}var i=_Ewa.h.e(n,this.a),t=this,r=function(n,r,u){return _Ewa.dw.a(t.a.c().a(),i,!1,t.h,!1,null,_Ewa.n.a(n,t.k),r,u,1,null)},u=this;_Ewa.H.a(this.a.f(),r,function(n){return new _Ewa.v(114,0,n,16,null)},null)}},W:function(n){if(_Ewa.i.c(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.i.a(n.Errors,",")),n.Result){var t=n.Result;this.u(t);this.j=!0}else this.d();return},U:function(n){if(_Ewa.i.c(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.i.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.g.b(t,null)}else Diag.a.a(591005598,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.d();return},R:function(n){if(_Ewa.i.c(n.Errors)){Diag.a.a(539358111,0,15,"Failed to insert starter data table. Error id names: {0}",_Ewa.i.a(n.Errors,","));return}this.d();return},v:function(){var n=this.b.a().a();return n.k()?_Ewa.h.c(n.a(),this.a):null},ba:function(){var n=this.b.a().a();return n.k()?_Ewa.h.e(n.a(),this.a):null}};_Ewa.hQ=function(n,t,i,r,u,f,e){this.cJ=Function.createDelegate(this,this.dH);this.cI=Function.createDelegate(this,this.dG);this.cK=Function.createDelegate(this,this.dI);this.cQ=Function.createDelegate(this,this.dQ);this.cR=Function.createDelegate(this,this.dR);this.cO=Function.createDelegate(this,this.dO);this.cP=Function.createDelegate(this,this.dP);this.cE=Function.createDelegate(this,this.dA);this.cF=Function.createDelegate(this,this.dB);this.bO=Function.createDelegate(this,this.dl);this.cN=Function.createDelegate(this,this.dN);this.cg=Function.createDelegate(this,this.dz);this.ci=Function.createDelegate(this,this.dK);this.cj=Function.createDelegate(this,this.dL);this.cS=Function.createDelegate(this,this.dT);this.cG=Function.createDelegate(this,this.dE);this.cL=Function.createDelegate(this,this.dJ);this.cH=Function.createDelegate(this,this.dF);this.cM=Function.createDelegate(this,this.dM);this.ck=Function.createDelegate(this,this.dS);this.ch=Function.createDelegate(this,this.dC);this.bP=Function.createDelegate(this,this.dD);this.cl=Function.createDelegate(this,this.dU);this.cm=Function.createDelegate(this,this.dV);this.Z=new Array(12);this.s=this.O;this.R=this.b;_Ewa.hQ.initializeBase(this,[!1]);this.V=n;this.bk=f;this.cz=i;this.by=e;this.bh=[];this.X=[];this.ba=_Ewa.c.a(this.V);this.bA=-1;this.bu=_Ewa.a.b(135);this.bg=_Ewa.a.b(475);this.cv=_Ewa.a.a("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.bm=this.V.L(472)&&this.V.L(301);this.bo=this.V.L(740);this.bv=_Ewa.a.c("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.bw=this.V.L(739)&&this.bg;this.bJ=this.bw&&_Ewa.a.c("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);this.bV=_Ewa.a.c("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.bi=_Ewa.a.c("Microsoft.Office.Excel.CheckExtraPowerBILicenses",!1);this.bY=_Ewa.a.a("OfficeVSO:5654328_RetryLetyAutoRefreshOnLoadIfHandshakeNotInitialized");this.Y=new($$sc.w.$$(_Ewa.Ed));this.bx=new _Ewa.Ix(n,t,this);r&&(this.W=new _Ewa.Iw(n,r,u,this,this));_Ewa.a.c("Microsoft.Office.Excel.LinkedEntityReduceGallerySize",!1)&&(this.Z=new Array(5));this.bu?(this.V.B(this.cm),_Ewa.bF.a(this.V)&&_Ewa.bF.a(this.V).v(this),this.cU()):n.a().b(_Ewa.dN,271,this);(this.bv||this.bm||this.bo)&&this.V.b().q(this.cl);_Ewa.a.b(133)&&_Ewa.a.b(142)&&(this.dh()||this.ba.C(this.bP));this.bg&&this.V.Q(this.ch);_Ewa.a.b(717)&&(_Ewa.a.a("OfficeVSO:5136181_ActiveSessionImageBusBar")&&this.V.b().g(this.ck),this.P());this.bJ&&(this.cd=new _Ewa.IB(this.V,this))};_Ewa.hQ.b=function(n,t,i,r,u){var f=u?'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel-70" align="middle">{0}<\/p><\/div>':'<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',e=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,t,r),o=String.format(f,i);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',e,o)};_Ewa.hQ.a=function(n){return n.StringId?n.Id.toString()+"."+n.StringId:n.Id.toString()};_Ewa.hQ.prototype={V:null,bk:null,bx:null,cz:null,by:null,bu:!1,bg:!1,cv:!1,bm:!1,bv:!1,bw:!1,bJ:!1,bo:!1,bV:!1,bi:!1,bY:!1,bz:!1,bD:!1,bT:null,bn:null,bW:null,bX:null,bb:null,bI:null,bK:null,bZ:null,cf:null,bt:0,bC:0,bB:0,bf:null,X:null,bU:!1,cd:null,bh:null,W:null,bS:null,bc:0,ba:null,be:null,bA:0,bl:8,bp:!1,cu:!1,cw:!1,bR:!1,bq:null,br:null,Y:null,bj:null,bQ:0,cT:5,bE:3e4,bN:!1,bd:null,bF:null,ce:!1,cB:!1,ca:0,cy:0,cr:!1,dS:function(n,t){t.d&&!t.b&&this.P()},dispose:function(){if((this.bv||this.bm||this.bo)&&this.V.b().s(this.cl),_Ewa.a.b(717)&&_Ewa.a.a("OfficeVSO:5136181_ActiveSessionImageBusBar")&&this.V.b().h(this.ck),!this.bd&&_Ewa.a.b(133)&&_Ewa.a.b(142)&&this.ba.I(this.bP),this.W&&this.W.dispose(),this.bg&&this.V.S(this.ch),this.bu&&(this.V.C(this.cm),this.bm&&(this.bT=null)),this.cf){var n=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.e("ExcelWolframAlpha",n.cf)})}this.by=null;System.a.a(this.bj)},u:function(n){this.es("LinkedEntityConverted",n)},M:function(n){this.eu("LinkedEntityConverted",n)},S:function(){return 5},a:function(){return this.X},U:function(n){return this.X=n,n},r:function(n){return this.W?this.W.bb(n):!1},o:function(n,t){this.W&&this.W.C(n,t,!1,0,null)},p:function(n,t,i,r){this.W&&this.W.C(n,t,!0,i,r)},m:function(n){return this.W?this.W.M(n):!1},n:function(){this.W&&this.W.T()},k:function(){this.W&&this.W.E()},q:function(n){this.W&&this.W.Z(n)},O:function(n){this.W&&this.W.bc(n)},t:function(n){this.W&&this.W.bd(n)},l:function(n,t){this.W&&this.W.H(n,t)},du:function(n){this.V.j()&&this.cy!==n&&Common.a.a.a("SupportsPolicies")&&(this.cy=n,Diag.a.a(561628898,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),_Ewa.dw.j(this.V.c().a(),this.cM,null,null,null,null))},dM:function(n){var t,i,r;if(!n.Result){Diag.a.a(561628896,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result");return}(t=n.Result,t&&t.length)&&(Diag.a.a(561628895,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",t.length),i=_Ewa.l.a(_Ewa.gR,this.V.a(),274,275,0,null),r=this,_Ewa.g.a(i,function(){var n=i.a().b(t,2);if(!n){Diag.a.a(559941251,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.");return}},this.V.g(),3,null,null))},dU:function(){var n,t;this.bv&&(this.ed(),n=this.V.b().m().LinkedEntityAsyncRefreshStateId,this.dt(n));this.bo?(t=this.V.b().m().RichDataClassificationLabelStateId,this.du(t)):this.bm&&this.cA(!0)},A:function(){var n=this,t=function(t,i,r){return _Ewa.dw.l(n.V.c().a(),_Ewa.n.a(t,n.cH),i,r,null,null)};_Ewa.a.d()?this.V.f().a(new _Ewa.v(589,0,t,80,null),null):this.V.f().a(new _Ewa.ba(589,0,t,16,null),null)},dF:function(){this.ce=!0;this.W&&this.W.Y()},P:function(){this.ce||this.cB||_Ewa.a.a("OfficeVSO:5136181_ActiveSessionImageBusBar")&&!this.V.b().a()||this.dX()},dX:function(){var n=this,t=function(t,i,r){return _Ewa.dw.g(n.V.c().a(),_Ewa.n.a(t,n.cL),i,r,null,null)};_Ewa.a.d()?this.V.f().a(new _Ewa.v(588,0,t,80,null),null):this.V.f().a(new _Ewa.ba(588,0,t,16,null),null)},dJ:function(n){if(n&&!_Ewa.O.a(n))try{var t=n.Result.HasUntrustedImageUrl;t&&(this.bk.a(54,null,null,null),this.cB=!0)}catch(i){Diag.a.a(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",i)}},cA:function(n){var i,t,r;this.bm&&this.bT==null&&!this.bo&&Common.a.a.a("SupportsPolicies")&&(i=this.bn==null?!1:this.bn,i)&&(!n||this.V.k().Options&262144)&&(t=_Ewa.l.a(_Ewa.gR,this.V.a(),274,275,0,null),r=this,_Ewa.g.a(t,function(){r.bT=t.a().j(2)},this.V.g(),3,null,null))},cn:null,B:function(){return this.cn},bs:!1,e:function(){return this.bs},y:function(n){var t=this.dp(n);if(!t){Diag.a.a(593241931,0,10,"Could not convert key into domain ID");return}this.x(t)},x:function(n){var h,r,u,i,c,f,e,t;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n.Id),!this.ba){Diag.a.b(34415005,0,!1,"grid view should not be null");return}var o=this.ba.a().a().c(),l=this.ba.R(),s=o.l(l);if(this.bw&&this.bU&&this.dj(n),s){if(h=this.ba.e().p(s),!this.cZ(n)&&n.Id===268435968){if(Diag.a.a(588001754,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data"),_Ewa.Q.a().h()){if(r=this.cs(),!r){Diag.a.a(588001753,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(u=this.bG(),!u){Diag.a.a(588001752,0,50,"RibbonCommandInfo is null for blankCellConvert");return}i={InputMethod:_Ewa.K.a};i.CalloutName=3;i.Target=r;i.RibbonButtonLabel=_Ewa.a.a("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.de(n):this.g(n.Id.toString());i.ExampleEntities=this.cX(n);this.V.i().a(u,i,null);return}Diag.a.a(588001751,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(n.Id===268435968&&!n.StringId){this.I(_Ewa.hQ.a(n));return}if(h){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.a.c("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.ec(n)){c=_Ewa.h.d(this.ba.a().a().b(),this.V);this.W.I(c,n);return}if(_Ewa.Q.a().h()){if(f=this.cs(),!f){Diag.a.a(588001756,0,50,"CalloutAnchorElement is null for blankCellConvert");return}if(e=this.bG(),!e){Diag.a.a(588001755,0,50,"RibbonCommandInfo is null for blankCellConvert");return}t={InputMethod:_Ewa.K.a};t.CalloutName=2;t.Target=f;t.RibbonButtonLabel=this.de(n);t.ExampleEntities=this.cX(n);t.BlankCellResourceId=this.dk(n);t.HasBlankCellWalkthrough=this.dv(n);t.ServiceDomain=n.Id;this.V.i().a(e,t,null);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.d(n,!1,o)}},J:function(){var n,t;if(this.bs){if(!_Ewa.Q.a().h()){Diag.a.a(574681243,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityWolframUpsellCallout() - Attempted to launch wolfram upsell callout but callout not enabled");return}if(_Ewa.a.c("Microsoft.Office.Excel.FloodgateWolframUpsellCalloutIsEnabled",!0)){Diag.a.a(558404183,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityWolframUpsellCallout() - Triggering Floodgate wolfram upsell callout");this.dy();return}Diag.a.a(545894727,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityWolframUpsellCallout() - Launching upsell callout");n={InputMethod:_Ewa.K.a};n.CalloutName=4;n.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";t=this.bG();this.V.i().a(t,n,null);return}},dz:function(){var t,n;if(!this.cw&&this.bH()&&!this.ct()){if(Common.A.a("DataTabActive",!0,0,null),!_Ewa.Q.a().h()){Diag.a.a(558690320,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled");return}if(!document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){Diag.a.a(558690319,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");return}if(t=this.bG(),!t){Diag.a.a(558690318,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout");return}n={};n.InputMethod=_Ewa.K.a;n.CalloutName=9;n.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.V.i().a(t,n,null);this.cw=!0}},z:function(){this.bd&&this.bd.A()},K:function(){var t=this,n=function(n,i,r){return _Ewa.dw.p(t.V.c().a(),n,i,r,null,null)},i,r;_Ewa.a.d()?(i=this,_Ewa.H.a(this.V.f(),n,function(n){return new _Ewa.v(230,0,n,80,null)},null)):(r=this,_Ewa.H.a(this.V.f(),n,function(n){return new _Ewa.ba(230,0,n,16,null)},null))},d:function(n,t,i){var u=_Ewa.h.e(i,this.V),r=this,f=function(i,f,e){return _Ewa.dw.d(r.V.c().a(),u,n,t,_Ewa.n.a(i,r.cG,r.cS,r.W.w),f,e,null,null)},o=this,e=function(){return new _Ewa.fP},s=this;_Ewa.H.a(this.V.f(),f,function(n){return new _Ewa.v(115,0,n,0,e)},null)},dj:function(n){var t,r,i;if(this.bw&&this.bU&&(t={},t.Id=n.Id,n.StringId&&(t.StringId=n.StringId),!(this.X.length>0)||this.X[0].Id!==t.Id||this.X[0].StringId!==t.StringId)){for(r=!1,Array.insert(this.X,0,t),i=1;i<this.X.length;++i)if(this.X[i].Id===t.Id&&this.X[i].StringId===t.StringId){Array.removeAt(this.X,i);r=!0;break}while(this.X.length>5)Array.removeAt(this.X,this.X.length-1);this.bf.Categories[0].DomainIds=this.X;this.T();this.bJ&&!r&&this.cd.h(this.X)}},dE:function(n){_Ewa.i.c(n.Errors)||(this.bo||this.cA(!1),this.er("LinkedEntityConverted",null,null))},dT:function(){var n=this;this.V.a().c(_Ewa.cC,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1716))},null)},w:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),!this.ba){Diag.a.b(34719502,0,!1,"grid view should not be null");return}var n=_Ewa.h.e(this.ba.a().a().c(),this.V),t=this,i=function(i,r,u){return _Ewa.dw.c(t.V.c().a(),n,i,r,u,null,null)},r=this;_Ewa.H.a(this.V.f(),i,function(n){return new _Ewa.v(116,0,n,0,null)},null)},i:function(){var n;if(Diag.a.a(572555984,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted"),n=_Ewa.c.a(this.V),!n){Diag.a.b(572555983,0,!1,"grid view should not be null");return}this.V.j()||Diag.a.a(572555982,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.cx();var t=_Ewa.h.d(this.ba.a().a().b(),this.V),i=this,r=function(n,r,u){return _Ewa.dw.q(i.V.c().a(),t,n,r,u,null,null)},u=this;_Ewa.H.a(this.V.f(),r,function(n){return new _Ewa.v(248,0,n,0,null)},null)},eb:function(){return this.df(this.bq)},ea:function(){return this.df(this.br)},df:function(n){try{if(this.bc===2&&n){var t=this.cp(parseInt(n));return!t||!t.ShowInRibbon}}catch(i){Diag.a.a(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+n)}return!0},N:function(n){var t=this.b(n.DomainId),i,r;if(!t||t.DomainBlocked||_Ewa.a.a("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!t.HasCuratedData)return!1;if(this.cv){for(i=this.Y.$$ge();i.$$mn();)if(r=i.$$cu(),r.a.DomainId.Id===t.DomainId.Id&&r.a.ShowInRibbon)return!0;return!1}return t.ShowInRibbon},dY:function(n){return this.bc!==2||!this.Z[n]},dZ:function(){var n,t,i;if(this.bg)return Diag.a.a(592213150,0,10,"Unexpectedly calling ShouldHideFlyout for new gallery design"),!1;if(!this.Y)return!0;if(this.bF!=null)return this.bF;for(n=0,t=this.Y.$$ge();t.$$mn();)i=t.$$cu(),i.a.DomainBlocked||++n;return this.bF=n<=2,this.bF},H:function(){this.W&&this.W.J()},L:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.bS=i.MenuId,!this.bc||this.bc===3)return this.dW(),!0;if(this.bg)if(this.bf){if(this.Y)return this.be=this.be||this.bx.c(this.bf,i.MenuId),i.MenuItems=this.be,this.bU=!0,!0;Diag.a.a(593264904,0,10,"PopulateMenu: Encountered null domain collection")}else Diag.a.a(593264905,0,10,"PopulateMenu: Encountered null ribbon section info");return this.be=this.be||this.bx.b(this.bh,i.MenuId),i.MenuItems=this.be,!0},dW:function(){if(this.bA===-1){this.h();var n=this;this.bA=window.setInterval(function(){n.h()},2e3)}},h:function(){if(this.V.b().a()&&this.bc!==2){this.bl--;Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.bc=1;this.bg?_Ewa.dw.h(this.V.c().a(),this.cj,this.ci,null,null,null):_Ewa.dw.i(this.V.c().a(),this.cj,this.ci,null,null,null);return}},ct:function(){return this.V.j()&&this.bc!==2&&(this.bl>=0||!this.bp)},cD:function(n){if(Common.a.g){Diag.a.a(587530655,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down.");return}if(!_Ewa.bF.a(this.V)){Diag.a.a(587530654,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.");return}this.cC();n&&this.V.t()},cc:function(n){this.bC=0;this.bB=0;this.bl=8;this.bp=!1;this.bA=0;this.bc=0;this.bf=null;this.bh=null;this.be=null;for(var t=0;t<this.Z.length;++t)this.Z[t]=null;n&&_Ewa.s.h(this.V)&&this.bH()&&this.cD(!0)},dV:function(n,t){if(Diag.a.a(575948507,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called"),t.a){Diag.a.a(575948506,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content");return}this.V.j()?this.cU():this.cc(!0);_Ewa.a.b(717)&&this.ce&&this.A()},bH:function(){var n=_Ewa.bF.a(this.V);return!!n&&n.a().a()==="Data"},dL:function(n){var h,f,c,i,r,u,e,l,a,t,s;if(this.be=null,n.Result){if(this.bg?(r=n.Result,i=r.DomainDataArray,this.bf=r.Ribbon,this.bw&&this.bf&&(u={},u.Name=_Ewa.ClientStringManager.a().a(1706),u.DomainIds=this.X,Array.insert(this.bf.Categories,0,u)),r.MaximumCellsToConvert>0&&(this.cn=r.MaximumCellsToConvert)):i=n.Result,this.bc=2,e=!1,i){Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",i.length);this.bh||(this.bh=[]);l=_Ewa.ClientStringManager.a().a(1703);a=_Ewa.ClientStringManager.a().a(1705);for(var v=i,y=v.length,o=0;o<y;++o){if(t=v[o],!t.DomainId){Diag.a.a(593291469,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.");continue}if(this.bh.push(t),t.DomainBlocked){s=!!t.DomainId.StringId;Diag.a.a(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",s?t.DomainId.Id.toString():t.Name,s);continue}this.Y.b(_Ewa.hQ.a(t.DomainId),t);t.Name===l||t.DomainId.Id===268435456?this.bq=t.DomainId.Id.toString():t.Name===a||t.DomainId.Id===536870912?this.br=t.DomainId.Id.toString():t.DomainId.Id===268435712&&t.ShowInRibbon&&(this.bR=!0);e=!0}}e||(this.bh=null);this.di();this.bJ&&this.cd.i();this.bY&&(this.bN||(this.dg(),this.bN=!0))}else this.bh=null,this.bc=3,h=this.bu?-1:0,this.bl>h&&(f=0,this.bu&&(f=100*(8-this.bl)),c=this,window.setTimeout(function(){c.h()},f)),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.cb();this.cV();this.bR&&this.bV&&_Ewa.gu.a(this.cg,this.V.g(),500);this.bY||this.bN||(this.dg(),this.bN=!0);this.bm&&!this.bo&&this.cA(!0)},dK:function(n){var t=_Ewa.X.a(n.b);Diag.a.a(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",_Ewa.i.a(t,","));this.bh=null;this.bc=3;this.bu&&(this.bp=!0);this.cb()},di:function(){var n,k,h,r,it,p,u,f,e,i;if(this.bf){if(n=0,this.bw){for(var t=-1,c=-1,l=0,a=0,g=0,v=0,nt=[null,null,null,null,null],tt=this.bf.Categories,et=tt.length,y=0;y<et;++y){it=tt[y];p=!1;for(var rt=it.DomainIds,ot=rt.length,w=0;w<ot;++w)u=rt[w],f=this.b(u),f&&!f.DomainBlocked&&f.ShowInRibbon&&(n<this.Z.length?(this.Z[n]=u,a||(t===-1&&(t=n),c=n,v=c-t+1),++n):n===this.Z.length&&l<v&&a&&(nt[l]=u,++l),p=!0);p&&++g;++a}if(t>-1&&g<=2){for(e=c;e>=t;--e)Array.removeAt(this.Z,e);for(i=0;i<v;++i)Array.insert(this.Z,n+i,nt[i])}}else for(var b=this.bf.Categories,ut=b.length,o=0;o<ut;++o){k=b[o];for(var d=k.DomainIds,ft=d.length,s=0;s<ft;++s)if(h=d[s],r=this.b(h),r&&!r.DomainBlocked&&r.ShowInRibbon&&(this.Z[n]=h,++n,n>=this.Z.length))break;if(n>=this.Z.length)break}while(n<this.Z.length)this.Z[n]=null,++n}},dD:function(){this.dh()&&this.ba.I(this.bP)},dh:function(){var n=$$as(_Ewa.gh,_Ewa.c.a(this.V).b()),i=!!n&&n.K(),r=this.ba.a().c(),t;return i&&r===1&&this.ba.a().a().a()?(t=_Ewa.l.b(_Ewa.df,this.V.a(),12,this.V.g(),1,null),this.bd=new _Ewa.uK(this.V,this.cz,t.a(),this),!0):!1},G:function(n){this.W&&this.W.t(n)},I:function(n){var t,i;if(this.W){if(t=this.cq(n),!t){Diag.a.a(593097799,0,10,"Unknown domain used when launching Data Type Selector pane");return}if(t.DomainId.StringId){Diag.a.a(593097798,0,10,"Domain with a string ID used when launching Data Type Selector pane");return}i=_Ewa.h.d(this.ba.a().a().b(),this.V);this.W.K(i,t.DomainId.Id)}},dn:function(){return this.co(this.bq)},dm:function(){return this.co(this.br)},co:function(n){var t=this.dx(n),i=Common.d.b(this.g(n)),r=Common.d.b(this.j(n));return _Ewa.hQ.b(t,_Ewa.x.a(11),i,r,!1)},j:function(n){try{return this.cp(parseInt(n)).Description}catch(t){}return _Ewa.ClientStringManager.a().a(1700)},g:function(n){try{return this.cp(parseInt(n)).Name}catch(t){}return _Ewa.ClientStringManager.a().a(1686)},de:function(n){try{return this.b(n).Name}catch(t){}return this.g(n.Id.toString())},dk:function(n){try{return this.b(n).BlankCellResourceId}catch(t){}return null},dv:function(n){try{return this.b(n).HasBlankCellWalkthrough}catch(t){}return!1},cZ:function(n){try{var t=_Ewa.hQ.a(n);return this.Y.c(t)?this.Y.a(t).HasCuratedData:!1}catch(i){}return!1},ec:function(n){try{return this.b(n).SupportsStarterData}catch(t){}return!1},cs:function(){return _Ewa.bF.a(this.V).d()===2?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"},bG:function(){return new _Ewa.L(-847286761,_Ewa.K.a,this.V.p(),0,"Help")},cV:function(){var t,i,r,n;if(this.bH()&&!this.ct()&&!this.cu&&_Ewa.a.b(472)&&(t={},t.Id=268435968,t.StringId=null,this.cZ(t)))if(Diag.a.a(574997530,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),_Ewa.Q.a().h()){if(i=this.cs(),!i){Diag.a.a(574997529,0,10,"CalloutAnchorElement is null for firstOrgData");return}if(r=this.bG(),!r){Diag.a.a(574997528,0,10,"RibbonCommandInfo is null for firstOrgData");return}n={InputMethod:_Ewa.K.a};n.CalloutName=7;n.Target=i;n.ShouldCanvasTakeFocus=!0;this.V.i().a(r,n,null);this.cu=!0}else Diag.a.a(574997527,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")},D:function(n){var t=this.cq(n);return t?this.bx.a(t.SubdomainFontLocator):(Diag.a.a(576057797,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)},F:function(n){return this.bd?this.bd.M(n,!1):!1},C:function(){return this.bd?this.bd.O():""},E:function(){return this.bd?this.bd.C():!1},dr:function(n,t){var u=this.da(n),r,i;if(u<0){Diag.a.a(592843911,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",n);return}(r=this.cW(n),i=r?this.b(r):null,i)&&(t[CommandUI.Controls.a.GalleryButtonProps]=this.bx.d(u,i),t.Alt=this.bx.e(i))},T:function(){this.di();_Ewa.s.h(this.V)&&this.bH()&&this.cD(!0);this.be=null},dx:function(n){return n===this.bq?"ewadata_StockLinkedEntity32":n===this.br?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},cX:function(n){try{return this.b(n).ExampleEntities}catch(t){}return _Ewa.ClientStringManager.a().a(1708)},cb:function(){(this.bl<0||this.bp)&&Diag.a.a(37089859,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(this.bc===2||this.bl<0||this.bp)&&window.clearInterval(this.bA);_Ewa.s.h(this.V)&&!this.ct()?this.cD(this.bH()):this.bS&&this.V.r().p(this.bS)},cC:function(){var n,i,f;if(this.bg){var r=!0,t=new Array(this.Z.length),u=_Ewa.bF.a(this.V)?_Ewa.bF.a(this.V).a():null;if(!u){Diag.a.a(587530653,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null");return}for(n=0;n<t.length;++n)this.dY(n)?t[n]=!0:(t[n]=!1,r=!1);if(u.d(["ConvertToLinkedEntityGallery"],r),!r)for(i=0;i<t.length;++i)t[i]&&(f=this.dq(i),u.d([f],!0))}else{var e=this.eb(),o=this.ea(),s=e&&o;if(this.bz||this.bD||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToLinkedEntityGallery",s?!0:!1)),s){this.bD=!0;this.bz=!0;return}e?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToStockLinkedEntity",!0)),this.bD=!0):o&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ConvertToGeographyLinkedEntity",!0)),this.bz=!0);this.dZ()&&_Ewa.j.H("ConvertToLinkedEntityGallery-previewExpandButton")}},b:function(n){var t=_Ewa.hQ.a(n);return this.Y.c(t)?this.Y.a(t):(Diag.a.a(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",n.Id,!!n.StringId),null)},dq:function(n){return"ConvertToLinkedEntityPreview"+n.toString()},Q:function(){var n=this,t;(Common.App.AppLifecycleManager.get_instance().a(10,function(){n.cV();n.bR&&n.bV&&_Ewa.gu.a(n.cg,n.V.g(),500)},3),_Ewa.s.h(this.V))||(t=this,Common.App.AppLifecycleManager.get_instance().a(10,function(){t.cC()},3))},f:function(n,t){var f;switch(n){case"QueryLinkedEntityGalleryButtons":if(!t.val[CommandUI.Controls.a.InnerHTML]){_Ewa.s.h(this.V)||this.cC();var i=t.val.MenuItemId.toString(),r=_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1703),!0)||_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1704),!0),u=_Ewa.f.b(i,_Ewa.ClientStringManager.a().a(1705),!0);_Ewa.a.b(475)?r||u||this.dr(i,t.val):!this.bD&&r?(this.bD=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.dn()):!this.bz&&u&&(this.bz=!0,t.val[CommandUI.Controls.a.InnerHTML]=this.dm())}break;case"QueryLinkedEntityMenuGalleryButtons":t.val[CommandUI.Controls.a.InnerHTML]||(f=t.val.MenuItemId,t.val[CommandUI.Controls.a.InnerHTML]=this.co(f))}},c:function(){_Ewa.a.c("Microsoft.Office.Excel.WolframAddin",!1)&&(this.bI||!1)&&(this.bb==null||this.bb||(Diag.a.a(541882391,0,50,"AfterWolframAddinInstalled: User is entitled to the Wolfram add-in (by licensing) and has just installed it. Wolfram domains enabled and handshake refresh being done."),this.bb=!0,this.bs=!1,this.cc(!1),this.bL(),this.V.O()))},v:function(){_Ewa.a.c("Microsoft.Office.Excel.WolframAddin",!1)&&(this.bI||!1)&&(this.bb=!1,this.cc(!1),this.bL(),this.V.O())},dp:function(n){var t,i,r;return _Ewa.a.b(475)&&(t=this.cW(n),t)?t:(i=this.cq(n),i)?i.DomainId:_Ewa.a.b(475)?(Diag.a.a(592843910,0,10,"Could not convert key into domain: {0}",n),null):(r=this.ds(n),!r)?(Diag.a.a(593241929,0,10,"Could not convert key into domain using fallback logic, Key: {0}",n),null):(t={},t.Id=r,t.StringId=null,t)},ds:function(n){var t=parseInt(n),i,r;return t>0?t:(Diag.a.a(593241928,0,50,"Checking for specific domains, Key: {0}",n),i=_Ewa.ClientStringManager.a().a(1704),r=_Ewa.ClientStringManager.a().a(1705),n===this.br||n===this.bq)?parseInt(n):this.dc(n,i,"Stock")?parseInt(this.bq):this.dc(n,r,"Geography")?parseInt(this.br):t},cp:function(n){var t={};return t.Id=n,this.b(t)},cq:function(n){return this.Y.c(n)?this.Y.a(n):null},da:function(n){if(!n.startsWith("PreviewGalleryButtonIndex."))return-1;var t=parseInt(n.substr(26));return isNaN(t)?(Diag.a.a(592843909,0,10,"Unexpected index in preview gallery button key: {0}",n),-1):t},cW:function(n){var t=this.da(n);return t<0?null:this.Z[t]},dC:function(){this.be=null},db:function(n,t,i){if(this.bv&&this.Y&&this.Y.d){Diag.a.a(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",n);var r=this.V.c().a().b(!1);this.V.b().a()&&_Ewa.dw.n(this.V.c().a(),_Ewa.n.a(this.cN,t),i,null,null,r)}},dN:function(n){var t,r,i;if(_Ewa.O.a(n)){t=_Ewa.l.a(_Ewa.cR,this.V.a(),5,4,0,null);r=this;_Ewa.g.a(t,function(){var i=null;n&&n.Errors&&(i=n.Errors[0]);t.a().g(i,null)},this.V.g(),3,null,null);Diag.a.a(591147843,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.i.a(n.Errors,","));i=_Ewa.i.f(n.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.V.b().o(i);return}},dg:function(){this.db("Auto-refresh on load",null,null)},ed:function(){if(this.bv&&this.Y&&this.Y.d){if(this.bj){Diag.a.a(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one");return}var n=this.V.b().m().HasAutoRefreshableLinkedEntityDomainsEver;if(!n){Diag.a.a(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created");return}Diag.a.a(51659663,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context");this.bj=_Ewa.B.a().a(this.bO,this.bE,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}},dl:function(){Diag.a.a(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.bE);this.db("Periodic auto-refresh check",this.cF,this.cE)},dB:function(n){if(_Ewa.O.a(n)?(Diag.a.a(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.i.a(n.Errors,",")),++this.bQ):this.bQ=0,System.a.a(this.bj),this.bQ>=this.cT){Diag.a.a(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh");this.bj=null;return}Diag.a.a(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext");this.bj=_Ewa.B.a().a(this.bO,this.bE,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},dA:function(n){var t=_Ewa.X.a(n.b);!t||!t.length?Diag.a.a(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):Diag.a.a(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",_Ewa.i.a(t,","));System.a.a(this.bj);this.bj=_Ewa.B.a().a(this.bO,this.bE,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},dc:function(n,t,i){return _Ewa.f.c(n,t,!0)||_Ewa.f.c(n,i,!0)},dP:function(n){var t=!!n.Result&&n.Result,i;Diag.a.a(591958236,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",t.toString());t?(i=_Ewa.q.a().b().m-this.bt,Diag.a.a(589947468,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",i,this.bC),this.h()):this.bM()},dO:function(){Diag.a.a(591958235,0,15,"OnNotifyFeatureLicensingStatusFailed");this.bM()},bM:function(){var n,t;this.bi&&(this.bW==null||this.bX==null)||this.V.b().a()&&this.bn!=null&&this.bb!=null&&this.bK!=null&&(++this.bC,this.bC<=12?(this.bC===1&&(this.bt=_Ewa.q.a().b().m,Diag.a.a(589947467,0,50,"StartLinkedEntityDelayedHandshake - starting handshake.")),n=this.V.c().a().b(!1),_Ewa.k.Y(this.V.c().a(),this.cY(),this.dd(),this.cP,this.cO,null,n)):(t=_Ewa.q.a().b().m-this.bt,Diag.a.a(591958231,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",t),this.bp=!0,this.cb()))},cU:function(){if(this.V.j()){if(this.bn!=null){this.bM();return}var t=_Ewa.q.a().b().m,n=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(i){i.a("ExcelPowerBiPro",!1).then(function(i){var r=_Ewa.q.a().b().m;return Diag.a.a(590747350,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",r-t),Diag.a.a(590747349,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",i),n.bn=i,i}).then(function(){_Ewa.a.c("Microsoft.Office.Excel.WolframAddin",!1)&&i.a("ExcelWolframAddin",!1).then(function(i){var r=_Ewa.q.a().b().m;return Diag.a.a(555053456,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAddin",r-t),Diag.a.a(555053455,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAddin",i),n.bI=i,i})}).then(function(){i.a("ExcelWolframAlpha",!1).then(function(r){var f=_Ewa.q.a().b().m,u;return Diag.a.a(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",f-t),Diag.a.a(590960587,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",r),n.bb=r,u=n.bI||!1,!n.bb&&u&&_Ewa.a.c("Microsoft.Office.Excel.WolframAddin",!1)&&n.dw()&&(Diag.a.a(541882390,0,50,"CheckE5LicensingAndStartDelayedHandshake: User is entitled to the Wolfram add-in (has it installed), and is eligible to use it to get Wolfram domains (by licensing). Wolfram domains enabled."),n.bb=!0,r=!0),!n.bb&&i.b()&&(n.bs=!0),n.bs&&(n.cf=i.c("ExcelWolframAlpha",function(t){Diag.a.a(570769950,0,50,"Wolfram upsell callback - upsell completed and handshake refresh started");var i=t.isEnabled;n.bb=i;n.bs=!i;n.cc(!1);n.bL();n.V.O()})),r})}).then(function(){i.a("ExcelDisableStockGeographyDataTypes",!1).then(function(i){var f=_Ewa.q.a().b().m,r,u;return Diag.a.a(541331849,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",f-t),Diag.a.a(541331848,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",i),u=[(r=new Otel.a,r.name="IsRestrictedByLicense",r.bool=i,r)],Common.A.a("SatoriStockGeographyLicensingRestrictions",!0,0,u),n.bZ=i&&_Ewa.a.c("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1),i})}).then(function(){i.a("StockHistory",!1).then(function(i){var r=_Ewa.q.a().b().m;return Diag.a.a(579081472,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",r-t),Diag.a.a(579081443,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",i),n.bK=i,n.bi||n.bM(),i})}).then(function(){n.bi&&i.a("ExcelPowerBiFree",!1).then(function(i){var r=_Ewa.q.a().b().m;return Diag.a.a(558903365,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",r-t),Diag.a.a(558903364,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",i),n.bW=i,i})}).then(function(){n.bi&&i.a("ExcelPowerBiPremiumPerUser",!1).then(function(i){var r=_Ewa.q.a().b().m;return Diag.a.a(558903363,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",r-t),Diag.a.a(558903362,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",i),n.bX=i,i})}).then(function(){n.bi&&n.bM()})})}},dR:function(n){var t=!!n.Result&&n.Result,i;Diag.a.a(570769949,0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",t.toString());t?(i=_Ewa.q.a().b().m-this.bt,Diag.a.a(570769948,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",i,this.bB),this.h()):this.bL()},dQ:function(){Diag.a.a(570769947,0,15,"OnRefreshHandshakeFailed");this.bL()},bL:function(){if(++this.bB,this.bB<=12)this.bB===1&&(this.bt=_Ewa.q.a().b().m,Diag.a.a(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh.")),_Ewa.dw.r(this.V.c().a(),this.cY(),this.dd(),this.cR,this.cQ,null,null,null);else{var n=_Ewa.q.a().b().m-this.bt;Diag.a.a(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",n);this.bp=!0;this.cb()}},cY:function(){return this.bi?["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelPowerBiFree","ExcelPowerBiPremiumPerUser","ExcelDisableStockGeographyDataTypes"]:["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelDisableStockGeographyDataTypes"]},dd:function(){return this.bi?[this.bn,this.bb,this.bK,this.bW,this.bX,this.bZ]:[this.bn,this.bb,this.bK,this.bZ]},cx:function(){this.bk&&this.bk.d(53)&&this.bk.b(53)},dt:function(n){if(this.ca!==n&&this.bk){if(this.ca=n,!this.ca){this.cx();return}_Ewa.dw.f(this.V.c().a(),this.cK,null,null,null,null)}},dI:function(n){if(!n.Result){Diag.a.a(561858696,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result");return}var t=n.Result;if(!t||!t.length){Diag.a.a(561833537,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result");return}this.cx();this.bk.g(null,t)},dy:function(){var n,r,t,i;try{if(n=Common.Utils.a.a().b(Common.bn,null),!n){Diag.a.a(558404182,0,10,"ConvertToLinkedEntityManager.LaunchFloodgateWolframUpsellCallout: could not resolve ISystemInitiatedFeedback");return}r=this;n.a(function(n){n.a("WolframUpsellCalloutActivity",null,null)});!this.cr&&window.addEventListener&&(t=this.cI,window.addEventListener("WolframUpsellCalloutGoPremiumEvent",t,!0),i=this.cJ,window.addEventListener("WolframUpsellCalloutLearnMoreEvent",i,!0),this.cr=!0)}catch(u){Diag.a.a(558404181,0,10,"ConvertToLinkedEntityManager.LaunchFloodgateWolframUpsellCallout: exception {0}.",u)}},dG:function(n){var t=(n?n.detail:null)||{},i=t.id,r;Diag.a.a(558404180,0,50,"OnFloodgateWolframUpsellCalloutEvent - clicked 'Go Premium' button {0}",i);r=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(n){var i=t.experienceId||"wolframdatatypes",r=t.dimeCampaignId;n.d(i,r)})},dH:function(n){var r=(n?n.detail:null)||{},u=r.id,t,i;Diag.a.a(558404179,0,50,"OnFloodgateWolframUpsellCalloutLearnMoreEvent - clicked 'Learn More' button {0}",u);t=new _Ewa.L(-859308420,_Ewa.K.a,this.V.p(),9,null);i={CommandValueId:"HelpID=Wolfram_RibbonUpsell",InputMethod:_Ewa.K.a,ShouldCanvasTakeFocus:!0,MenuItemId:"HelpArticle"};this.V.i().a(t,i,null)},dw:function(){this.by||Diag.a.a(544018915,0,10,"ConvertToLinkedEntityManager.HasWolframAddinEntitlement: IWebExtensionService still null after waiting for initialization tasks.");var n=new Common.App.AppsForOfficeCommon.g(Common.Utils.c.a());return(this.by?this.by.a().isAddinActivated("WA200002680")||this.by.a().isAddinActivated("a048b5e5-dc67-4812-b114-0969772a09ec"):!1)||n.b("a048b5e5-dc67-4812-b114-0969772a09ec")||n.a("WA200002680")}};_Ewa.wb=function(n){_Ewa.wb.initializeBase(this);this.h=n;this.l()};_Ewa.wb.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.dN),272,new _Ewa.wb(n))};_Ewa.wb.prototype={h:null,a:function(){var n=_Ewa.l.b(_Ewa.dJ,this.h.a(),102,this.h.g(),this.j,null),t=_Ewa.l.a(_Ewa.cR,this.h.a(),5,4,this.j,null),i=_Ewa.l.a(_Ewa.gV,this.h.a(),388,387,this.j,null),r=_Ewa.l.a(_Ewa.bQ,this.h.a(),35,106,this.j,null),u;if(this.h.z())u=this,_Ewa.g.a(_Ewa.g.b([n,t,i,r],this.i(),3),function(){u.k(u.h.a().a(_Ewa.dN,271,!1,null)||new _Ewa.hQ(u.h,n.a(),i.a(),null,null,t.a(),r.a()))},this.h.g(),3,null,null);else{var e=_Ewa.l.a(_Ewa.rN,this.h.a(),257,258,this.j,null),o=_Ewa.ct.a(this.h),f=this;_Ewa.g.a(_Ewa.g.b([n,e,o,t,i,r],this.i(),3),function(){f.k(f.h.a().a(_Ewa.dN,271,!1,null)||new _Ewa.hQ(f.h,n.a(),i.a(),e.a(),o.a(),t.a(),r.a()))},this.h.g(),3,null,null)}}};_Ewa.Ix=function(n,t,i){this.k=n;this.f=t;this.g=i;this.h=_Ewa.a.b(739)&&_Ewa.a.b(475)};_Ewa.Ix.prototype={j:2,i:"Size64by48",h:!1,f:null,g:null,k:null,b:function(n,t){var i=this.o(n,t);return i.b()},o:function(n,t){var r=this.f.c(t),u,f,i;if(n&&n.length>0){u=this.f.b();r.a().push(u);f=this.f.e("ConvertToLinkedEntitySeeMore",this.j,this.i,null);for(var o=n,h=o.length,e=0;e<h;++e)if((i=o[e],!i.DomainId.StringId)&&!i.DomainBlocked&&i.ShowInRibbon){var s=i.DomainId.Id.toString(),c=this.q(i.Name),l=i.Name;f.c(0,"Data.ConvertToLinkedEntityMenuItem_"+s,-1203788282,"QueryLinkedEntityGalleryIcon",i.Description,s,c,null,null,null)}Array.add(u.a(),f)}return r.a().length||Diag.a.a(34415008,0,15,"No domain data available"),r},c:function(n,t){var a,e,s;this.s();for(var p=this.f.c(t),i=p.b(),u=0,h=0,c=!1,l=n.Categories,w=l.length,f=0;f<w;++f)a=l[f],e=this.p(a,u),e&&(this.h&&!h&&(c=!0),Array.add(i.MenuSectionList,e),++u),++h;this.h&&c&&u<=2&&Array.removeAt(i.MenuSectionList,0);for(var b=this.f.b(),r=b.d(),v=_Ewa.x.a(11),y=n.LongButtons,k=y.length,o=0;o<k;++o)s=y[o],this.g.N(s)&&this.m(r,s,v);return this.n(r,v),r.ControlList.length>0&&Array.add(i.MenuSectionList,r),i},m:function(n,t,i){var u,f,r,e;t&&(u="Data.ConvertToLinkedEntityMenuItem_"+t.Name,f=this.g.b(t.DomainId),f)&&(e=(r=new Common.bP,r.Id=u,r.ExternalId=u,r.Command="-1662108744",r.LabelText=t.Name,r.Alt=t.SuperTip,r.Visible=!0,r.MenuItemId=_Ewa.hQ.a(t.DomainId),r.Image16by16=i,r.Image16by16Class=this.r(f.FontLocator,!0),r),Array.add(n.ControlList,e))},n:function(n,t){if(this.g.e()){Diag.a.a(573087815,0,50,"ConvertToLinkedEntityMenuRenderer::AddWolframUpsellButtonToControlList() - Generating wolfram upsell button");var r="Data.LinkedEntityWolframUpsell",i,u=(i=new Common.bP,i.Id=r,i.ExternalId=r,i.Command="325814869",i.LabelText=_Ewa.ClientStringManager.a().b(658),i.Visible=!0,i.MenuItemId=r,i.Image16by16=t,i.Image16by16Class="ewadata_UpgradeProductExcel16",i);Array.add(n.ControlList,u)}},d:function(n,t){var r=24,u={width:r,"min-width":r,height:r},i;return i=new Common.dt,i.Id="ConvertToLinkedEntityPreview"+n.toString(),i.ExternalId="ConvertToLinkedEntityPreview"+n.toString(),i.MenuItemId="PreviewGalleryButtonIndex."+n.toString(),i.Command="-1203788282",i.QueryCommand="QueryLinkedEntityGalleryButtons",i.Icon=this.l(t.FontLocator),i.LabelText=t.Name,i.PreviewIconStyle={root:u},i.Alt=this.e(t),i},a:function(n){switch(n){case"Animal":return"AnimalExcelDataTypes_16";case"Apple":return"AppleExcelDataTypes_16";case"Atom":return"AtomExcelDataTypes_16";case"Beaker":return"BeakerExcelDataTypes_16";case"Bridge":return"BridgeExcelDataTypes_16";case"Cat":return"CatExcelDataTypes_16";case"City":return"CityExcelDataTypes_16";case"Constellation":return"ConstellationExcelDataTypes_16";case"Dog":return"DogExcelDataTypes_16";case"Finance":return"Bank_16";case"GradCap":return"GradCapExcelDataTypes_16";case"HumanAnatomy":return"HumanAnatomyExcelDataTypes_16";case"LocationPointer":return"LocationPointerExcelDataTypes_16";case"Map":return"OpenMap_16";case"MedicineNeedle":return"MedicineNeedleExcelDataTypes_16";case"Mountain":return"MountainExcelDataTypes_16";case"Movie":return"MovieExcelDataTypes_16";case"Music":return"MusicExcelDataTypes_16";case"OuterSpace":return"OuterSpaceExcelDataTypes_16";case"Planet":return"PlanetExcelDataTypes_16";case"Satellite":return"SatelliteExcelDataTypes_16";case"WolframGeneric":return"RichDataWolfram_16";default:return"ConvertToEntity_16"}},r:function(n,t){if(t&&n!=="PowerBIRibbon")return"ewadata_ConvertToEntityIcon16";switch(n){case"AnimalRibbon":return"ewadata_Animal32";case"AppleRibbon":return"ewadata_Apple32";case"AtomRibbon":return"ewadata_Atom32";case"BeakerRibbon":return"ewadata_Beaker32";case"BridgeRibbon":return"ewadata_Bridge32";case"CenterMapRibbon":return"ewadata_CenterMap32";case"CityRibbon":return"ewadata_City32";case"CurrencyRibbon":return"ewadata_Currency32";case"ExerciseRibbon":return"ewadata_Exercise32";case"FinanceRibbon":return"ewadata_StockLinkedEntity32";case"FirstAidRibbon":return"ewadata_FirstAid32";case"GlobeLightningRibbon":return"ewadata_GlobeLightning32";case"GradCapRibbon":return"ewadata_GradCap32";case"HumanAnatomyRibbon":return"ewadata_HumanAnatomy32";case"LeafRibbon":return"ewadata_Leaf32";case"LocationPointerRibbon":return"ewadata_LocationPointer32";case"MapRibbon":return"ewadata_GeographyLinkedEntity32";case"MountainRibbon":return"ewadata_Mountain32";case"MovieRibbon":return"ewadata_Movie32";case"MusicRibbon":return"ewadata_Music32";case"NotablePeopleRibbon":return"ewadata_NotablePeople32";case"OuterSpaceRibbon":return"ewadata_OuterSpace32";case"PartlySunnyWeatherRibbon":return"ewadata_PartlySunnyWeather32";case"PowerBIRibbon":return t?"ewadata_OrganizationData16":"ewadata_OrganizationData32";case"SatelliteRibbon":return"ewadata_Satellite32";case"WolframGenericRibbon":return"ewadata_Lightning32";case"YogaRibbon":return"ewadata_Yoga32";default:return"ewadata_ConvertToEntityIcon32"}},l:function(n){switch(n){case"AnimalRibbon":return"AnimalExcelDataTypes_24";case"AppleRibbon":return"AppleExcelDataTypes_24";case"AtomRibbon":return"AtomExcelDataTypes_24";case"BeakerRibbon":return"BeakerExcelDataTypes_24";case"BridgeRibbon":return"BridgeExcelDataTypes_24";case"CenterMapRibbon":return"CenterMapExcelDataTypes_24";case"CityRibbon":return"CityExcelDataTypes_24";case"CurrencyRibbon":return"CurrencyExcelDataTypes_24";case"ExerciseRibbon":return"ExerciseExcelDataTypes_24";case"FinanceRibbon":return"Bank_32";case"FirstAidRibbon":return"FirstAidExcelDataTypes_24";case"GlobeLightningRibbon":return"GlobeLightning_24";case"GradCapRibbon":return"GradCapExcelDataTypes_24";case"HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case"LeafRibbon":return"LeafExcelDataTypes_24";case"LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case"MapRibbon":return"OpenMap_24";case"MountainRibbon":return"MountainExcelDataTypes_24";case"MovieRibbon":return"MovieExcelDataTypes_24";case"MusicRibbon":return"MusicExcelDataTypes_24";case"NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case"OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case"PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case"PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case"SatelliteRibbon":return"SatelliteExcelDataTypes_24";case"WolframGenericRibbon":return"Lightning_24";case"YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}},p:function(n,t){for(var u,i,l,f,a,e,o,s=this.f.e("ConvertToLinkedEntitySection_"+t,this.j,this.i,null),h=!1,c=n.DomainIds,v=c.length,r=0;r<v;++r)(u=c[r],i=this.g.b(u),i&&!i.DomainBlocked&&i.ShowInRibbon)&&(l=i.Name,f=_Ewa.hQ.a(u),s.a("Data.ConvertToLinkedEntityMenuItem_"+f,-1203788282,"QueryLinkedEntityGalleryIcon",0,f,this.l(i.FontLocator),null,null,this.e(i),l),h=!0);return h?(a=s.b(!0),e=this.f.b(),e.c(n.Name),o=e.d(),Array.add(o.ControlList,a),o):null},q:function(n){return n==="Stocks"?"Bank_32":n==="Geography"?"OpenMap_32":"ConvertToEntity_32"},s:function(){this.j=5;this.i="Size112by64"},e:function(n){return!n.RibbonTooltipHeader||!n.RibbonTooltipHeader.length?n.RibbonTooltip:n.RibbonTooltipHeader+"\n\n"+n.RibbonTooltip}};_Ewa.dw=function(){};_Ewa.dw.j=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetRichDataClassificationLabels",e,t,i,r,u,4,null,null)};_Ewa.dw.d=function(n,t,i,r,u,f,e,o,s){var h=n.a(1,s);return h.selectedRanges=t,h.domainId=i,h.autodetect=r,_Ewa.k.a(n,"ConvertToLinkedEntity",h,u,f,e,o,4,null,null)};_Ewa.dw.p=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"OnAutoDetectUIShown",e,t,i,r,u,4,null,null)};_Ewa.dw.i=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetLinkedEntityServiceDomains",e,t,i,r,u,4,null,null)};_Ewa.dw.h=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetLinkedEntityMetadata",e,t,i,r,u,4,null,null)};_Ewa.dw.c=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,_Ewa.k.a(n,"ConvertLinkedEntityToText",o,i,r,u,f,4,null,null)};_Ewa.dw.q=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.selectedRanges=t,_Ewa.k.a(n,"RefreshLinkedEntitiesInRange",o,i,r,u,f,4,null,null)};_Ewa.dw.a=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(1,c);return l.selectedRanges=t,l.isChangeObject=i,l.isFloodgateEnabled=r,l.isStarterData=u,l.starterDataDomainId=f,_Ewa.k.a(n,"GetDataSelectorPaneData",l,e,o,s,h,4,null,null)};_Ewa.dw.s=function(n,t,i,r,u,f,e,o){var s=n.a(9,o);return s.activeCell=t,s.selectionIndex=i,_Ewa.k.a(n,"SelectLinkedEntityForDisambiguation",s,r,u,f,e,4,null,null)};_Ewa.dw.m=function(n,t,i,r,u,f,e,o,s,h,c,l){var a=n.a(1,l);return a.searchCell=t,a.searchQuery=i,a.isFloodgateEnabled=r,a.isStarterData=u,a.starterDataDomainId=f,a.starterDataDomainIdString=e,_Ewa.k.a(n,"LinkedEntitySearch",a,o,s,h,c,4,null,null)};_Ewa.dw.k=function(n,t,i,r,u,f,e,o,s){var h=n.a(1,s);return h.cell=t,h.starterDataDomainId=i,h.starterDataDomainIdString=r,_Ewa.k.a(n,"InsertStarterDataTable",h,u,f,e,o,4,null,null)};_Ewa.dw.o=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.activeCell=t,s.isBackward=i,_Ewa.k.a(n,"MoveToNextAmbiguousLinkedEntity",s,r,u,f,e,4,null,null)};_Ewa.dw.b=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,_Ewa.k.a(n,"CancelSearchLinkedEntity",o,i,r,u,f,4,null,null)};_Ewa.dw.r=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.featureNames=t,s.isEnabledValues=i,_Ewa.k.a(n,"RefreshLinkedEntityWebServiceHandshake",s,r,u,f,e,4,null,null)};_Ewa.dw.e=function(n,t,i,r,u,f,e,o){var s=n.a(1,o);return s.selectedRanges=t,s.letyDomainId=i,_Ewa.k.a(n,"GetDataTypeSelectorData",s,r,u,f,e,4,null,null)};_Ewa.dw.f=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetErrorMessageForLinkedDataTypeRefresh",e,t,i,r,u,4,null,null)};_Ewa.dw.g=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"GetHasUntrustedImageUrls",e,t,i,r,u,4,null,null)};_Ewa.dw.l=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LinkedEntitiesEnableUntrustedImages",e,t,i,r,u,0,null,null)};_Ewa.dw.n=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"LinkedEntityTryAutoRefresh",e,t,i,r,u,0,null,null)};_Ewa.IB=function(n,t){this.g=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.l);this.f=Function.createDelegate(this,this.k);this.b=n;this.a=t};_Ewa.IB.prototype={b:null,a:null,d:!1,c:!1,i:function(){this.d||(Diag.a.a(571274630,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),_Ewa.k.ba(this.b.c().a(),0,this.f,this.e,null,null))},h:function(n){if(!n||!n.length){Diag.a.a(571274629,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.");return}if(!this.d){this.c=!0;return}var t=this.o(n);if(!t||!t.length){Diag.a.a(571274628,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string.");return}Diag.a.a(571274627,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation.");_Ewa.k.bo(this.b.c().a(),0,t,this.g,this.e,null,null)},o:function(n){var u,i,r,t,e;if(!n||!n.length)return Diag.a.a(571274626,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;u=[];for(var o=n,s=o.length,f=0;f<s;++f)i=o[f],r={},r.Id=i.Id,i.StringId&&(r.StringId=i.StringId),u.push(r);return(t=new Sys.StringBuilder,t.append("<DataTypes>"),t.append(_Ewa.E.a(u)),t.append("<\/DataTypes>"),e=t.toString(),e.length>1906)?(Diag.a.a(571274625,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):e},n:function(n){var i,t,r,u;if(!n||!n.length)return Diag.a.a(571274624,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!n.startsWith("<DataTypes>")||!n.endsWith("<\/DataTypes>"))return Diag.a.a(571274595,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;if(i=n.substring(11,n.length-12),!i||!i.length)return Diag.a.a(571274594,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;t=[];try{t=_Ewa.E.b(i)}catch(f){return Diag.a.a(571274593,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",f.message),null}return Diag.a.a(571274592,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",t.length),_Ewa.a.a("OfficeVSO:5545530_FixMruNewUserLogging")||(u=[(r=new Otel.a,r.name="MruCount",r.int64=t.length,r)],Common.A.a("ReadRecentlyUsedLinkedDataTypes",!0,0,u)),t},j:function(n){var t=this.a.a(),u=this.a.S(),i,r;if(t.length!==u){for(i=0;i<n.length&&t.length<u;++i)(r=n[i],this.a.R(r)&&!Array.contains(t,r))&&t.push(r);this.a.U(t)}},k:function(n){var i,c,r,u,f;if(Diag.a.a(571274591,0,50,"OnReadRoamingStringSuccess called."),this.d=!0,_Ewa.i.c(n.Errors)){Diag.a.a(571274590,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",_Ewa.i.a(n.Errors,","));return}var e=0,t=[],o=!1;try{if(!n.Result)return;if(i=n.Result,!i||!i.length){Diag.a.a(571274589,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}if(t=this.n(i),!t||!t.length)return;if(e=t.length,this.j(t),this.a.T(),Diag.a.a(557672200,0,50,"OnReadRoamingStringSuccess MruCount:{0}",this.a.a().length),_Ewa.a.a("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var h=this.a.a(),l=h.length,s=0;s<l;++s)if(c=h[s],(c.Id&1048320)>>8==1){o=!0;break}Diag.a.a(556351650,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",o)}}finally{_Ewa.a.a("OfficeVSO:5545530_FixMruNewUserLogging")&&(Diag.a.a(541181405,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",e),r=[],r.push((u=new Otel.a,u.name="MruCount",u.int64=e,u)),r.push((f=new Otel.a,f.name="MruWolframAvailable",f.bool=o,f)),Common.A.a("ReadRecentlyUsedLinkedDataTypes",!0,0,r))}this.c&&(this.h(this.a.a()),this.c=!1)},m:function(n){if(Diag.a.a(571274588,0,50,"OnWriteRoamingStringSuccess called."),_Ewa.i.c(n.Errors)){Diag.a.a(571274587,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",_Ewa.i.a(n.Errors,","));return}if(n.Result){var t=n.Result;if(!t){Diag.a.a(571274586,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service.");return}}},l:function(n,t,i){var r=_Ewa.X.a(n.b);Diag.a.a(571274585,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",i,_Ewa.i.a(r,","))}};_Ewa.Iz=function(n){_Ewa.Iz.initializeBase(this,[n])};_Ewa.Iz.prototype={dispose:function(){Common.App.Enrichment.h.prototype.dispose.call(this)}};_Ewa.oA=function(n,t,i){this.m=Function.createDelegate(this,this.q);this.b=this.cF;this.d=this.cB;_Ewa.oA.initializeBase(this,[n,null]);this.i=t;this.j=i;_Ewa.bk.a(t).a(this);this.i.D(this.m);_Ewa.s.a(this.i)&&this.cB(!1)};_Ewa.oA.a=function(n,t){var f=n.l(),i=document.getElementById(f+"m_enrichmentTaskPane"),r,u,e;return i||(i=CommonUI.a.a("div",n.l()+"m_enrichmentTaskPane","cui-taskpane"),_Ewa.s.a(n)||(r=document.getElementById(f+"novTaskpaneBody"),isNullOrUndefined(r)?Diag.a.a(554239310,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",n.U()):r.appendChild(i))),u=n.a(),e=u.a(_Ewa.oA,257,!1,null)||u.b(_Ewa.oA,257,new _Ewa.oA(i,n,t)),e};_Ewa.oA.prototype={j:null,br:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},bu:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cD("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cH("EnrichmentTaskPaneOnFocus",n)},cF:function(){return _Ewa.bdQ.prototype.cF.call(this)},cB:function(n){return _Ewa.bdQ.prototype.cB.call(this,n),this.cz("EnrichmentTaskPaneVilibilityChanged",null),n},bG:function(){return this.cF()},bq:function(){return"ETP"},a:function(){return 10},C:function(){return"ewanov_linkedrecordPane"},D:function(){return"Enrichment"},o:function(){return 300},n:0,F:function(){return this.n},bv:function(n){return this.n=n,n},E:function(){return!1},H:function(){return this.cx()},l:!1,p:function(){var n=this,t=this,i=this,r=this;return this.j.i(this.H(),"Enrichment",300,!1,function(){n.cB(!0)},function(){t.cB(!1)},function(){i.cB(!0)},function(){r.cB(!1)},300,950,null,null,!1)},i:null,k:function(){},bs:function(){},g:function(){return this.l},h:function(){return this.l},G:function(){},dispose:function(){this.i&&this.i.H(this.m);this.i=null;this.j=null;_Ewa.bdQ.prototype.dispose.call(this)},O:function(n,t){return t||this.cz("EnrichmentTaskPaneOnFocus",null),!t},en:function(n){return _Ewa.b.e(this.H(),n)},cW:function(){},bV:function(){},c:function(n){this.l=n;var t=this.j;this.cB(n);_Ewa.s.a(this.i)?n?this.j.h("EnrichmentTaskPane",this.p()):this.j.g("EnrichmentTaskPane"):(n&&t.c().length>0&&(!t.a()||t.a().a().a()!==10||t.e())&&t.d(this,!0),t.b());n||(_Ewa.c.a(this.i).O(!0,!1),this.i.t())},bt:function(){return!1},q:function(){this.c(!1)}};_Ewa.wc=function(n){_Ewa.wc.initializeBase(this);this.h=n;this.l()};_Ewa.wc.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.rN),258,new _Ewa.wc(n))};_Ewa.wc.prototype={m:null,n:null,p:function(){if(!this.m){var n=this;this.m=_Ewa.g.a(_Ewa.ct.a(this.h),function(t){n.n=_Ewa.oA.a(n.h,t.a())},this.i(),3,null,null)}return this.m},h:null,a:function(){var t=_Ewa.l.b(Sys.IDisposable,this.h.a(),203,this.i(),this.j,null),i=_Ewa.l.b(Object,this.h.a(),155,this.i(),this.j,null),r=this,n=this;_Ewa.g.a(_Ewa.g.ts(_Ewa.g.b([t,i],this.i(),3),function(){return r.p()},this.i(),3,null),function(){n.k(n.n)},this.i(),3,null,null)},dispose:function(){this.h=null;this.m=null;this.n=null;_Ewa.sX.prototype.dispose.call(this)}};_Ewa.Iy=function(n){_Ewa.Iy.initializeBase(this,[Common.a.b().e(),Common.a.b().f(),Common.a.b().h(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.t)};_Ewa.Iy.prototype={f:null,B:function(){return this.f.H()},E:function(){this.f.b()||this.f.c(!0)},D:function(){this.f.c(!1)},dispose:function(){this.f&&(this.f.f(this.t),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.Fx=function(n,t,i,r,u){_Ewa.Fx.initializeBase(this,[!1]);this.c=n;this.a=r.c(n,t,i,"",_Ewa.x.a(11),u,"AutoDetectPointerDown",_Ewa.ClientStringManager.a().a(1711)+"...")};_Ewa.Fx.prototype={c:null,a:null,b:function(){return this.a.a()},dispose:function(){this.a.dispose();this.c=null;_Ewa.bgG.prototype.dispose.call(this)},f:function(n){return this.a.b(n)},e:function(n){return this.a.d(n,!1)},i:function(n,t,i,r){this.a.l(_Ewa.uK.a(n),t,r,!1);this.a.g(i,t,r,!1)},g:function(n,t){var r=_Ewa.c.a(this.c),u=r.g().e(n),i=r.y(n,u,!1,!1),f=r.n(u).v(),h;if(i&&i.a.a>=0&&i.a.b>=0&&f.c()>i.c()+160){var e=i.b.a+this.b(),o=i.a.b+this.b(),s=!1;if(e+160>f.b.a&&(e=i.a.a-this.b(),s=!0),h=o<f.a.b+this.b(),h){if(r.g().n()){this.d();return}o=f.a.b+this.b()}this.a.f(t,"AutoDetectHover",u);this.h(e,o,r.d(),u,s)}else this.d()},h:function(n,t,i,r,u){this.a.c(n,t,i,r,!1,u)},d:function(){this.a.e()}};_Ewa.Fy=function(n,t){this.i=t;this.c=n};_Ewa.Fy.prototype={i:null,c:null,b:null,d:null,a:null,h:null,g:null,f:null,e:null,k:function(){var t=this.l(),n=this;_Ewa.gi.a(_Ewa.he,this.i,243,242,0,function(i){n.b=i;i.f(n.c,2,t,!1,!0)},null)},j:function(){this.b&&this.b.b(-1,-1,this.c)},l:function(){var n={};return n.layoutId="AutoDetectTooltip",n.description=this.a,n.convertToDomainName=this.d,n.longDescription=this.a,n.urlValue=this.h,n.imageAltText=this.g,n.helpText=this.f,n.helpId=this.e,n}};_Ewa.uK=function(n,t,i,r){this.x=Function.createDelegate(this,this.U);this.w=Function.createDelegate(this,this.T);this.v=Function.createDelegate(this,this.E);this.t=Function.createDelegate(this,this.R);this.y=Function.createDelegate(this,this.W);this.u=Function.createDelegate(this,this.S);this.q=Function.createDelegate(this,this.V);this.F=Function.createDelegate(this,this.Q);this.G=Common.c.d();_Ewa.uK.initializeBase(this,[!1]);this.b=n;this.j=_Ewa.a.c("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);t||Diag.a.a(574681089,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.e=r;r.h();this.d=new _Ewa.Fx(n,t,this.F,i,"");this.z=new _Ewa.Fz(this.b,r);this.a=_Ewa.c.a(this.b);this.a.a().o(this.q);this.a.f().r(this.q);this.a.C(this.u);n.D(this.y);n.Q(this.t);this.m=$$as(_Ewa.gh,this.a.b());this.g=n.r().ba;this.r()};_Ewa.uK.a=function(n){return _Ewa.ClientStringManager.a().a(1711)+" "+n};_Ewa.uK.prototype={e:null,z:null,d:null,a:null,m:null,b:null,g:null,i:-1,l:null,f:-1,k:!1,p:!1,s:!1,o:!1,h:!1,c:null,j:!1,N:function(){return this.d.f(1)},C:function(){var n=this.d.f(1);return n?_Ewa.b.d(n):!1},B:function(){if(this.b.j()&&_Ewa.a.b(139)&&_Ewa.a.b(142)){var n=new _Ewa.bN(this.b.d());if(n.b())return!1}return this.f!==-1},dispose:function(){if(this.a&&this.a.a().s(this.q),this.b){var n=this.b;n.H(this.y);n.S(this.t);_Ewa.c.a(n).I(this.u)}System.a.a(this.d);this.d=null;this.a=null;this.b=null;this.g=null;_Ewa.bgG.prototype.dispose.call(this)},n:function(){this.E(null,!1);this.i=-1;this.d.d();this.Y();this.h=!1},I:function(){this.d.e(1).a();this.h=!1},J:function(){this.d.e(1).b();this.L(this.l);this.h=!0;var n=this;this.b.a().c(_Ewa.cC,211,function(n){n.d(_Ewa.ClientStringManager.a().a(1654))},null)},H:function(){this.B()&&this.i!==-1&&this.e.K()},M:function(n,t){for(var r,f,e=new _Ewa.p(n.a===1?1:n.a-1,n.b,n.c,n.d,!0,!1),o=this.a.G(e),u=o,s=u.length,i=0;i<s;++i)if(r=u[i],_Ewa.jG.isInstanceOfType(r)&&(f=r,this.D(n,t,f)))return!0;return!1},A:function(){var n,t,i;this.B()&&this.i!==-1&&(this.d.e(1).b(),n={},n.Id=this.f,n.StringId=null,this.e.d(n,!0,this.l),Diag.a.a(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)"),i=[(t=new Otel.a,t.name="Domain",t.int64=this.f,t)],Common.A.a("AssistedAutoConvertMenuConvertClicked",!0,0,i),this.f=-1)},O:function(){var n=new Sys.StringBuilder(_Ewa.ClientStringManager.a().a(1650));if(this.f!==-1){n.append(" ");try{n.append(this.e.g(this.f.toString()))}catch(t){Diag.a.a(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.f)}}return n.append(" "),this.j?n.append(_Ewa.ClientStringManager.a().a(1653)):n.append(_Ewa.ClientStringManager.a().a(this.G?1652:1651)),n.toString()},V:function(){this.B()&&this.a&&this.r()},W:function(){this.n()},Q:function(){this.A();_Ewa.c.a(this.b).O(!0,!1)},E:function(n,t){if(t)this.L(this.l),this.K();else{var i=[29];this.a.j().a(i);this.a.j().b(null,i,!0);this.c&&this.c.j()}},K:function(){if(this.j){this.c||(this.c=new _Ewa.Fy(this.N(),this.b),this.c.d=_Ewa.ClientStringManager.a().a(1655),this.c.h="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.c.g=_Ewa.ClientStringManager.a().a(1657),this.c.e="HID_DataTypes_Wolfram",this.c.f=_Ewa.ClientStringManager.a().a(1656));var n=this.i.toString();this.c.a=this.e.j(n);this.c.k()}},R:function(){this.P()&&this.d.d();var n=this.a.a().c();n===1&&this.r()},S:function(){var n=this.a.a().a().a(),t=this.a.a().c();n&&t===1&&this.r()},D:function(n,t,i){var f=new _Ewa.p(i.a,i.b,i.c===1048576?i.c:i.c+1,i.d,!0,!1),r;if(f.h(n)){if(t){if(r=i,r&&r.q!==this.i){this.i=r.q;var u=r.q.toString(),e=this.j?"":this.e.j(u),o=this.e.D(u);this.d.i(this.e.g(u),e,o,1)}this.f=r.q;this.l=i}return!0}return!1},r:function(){var r,t;if(this.e){var s=!!this.m&&this.m.K(),h=this.a.a().a().i(),u=this.a.a().c(),f=_Ewa.a.b(507);if(!s||!h&&!f){this.n();return}for(var n=this.a.a().a().a(),c=this.m.e(n,!1),e=!c,l=this.a.s(),a=this.a.G(l),o=a,v=o.length,i=0;i<v;++i)if(r=o[i],_Ewa.jG.isInstanceOfType(r))if(t=r,f)switch(t.t){case 3:if(this.D(n,!0,t)){if(u!==1||e){this.n();return}Diag.a.a(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.X();this.d.g(n,this.v);this.k||(this.k=!0,this.H());return}break;case 2:case 1:(_Ewa.a.b(509)||_Ewa.a.b(510))&&this.z.f(t);break;default:Diag.a.a(593266063,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}else{if(u!==1||e){this.n();return}if(this.D(n,!0,t)){Diag.a.a(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.d.g(n,this.v);this.k||(this.k=!0,this.H());return}}this.n()}},L:function(n){var t=[29];this.a.j().b(n,t,!0);this.a.j().d(t,null,null)},P:function(){return this.b.b().b()&&_Ewa.D.b(this.b.h())},U:function(n){if(!this.C())return this.p=!1,!1;if(this.p)return!1;var t=n.a.keyCode;return t===17&&this.s?(this.h?(this.K(),this.I()):this.J(),!0):!1},T:function(n){if(!this.C())return this.p=!1,!1;this.s=!1;this.p=n.i();var t=n.a.keyCode;switch(t){case 27:return this.h?(this.E(null,!1),this.I()):this.c&&(this.c.j(),this.J()),!0;case 13:if(this.h)return this.h=!1,this.A(),!0;break;case 17:return this.s=!0,!0}return!1},X:function(){this.j&&!this.o&&this.g&&(this.g.f("keydown",this.b.q(),this.w,!0),this.g.f("keyup",this.b.q(),this.x,!0),this.o=!0)},Y:function(){this.j&&this.o&&this.g&&(this.g.i("keydown",this.b.q(),this.w,!0),this.g.i("keyup",this.b.q(),this.x,!0),this.o=!1)}};_Ewa.uL=function(n,t){this.c=Function.createDelegate(this,this.f);_Ewa.uL.initializeBase(this,[!1]);this.b=n;this.d=t;this.a=document.createElement("div");this.a.className="clip16x16";this.e=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',Common.d.b("autodetectid"+this.b.b),"ewadata_ConvertToEntityIcon16",_Ewa.x.a(11));this.a.innerHTML=this.e;var i=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.j.a().a("click",i,this.c)};_Ewa.uL.prototype={e:"",d:null,b:null,a:null,dispose:function(){if(this.a){var n=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");Common.j.a().b("click",n,this.c)}_Ewa.bgG.prototype.dispose.call(this)},f:function(n){if(n.c.id===this.a.firstChild.id){var t=this.b,i={};return i.Id=t.q,this.d.d(i,!0,t),this.a.removeChild(this.a.firstChild),!0}return!1}};_Ewa.Fz=function(n,t){_Ewa.Fz.initializeBase(this,[!1]);this.d=n;this.b=_Ewa.c.a(n);this.c=t;this.a=new($$sc.s.$$(_Ewa.uL))};_Ewa.Fz.prototype={d:null,b:null,c:null,a:null,dispose:function(){_Ewa.bgG.prototype.dispose.call(this)},f:function(n){for(var r=this.b.bs().$$ge(),u,t;r.$$mn();)for(u=r.$$cu(),t=u.$$ge();t.$$mn();){var i=t.$$cu(),e=i.a(),f=_Ewa.rG.a(i.f());this.e(n,f,e);i.l(f)}},e:function(n,t,i){var u,f,r;if(t.length&&(u=i.length,!(i[u-1]<n.b))&&(f=_Ewa.j.h(new _Ewa.dk(i),0,u,n.b,_Ewa.j.g),!(f<0))&&(r=t[f],r)){this.b.d()?Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-rtl"):Sys.UI.DomElement.addCssClass(r,"ewr-autodetect-column-ltr");this.a.c(n.b)||this.a.d(n.b,new _Ewa.uL(n,this.c));var e=this.a.a(n.b),o=e.a,s=r.getElementsByClassName("clip16x16");!s.length&&this.g(r)&&r.appendChild(o)}},g:function(n){var u=parseInt(n.style.width),i=this.d.a().a(_Ewa.dp,268,!1,null),r,t;if(!i)return Diag.a.a(593266065,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton IInstantaneousSupportInformationManager not initialized in time for rendering Auto Detect Column Header Button"),!0;if(r=i?i.d():null,!r)return Diag.a.a(593266064,0,15,"AutoDetectColumnHeaderManager.SpaceExistsForAutoDetectButton NumberFormattingCalculator not initialized in time for rendering Auto Detect Column Header Button"),!0;t={};t.fontVariant="normal";t.fontStyle="normal";t.fontFamily='"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif';t.fontSize="10pt";t.fontWeight=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";t.lineHeight="normal";t.letterSpacing="0px";var f=r.calculateTextWidth(n.firstChild.innerHTML,t),e=u-(u/2+f/2);return e>16*.9+4?!0:!1}};_Ewa.Iv.registerClass("_Ewa.Iv",null,_Ewa.lI);_Ewa.wa.registerClass("_Ewa.wa",_Ewa.bh);_Ewa.IA.registerClass("_Ewa.IA");_Ewa.Iw.registerClass("_Ewa.Iw",null,Sys.IDisposable);_Ewa.hQ.registerClass("_Ewa.hQ",_Ewa.bW,_Ewa.dN,Common.App.Enrichment.n,Sys.IDisposable,_Ewa.bfp);_Ewa.wb.registerClass("_Ewa.wb",_Ewa.sX.$$(_Ewa.dN));_Ewa.Iz.registerClass("_Ewa.Iz",Common.App.Enrichment.h);_Ewa.oA.registerClass("_Ewa.oA",_Ewa.bdQ,_Ewa.rN,Sys.IDisposable,_Ewa.bkz,_Ewa.pn);_Ewa.wc.registerClass("_Ewa.wc",_Ewa.sX.$$(_Ewa.rN));_Ewa.Iy.registerClass("_Ewa.Iy",Common.App.Enrichment.a);_Ewa.Fx.registerClass("_Ewa.Fx",_Ewa.bgG);_Ewa.Fy.registerClass("_Ewa.Fy");_Ewa.uK.registerClass("_Ewa.uK",_Ewa.bgG);_Ewa.uL.registerClass("_Ewa.uL",_Ewa.bgG);_Ewa.Fz.registerClass("_Ewa.Fz",_Ewa.bgG);Type.registerNamespace("_Ewa");_Ewa.bfm=function(){};_Ewa.bfm.a=function(){_Ewa.m.a(function(n){_Ewa.wc.a(n);_Ewa.wb.a(n);_Ewa.wa.a(n)})};_Ewa.bfm.a();