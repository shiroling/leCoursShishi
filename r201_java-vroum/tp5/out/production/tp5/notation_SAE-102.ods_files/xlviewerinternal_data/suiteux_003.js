var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_otellogging_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["otellogging"],{1899:function(e,n,t){t.r(n),t.d(n,{initializeLogging:function(){return Ai}});var r=t(31191);var i,o=(i=[],{fireEvent:function(e){i.forEach((function(n){return n(e)}))},addListener:function(e){e&&i.push(e)}});function a(e,n,t){o.fireEvent({level:e,category:n,message:t})}function s(e,n,t){a(0,e,(function(){var e=t instanceof Error?t.message:"";return n+": "+e}))}var u,c={};!function(e){var n=9007199254740991,t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,r=/^[a-zA-Z0-9_\.]{1,95}$/;function i(e){return r.test(e)}function o(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&a(e.value)}))}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!i(n.name))throw new Error("Invalid eventContract");o(n.dataFields)}o(e.dataFields)},e.validateInt=a}(u||(u={}));function l(e,n){return{name:e,dataType:1,value:n,classification:4}}function f(e,n){return{name:e,dataType:2,value:n,classification:4}}function d(e,n){return{name:e,dataType:0,value:n,classification:4}}function v(e){var n={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.pi)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(n.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),n}var p=function(){function e(e,n,t){var i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=t||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,r.pi)((0,r.pi)({},e.getConfig()),this.config)),n&&(o=this.persistentDataFields).push.apply(o,n)}return e.prototype.sendTelemetryEvent=function(e){var n=v(e),t=n.telemetryProperties;if(t.customerContentVersion||t.customerContentType)a(0,0,(function(){return"Customer content"}));else{if(!t.ariaTenantToken||!t.nexusTenantToken){var r=function(e){for(var n=e.length;n>0;){var t=e.substr(0,n);if(c[t])return c[t];n=e.lastIndexOf(".",n-1)}}(n.eventName);if(!r)return void a(0,0,(function(){return"No tenant token: "+e.eventName}));t.ariaTenantToken=r.ariaTenantToken,t.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(n)}},e.prototype.sendCustomerContent=function(e){var n=v(e),t=n.telemetryProperties;return(!t.customerContentVersion||t.customerContentVersion>1)&&(t.customerContentVersion=1),t.ariaTenantToken=void 0,t.nexusTenantToken=void 0,n.dataFields.push(f("EventContent.Type",2)),this.sendTelemetryEventInternal(n)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):a(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void s(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){var t=e.telemetryProperties;t.customerContentVersion&&t.customerContentType?n.sendCustomerContent&&n.sendCustomerContent(e):n.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var n,t;e.dataFields&&(null===(t=e.dataFields)||void 0===t||t.unshift(d("OTelJS.Version","4.4.4")),this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.config.disableValidation||u.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,n=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&n.forEach((function(n){e.sendTelemetryEventInternal(n)}))},e.prototype.setTenantToken=function(e,n,t){!function(e,n){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?c[e]=n:a(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:n,nexusTenantToken:t})},e.prototype.cloneEvent=function(e){return v(e)},e.prototype.getConfig=function(){return this.config},e}();function h(e,n){return e?e+"."+n:n}function g(e,n,t,r){t&&r.push(d(""+h(e,n),t))}function y(e,n,t,r){"boolean"==typeof t&&r.push(l(""+h(e,n),t))}function m(e,n,t,r){"number"==typeof t&&r.push(f(""+h(e,n),t))}var C,T=function(e){var n="Activity.Result",t=[];return m(n,"Code",e.code,t),g(n,"Type",e.type,t),m(n,"Tag",e.tag,t),y(n,"IsExpected",e.isExpected,t),t.push(d("zC.Activity.Result","Office.System.Result")),t},S={contractName:"Office.System.Activity",getFields:function(e){var n="Activity",t=[];return g(n,"CV",e.cV,t),m(n,"Duration",e.duration,t),m(n,"Count",e.count,t),m(n,"AggMode",e.aggMode,t),y(n,"Success",e.success,t),e.result&&t.push.apply(t,T(e.result)),t.push(d("zC.Activity",this.contractName)),t}},x=function(e){var n="User",t=[];return g(n,"PrimaryIdentityHash",e.primaryIdentityHash,t),g(n,"PrimaryIdentitySpace",e.primaryIdentitySpace,t),g(n,"TenantId",e.tenantId,t),g(n,"TenantGroup",e.tenantGroup,t),y(n,"IsAnonymous",e.isAnonymous,t),t},w=function(e){var n="App",t=[];return g(n,"Name",e.name,t),g(n,"Platform",e.platform,t),g(n,"Version",e.version,t),t},b=function(e){var n=[];return g("Session","Id",e.id,n),n};!function(e){var n,t=0;e.getNext=function(){return void 0===n&&(n=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=22,t=[],r=0;r<n;r++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(n,++t)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,n){this.base=e,this.id=n,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(C||(C={}));var I=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(I=function(){return 1e3*Math.floor(window.performance.now())});var _=function(e){var n,t=I(),r=v(e.telemetryEvent);return{cv:e.parentCv?C.getNextChild(e.parentCv):C.getNext(),eventName:e.telemetryEvent.eventName,dataFields:r.dataFields,eventFlags:r.eventFlags,telemetryProperties:r.telemetryProperties,createChildActivity:function(n){return _({telemetryEvent:n,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,n,t){this.result={code:e,type:n,tag:t}},endNow:function(){if(!n){void 0===this.success&&void 0===this.result&&a(1,0,(function(){return"Activity does not have success or result set"}));var r=I();n=!0;var i={duration:r-t,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,S.getFields(i)),this.eventContract={name:S.contractName,dataFields:o},e.sendTelemetryEvent(this)}a(0,0,(function(){return"Already ended"}))}}},P=function(e){var n=[];return n.push(d("Error.ErrorGroup",e.errorGroup)),n.push(f("Error.Tag",e.tag)),void 0!==e.code&&n.push(f("Error.Code",e.code)),void 0!==e.id&&n.push(f("Error.Id",e.id)),void 0!==e.count&&n.push(f("Error.Count",e.count)),n},E=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.createActivity=function(e){return function(e,n){return _({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendTelemetryEvent(n)}})}(this,e)},n.prototype.sendActivity=function(e,n,t,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:S.contractName,dataFields:S.getFields(n)},dataFields:t,eventFlags:r})},n.prototype.sendError=function(e){var n=P(e.error);return null!=e.dataFields&&n.push.apply(n,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:n,eventFlags:e.eventFlags})},n.prototype.createCustomerContentActivity=function(e){return function(e,n){return _({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendCustomerContent(n)}})}(this,e)},n}(p),k="function",F="object",O="undefined",N=Object,M=N.prototype,R=N.assign,L=N.create,A=N.defineProperty,D=M.hasOwnProperty;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
function B(){return typeof globalThis!==O&&globalThis?globalThis:typeof self!==O&&self?self:typeof window!==O&&window?window:typeof t.g!==O&&t.g?t.g:null}function z(e){throw new TypeError(e)}function K(e){if(L)return L(e);if(null==e)return{};var n=typeof e;function t(){}return n!==F&&n!==k&&z("Object prototype may only be an Object:"+e),t.prototype=e,new t}
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
(B()||{}).Symbol,(B()||{}).Reflect;var q,U=R||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])M.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},H=function(e,n){return H=N.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},H(e,n)};function V(e,n){function t(){this.constructor=e}typeof n!==k&&null!==n&&z("Class extends value "+String(n)+" is not a constructor or null"),H(e,n),e.prototype=null===n?K(n):(t.prototype=n.prototype,new t)}function j(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(q||(q={}));var W={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},Q=A;N.freeze,N.seal;function G(e){return M.toString.call(e)}function J(e){return void 0===e||typeof e===O}function X(e){return null===e||J(e)}function Z(e){return!X(e)}function $(e,n){return e&&D.call(e,n)}function Y(e){return typeof e===F}function ee(e){return typeof e===k}function ne(e,n,t,r){void 0===r&&(r=!1);var i=!1;if(!X(e))try{X(e.addEventListener)?X(e.attachEvent)||(e.attachEvent("on"+n,t),i=!0):(e.addEventListener(n,t,r),i=!0)}catch(e){}return i}function te(e,n){if(e)for(var t in e)D.call(e,t)&&n.call(e,t,e[t])}function re(e,n){if(e&&n){var t=n.length,r=e.length;if(e===n)return!0;if(r>=t){for(var i=r-1,o=t-1;o>=0;o--){if(e[i]!=n[o])return!1;i--}return!0}}return!1}function ie(e,n){var t=!1;if(e&&n){var r=n.length;if(e===n)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}}return t}function oe(e,n){return!(!e||!n)&&-1!==e.indexOf(n)}function ae(e){return"[object Date]"===G(e)}function se(e){return"[object Array]"===G(e)}function ue(e){return"[object Error]"===G(e)}function ce(e){return"string"==typeof e}function le(e){return"number"==typeof e}function fe(e){return"boolean"==typeof e}function de(e){if(ae(e)){var n=function(e){var n=String(e);return 1===n.length&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ve(e,n,t){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==n.call(t||e,e[i],i,e));i++);}catch(e){}}function pe(e,n,t){var r=e.length,i=t||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o}catch(e){}return-1}function he(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var ge=!{toString:null}.propertyIsEnumerable("toString"),ye=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function me(e){var n=typeof e;n===k||n===F&&null!==e||z("objKeys called on non-object");var t=[];for(var r in e)e&&D.call(e,r)&&t.push(r);if(ge)for(var i=ye.length,o=0;o<i;o++)e&&D.call(e,ye[o])&&t.push(ye[o]);return t}function Ce(e,n,t,r){if(Q)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),Q(e,n,i),!0}catch(e){}return!1}function Te(){var e=Date;return e.now?e.now():(new e).getTime()}function Se(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function xe(e){return!e}function we(e){return!!e}function be(e){throw new Error(e)}function Ie(e){return e&&(e=N(R?R({},e):e)),e}
/*
 * Application Insights JavaScript SDK - Core, 2.7.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var _e="window",Pe="JSON",Ee="msie",ke="trident/",Fe=null,Oe=null,Ne=!1,Me=null,Re=null;function Le(e,n){var t=!1;if(e){try{if(!(t=n in e)){var r=e.prototype;r&&(t=n in r)}}catch(e){}if(!t)try{t=!J((new e)[n])}catch(e){}}return t}function Ae(e){var n=B();return n&&n[e]?n[e]:e===_e&&De()?window:null}function De(){return Boolean(typeof window===F&&window)}function Be(){return De()?window:Ae(_e)}function ze(){return Boolean(typeof document===F&&document)?document:Ae("document")}function Ke(){return Boolean(typeof navigator===F&&navigator)}function qe(){return Ke()?navigator:Ae("navigator")}function Ue(e){if(e&&Ne){var n=Ae("__mockLocation");if(n)return n}return typeof location===F&&location?location:Ae("location")}function He(){return Boolean(typeof JSON===F&&JSON||null!==Ae(Pe))}function Ve(){return He()?JSON||Ae(Pe):null}function je(){var e=qe();return!(!e||!e.product)&&"ReactNative"===e.product}function We(){var e=qe();if(e&&(e.userAgent!==Oe||null===Fe)){var n=((Oe=e.userAgent)||"").toLowerCase();Fe=oe(n,Ee)||oe(n,ke)}return Fe}function Qe(e){var n=Object.prototype.toString.call(e),t="";return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":He()&&(t=Ve().stringify(e)),n+t}function Ge(){return null===Re&&(Re=Ke()&&Boolean(qe().sendBeacon)),Re}function Je(e){var n=!1;try{n=!!Ae("fetch");var t=Ae("Request");n&&e&&t&&(n=Le(t,"keepalive"))}catch(e){}return n}function Xe(){return null===Me&&(Me=void 0!==typeof XDomainRequest)&&Ze()&&(Me=Me&&!Le(Ae("XMLHttpRequest"),"withCredentials")),Me}function Ze(){var e=!1;try{e=!!Ae("XMLHttpRequest")}catch(e){}return e}
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var $e="constructor",Ye="prototype",en="function",nn="_dynClass",tn="_unknown_",rn=Object,on=rn.getPrototypeOf,an=0;function sn(e,n){return e&&rn.prototype.hasOwnProperty.call(e,n)}function un(e){return e&&(e===rn.prototype||e===Array.prototype)}function cn(e){return un(e)||e===Function.prototype}function ln(e){if(e){if(on)return on(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(n)return n}return null}function fn(e,n){var t=[],r=rn.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&sn(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function dn(e,n,t){return n!==$e&&typeof e[n]===en&&(t||sn(e,n))}function vn(e){throw new TypeError("DynamicProto: "+e)}function pn(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function hn(e,n,t,r){var i=null;if(e&&sn(t,nn)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||vn("Missing ["+n+"] "+en),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!sn(e,n),s=ln(e),u=[];a&&s&&!cn(s)&&!pn(u,s);){var c=s[n];if(c){a=c===r;break}u.push(s),s=ln(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function gn(e,n,t){var r=n[e];return r===t&&(r=ln(n)[e]),typeof r!==en&&vn("["+e+"] is not a "+en),r}function yn(e,n,t,r,i){if(!un(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),fn(t,(function(n){dn(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!sn(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(hn(this,n,e,t)||gn(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function mn(e,n){return sn(e,Ye)?e.name||n||tn:((e||{}).constructor||{}).name||n||tn}function Cn(e,n,t,r){sn(e,Ye)||vn("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){if(on)for(var t=[],r=ln(n);r&&!cn(r)&&!pn(t,r);){if(r===e)return!0;t.push(r),r=ln(r)}return!1})(i,n)||vn("["+mn(e)+"] is not in class hierarchy of ["+mn(n)+"]");var o=null;sn(i,nn)?o=i._dynClass:(o="_dynCls$"+mn(e,"_")+"$"+an,an++,i._dynClass=o);var a=Cn._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return fn(e,(function(t){!n[t]&&dn(e,t,!1)&&(n[t]=e[t])})),n}(n),c=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};fn(t,(function(e){o[e]=i(n,t,e)}));for(var a=ln(e),s=[];a&&!cn(a)&&!pn(s,a);)fn(a,(function(e){!o[e]&&dn(a,e,!on)&&(o[e]=i(n,a,e))})),s.push(a),a=ln(a);return o}(i,n,u,s);t(n,c);var l=!!on&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),yn(i,o,n,u,!1!==l)}Cn._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Tn=Cn;function Sn(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function xn(e,n){var t=typeof console!==O?console:Ae("console");if(t){var r="log";t[e]&&(r=e),ee(t[r])&&t[r](n)}}var wn=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i.messageId=e,i.message=(t?"AI: ":"AI (Internal): ")+e;var o="";He()&&(o=Ve().stringify(r));var a=(n?" message:"+Sn(n):"")+(r?" props:"+Sn(o):"");i.message+=a}return e.dataType="MessageData",e}();var bn=function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,r={};Tn(e,this,(function(e){function i(e,t){var r=n[e];return X(r)?t:r}X(n)&&(n={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(n,t,i,o,a){void 0===a&&(a=!1);var s=new wn(t,i,a,o);if(e.enableDebugExceptions())throw s;var u=n===q.CRITICAL?"errorToConsole":"warnToConsole";if(!J(s.message)){var c=e.consoleLoggingLevel();if(a){var l=+s.messageId;!r[l]&&c>=n&&(e[u](s.message),r[l]=!0)}else c>=n&&e[u](s.message);e.logInternalMessage(n,s)}},e.warnToConsole=function(e){xn("warn",e)},e.errorToConsole=function(e){xn("error",e)},e.resetInternalMessageCount=function(){t=0,r={}},e.logInternalMessage=function(n,i){if(!(t>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+i.messageId;if(r[a]?o=!1:r[a]=!0,o&&(n<=e.telemetryLoggingLevel()&&(e.queue.push(i),t++),t===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new wn(W.MessageLimitPerPVExceeded,s,!1);e.queue.push(u),e.warnToConsole(s)}}}}))},In=null,_n=function(){function e(n,t,r){var i,o=this,a=!1;(o.start=Te(),o.name=n,o.isAsync=r,o.isChildEvt=function(){return!1},ee(t))&&(a=Ce(o,"payload",(function(){return!i&&ee(t)&&(i=t(),t=null),i})));o.getCtx=function(n){return n?n===e.ParentContextKey||n===e.ChildrenContextKey?o[n]:(o.ctx||{})[n]:null},o.setCtx=function(n,t){if(n)if(n===e.ParentContextKey)o[n]||(o.isChildEvt=function(){return!0}),o[n]=t;else if(n===e.ChildrenContextKey)o[n]=t;else{(o.ctx=o.ctx||{})[n]=t}},o.complete=function(){var n=0,r=o.getCtx(e.ChildrenContextKey);if(se(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(n+=s.time)}o.time=Te()-o.start,o.exTime=o.time-n,o.complete=function(){},!a&&ee(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Pn=function e(n){this.ctx={},Tn(e,this,(function(e){e.create=function(e,n,t){return new _n(e,n,t)},e.fire=function(e){e&&(e.complete(),n&&ee(n.perfEvent)&&n.perfEvent(e))},e.setCtx=function(n,t){n&&((e.ctx=e.ctx||{})[n]=t)},e.getCtx=function(n){return(e.ctx||{})[n]}}))},En="CoreUtils.doPerf";function kn(e,n,t,r,i){if(e){var o=e;if(ee(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(En);try{if(a=o.create(n(),r,i)){if(s&&a.setCtx&&(a.setCtx(_n.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(_n.ChildrenContextKey);u||(u=[],s.setCtx(_n.ChildrenContextKey,u)),u.push(a)}return o.setCtx(En,a),t(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx(En,s)}}}return t()}
/*
 * Application Insights JavaScript SDK - Core, 2.7.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Fn=function(e,n){var t=this,r=null,i=ee(e.processTelemetry),o=ee(e.setNextPlugin);t._hasRun=!1,t.getPlugin=function(){return e},t.getNext=function(){return r},t.setNext=function(e){r=e},t.processTelemetry=function(a,s){s||(s=n);var u=e?e.identifier:"TelemetryPluginChain";kn(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&i){t._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(t){var n=r&&r._hasRun;r&&n||s.diagLog().throwInternal(q.CRITICAL,W.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Qe(t)),r&&!n&&r.processTelemetry(a,s)}}else r&&(t._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};
/*
 * Application Insights JavaScript SDK - Core, 2.7.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function On(e,n){var t=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&ee(o.processTelemetry)){var a=new Fn(o,n);t.push(a),r&&r.setNext(a),r=a}}return t.length>0?t[0]:null}var Nn=function e(n,t,r,i){var o=this,a=null;null!==i&&(n&&ee(n.getPlugin)?a=function(e,n,t){var r=[],i=!t;if(e)for(;e;){var o=e.getPlugin();(i||o===t)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(t),On(r,n)}(n,o,i||n.getPlugin()):i?a=function(e,n,t){var r=e,i=!1;return t&&e&&(r=[],ve(e,(function(e){(i||e===t)&&(i=!0,r.push(e))}))),t&&!i&&(r||(r=[]),r.push(t)),On(r,n)}(n,o,i):J(i)&&(a=On(n,o))),o.core=function(){return r},o.diagLog=function(){return function(e,n){return(e||{}).logger||new bn(n)}(r,t)},o.getCfg=function(){return t},o.getExtCfg=function(e,n){var r;if(void 0===n&&(n={}),t){var i=t.extensionConfig;i&&e&&(r=i[e])}return r||n},o.getConfig=function(e,n,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!X(a[n])?i=a[n]:t&&!X(t[n])&&(i=t[n]),X(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var n=a;n&&(a=n.getNext(),n.processTelemetry(e,o))},o.createNew=function(n,i){return void 0===n&&(n=null),new e(n||a,t,r,i)}},Mn="extensionConfig",Rn=function(){function e(){var e=this,n=!1,t=null,r=null;e.core=null,e.diagLog=function(n){return e._getTelCtx(n).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(e){n=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,n){n?n.processNext(e):r&&ee(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(n){void 0===n&&(n=null);var i=n;if(!i){var o=t||new Nn(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&Se(i,Mn,[],null,X),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,t=new Nn(s,i,o,u),n=!0}}return e.prototype.initialize=function(e,n,t,r){this._baseTelInit(e,n,t,r)},e}();function Ln(e,n){for(var t=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&ee(r.setNextPlugin)&&ee(o.processTelemetry)&&r.setNextPlugin(o),ee(o.isInitialized)&&o.isInitialized()||t.push(o),r=o,i=i.getNext())}ve(t,(function(t){t.initialize(e.getCfg(),e.core(),n,e.getNext())}))}function An(e){return e.sort((function(e,n){var t=0,r=ee(n.processTelemetry);return ee(e.processTelemetry)?t=r?e.priority-n.priority:1:r&&(t=-1),t}))}
/*
 * Application Insights JavaScript SDK - Core, 2.7.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Dn=500,Bn=function(e){function n(){var t,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){ve(e,(function(e){e.priority<Dn&&be("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,n){return e.priority-n.priority}))),t.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,Tn(n,r,(function(e,n){e.setNextPlugin=function(e){},e.processTelemetry=function(e,n){t&&ve(t,(function(t){t.length>0&&r._getTelCtx(n).createNew(t).processNext(e)}))},e.getChannelControls=function(){return t},e.initialize=function(r,o,a){e.isInitialized()||(n.initialize(r,o,a),function(e,n){t=[],e&&ve(e,(function(e){return i(e)}));if(n){var r=[];ve(n,(function(e){e.priority>Dn&&r.push(e)})),i(r)}}((r||{}).channels,a),ve(t,(function(e){return Ln(new Nn(e,r,o),a)})))}})),r}var t;return V(n,e),n._staticInit=(Ce(t=n.prototype,"ChannelControls",t.getChannelControls),void Ce(t,"channelQueue",t.getChannelControls)),n}(Rn),zn="toGMTString",Kn="toUTCString",qn="expires",Un="",Hn=null,Vn=null,jn=null,Wn=ze(),Qn={},Gn={};function Jn(e){return!e||e.isEnabled()}function Xn(e,n){var t=function(e){var n=e.cookieCfg=e.cookieCfg||{};if(Se(n,"domain",e.cookieDomain,Z,X),Se(n,"path",e.cookiePath||"/",null,X),X(n.enabled)){var t=void 0;J(e.isCookieUseDisabled)||(t=!e.isCookieUseDisabled),J(e.disableCookiesUsage)||(t=!e.disableCookiesUsage),n.enabled=t}return n}(e||Gn),r=t.path||"/",i=t.domain,o=!1!==t.enabled,a={isEnabled:function(){var e=o&&Zn(n),t=Gn._ckMgr;return e&&t&&a!==t&&(e=Jn(t)),e},setEnabled:function(e){o=!1!==e},set:function(e,n,o,s,u){var c=!1;if(Jn(a)){var l={},f=he(n||Un),d=f.indexOf(";");if(-1!==d&&(f=he(n.substring(0,d)),l=$n(n.substring(d+1))),Se(l,"domain",s||i,we,J),!X(o)){var v=We();if(J(l.expires)){var p=Te()+1e3*o;if(p>0){var h=new Date;h.setTime(p),Se(l,qn,Yn(h,v?zn:Kn)||Yn(h,v?zn:Kn)||Un,we)}}v||Se(l,"max-age",Un+o,null,J)}var g=Ue();g&&"https:"===g.protocol&&(Se(l,"secure",null,null,J),null===Vn&&(Vn=!rt((qe()||{}).userAgent)),Vn&&Se(l,"SameSite","None",null,J)),Se(l,"path",u||r,null,J),(t.setCookie||tt)(e,et(f,l)),c=!0}return c},get:function(e){var n=Un;return Jn(a)&&(n=(t.getCookie||nt)(e)),n},del:function(e,n){var t=!1;return Jn(a)&&(t=a.purge(e,n)),t},purge:function(e,r){var i,o=!1;if(Zn(n)){var a=((i={}).path=r||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);We()||(a["max-age"]="0"),(t.delCookie||tt)(e,et(Un,a)),o=!0}return o}};return a._ckMgr=a,a}function Zn(e){if(null===Hn){Hn=!1;try{Hn=void 0!==(Wn||{}).cookie}catch(t){e&&e.throwInternal(q.WARNING,W.CannotAccessCookie,"Cannot access document.cookie - "+(ue(n=t)?n.name:""),{exception:Qe(t)})}}var n;return Hn}function $n(e){var n={};e&&e.length&&ve(he(e).split(";"),(function(e){if(e=he(e||Un)){var t=e.indexOf("=");-1===t?n[e]=null:n[he(e.substring(0,t))]=he(e.substring(t+1))}}));return n}function Yn(e,n){return ee(e[n])?e[n]():null}function et(e,n){var t=e||Un;return te(n,(function(e,n){t+="; "+e+(X(n)?Un:"="+n)})),t}function nt(e){var n=Un;if(Wn){var t=Wn.cookie||Un;jn!==t&&(Qn=$n(t),jn=t),n=he(Qn[e]||Un)}return n}function tt(e,n){Wn&&(Wn.cookie=e+"="+n)}function rt(e){return!!ce(e)&&(!(!oe(e,"CPU iPhone OS 12")&&!oe(e,"iPad; CPU OS 12"))||(!!(oe(e,"Macintosh; Intel Mac OS X 10_14")&&oe(e,"Version/")&&oe(e,"Safari"))||(!(!oe(e,"Macintosh; Intel Mac OS X 10_14")||!re(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!oe(e,"Chrome/5")&&!oe(e,"Chrome/6"))||(!(!oe(e,"UnrealEngine")||oe(e,"Chrome"))||!(!oe(e,"UCBrowser/12")&&!oe(e,"UCBrowser/11")))))))}function it(e,n){return new Pn(n)}var ot=0,at=1,st=2,ut=4,ct=5,lt=function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;Tn(e,this,(function(e){e.addNotificationListener=function(n){e.listeners.push(n)},e.removeNotificationListener=function(n){for(var t=pe(e.listeners,n);t>-1;)e.listeners.splice(t,1),t=pe(e.listeners,n)},e.eventsSent=function(n){ve(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(n)}),0)}))},e.eventsDiscarded=function(n,t){ve(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(n,t)}),0)}))},e.eventsSendRequest=function(n,t){ve(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(t)setTimeout((function(){return e.eventsSendRequest(n,t)}),0);else try{e.eventsSendRequest(n,t)}catch(e){}}))},e.perfEvent=function(n){n&&(!t&&n.isChildEvt()||ve(e.listeners,(function(e){if(e&&e.perfEvent)if(n.isAsync)setTimeout((function(){return e.perfEvent(n)}),0);else try{e.perfEvent(n)}catch(e){}})))}}))},ft=function(e){function n(){var t=e.call(this)||this,r=0;return Tn(n,t,(function(e,n){function t(n){var t=e.getNotifyMgr();t&&t.eventsDiscarded([n],st)}e.initialize=function(e,t,r,i){n.initialize(e,t,r||new bn(e),i||new lt(e))},e.track=function(r){kn(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(t(r),be("Invalid telemetry item")),function(e){if(X(e.name))throw t(e),Error("telemetry name required")}(r),n.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.addNotificationListener(n)},e.removeNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.removeNotificationListener(n)},e.pollInternalLogs=function(n){var t=e.config.diagnosticLogInterval;return t&&t>0||(t=1e4),r&&e.stopPollingInternalLogs(),r=setInterval((function(){var t=e.logger?e.logger.queue:[];ve(t,(function(t){var r={name:n||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:de(new Date),baseType:wn.dataType,baseData:{message:t.message}};e.track(r)})),t.length=0}),t)},e.stopPollingInternalLogs=function(){r&&(clearInterval(r),r=0)}})),t}return V(n,e),n}((function e(){var n,t,r,i,o,a=!1;Tn(e,this,(function(e){e._extensions=new Array,t=new Bn,e.logger=new bn({loggingLevelConsole:q.CRITICAL}),n=[],e.isInitialized=function(){return a},e.initialize=function(n,i,o,s){var u,c,l,f;e.isInitialized()&&be("Core should not be initialized more than once"),n&&!X(n.instrumentationKey)||be("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=n||{},e.config.enablePerfMgr&&Se(e.config,"createPerfMgr",it),n.extensions=X(n.extensions)?[]:n.extensions,(c=Mn,(u=n)?!(f=u[c])&&X(f)&&(f=J(l)?{}:l,u[c]=f):f=J(l)?{}:l,f).NotificationManager=s,o&&(e.logger=o);var d=[];d.push.apply(d,j(j([],i),n.extensions)),d=An(d);var v=[],p=[],h={};ve(d,(function(e){(X(e)||X(e.initialize))&&be("Extensions must provide callback to initialize");var n=e.priority,r=e.identifier;e&&n&&(X(h[n])?h[n]=r:o.warnToConsole("Two extensions have same priority #"+n+" - "+h[n]+", "+r)),!n||n<t.priority?v.push(e):p.push(e)})),d.push(t),v.push(t),d=An(d),e._extensions=d,Ln(new Nn([t],n,e),d),Ln(new Nn(v,n,e),d),e._extensions=v,0===e.getTransmissionControls().length&&be("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return t.getChannelControls()},e.track=function(t){Se(t,"iKey",e.config.instrumentationKey,null,xe),Se(t,"time",de(new Date),null,xe),Se(t,"ver","4.0",null,X),e.isInitialized()?e.getProcessTelContext().processNext(t):n.push(t)},e.getProcessTelContext=function(){var n=e._extensions,r=n;return n&&0!==n.length||(r=[t]),new Nn(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=K({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,n){},eventsSendRequest:function(e,n){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return o||(o=Xn(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&ee(e.config.createPerfMgr)&&(i=e.config.createPerfMgr(e,e.getNotifyMgr())),i||In},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){n.length>0&&(ve(n,(function(n){e.getProcessTelContext().processNext(n)})),n=[])}}))})),dt=0,vt=13,pt=32,ht=1,gt=2,yt=3,mt=4,Ct=0,Tt=1,St=6,xt=7,wt=U(U({},W),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),bt=4294967296,It=4294967295,_t=!1,Pt=123456789,Et=987654321;function kt(e){e<0&&(e>>>=0),Pt=123456789+e&It,Et=987654321-e&It,_t=!0}function Ft(){try{var e=2147483647&Te();kt((Math.random()*bt^e)+e)}catch(e){}}function Ot(e){return e>0?Math.floor(Nt()/It*(e+1))>>>0:0}function Nt(e){var n,t=Ae("crypto")||Ae("msCrypto");return t&&t.getRandomValues?n=t.getRandomValues(new Uint32Array(1))[0]&It:We()?(_t||Ft(),n=Mt()&It):n=Math.floor(bt*Math.random()|0),e||(n>>>=0),n}function Mt(e){var n=((Et=36969*(65535&Et)+(Et>>16)&It)<<16)+(65535&(Pt=18e3*(65535&Pt)+(Pt>>16)&It))>>>0&It|0;return e||(n>>>=0),n}
/*
 * Application Insights JavaScript SDK - Core, 2.7.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Rt="visibilitychange",Lt="pagehide",At="pageshow";function Dt(e,n){var t=!1,r=Be();r&&(t=ne(r,e,n),t=ne(r.body,e,n)||t);var i=ze();return i&&(t=ne(i,e,n)||t),t}function Bt(e,n,t){var r=!1;if(n&&e&&se(e)){var i=[];ve(e,(function(e){ce(e)&&(t&&-1!==pe(t,e)?i.push(e):r=Dt(e,n)||r)})),!r&&i.length>0&&(r=Bt(i,n))}return r}function zt(e,n){return Bt(["beforeunload","unload","pagehide"],e,n)}function Kt(e,n){var t=!1;return n&&-1!==pe(n,Lt)||(t=Dt(Lt,e)),n&&-1!==pe(n,Rt)||(t=Dt(Rt,(function(n){var t=ze();e&&t&&"hidden"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=Kt(e)),t}function qt(e,n){var t=!1;return n&&-1!==pe(n,At)||(t=Dt(At,e)),n&&-1!==pe(n,Rt)||(t=Dt(Rt,(function(n){var t=ze();e&&t&&"visible"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=qt(e)),t}function Ut(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(jt,(function(e){var n=0|Ot(15);return("x"===e?n:3&n|8).toString(16)}))}function Ht(){var e=Ae("performance");return e&&e.now?e.now():Te()}var Vt,jt=/[xy]/g;
/**
 * Utils.ts
 * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 * File containing utility functions.
 */
var Wt="1DS-Web-JS-3.1.9",Qt="withCredentials",Gt=((Vt={})[0]=Ct,Vt[2]=St,Vt[1]=Tt,Vt[3]=xt,Vt[4098]=St,Vt[4097]=Tt,Vt[4099]=xt,Vt),Jt=(Boolean(ze()),Boolean(Be()));function Xt(e){return!(""===e||X(e))}function Zt(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function $t(e){return!!(e&&le(e)&&e>=ht&&e<=mt)}function Yt(e,n,t){if(!n&&!Xt(n)||"string"!=typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||se(n))n={value:n};else if("object"!==r||n.hasOwnProperty("value")){if(X(n.value)||""===n.value||!ce(n.value)&&!le(n.value)&&!fe(n.value)&&!se(n.value))return null}else n={value:t?JSON.stringify(n):n};if(se(n.value)&&!or(n.value))return null;if(!X(n.kind)){if(se(n.value)||!ir(n.kind))return null;n.value=n.value.toString()}return n}function er(e,n,t){var r=-1;if(!J(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(t))-1===r&&(r=0),r|=t;else{var i=Gt[sr(e)]||-1;-1!==r&&-1!==i?r|=i:i===St&&(r=i)}return r}function nr(e){void 0===e&&(e="D");var n=Ut();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,"")),n}function tr(e,n,t,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object.prototype,l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){te(e=l[s],(function(e,n){a&&n&&Y(n)?se(n)?(o[e]=o[e]||[],ve(n,(function(n,t){n&&Y(n)?o[e][t]=tr(!0,o[e][t],n):o[e][t]=n}))):o[e]=tr(!0,o[e],n):o[e]=n}))}return o}var rr=Ht;function ir(e){return e===dt||e>dt&&e<=vt||e===pt}function or(e){return e.length>0}function ar(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=rr()}function sr(e){var n=0;if(null!=e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===F&&(n=4,se(e)?(n=4096,e.length>0&&(n|=sr(e[0]))):$(e,"value")&&(n=8192|sr(e.value)))}return n}
/*
 * 1DS JS SDK Core, 3.1.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
 * AppInsightsCore.ts
 * @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 */
var ur=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",Tn(n,t,(function(e,n){e.logger&&e.logger.queue||(e.logger=new bn({loggingLevelConsole:q.CRITICAL})),e.initialize=function(t,r,i,o){kn(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=t.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");t.channels&&ve(t.channels,(function(n){n&&ve(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&ve(r,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,r,i,o),e.pollInternalLogs("InternalLog")}catch(n){var s=e.logger,u=Qe(n);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),s.throwInternal(q.CRITICAL,wt.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:t,extensions:r,logger:i,notificationManager:o}}))},e.track=function(t){kn(e,(function(){return"AppInsightsCore.track"}),(function(){var r=t;if(r){r.timings=r.timings||{},r.timings.trackStart=rr(),$t(r.latency)||(r.latency=ht);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=Wt;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}n.track(r)}),(function(){return{item:t}}),!t.sync)}})),t}return V(n,e),n}(ft),cr=ur,lr="function",fr="undefined",dr=Object,vr=dr.prototype,pr=(dr.assign,dr.create);dr.defineProperty,vr.hasOwnProperty;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
function hr(){return typeof globalThis!==fr&&globalThis?globalThis:typeof self!==fr&&self?self:typeof window!==fr&&window?window:typeof t.g!==fr&&t.g?t.g:null}function gr(e){throw new TypeError(e)}
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
(hr()||{}).Symbol,(hr()||{}).Reflect;var yr=function(e,n){return yr=dr.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},yr(e,n)};function mr(e,n){function t(){this.constructor=e}typeof n!==lr&&null!==n&&gr("Class extends value "+String(n)+" is not a constructor or null"),yr(e,n),e.prototype=null===n?function(e){if(pr)return pr(e);if(null==e)return{};var n=typeof e;function t(){}return"object"!==n&&n!==lr&&gr("Object prototype may only be an Object:"+e),t.prototype=e,new t}(n):(t.prototype=n.prototype,new t)}
/*
 * 1DS JS SDK POST plugin, 3.1.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
var Cr="REAL_TIME",Tr=function(){function e(n,t){var r=t?[].concat(t):[],i=this;i.iKey=function(){return n},i.count=function(){return r.length},i.events=function(){return r},i.addEvents=function(e,n){return void 0===n&&(n=!0),e&&e.length>0?(r=n?r.concat(e):e.concat(r),e.length):0},i.split=function(t,i){var o=new e(n);if(t<r.length){var a=r.length-t;X(i)||(a=i<a?i:a),o.addEvents(r.splice(t,a),!0)}return o}}return e.create=function(n,t){return new e(n,t)},e}(),Sr="constructor",xr="prototype",wr="function",br="_dynClass",Ir="_unknown_",_r=Object,Pr=_r.getPrototypeOf,Er=0;function kr(e,n){return e&&_r.prototype.hasOwnProperty.call(e,n)}function Fr(e){return e&&(e===_r.prototype||e===Array.prototype)}function Or(e){return Fr(e)||e===Function.prototype}function Nr(e){if(e){if(Pr)return Pr(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(n)return n}return null}function Mr(e,n){var t=[],r=_r.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&kr(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function Rr(e,n,t){return n!==Sr&&typeof e[n]===wr&&(t||kr(e,n))}function Lr(e){throw new TypeError("DynamicProto: "+e)}function Ar(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function Dr(e,n,t,r){var i=null;if(e&&kr(t,br)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||Lr("Missing ["+n+"] "+wr),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!kr(e,n),s=Nr(e),u=[];a&&s&&!Or(s)&&!Ar(u,s);){var c=s[n];if(c){a=c===r;break}u.push(s),s=Nr(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function Br(e,n,t){var r=n[e];return r===t&&(r=Nr(n)[e]),typeof r!==wr&&Lr("["+e+"] is not a "+wr),r}function zr(e,n,t,r,i){if(!Fr(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),Mr(t,(function(n){Rr(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!kr(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(Dr(this,n,e,t)||Br(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function Kr(e,n){return kr(e,xr)?e.name||n||Ir:((e||{}).constructor||{}).name||n||Ir}function qr(e,n,t,r){kr(e,xr)||Lr("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){if(Pr)for(var t=[],r=Nr(n);r&&!Or(r)&&!Ar(t,r);){if(r===e)return!0;t.push(r),r=Nr(r)}return!1})(i,n)||Lr("["+Kr(e)+"] is not in class hierarchy of ["+Kr(n)+"]");var o=null;kr(i,br)?o=i._dynClass:(o="_dynCls$"+Kr(e,"_")+"$"+Er,Er++,i._dynClass=o);var a=qr._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return Mr(e,(function(t){!n[t]&&Rr(e,t,!1)&&(n[t]=e[t])})),n}(n),c=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};Mr(t,(function(e){o[e]=i(n,t,e)}));for(var a=Nr(e),s=[];a&&!Or(a)&&!Ar(s,a);)Mr(a,(function(e){!o[e]&&Rr(a,e,!Pr)&&(o[e]=i(n,a,e))})),s.push(a),a=Nr(a);return o}(i,n,u,s);t(n,c);var l=!!Pr&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),zr(i,o,n,u,!1!==l)}qr._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Ur=qr,Hr=2e6,Vr=Math.min(Hr,65e3),jr=/\./,Wr=function e(n,t,r,i){var o="data",a="baseData",s=!!i,u=t,c={};Ur(e,this,(function(e){function t(e,n,i,o,a,l,f){te(e,(function(e,d){var v=null;if(d||Xt(d)){var p=i,h=e,g=a,y=n;if(s&&!o&&jr.test(e)){var m=e.split("."),C=m.length;if(C>1){g&&(g=g.slice());for(var T=0;T<C-1;T++){var S=m[T];y=y[S]=y[S]||{},p+="."+S,g&&g.push(S)}h=m[C-1]}}var x=o&&function(e,n){var t=c[e];return void 0===t&&(e.length>=7&&(t=ie(e,"ext.metadata")||ie(e,"ext.web")),c[e]=t),t}(p);if(v=!x&&u&&u.handleField(p,h)?u.value(p,h,d,r):Yt(h,d,r)){var w=v.value;if(y[h]=w,l&&l(g,h,v),f&&"object"==typeof w&&!se(w)){var b=g;b&&(b=b.slice()).push(h),t(d,w,p+"."+h,o,b,l,f)}}}}))}e.createPayload=function(e,n,t,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&kn(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,u=[],c=[],l=t.isBeacon,f=l?65e3:3984588,d=l?Vr:Hr,v=0,p=0;v<n.length;){var h=n[v];if(h){if(a>=i){t.overflow=r.split(v);break}var g=e.getEventBlob(h);if(g&&g.length<=d){var y=g.length;if(o.length+y>f){t.overflow=r.split(v);break}o&&(o+="\n"),o+=g,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else g?u.push(h):c.push(h),n.splice(v,1),v--}v++}if(u&&u.length>0&&t.sizeExceed.push(Tr.create(r.iKey(),u)),c&&c.length>0&&t.failedEvts.push(Tr.create(r.iKey(),c)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var m=r.iKey();-1===pe(t.apiKeys,m)&&t.apiKeys.push(m)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return kn(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+Zt(e.iKey);var r={},i=e.ext;i&&(n.ext=r,te(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var s=n.data={};s.baseType=e.baseType;var u=s.baseData={};return t(e.baseData,u,a,!1,[a],(function(e,n,t){Qr(r,e,n,t)}),!0),t(e.data,s,o,!1,[],(function(e,n,t){Qr(r,e,n,t)}),!0),JSON.stringify(n)}),(function(){return{item:e}}))}catch(e){return null}}}))};function Qr(e,n,t,r){if(r&&e){var i=er(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),n)for(var s=0;s<n.length;s++){var u=n[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[t]={},se(r.value)?a.a={t:i}:a.t=i}}}
/*
 * 1DS JS SDK POST plugin, 3.1.9
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var Gr,Jr=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}(),Xr=function e(){var n={};Ur(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(a=e.split(","),s=[],a&&ve(a,(function(e){s.push(he(e))})),s);if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),o=0;o<r.length;++o)n[r[o]]=Te()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var t=n,r=he(e);return void 0!==t[r]&&t[r]>Te()||(delete t[r],!1)}}))},Zr=function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;Ur(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}}))},$r="POST",Yr="drop",ei="send",ni="requeue",ti="rspFail",ri="application/x-json-stream",ii="cache-control",oi="content-type",ai="kill-duration",si="time-delta-millis",ui=((Gr={})[1]=ni,Gr[100]=ni,Gr[200]="sent",Gr[8004]=Yr,Gr[8003]=Yr,Gr);function ci(e){try{return e.responseText}catch(e){}return""}function li(e,n){var t=!1;if(e&&n){var r=me(e);if(r&&r.length>0)for(var i=n.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&$(n,a)&&a.toLowerCase()===i){t=!0;break}}}return t}var fi=function e(n,t,r,i){this._responseHandlers=[];var o,a,s,u,c="?cors=true&"+oi.toLowerCase()+"="+ri+"&client-id=NO_AUTH&client-version="+Wt,l=new Xr,f=!1,d=new Zr,v=!1,p=0,h=!0,g=[],y={},m=[],C=null,T=!1,S=!1;Ur(e,this,(function(e){var x=!0;function w(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?Xe()?r=b:Ze()&&(r=_):2===t&&Je(n)?r=I:v&&3===t&&Ge()&&(r=E),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function b(e,n,t){var r=new XDomainRequest;r.open($r,e.urlString),r.onload=function(){var e=ci(r);P(n,200,{},e),U(e)},r.onerror=function(){P(n,400,{})},r.ontimeout=function(){P(n,500,{})},r.onprogress=function(){},t?r.send(e.data):o._setTimeoutOverride((function(){r.send(e.data)}),0)}function I(e,n,t){var r,i=((r={body:e.data,method:$r}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);t&&(i.keepalive=!0),x&&(i.credentials="include"),e.headers&&me(e.headers).length>0&&(i.headers=e.headers),fetch(e.urlString,i).then((function(e){var t={},r="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),P(n,e.status,t,r),U(r)})).catch((function(e){P(n,0,{})}))}function _(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=he(r))}return e}function i(e){var n,t,i={};return e.getAllResponseHeaders?(n=e.getAllResponseHeaders(),t={},ce(n)&&ve(he(n).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=he(e.substring(0,n)).toLowerCase(),i=he(e.substring(n+1));t[r]=i}else t[he(e)]=1}})),i=t):(i=r(i,e,si),i=r(i,e,ai),i=r(i,e,"kill-duration-seconds")),i}function o(e,t){P(n,e.status,i(e),t)}var a=function(e,n,t,r,i){function o(e,n,t){try{e[n]=t}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return r&&o(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),t&&o(a,Qt,t),a.open(e,n,!i),t&&o(a,Qt,t),a}($r,e.urlString,x,!0,t);te(e.headers,(function(e,n){a.setRequestHeader(e,n)})),a.onload=function(){var e=ci(a);o(a,e),U(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function P(e,n,t,r){try{e(n,t,r)}catch(e){o.diagLog().throwInternal(q.WARNING,wt.SendPostOnCompleteFailure,Qe(e))}}function E(e,n,t){var r=200,i=e._thePayload;try{var a=qe();if(!a.sendBeacon(e.urlString,e.data))if(i){var s=[];ve(i.batches,(function(n){if(s&&n&&n.count()>0){for(var t=n.events(),r=0;r<t.length;r++)if(!a.sendBeacon(e.urlString,C.getEventBlob(t[r]))){s.push(n.split(r));break}}else s.push(n.split(0))})),H(s,8003,i.sendType,!0)}else r=0}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),r=0}finally{P(n,r,{},"")}}function k(e){return 2===e||3===e}function F(e){return S&&k(e)&&(e=2),e}function N(){return!f&&p<t}function M(){var e=m;return m=[],e}function R(e,n,t){var r=!1;return e&&e.length>0&&!f&&a[n]&&C&&(r=0!==n||N()&&(t>0||d.allowRequestSending())),r}function L(e){var n={};return e&&ve(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function A(e,t,r,i,u){if(e&&0!==e.length)if(f)H(e,1,i);else{i=F(i);try{var c=e,d=0!==i;kn(s,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],c=null,f=rr(),p=a[i]||(d?a[1]:a[0]),g=(S||k(i)||p&&3===p._transport)&&!h&&v&&Ge();R(e,i,t);){var y=e.shift();y&&y.count()>0&&(l.isTenantKilled(y.iKey())?s.push(y):(c=c||C.createPayload(t,r,d,g,u,i),C.appendPayload(c,y,n)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,z(c,f,rr(),u),f=rr(),c=null):(z(c,f,rr(),u),f=rr(),e=[y].concat(e),c=null)))}c&&z(c,f,rr(),u),e.length>0&&(m=e.concat(m)),H(s,8004,i)}),(function(){return{batches:L(c),retryCount:t,isTeardown:r,isSynchronous:d,sendReason:u,useSendBeacon:k(i),sendType:i}}),!d)}catch(e){o.diagLog().throwInternal(q.WARNING,wt.CannotSerializeObject,"Unexpected Exception sending batch: "+Qe(e))}}}function D(e){var n=c,t="";ve(e.apiKeys,(function(e){t.length>0&&(t+=","),t+=e})),t.length>0&&(n+="&apikey="+t),n+="&upload-time="+Te().toString();var r=function(e){for(var n=0;n<e.batches.length;n++)for(var t=e.batches[n].events(),r=0;r<t.length;r++){var i=(t[r].ext||{}).intweb||{};if(Xt(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(Xt(r)&&(n=n+"&ext.intweb.msfpc="+r),d.shouldAddClockSkewHeaders()&&(n+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),s.getWParam){var i=s.getWParam();i>=0&&(n+="&w="+i)}for(var o=0;o<g.length;o++)n+="&"+g[o].name+"="+g[o].value;return n}function B(e,n,t){e[n]=e[n]||{},e[n][o.identifier]=t}function z(n,t,i,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var c=D(n),f=rr();kn(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var v=0;v<n.batches.length;v++)for(var g=n.batches[v].events(),m=0;m<g.length;m++){var C=g[m];if(T){var x=C.timings=C.timings||{};B(x,"sendEventStart",f),B(x,"serializationStart",t),B(x,"serializationCompleted",i)}C.sendAttempt>0?C.sendAttempt++:C.sendAttempt=1}H(n.batches,1e3+(u||0),n.sendType,!0);var w={data:n.payloadBlob,urlString:c,headers:tr({},y),_thePayload:n,_sendReason:u};li(w.headers,ii)||(w.headers[ii]="no-cache, no-store"),li(w.headers,oi)||(w.headers["content-type"]=ri);var b=null,I=!!e.sendHook,_=a[n.sendType];!k(n.sendType)&&n.isBeacon&&2===n.sendReason&&(_=a[2]||a[3]||_),_&&(b=function(t){d.firstRequestSent();var i=function(t,i){!function(n,t,i,a){var s=9e3,u=null,c=!1,f=!1;try{var v=!0;if(typeof n!==O){if(t){d.setClockSkew(t[si]);var h=t["kill-duration"]||t["kill-duration-seconds"];ve(l.setKillSwitchTenants(t["kill-tokens"],h),(function(e){ve(i.batches,(function(n){if(n.iKey()===e){u=u||[];var t=n.split(0);i.numEvents-=t.count(),u.push(t)}}))}))}if(200==n)return void(s=200);(!Jr.shouldRetryForStatus(n)||i.numEvents<=0)&&(v=!1),s=9e3+n%1e3}if(v){s=100;var g=i.retryCnt;0===i.sendType&&(g<r?(c=!0,K((function(){0===i.sendType&&p--,A(i.batches,g+1,i.isTeardown,S?2:i.sendType,5)}),S,Jr.getMillisToBackoffForRetry(g))):f=!0)}}finally{c||(d.setClockSkew(),function(n,t,r,i){try{i&&o._backOffTransmission(),200===t&&(i||n.isSync||o._clearBackOff(),function(e){if(T){var n=rr();ve(e,(function(e){e&&e.count()>0&&function(e,n){T&&ve(e,(function(e){B(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),H(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(p--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(i,s,a,f)),H(u,8004,i.sendType)}}(t,i,n,u)},a=n.isTeardown||n.isSync;try{_.sendPOST(t,i,a),e.sendListener&&e.sendListener(w,t,a,n.isBeacon)}catch(e){o.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+Qe(e)),P(i,0,{})}}),kn(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(b)if(0===n.sendType&&p++,I&&!n.isBeacon&&3!==_._transport){var t={data:w.data,urlString:w.urlString,headers:tr({},w.headers)},r=!1;kn(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,h||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),b(e)}),n.isSync||n.isTeardown)}catch(e){r||b(w)}}))}else b(w)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:u}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&H(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&H(n.failedEvts,8002,n.sendType)}function K(e,n,t){n?e():o._setTimeoutOverride(e,t)}function U(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){o.diagLog().throwInternal(q.CRITICAL,wt.PostResponseHandler,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);Xt(i.webResult)&&Xt(i.webResult.msfpc)&&u.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function H(e,n,t,r){if(e&&e.length>0&&i){var a=i[(c=n,l=ui[c],Xt(l)||(l="oth",c>=9e3&&c<=9999?l=ti:c>=8e3&&c<=8999?l=Yr:c>=1e3&&c<=1999&&(l=ei)),l)];if(a){var u=0!==t;kn(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){K((function(){try{a.call(i,e,n,u,t)}catch(e){o.diagLog().throwInternal(q.CRITICAL,wt.NotificationException,"send request notification failed: "+e)}}),r||u,0)}),(function(){return{batches:L(e),reason:n,isSync:u,sendSync:r,sendType:t}}),!u)}}var c,l}e.initialize=function(e,n,t,r,i){var l;i||(i={}),c=e+c,s=n,u=n.getCookieMgr(),T=!s.config.disableEventTimings;var f=!!s.config.enableCompoundKey;o=t;var d=i.valueSanitizer,p=i.stringifyObjects;J(i.enableCompoundKey)||(f=!!i.enableCompoundKey),v=!je(),C=new Wr(s,d,p,f);var g=r;if(!r){h=!1;var y=Ue();y&&y.protocol&&"file:"===y.protocol.toLowerCase()&&(x=!1);var m=[];m=je()?[2,1]:[1,2,3];var S=i.transports;S&&(le(S)?m=[S].concat(m):se(S)&&(m=S.concat(m))),r=w(m,!1),g=w(m,!0),r||o.diagLog().warnToConsole("No available transport to send events")}(l={})[0]=r,l[1]=g||w([1,2,3],!0),l[2]=w([3,2,1],!0)||g,l[3]=w([2,3,1],!0)||g,a=l},e._getDbgPlgTargets=function(){return[a[0],l,C,a]},e.addQueryStringParameter=function(e,n){for(var t=0;t<g.length;t++)if(g[t].name===e)return void(g[t].value=n);g.push({name:e,value:n})},e.addHeader=function(e,n){y[e]=n},e.canSendRequest=function(){return N()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,n){J(e)&&(e=0),S&&(e=F(e),n=2),R(m,e,0)&&A(M(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!f&&0===p&&0===m.length},e.setUnloading=function(e){S=e},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&A(M(),0,!0,2,2)},e.pause=function(){f=!0},e.resume=function(){f=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&(X(n)&&(n=1),S&&(n=F(n),t=2),A([e],0,!1,n,t||0))}}))},di=fi,vi=Jt?window:void 0,pi="eventsDiscarded",hi=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.9";var i,o,a,s,u,c=!1,l=[],f=null,d=!1,v=0,p=500,h=0,g=1e4,y={},m=Cr,C=null,T=null,S=0,x=0,w={},b=-1,I=!0,_=!1;return Ur(n,r,(function(e,n){function r(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=ht),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,I&&(e.ext=Ie(e.ext),e.baseData&&(e.baseData=Ie(e.baseData)),e.data&&(e.data=Ie(e.data))),e.sync)if(S||d)e.latency=yt,e.sync=!1;else if(o)return I&&(e=Ie(e)),void o.sendSynchronousBatch(Tr.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=h,i=g;t===mt&&(r=v,i=p);var a=!1;if(r<i)a=!L(e,n);else{var s=ht,u=20;t===mt&&(s=mt,u=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=M(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return t===mt?v-=a:h-=a,V(pi,[o],ct),!0}t++}return A(),!1}(e.iKey,e.latency,s,u)&&(a=!L(e,n))}a&&H(pi,[e],ct)}function P(e,n,t){var r=D(e,n,t);return o.sendQueuedRequests(n,t),r}function E(){return h>0}function k(){if(b>=0&&D(b,0,u)&&o.sendQueuedRequests(0,u),v>0&&!T&&!d){var e=y[m][2];e>=0&&(T=F((function(){T=null,P(mt,0,1),k()}),e))}var n=y[m][1];!C&&!f&&n>=0&&!d&&(E()?C=F((function(){C=null,P(0===x?yt:ht,0,1),x++,x%=2,k()}),n):x=0)}function F(n,t){0===t&&S&&(t=1);var r=1e3;return S&&(r=Jr.getMillisToBackoffForRetry(S-1)),e._setTimeoutOverride(n,t*r)}function O(){null!==C&&(e._clearTimeoutOverride(C),C=null,x=0)}function N(n,t){O(),f&&(e._clearTimeoutOverride(f),f=null),d||P(ht,n,t)}function M(e,n,t){var r=w[n];r||(r=w[n=ht]);var i=r.iKeyMap[e];return!i&&t&&(i=Tr.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function R(n,t){o.canSendRequest()&&!S&&(a>0&&h>a&&(t=!0),t&&null==f&&e.flush(n,null,20))}function L(e,n){I&&(e=Ie(e));var t=e.latency,r=M(e.iKey,t,!0);return!!r.addEvents([e],n)&&(t!==mt?(h++,n&&0===e.sendAttempt&&R(!e.sync,s>0&&r.count()>=s)):v++,!0)}function A(){for(var e=0,n=0,t=function(t){var r=w[t];r&&r.batches&&ve(r.batches,(function(r){t===mt?e+=r.count():n+=r.count()}))},r=ht;r<=mt;r++)t(r);h=n,v=e}function D(n,t,r){var i=!1,a=0===t;return!a||o.canSendRequest()?kn(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=mt;t>=n;){var r=w[t];r&&r.batches&&r.batches.length>0&&(ve(r.batches,(function(n){o.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),t===mt?v-=n.count():h-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&H(pi,e,ut),i&&b>=n&&(b=-1,u=0)}),(function(){return{latency:n,sendType:t,sendReason:r}}),!a):(b=b>=0?Math.min(b,n):n,u=Math.max(u,r)),i}function B(e,n){P(ht,0,n),z((function(){e&&e(),l.length>0?f=F((function(){return B(l.shift(),n)}),0):(f=null,E()&&k())}))}function z(e){o.isCompletelyIdle()?e():f=F((function(){z(e)}),.25)}function K(){(y={}).REAL_TIME=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function U(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){e.diagLog().throwInternal(q.CRITICAL,wt.NotificationException,n+" notification failed: "+t)}}function H(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&U(e,[n].concat(t))}function V(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&ve(n,(function(n){n&&n.count()>0&&U(e,[n.events()].concat(t))}))}function j(){s=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}K(),w[mt]={batches:[],iKeyMap:{}},w[yt]={batches:[],iKeyMap:{}},w[gt]={batches:[],iKeyMap:{}},w[ht]={batches:[],iKeyMap:{}},j(),o=new di(500,2,1,{requeue:function(n,t){var i=[];ve(n,(function(n){n&&n.count()>0&&ve(n.events(),(function(n){n&&(n.sync&&(n.latency=mt,n.sync=!1),n.sendAttempt<6?(ar(n,e.identifier),r(n,!1)):i.push(n))}))})),i.length>0&&H(pi,i,at);_&&N(2,2)},send:function(e,n,t){e&&e.length>0&&U("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){V("eventsSent",e,n),k()},drop:function(e,n){V(pi,e,n>=8e3&&n<=8999?n-8e3:ot)},rspFail:function(e){V(pi,e,at),k()},oth:function(e,n){V(pi,e,ot),k()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,u){kn(s,(function(){return"PostChannel:initialize"}),(function(){var c=s;n.initialize(r,s,u),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},t=l.getExtCfg(e.identifier),e._setTimeoutOverride=t.setTimeoutOverride?t.setTimeoutOverride:setTimeout.bind(vi),e._clearTimeoutOverride=t.clearTimeoutOverride?t.clearTimeoutOverride:clearTimeout.bind(vi),I=!t.disableOptimizeObj&&!!Ae("chrome");var f=c.getWParam;c.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},t.eventsLimitInMem>0&&(g=t.eventsLimitInMem),t.immediateEventLimit>0&&(p=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(a=t.autoFlushEventsLimit),j(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(i=t.httpXHROverride),Xt(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=t.payloadPreprocessor,o.sendListener=t.payloadListener;var d=t.overrideEndpointUrl?t.overrideEndpointUrl:r.endpointUrl;function v(e){"beforeunload"!==(e||Be().event).type&&(_=!0,o.setUnloading(_)),N(2,2)}e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(d,e.core,e,i,t);var h=r.disablePageUnloadEvents||[];zt(v,h),Kt(v,h),qt((function(e){_=!1,o.setUnloading(_)}),r.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:u}}))},e.processTelemetry=function(n,i){ar(n,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!t.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=n;a||c||(t.overrideInstrumentationKey&&(s.iKey=t.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),_?N(2,2):k()),e.processNext(s,i)},e.setEventQueueLimits=function(e,n){g=e>0?e:1e4,a=n>0?n:0,j();var t=h>e;if(!t&&s>0)for(var r=ht;!t&&r<=yt;r++){var i=w[r];i&&i.batches&&ve(i.batches,(function(e){e&&e.count()>=s&&(t=!0)}))}R(!0,t)},e.teardown=function(){N(2,2),c=!0,o.teardown()},e.pause=function(){O(),d=!0,o.pause()},e.resume=function(){d=!1,o.resume(),k()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){O(),K(),m=Cr,k(),te(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),y[e]=n}}))},e.flush=function(e,n,t){void 0===e&&(e=!0),d||(O(),t=t||1,e?(D(ht,0,t),A(),null==f?f=F((function(){B(n,t)}),0):l.push(n)):(P(ht,1,t),null!=n&&n()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=E,e._setTransmitProfile=function(e){m!==e&&void 0!==y[e]&&(O(),m=e,k())},e._backOffTransmission=function(){S<4&&(S++,O(),k())},e._clearBackOff=function(){S&&(S=0,O(),k())}})),r}return mr(n,e),n}(Rn),gi=hi,yi=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t){this._postChannel=new gi;var i=[];t&&(i=i.concat(t)),n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=(0,r.pi)((0,r.pi)({},n.channelConfiguration),n.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,n,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var n=e/1e3,t=n/2,r={};r.OTelCustomTransmissionProfile=[n,t],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(cr),mi="Data.",Ci="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function Ti(e,n,t){n&&n.forEach((function(n){if(!n.classification||4===n.classification||1===n.classification||t.customerContentEnabled&&32===n.classification){var r,i;switch(r=t.prependDataToken?"zC."===n.name.substr(0,3)?"zC.Data."+n.name.substr(3):mi+n.name:n.name,n.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof n.value?n.value.substr(0,25e3):n.value);default:return void(e[r]=n.value)}var o={value:n.value,propertyType:i};e[r]=o}}))}function Si(e,n){try{return e()}catch(e){return s(1,"1DS Sink",e),n}}var xi,wi=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.identifier="PartAPlugin",n.priority=3,n._properties={},n}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t,r){e.prototype.initialize.call(this,n,t,r)},n.prototype.processTelemetry=function(e,n){e.data=tr(this._properties,e.data);var t=this._getTelCtx(n);this.processNext(e,t)},n.prototype.addDataFields=function(e){Ti(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},n}(Rn),bi="HttpManager:_sendBatches",Ii="HttpManager:_sendBatchesNotification",_i=function(){function e(e,n,t){this.start=Date.now(),this.name=e,this.isAsync=!0===t,this.payload=n}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Pi=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,n,t){return e===bi||e===Ii?new _i(e,n,t):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case bi:this.handleSendBatches(e);break;case Ii:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,n){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var n=e.payload();if(n.batches&&n.reason&&n.reason>=1e3&&n.reason<=1999){var t=0;for(var r in n.batches)t+=n.batches[r].evts.length;this._callbacks.requestProcessingStats(0,t)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/"}(xi||(xi={}));var Ei=void 0,ki=function(e){function n(n,t){var i,o,s=e.call(this,n,t)||this;s.usePartAPlugin=!0;var u=new wi,c=function(e){e&&e.addNotificationListener({eventsSent:function(e){a(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),a(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),s.eventsSent+=e.length},eventsDiscarded:function(e,n){a(0,2,(function(){return"Discarded "+e.length+" event(s) because "+n})),a(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),s.eventsDiscarded+=e.length}})};function l(e,n,t,i){var o={instrumentationKey:n,endpointUrl:t,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:(0,r.pi)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&o.channelConfiguration&&(o.channelConfiguration.payloadListener=function(n,t){var r,i=t||n;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new yi;return a.initialize(o,i),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new Pi(e.stats)),a}s.sendTelemetryEvent=function(e){return Si((function(){var n=s.getOneDSTelemetryEvent(e);n&&i&&i.track(n)}),Ei)},s.sendCustomerContent=function(e){return Si((function(){var n=s.getOneDSCustomerContent(e);n&&o&&o.track(n)}),Ei)},s.addPersistentDataFields=function(e){u.addDataFields(e)},s.flush=function(e){i&&i.flush(e)},s.shutdown=function(){try{i&&i.shutdown()}catch(e){a(0,2,(function(){return"An error occurred on shutdown"}))}};var f=[u];if(t.plugins&&f.push.apply(f,t.plugins),!t.endpointUrl)throw new Error("Missing Endpoint Url");return i=l(t,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",t.endpointUrl,f),t.enableCustomerContent&&t.endpointUrl===xi.PUBLIC&&(o=l(t,Ci,xi.CUSTOMER_CONTENT,f)),t.disableStatsTracking||(c(i),c(o)),s.addPersistentDataFields(n),s}return(0,r.ZT)(n,e),n}((function(e,n){var t=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var i=[],o=!1,s={name:"DiagnosticLevel",processEvent:function(e){var n=e.eventFlags.diagnosticLevel;return o||10===n||110===n||120===n}},u={},c=nr(),l=(new Date).getTime().toString(),f=function(e,n){if(1===n.eventType)return Ci;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},d=function(e,n){var o,s=v(e);if(function(e){for(var n=function(n){var t=i[n];if(!t.processEvent(e))return a(2,1,(function(){return e.eventName+" suppressed by "+t.name})),{value:!1}},t=0;t<i.length;t++){var r=n(t);if("object"==typeof r)return r.value}return!0}(s)){t.eventsProcessed++;var d=((o=s.timestamp)?new Date(o):new Date).toISOString(),p={"Event.Sequence":{value:t.eventsProcessed,propertyType:4},"Event.Name":s.eventName,"Event.Source":"OTelJS","Event.Time":{value:d,propertyType:9}};Ti(p,s.dataFields,{prependDataToken:!0,customerContentEnabled:1===n.eventType}),p["Event.Id"]=c+"."+t.eventsProcessed;var h="custom";s.eventContract&&(s.eventContract.name&&(p["Event.Contract"]=s.eventContract.name,h+="."+s.eventContract.name.toLowerCase().replace(/\./g,"_")),Ti(p,s.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===n.eventType}));var g={iKey:f(s,n),name:s.eventName,data:p,time:d,baseType:h,ext:{sdk:{seq:t.eventsProcessed,epoch:l}}};return t.usePartAPlugin||(g.data=(0,r.pi)((0,r.pi)({},g.data),u)),g}};this.getOneDSTelemetryEvent=function(e){return d(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(n.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return d(e,{eventType:1})},this.addPreprocessor=function(e){i.push(e)},this.addPersistentDataFields=function(e){Ti(u,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,n.enableOptionalEvents&&(o=!0),this.addPersistentDataFields(e),this.addPreprocessor(s)})),Fi=t(18092),Oi=t(37344),Ni=t(37831),Mi=t(74688),Ri=null,Li=function(){function e(e,n,t){void 0===t&&(t=5),this.serverRequestInfluxControl=t,this.otelLogger=new E,this.intentionalPageViewLogTime=null;var r=new ki(e,{endpointUrl:xi.PUBLIC});this.otelLogger.addSink(r);this.otelLogger.setTenantToken("Office.Taos.Shell",n,-1),this.serverRequestInfluxControl<0?this.serverRequestInfluxControl=0:this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.registerContextParam=function(){},e.prototype.writeEvent=function(e){if(null!=e){if(e.name===Fi.F5.ServerRequest){var n=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(n.length>0&&n[0].value>=200&&n[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var t=[];if(e.name===Fi.F5.Click){var r=void 0;null===this.intentionalPageViewLogTime||this.intentionalPageViewLogTime>e.timestamp+864e5?(this.intentionalPageViewLogTime=e.timestamp,r=!0):r=!1,t.push(l("Click_IntentionalPageView",r))}t.push(d("Event_Type",Fi.hi[e.type])),e.properties.forEach((function(e){switch(e.type){case 1:t.push(l(e.name,e.value));break;case 3:t.push((n=e.name,r=e.value,{name:n,dataType:3,value:r,classification:4}));break;case 4:t.push(function(e,n){return{name:e,dataType:4,value:n,classification:4}}(e.name,e.value));break;case 2:t.push(f(e.name,e.value));break;default:t.push(d(e.name,e.value))}var n,r})),this.otelLogger.sendTelemetryEvent({eventName:e.elementName?"Office.Taos.Shell."+Fi.F5[e.name]+"."+e.elementName:"Office.Taos.Shell."+Fi.F5[e.name],dataFields:t,eventFlags:{dataCategories:4,diagnosticLevel:110}})}},e}();function Ai(e,n){if(null==Ri){var t=Fi.cO.getNewID(),i=(0,Ni.aH)(),o=(0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)([],w({name:"OfficeTaosShell",platform:"Web",version:window.O365ShellVerStr||"unknown"})),b({id:n.SHSID})),x({primaryIdentityHash:n.PUID,primaryIdentitySpace:n.IsConsumerShell?"MSAPUID":"OrgIdPUID",isAnonymous:!1,tenantId:n.TID,tenantGroup:n.IsConsumerShell?"Consumer":"Commercial"})),[d("Context_Env",n.Environment||"unknown"),d("Context_Site",n.WorkloadId),d("Context_SiteSubId",e.CurrentMainLinkElementID),d("Context_WorkloadAppId",(0,Mi.Dd)(n.WorkloadId,e.CurrentMainLinkElementID,document.URL)),d("Context_CID",Oi.Eu(i.correlationID)),d("Context_PID",t),d("Context_UID",n.UID),d("Context_Language",e.CultureName),d("Context_Flights",e.FlightName),d("Context_FlightRings",n.FlightRing),d("Context_Segment",n.ActiveExperiences)]);window.O365ShellContext.SID=n.SHSID,window.O365ShellContext.PID=t,i.correlationID&&(window.O365ShellContext.CID=i.correlationID),Ri=new Li(o,"b0c82c6598ad49f3848b1d3dc0d8dd25-299cbfe9-b72e-4e9d-a5e3-20319efba5b5-7268",n.AriaTelemetryServerRequestInfluxControl);var a=(0,Ni.jl)();a.registerService(Ri),a.IsConsumer=n.IsConsumerShell}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_otellogging_end"),shellPerformance.measure("shell_otellogging","shell_otellogging_start","shell_otellogging_end"));