Type.registerNamespace("Common");Common.fa=function(n,t){if(isNullOrUndefined(n)||isNullOrUndefined(t))throw Error.argumentNull("appSettingsManager/clientRequestManager");this.e=n;this.g=t;this.d=null;this.f=null};Common.fa.a=function(n,t){try{return Diag.a.a(50860943,3004,50,"Parsing user privacy settings {0} from {1}",n,t),Common.cH.b(n,t)}catch(i){Diag.a.a(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",i.toString());throw i;}};Common.fa.prototype={d:null,f:null,e:null,g:null,i:function(n){var i=this.e.l.d.RoamingServiceHandlerWebServiceBase||"",r=String.format("{0}RoamingServiceHandler.ashx?action=",i),t=new Sys.StringBuilder(r);return t.append(n),t.append("&"),t.append(Common.a.i),t.toString()},h:function(n,t,i,r){return this.g.f(n,t,r,null,!1,2,null,i,"33",!1,null,6e4,null,null,!1,null)},b:function(n){var t=this;return new Promise(function(i,r){var e,u,f;try{if(isNullOrUndefined(t.d)||isNullOrUndefined(n)){Diag.a.a(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save");r("Can't determine setting changes to save");return}if(e=t.d.a!==n.a,t.d.b===2&&e){t.k(n);i(!0);return}if(u=t.l(n),isNullOrUndefined(u)||!u.length){Diag.a.a(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed");r("No changes to save");return}if(t.d.b===1){i(t.j(u));return}t.d.b||(Diag.a.a(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",u),f=t.h(t.i("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",u),f.CW(function(){if(f.b===4||f.b===5){Diag.a.a(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed");i(!1);return}var n=f.a();isNullOrUndefined(n.a)||isNullOrUndefined(n.a.a())||n.a.a().a!==200?(Diag.a.a(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),i(!1)):(Diag.a.a(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),i(!0))}))}catch(o){Diag.a.a(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",o.toString());i(!1)}})},l:function(n){if(isNullOrUndefined(this.d)||isNullOrUndefined(n))throw Error.invalidOperation("User Privacy settings have not been initialized");var t=new($$sc.v.$$(String));return(n.b?n.b===1&&this.d.a!==n.a&&t.b("CCS"):(this.d.a!==n.a&&(t.b("CCS"),t.b("CCSTime")),this.d.c!==n.c&&t.b("OfficePrivacyRoamedNoticeShown")),!t.f.length)?(Diag.a.a(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null):n.j(t)},a:function(){if(!this.f){var n=this;this.f=new Promise(function(t){try{if(n.d){t(n.d.e());return}n.o().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.m().then(function(i){return n.d=i,t(n.d.e()),null},function(){return n.n().then(function(i){return n.d=i,t(n.d.e()),null},function(){return Diag.a.a(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)"),n.d=new Common.cH,t(n.d.e()),null}),null}),null})}catch(i){Diag.a.a(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",i.toString());n.d=new Common.cH;t(n.d.e())}})}return this.f},o:function(){var n=this;return new Promise(function(t,i){var u,f,r;try{if(u=window.location.href.indexOf("&wd_pn=2")!==-1,f=n.e.a("PrivacyDialogShouldCheckRoaming"),!f&&!u){Diag.a.a(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used");i("Roaming should not be used");return}r=n.h(n.i("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest",null);r.CW(function(){try{if(r.b===4||r.b===5)Diag.a.a(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var n=r.a();if(n&&n.a&&n.a.a())if(n.a.a().a!==200)Diag.a.a(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",n.a.a().a);else{if(n.a.a().b){t(Common.fa.a(n.a.a().b,0));Diag.a.a(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",n.a.a().b);return}Diag.a.a(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Diag.a.a(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");i("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure");return}}catch(u){Diag.a.a(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",u.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Request Exception");return}})}catch(e){Diag.a.a(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",e.toString());i("UserPrivacySettings TryGetSettingsFromRoaming Exception");return}})},m:function(){var n=this;return new Promise(function(t,i){var u,r,e,o,s,f;try{if(u=Common.G.b("WacUPToggleState"),r=null,!isNullOrUndefined(u)&&u.length>0&&(r=decodeURIComponent(u)),!isNullOrUndefined(r)&&r.length>0){e=Common.fa.a(r,1);Diag.a.a(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",e.toString());t(e);return}if(o=Common.cH.a(1,null),s=new($$sc.v.$$(String)),s.b("CCS"),f=o.j(s),n.j(f)){Diag.a.a(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",f);t(o);return}Diag.a.a(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",f);i("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie");return}catch(h){Diag.a.a(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",h.toString());i("UserPrivacySettings TryGetSettingsFromCookie Eception")}})},n:function(){var n=this;return new Promise(function(n){var r,t,i;try{r=window.location.href.indexOf("&wdccsoff=1")!==-1;t=Common.cH.a(2,null);r?(t.a=2,Common.a.S=!0,Diag.a.a(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",t.toString())):(t.a=1,Diag.a.a(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",t.toString()));n(t);return}catch(u){Diag.a.a(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",u.toString());i=Common.cH.a(2,null);i.a=1;n(i)}})},k:function(n){return Diag.a.a(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam"),Common.a.S=n.a===2?!0:!1,Diag.a.a(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",n),!0},j:function(n){try{Diag.a.a(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",n);var t=this.e.b("PrivacyCookieDomain")||"";if(!t||!t.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");return Diag.a.a(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",n),Common.G.g("WacUPToggleState",n,365,"/",t)}catch(i){return Diag.a.a(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",i.toString()),!1}},c:function(n){var t=this,i=this;return this.a().then(function(i){for(var u=t.e.f("ServicesControlsMicrosoftControllerServicesList")?t.e.h("ServicesControlsMicrosoftControllerServicesList"):new Array(0),f=new($$sc.n.$$(String))($$sc.d.b()),r=0;r<u.length;r++)f.a(u[r]);return f.b(n)?i.a!==2:!0},function(){return Diag.a.a(50860945,3004,10,"Failed to get privacy setting for feature {0}",n),!0})}};Type.registerNamespace("Common.App.ApplicationFeatureHelper");Common.App.ApplicationFeatureHelper.k=function(){};Common.App.ApplicationFeatureHelper.k.prototype={Enabled:0,Disabled:1};Common.App.ApplicationFeatureHelper.k.registerEnum("Common.App.ApplicationFeatureHelper.k",!1);Common.App.ApplicationFeatureHelper.o=function(n,t){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=n.PolicySettings;var i=new Date;i.setMinutes(i.getMinutes()+t);this.ExpirationTime=i.getTime()};Common.App.ApplicationFeatureHelper.i=function(){};Common.App.ApplicationFeatureHelper.i.prototype={applicationFeatureHelperHandler:0,cloudPolicySettings:1,alternateAuthToken:2};Common.App.ApplicationFeatureHelper.i.registerEnum("Common.App.ApplicationFeatureHelper.i",!1);Common.App.ApplicationFeatureHelper.r=function(){};Common.App.ApplicationFeatureHelper.r.prototype={Features:null};Common.App.ApplicationFeatureHelper.s=function(){};Common.App.ApplicationFeatureHelper.s.prototype={LicenseTier:0,FeatureState:0};Common.App.ApplicationFeatureHelper.j=function(){};Common.App.ApplicationFeatureHelper.j.prototype={PolicySettings:null,ControllerConnectedServicesFeatureNames:null};Common.App.ApplicationFeatureHelper.l=function(){};Common.App.ApplicationFeatureHelper.l.prototype={Token:null,ExpirationTime:0};Common.App.ApplicationFeatureHelper.n=function(){};Common.App.ApplicationFeatureHelper.n.a=function(){Common.App.a.a().a(new Common.App.ApplicationFeatureHelper.n,0,!1)};Common.App.ApplicationFeatureHelper.n.prototype={d:null,a:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"},c:function(n){var i,r,u,t;this.d=n;i=this;this.d.c(Common.App.ApplicationFeatureHelper.c,null).a().b(function(){return new Common.App.ApplicationFeatureHelper.p(Common.a.a,Common.a.e)});r=this;this.d.c(Common.App.ApplicationFeatureHelper.e,null).a().b(function(){return new Common.fa(Common.a.a,Common.a.e)});u=this;this.d.c(Common.App.ApplicationFeatureHelper.h,null).a().b(function(){return new Common.App.ApplicationFeatureHelper.m(Common.a.a,Common.a.e)});t=this;this.d.c(Common.App.ApplicationFeatureHelper.a,null).a().b(function(){return new Common.App.ApplicationFeatureHelper.f(Common.a.a,Common.a.e,t.d.a(Common.App.ApplicationFeatureHelper.c,null),t.d.a(Common.App.ApplicationFeatureHelper.e,null),Common.a.c())})},b:function(){var n=this;Common.a.a.k(function(){var t=n.d.a(Common.App.ApplicationFeatureHelper.a,null);Common.a.a.a("LicensingIsEnabled")&&(t.a("LicensingTestFeature",!1).then(function(n){return Diag.a.a(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",n,Common.a.a.b("IsAnonymousUser")),null}),t.f("LicensingTestFeature",0).then(function(n){return Diag.a.a(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",n,Common.a.a.b("IsAnonymousUser")),null}));n.d.a(Common.App.ApplicationFeatureHelper.h,null);n.e()})},e:function(){try{if(Common.a.a.a("SideCarIsEnabled")){var n=this;Common.cw.c().then(function(n){return Diag.a.a(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",n),n})}}catch(t){return}}};Common.App.ApplicationFeatureHelper.f=function(n,t,i,r,u){var e,o,s,h,f;this.H=Function.createDelegate(this,this.Q);this.J=Function.createDelegate(this,this.W);this.I=Function.createDelegate(this,this.U);this.B=new Common.App.ApplicationFeatureHelper.g(n,t);this.i=n;this.C=n.c("LicensingMaxRetryAttempts",0);this.p=n.a("IsO365ConsumerHost");this.o=n.a("IsO365CommercialHost");this.m=n.a("PremiumUpsellIsEnabled");this.u=i;this.y=r;this.A=u;this.j=n.a("LicensingIsEnabled");this.q=n.a("OcpsIsEnabled")&&this.o;this.s=n.a("ShowPrivacyDialog")&&!!r;this.v=n.a("IsAnonymousUser");e=this;this.t=new Promise(function(n){n(!1)});o=this;this.h=new Promise(function(n){n(!0)});this.g=new($$sc.q.$$(String,$$sc.q.$$(String,Function)))($$sc.d.a());this.n=this.i.d("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.w=this.P();this.T()&&!this.v?(isNullOrUndefined(Common.a.b())||(this.x=Common.a.b().d(),isNullOrUndefined(this.x)||(this.l=this.x.b("WebServiceCall","ApplicationFeatureHelperService"))),this.k=this.G(0,!1)):(s=this,this.k=new Promise(function(n){n({})}));h=this;this.k.catch(function(n){Diag.a.a(42513088,3004,10,JSON.stringify(n))});this.n&&(this.m=!1,f=this,this.a("FreemiumUpsell",!0).then(function(n){return f.m=f.i.a("PremiumUpsellIsEnabled")&&n,null}))};Common.App.ApplicationFeatureHelper.f.a=function(n){var r,t;try{if(Common.c.bJ()&&(r=n.b("UserDataSignature"),t=r.split("."),t.length>1)){var u=window.self.atob(t[1]),f=JSON.parse(u),i=f.LocalStorageKey;if(!isNullOrUndefined(i)&&i.length>0)return i}}catch(e){Diag.a.a(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",e.toString())}return null};Common.App.ApplicationFeatureHelper.f.prototype={B:null,i:null,A:null,u:null,y:null,C:0,j:!1,q:!1,s:!1,p:!1,o:!1,m:!1,v:!1,w:null,t:null,h:null,x:null,n:!1,l:null,D:null,r:null,k:null,g:null,P:function(){for(var t=this.i.f("AllLicensedFeatures")?this.i.h("AllLicensedFeatures"):new Array(0),i=new($$sc.n.$$(String))($$sc.d.b()),n=0;n<t.length;n++)i.a(t[n]);return i},T:function(){return this.o||this.p},G:function(n,t){var i,r;Diag.a.a(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",t);i=this.E();i&&(i.set("retryAttempt",n.toString()),i.set("forceRefresh",t.toString()),i.set("isO365ConsumerHost",this.p.toString()),i.set("isO365CommercialHost",this.o.toString()),i.set("isFreemiumUpsellEnabled",this.m.toString()));Common.i.a().recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",i);Common.i.a().recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",i);isNullOrUndefined(this.l)||this.l.d();r=null;t&&(r=new($$sc.q.$$(String,String))($$sc.d.a()),r.b("x-LicensingForceRefresh","true"));this.D=new Date;var e=this.j?this.B.d(this.O("/afhs/ApplicationFeatureHelperHandler.ashx"),this.I,0,r,this.J,["Date"],null,null):Promise.resolve({}),u=this,f=this;return e.then(function(n){var r,t=(r=new Common.U,r.durationMs=u.N(),r);return t.extendedProperties=i,t.extendedProperties&&n&&(t.extendedProperties.set("featureCount",Common.D.c(n).toString()),t.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in n).toString()),t.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in n).toString()),u.r&&t.extendedProperties.set("fromCache",(u.r<u.D).toString())),Common.i.a().recordKpiSuccess("AFHSLicensingSuccessfulRequest",t),n},function(t){var e,r=(e=new Common.U,e.durationMs=f.N(),e),u=$$as(Common.App.ApplicationFeatureHelper.d,t);return u?(r.extendedProperties=i,r.extendedProperties&&r.extendedProperties.set("status",u.a.toString()),Common.i.a().recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,r),u.a===408&&++n<=f.C)?f.G(n,!1):new Promise(function(n,t){t(u)}):(Diag.a.a(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Common.i.a().recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,r),new Promise(function(n,i){i(t)}))})},U:function(n){var t=JSON.parse(n);return t?(Diag.a.a(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Diag.a.a(50938594,3004,50,"{0}",t)):Diag.a.a(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set"),t.Features},O:function(n){var i=String.format("{0}{1}",this.i.b("WebServiceBase"),n),t,r;return this.i.f("ApplicationFeatureHelperHttpCachingEnabled")&&this.i.a("ApplicationFeatureHelperHttpCachingEnabled")&&(t=Common.App.ApplicationFeatureHelper.f.a(this.i),t&&t.length>0&&(this.n&&(t=t+"ucbf"),r=new Common.bF(i),r.a("afhskey",t),i=r.toString())),i},a:function(n,t){var i,r,u;if(!this.q&&!this.s&&!this.j)return this.h;if(Diag.a.a(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",n),n==="ConnectedServices"){var e=this.q?this.u.a("ControllerConnectedServicesEnabled",!0):this.h,l=this,a=this,o=this.s?this.y.a().then(function(n){return n.a!==2},function(){return t}):this.h,s=this;return e.then(function(n){return n?o:s.t})}i=null;i=this.q?this.u.b(n,!0):this.h;r=null;r=this.j?this.S(n,t):this.h;u=null;u=this.s?this.y.c(n):this.h;var f=this,h=this,c=this;return i.then(function(n){return n?u.then(function(n){return n?r:f.t}):f.t}).then(function(t){return h.K(n,t,null),t},function(i){return c.K(n,t,i),t})},K:function(n,t,i){var r=this.E(),u,f;r&&(r.set("FeatureName",n),r.set("IsEnabled",t.toString()));i?(f=(u=new Common.U,u.extendedProperties=r,u),Common.i.a().recordKpiFailure("AFHFeatureStatus","CanNotDetermineFeatureStatus",!1,!0,f)):Common.i.a().recordKpiUsage("AFHFeatureStatus",0,"jpittsdirects",r)},f:function(n,t){var r,i,u;return this.j?(Diag.a.a(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",n),i=this,u=this,this.k.then(function(r){return i.z(n,r,t)},function(){return t})):(r=this,new Promise(function(n){n(2)}))},b:function(){return this.m&&this.p&&!this.v},d:function(n,t){var i,r,u;Diag.a.a(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",n));i=this.E();i&&(i.set("experienceId",n),t&&i.set("campaignId",t));Common.i.a().recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",i);r=Common.Utils.a.a().d(Common.cE,null);r?(u=this.H,r.a(n,u,t)):(Diag.a.a(594367561,3004,15,"InProductMessaging was not initialized"),Common.i.a().recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.A.c(1274543852,2,{experience:n},null))},c:function(n,t){if(!this.j)return null;if(!n||!t)return Diag.a.a(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var i=Common.u.a().a;return this.g.c(n)?this.g.a(n).d(i,t):(this.g.b(n,new($$sc.q.$$(String,Function))($$sc.d.a())),this.g.a(n).d(i,t)),Diag.a.a(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",i,n)),i},e:function(n,t){return this.j?!n||!this.g.c(n)?(Diag.a.a(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",n)),!1):!t||!Common.u.f(t)?(Diag.a.a(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",t,n)),!1):this.g.a(n).c(t)?(Diag.a.a(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",t,n)),this.g.a(n).f(t)):(Diag.a.a(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",t,n)),!1):!1},z:function(n,t,i){if(this.n){if(n in t){var r=t[n];return r.LicenseTier}return i}return n in t?this.V(t[n],i):i},V:function(n,t){switch(n.toLowerCase()){case"unknown":return 0;case"basic":return 1;case"premium":return 2;default:return t}},Q:function(){Diag.a.a(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");var n=this,t=this;this.k.then(function(t){n.M(t)}).catch(function(){t.M({})})},M:function(n){Diag.a.a(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var i=this.G(0,!0),t=this,r=this;i.then(function(r){var e,u,f,o;for(t.k=i,Common.D.c(r)>Common.D.c(n)?Common.i.a().recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Common.i.a().recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null),e=t.g.i().$$ge();e.$$mn();)u=e.$$cu(),u in r?(f=t.z(u,r,0),u in n?(o=t.z(u,n,0),o!==f&&t.F(u,!0,f)):t.F(u,!0,f)):u in n&&t.F(u,!1,t.z(u,n,0))}).catch(function(n){Common.i.a().recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);Diag.a.a(594051086,3004,10,JSON.stringify(n))})},F:function(n,t,i){var r;Diag.a.a(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",n,t,i);for(var f=new Common.App.ApplicationFeatureHelper.q(n,t,i),e=this.g.a(n),u=e.$$ge();u.$$mn();){r=u.$$cu();try{r.a(f)}catch(o){Diag.a.a(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",n,r.b,o.message))}}},R:function(n,t){if(this.j){var r=this.w.b(n),i=!0,u="",f=!1,e=this,o=this;return this.k.then(function(o){if(n in o){var s=o[n];u=Common.App.ApplicationFeatureHelper.k.toString(s.FeatureState);i=s.FeatureState!==1}else i=!r;return e.L(n,r,u,f,t,i),i},function(){return f=!0,r&&(i=t),o.L(n,r,u,f,t,i),i})}return this.h},L:function(n,t,i,r,u,f){Diag.a.a(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",n,t,r,i,u,f)},S:function(n,t){if(this.n)return this.R(n,t);if(this.j){if(this.w.b(n)){var i=this,r=this;return this.k.then(function(t){return n in t},function(){return t})}return Diag.a.a(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",n),this.h}return this.h},W:function(n){try{n&&"Date"in n&&(this.r=new Date(n.Date),Diag.a.a(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.r.toString()))}catch(t){Diag.a.a(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",t)}},E:function(){try{return new Map}catch(t){return null}},N:function(){if(!isNullOrUndefined(this.l)){var n=this.l.b();return this.l.a(),n}return null}};Common.App.ApplicationFeatureHelper.p=function(n,t){var r,u,i,f,e,o;for(this.m=Function.createDelegate(this,this.u),this.l=Function.createDelegate(this,this.t),this.j={},this.k=new Common.App.ApplicationFeatureHelper.g(n,t),this.c=n,r=n.b("HostAuthType"),this.f=n.a("OcpsIsEnabled")&&n.a("IsO365CommercialHost")&&!isNullOrUndefined(r)&&r.toLowerCase()==="aad",this.j=JSON.parse(n.b("OcpsDefaultSettings")||"{}"),this.e=this.r(),u=this.c.f("ServicesControlsMicrosoftControllerServicesList")?this.c.h("ServicesControlsMicrosoftControllerServicesList")||new Array(0):new Array(0),this.d=new($$sc.n.$$(String))($$sc.d.b()),i=0;i<u.length;i++)this.d.a(u[i]);f=this.f&&!n.a("IsAnonymousUser")&&n.a("SideCarIsEnabled");this.g=f?this.y():this.x(this.f,this.q("/afhs/CloudPolicySettings.ashx"),this.l);e=this;o=this;this.g.then(function(){return null}).catch(function(n){Diag.a.a(50622685,3004,10,JSON.stringify(n))})};Common.App.ApplicationFeatureHelper.p.prototype={k:null,c:null,d:null,f:!1,e:null,i:0,g:null,a:function(n,t){var r;if(!this.f)return r=this,new Promise(function(t){t(r.h(n))});var i=this,u=this,f=this.g.then(function(r){var u,e,f;try{return u=null,e=Common.bY.toString(0).toLowerCase(),r.PolicySettings&&e in r.PolicySettings&&(u=r.PolicySettings[e]),u?n in u&&!isNullOrUndefined(u[n])?new Promise(function(t){t(u[n]!=="0")}):(f=n.toLowerCase(),f in u&&!isNullOrUndefined(u[f])?new Promise(function(n){n(u[f]!=="0")}):(Diag.a.a(51512667,3004,50,"Policy"+n+" not found, using default"),new Promise(function(t){t(i.h(n))}))):new Promise(function(t){t(i.h(n))})}catch(o){return Diag.a.a(50622686,3004,10,"Failed to get "+n+" policy value. Error Message: {0}",o.message),i.n(o.toString(),t,i.h(n))}},function(i){return u.n(i,t,u.h(n))}),e=this;return f.then(function(t){return Diag.a.a(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",n,t),null}),f},b:function(n,t){var u;if(this.c.d("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.s(n,t);var f=this,i=new Promise(function(n){n(!0)}),r="";return this.d.b(n)&&(r="ControllerConnectedServicesEnabled",i=this.a(r,t)),u=this,i.then(function(t){return Diag.a.a(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",n,t,r),null}),i},s:function(n,t){var f=this,r=new Promise(function(n){n(!0)}),i="",u;return n==="mso_sendASmile"?i="Enabled":n==="Survey"||n==="FloodgateSurvey"?i="SurveyEnabled":this.d.b(n)&&(i="ControllerConnectedServicesEnabled"),i!==""&&(r=this.a(i,t)),u=this,r.then(function(t){return Diag.a.a(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",n,t,i),null}),r},n:function(n,t,i){var r,u;return t?(r=this,new Promise(function(n){n(i)})):(u=this,new Promise(function(t,i){i(n)}))},x:function(n,t,i){var u,f;if(!n)return Promise.resolve(new Common.App.ApplicationFeatureHelper.j);u=!1;f=null;Common.i.a().recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var e=this.o("GetCloudPolicySettings"),r=this,s=new Promise(function(n,f){if(!isNullOrUndefined(r.e)&&r.e.length>0){var e=r.w();if(!isNullOrUndefined(e)){u=!0;n(e);return}}r.k.d(t,i,1,null,r.m,["CheckIn-Interval"],r.c.c("CloudPolicySettingsRequestQueueTimeout",15e3),r.c.c("CloudPolicySettingsRequestSentTimeout",3e4)).then(function(t){return Diag.a.a(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS"),r.z(t),n(t),t},function(n){return f(n),null})}),o=this;return s.then(function(n){var r,s,t,i,h;return f=(s=o.v(r={val:e}),e=r.val,s),t=o.p(),t&&t.set("FromCache",u.toString()),h=(i=new Common.U,i.durationMs=f,i.extendedProperties=t,i),Common.i.a().recordKpiSuccess("GetCloudPolicySettings",h),n})},y:function(){var n=this;return Common.cw.c().then(function(){return Diag.a.a(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar"),sidecar.cloudPolicy.GetCloudPolicySettingsData()})},q:function(n){return String.format("{0}{1}",this.c.b("WebServiceBase"),n)},t:function(n){var t=null,i,r;return r=Common.bp.a(n,i={val:t}),t=i.val,r,Diag.a.a(50622687,3004,t?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",n),t},u:function(n){try{if(isNullOrUndefined(n))return;if("CheckIn-Interval"in n){var t=parseInt(n["CheckIn-Interval"]);!isNullOrUndefined(t)&&t>0&&(this.i=t)}}catch(i){Diag.a.a(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",i)}},h:function(n){return n in this.j?this.j[n]!=="0":!0},w:function(){var i,n,u,t,e,r,f;try{if(i=Common.Utils.c.a().b(this.e),isNullOrUndefined(i))return Diag.a.a(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;if(Diag.a.a(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",i),n=JSON.parse(i),isNullOrUndefined(n))return Diag.a.a(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(isNullOrUndefined(n.ExpirationTime))return Diag.a.a(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if(u=new Date(n.ExpirationTime),u.getTime()<Date.now())return Diag.a.a(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;for(t=new Common.App.ApplicationFeatureHelper.j,t.PolicySettings=n.PolicySettings,t.ControllerConnectedServicesFeatureNames=new($$sc.v.$$(String)),e=this.c.f("ServicesControlsMicrosoftControllerServicesList")?this.c.h("ServicesControlsMicrosoftControllerServicesList"):new Array(0),r=this.d.$$ge();r.$$mn();)f=r.$$cu(),t.ControllerConnectedServicesFeatureNames.b(f);return Diag.a.a(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved"),t}catch(o){return Diag.a.a(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",o.toString()),null}},z:function(n){try{if(isNullOrUndefined(n)||isNullOrUndefined(n.PolicySettings))Diag.a.a(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(this.i<=0)Diag.a.a(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var i=new Common.App.ApplicationFeatureHelper.o(n,this.i),t=JSON.stringify(i);Diag.a.a(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",t);Common.Utils.c.a().c(this.e,t);Diag.a.a(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(r){Diag.a.a(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",r.toString())}},r:function(){var n=Common.App.ApplicationFeatureHelper.f.a(this.c);return n&&n.length>0?"OCPS"+n:null},p:function(){try{return new Map}catch(n){return null}},o:function(n){var t=Common.Utils.a.a().d(DiagUse.a,null);return isNullOrUndefined(t)?null:t.a("WebServiceCall",n)},v:function(n){if(!isNullOrUndefined(n.val)){var t=n.val.b();return n.val.a(),n.val=null,t}return null}};Common.App.ApplicationFeatureHelper.d=function(){};Common.App.ApplicationFeatureHelper.d.prototype={b:null,a:0};Common.App.ApplicationFeatureHelper.g=function(n,t){this.a=n;this.c=t};Common.App.ApplicationFeatureHelper.g.prototype={a:null,c:null,d:function(n,t,i,r,u,f,e,o){var s=Common.App.ApplicationFeatureHelper.i.toString(i),c=s+"RequestFailure",h;return Common.i.a().recordKpiUsage(c,0,"jpittsdirects",null),h=this,new Promise(function(l,a){Diag.a.a(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",s);var v=e!=null?e:h.a.c("ApplicationFeatureHelperRequestQueueTimeout",15e3),y=o!=null?o:h.a.c("ApplicationFeatureHelperRequestSentTimeout",3e4);h.c.d(n,1,null,h.e(i,r),f,!1,1,function(n){var r,f,i,e,o;Diag.a.a(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",s);try{if(isNullOrUndefined(n)||isNullOrUndefined(n.b)||isNullOrUndefined(n.b.b)){Common.i.a().recordKpiFailure(c,"Invalid RequestSucceededEventArgs",!1,!0,null);r=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",s);a(h.b(r,n));return}if(n.b.a!==200){Common.i.a().recordKpiFailure(c,"HttpStatusCode_"+n.b.a.toString(),!1,!0,null);f=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",n.b.a,s);a(h.b(f,n));return}if(isNullOrUndefined(u)||isNullOrUndefined(n.b.d)||u(n.b.d),i=t(n.b.b),!i){Common.i.a().recordKpiFailure(c,"Parse Failure",!1,!0,null);e=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",s);a(h.b(e,n));return}Diag.a.a(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",s);l(i)}catch(v){Common.i.a().recordKpiFailure(c,"Unexpected Failure",!1,!0,null);o=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",v,s);a(h.b(o,n))}},function(n){Diag.a.a(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",s);var t="";if(!n.b){Common.i.a().recordKpiFailure(c,"Invalid RequestFailedEventArgs",!1,!0,null);t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",s);a(h.b(t,n));return}Common.i.a().recordKpiFailure(c,"HttpStatusCode_"+n.b.a.toString(),!1,!0,null);t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",n.b.a,n.b.b||"No Data",s);a(h.b(t,n))},null,null,!1,v,y,null,null,!1,null,!1,null,null)})},b:function(n,t){var i=new Common.App.ApplicationFeatureHelper.d;return i.b=n,i.a=t&&t.a()?t.a().a:-1,i},e:function(n,t){var i={},r,u;if(i["x-UserDataSignature"]=this.a.b("UserDataSignature"),i["x-LicensingIsEnabled"]=this.a.a("LicensingIsEnabled").toString(),i["x-CacheIsEnabled"]=this.a.a("LicensingRedisIsEnabled").toString(),i["x-OcpsIsEnabled"]=this.a.a("OcpsIsEnabled").toString(),i["x-LicensingAADIdIsEnabled"]=this.a.a("LicensingAadIdIsEnabled").toString(),n||(i["x-LicenseCheckOnTenantEnabled"]=this.a.a("LicensingForSafeLinksIsEnabled").toString(),i["x-SupportUserConsentDependentFeatures"]=this.a.d("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),i["x-AFHUserConsentGroupValue"]=this.a.g("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),i["x-UseShellServiceForUserConsentGroup"]=this.a.d("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),i["x-UseSALForLicensing"]=this.a.d("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),i["x-SMBUserLicensingEnabled"]=this.a.d("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString()),t)for(r=t.i().$$ge();r.$$mn();)u=r.$$cu(),i[u]=t.a(u);return i}};Common.App.ApplicationFeatureHelper.m=function(n,t){if(this.e=Function.createDelegate(this,this.j),isNullOrUndefined(n)||isNullOrUndefined(t))throw Error.argumentNull("appSettingsManager/clientRequestManager");if(this.c=n,this.b=new($$sc.q.$$(String,Common.App.ApplicationFeatureHelper.l))($$sc.d.a()),this.d=new Common.App.ApplicationFeatureHelper.g(n,t),!isNullOrUndefined(Common.App.OAuth.a.o())&&!isNullOrUndefined(Common.App.OAuth.a.l())&&Common.App.OAuth.a.l()>0){var i=new Common.App.ApplicationFeatureHelper.l;i.Token=Common.App.OAuth.a.o();i.ExpirationTime=Common.App.OAuth.a.l();this.b.b(Common.App.ApplicationFeatureHelper.b.toString(0),i)}};Common.App.ApplicationFeatureHelper.m.prototype={f:3e5,c:null,d:null,b:null,a:function(n){var t=null;return(this.b.c(Common.App.ApplicationFeatureHelper.b.toString(n))&&(t=this.b.a(Common.App.ApplicationFeatureHelper.b.toString(n))),!isNullOrUndefined(t)&&!this.i(t))?Promise.resolve(t.Token):this.g(n)},i:function(n){return n.ExpirationTime-Date.now()<this.f},g:function(n){var t=new($$sc.q.$$(String,String))($$sc.d.a()),i,r;return t.b("X-AlternateAuthApp",Common.App.ApplicationFeatureHelper.b.toString(n)),i=this,r=this,this.d.d(this.h("/afhs/AlternateAuthHelperHandler.ashx"),this.e,2,t,null,null,null,null).then(function(t){return Diag.a.a(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Common.App.ApplicationFeatureHelper.b.toString(n)),i.b.b(Common.App.ApplicationFeatureHelper.b.toString(n),t),t.Token},function(n){var t=$$as(Common.App.ApplicationFeatureHelper.d,n);return Diag.a.a(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",t.b,t.a),null})},j:function(n){var t=null,i,r;return r=Common.bp.a(n,i={val:t}),t=i.val,r,Diag.a.a(545821457,3004,t?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",n),t},h:function(n){return String.format("{0}{1}?{2}",this.c.b("WebServiceBase"),n,Common.a.i)}};Common.App.ApplicationFeatureHelper.o.registerClass("Common.App.ApplicationFeatureHelper.o");Common.App.ApplicationFeatureHelper.r.registerClass("Common.App.ApplicationFeatureHelper.r");Common.App.ApplicationFeatureHelper.j.registerClass("Common.App.ApplicationFeatureHelper.j");Common.App.ApplicationFeatureHelper.l.registerClass("Common.App.ApplicationFeatureHelper.l");Common.App.ApplicationFeatureHelper.d.registerClass("Common.App.ApplicationFeatureHelper.d");Common.App.ApplicationFeatureHelper.n.a();Type.registerNamespace("Common.App.InProductMessaging");Common.App.InProductMessaging.f=function(){};Common.App.InProductMessaging.f.registerInterface("Common.App.InProductMessaging.f");Common.App.InProductMessaging.k=function(){};Common.App.InProductMessaging.c=function(){};Common.App.InProductMessaging.c.prototype={b:!1,a:!1};Common.App.InProductMessaging.d=function(n,t,i){this.d=Function.createDelegate(this,this.h);this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.i);this.a=n;this.c=t;this.b=i};Common.App.InProductMessaging.d.prototype={a:null,c:null,b:null,l:function(){this.a.b(672565674,2147483648,this.e,64);this.a.a(1501863744,2147483648,this.g);this.a.a(3016992658,2147483648,this.f);this.a.a(4275690876,2147483648,this.d);this.a.a(4142738798,2147483648,Common.y.a);this.a.a(3865601672,2147483648,Common.y.a);this.a.a(2275483468,2147483648,Common.y.a);this.c&&this.c.c(!1)},i:function(n,t,i,r,u){return i===2&&this.b.c(u),32},h:function(n,t,i,r,u){return i===2&&this.b.b(u),32},k:function(n,t,i){return i===2?this.b.f():32},j:function(n,t,i){return i===2?this.b.e():32}};Common.App.InProductMessaging.a=function(){};Common.App.InProductMessaging.a.d=function(n){var t=Common.App.InProductMessaging.a.b(n),i=Common.bI.a(t,null,null);return Common.App.InProductMessaging.a.a(i)};Common.App.InProductMessaging.a.c=function(n){var t=Common.App.InProductMessaging.a.b(n),i=new Common.fx(t);return Common.App.InProductMessaging.a.a(i)};Common.App.InProductMessaging.a.b=function(n){return Common.E.g(String.format("ipm/{0}",n))};Common.App.InProductMessaging.a.a=function(n){return Common.bi.a(n),n.f.b};Common.App.InProductMessaging.a.prototype={c:null,d:null,a:function(){if(!this.c){Diag.a.a(21030598,324,50,"InProductMessagingDependenciesLoad usage");this.c=$$sc.a.WAA(Common.App.InProductMessaging.a.d("inproductmessaging.js"),Common.App.InProductMessaging.a.c("inproductmessaging.css"));var n=this;this.c.CWo(function(n){Diag.a.a(21030599,324,10,"{0}",Common.d.D(n.c))},5)}return this.c},b:function(){var n,t;if(!this.d)try{Diag.a.a(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage");n=Common.a.a.b("DimeUrl");this.d=$$sc.a.WAA(Common.App.InProductMessaging.a.a(Common.bI.a(n,null,null)));t=this;this.d.CWo(function(n){Diag.a.a(39978391,324,10,"{0}",Common.d.D(n.c))},5)}catch(i){Diag.a.a(594874951,324,10,"{0}",Common.d.D(i))}return this.d}};Common.App.InProductMessaging.i=function(){};Common.App.InProductMessaging.i.prototype={b:null,a:null,e:null,d:null,c:null};Common.App.InProductMessaging.h=function(){this.a=new Array(5);this.a[0]=10;this.a[1]=15;this.a[2]=50;this.a[3]=100;this.a[4]=200};Common.App.InProductMessaging.h.prototype={b:0,Init:function(n){this.b=n},SendTrace:function(n,t){Diag.a.a(34182235,this.b,this.a[n],"{0}",t)}};Common.App.InProductMessaging.j=function(){};Common.App.InProductMessaging.j.a=function(){Common.App.a.a().a(new Common.App.InProductMessaging.j,0,!1)};Common.App.InProductMessaging.j.prototype={d:null,a:function(){return"Common.App.InProductMessaging"},c:function(n){var e=this,t,i,r,u,f;n.c(Common.App.InProductMessaging.a,null).c(Common.App.InProductMessaging.f,null).a().b(function(){return new Common.App.InProductMessaging.a});t=this;n.c(Common.App.InProductMessaging.g,null).c(Common.fP,null).a().b(function(){return new Common.App.InProductMessaging.g(Common.q.a())});i=this;n.c(Common.App.InProductMessaging.b,null).c(Common.cE,null).a().b(function(){return new Common.App.InProductMessaging.b(Common.a.c(),n.a(Common.fP,null),n.a(Common.App.InProductMessaging.f,null),Common.a.b().a().a(),Common.a.b().a().o())});r=this;n.c(Common.App.InProductMessaging.d,null).a().b(function(){return new Common.App.InProductMessaging.d(Common.a.c(),Common.a.b(),n.a(Common.cE,null))});u=this;n.c(Common.App.InProductMessaging.e,null).c(Common.hy,null).a().b(function(){return new Common.App.InProductMessaging.e});f=this;n.c(Common.App.InProductMessaging.c,null).c(Common.hz,null).a().b(function(){return new Common.App.InProductMessaging.c});this.d=n},b:function(){var t=this.d.a(Common.App.InProductMessaging.d,null),n;t.l();n=this;Common.a.a.k(function(){Common.a.b().a().c()&&Common.App.AppLifecycleManager.get_instance().a(15,function(){n.d.b(Common.App.ApplicationFeatureHelper.a,null).a(function(t){n.d.a(Common.App.InProductMessaging.b,null).n(t)})},3);Common.a.a.a("FreemiumUpsellShowDialogIsEnabled")&&Common.dr.a()&&!Common.c.j()&&Common.a.b().a().a()!==1&&n.d.b(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.a("MsoPremiumBadge",!0).then(function(i){return!i&&t.b()&&n.d.a(Common.App.InProductMessaging.b,null).d(),null})})})}};Common.App.InProductMessaging.b=function(n,t,i,r,u){this.i=n;this.g=t;this.l=i;this.k=r;this.m=u};Common.App.InProductMessaging.b.prototype={g:null,l:null,i:null,k:0,m:0,j:!1,h:null,n:function(n){if(Common.F.e("getHeaderApi")){var t="MsoPremiumBadge",i=this;n.a(t,!0).then(function(i){var r=n.b();return r&&(appChrome.getHeaderApi().then(function(n){return n.updatePremiumStatus(i,r),null}),n.c(t,function(n){appChrome.getHeaderApi().then(function(t){return t.updatePremiumStatus(n.isEnabled,r),null})})),null})}else Diag.a.a(593859840,324,10,"getHeaderApi not available")},c:function(n){var t=this;this.l.a().CW(function(){t.g.d(n)})},b:function(n){var t=n,i="gopremium",r=null,f=this,u=function(){};t?(t.experience&&$$as(String,t.experience)!==""&&(i=$$as(String,t.experience)),t.onTaskComplete&&(u=t.onTaskComplete),t.campaignId&&$$as(String,t.campaignId)!==""&&(r=$$as(String,t.campaignId))):Diag.a.a(51675402,324,50,"Experience not given, using default experience");this.a(i,u,r)},a:function(n,t,i){var r;if(this.j&&this.h){r={};r.experience=n||"gopremium";r.campaignId=i||Common.dr.b(this.k,this.m,$$as(String,r.experience),!0);this.i.d(4142738798,2,null);Diag.a.a(51675403,324,50,"Launching Freemium Upsell dialog: "+r.experience);try{var u,s=this,h=this,f=this,e=(u=new Common.App.InProductMessaging.i,u.b=this.h,u.a=r,u.e=t||function(){},u.d=function(n){Diag.a.a(51675405,324,50,"Dime launch result: "+n.status)},u.c=function(){Diag.a.a(51675406,324,10,"Dime launch error");f.j=!1;f.h=null},u);this.g.c(e)}catch(o){Diag.a.a(51675407,324,10,"Dime launch error: "+o.message);this.j=!1;this.h=null;this.i.c(1274543852,2,{experience:r.experience},null)}}else Diag.a.a(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.i.c(1274543852,2,{experience:n},null)},d:function(){var n=this;this.l.b().CWo(function(){var f,i,t,r,u;try{if(f=Common.a.D.toLowerCase(),i=Common.dr.c(n.k),!i){Diag.a.a(51675409,324,15,"App not supported");return}t={};t.partnerId=i;t.language=f;t.sessionId=Common.a.j;t.authHint=Common.a.a.b("UserPrincipalName");r=Common.a.a.b("Puid")||"";r!==""&&(u={},u.puid=r,t.userInfo=u);n.h=new Dime(t);n.j=!0;Diag.a.a(592721856,324,50,"Dime initialized")}catch(e){Diag.a.a(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+e.message)}},3)},f:function(){return this.g.b()},e:function(){return this.g.a()}};Common.App.InProductMessaging.g=function(n){this.h=Function.createDelegate(this,this.k);this.e=n};Common.App.InProductMessaging.g.prototype={e:null,f:!1,d:function(n){var t=n;t&&(InProductMessaging.Networking.NetworkingMgr=new Common.App.InProductMessaging.h,InProductMessaging.Networking.NetworkingMgr.Init(387),this.f=!0,InProductMessaging.Init(t.f,t.e,t.d,t.c,t.b,this.h,t.a),this.i("inProductMessagingOverlayDiv",!0))},c:function(n){var t=n,i,r,u;if(t&&t.b&&t.a)i=document.getElementById("wacDimeContainer"),i||(i=document.createElement("div"),i.id="wacDimeContainer",document.body.appendChild(i)),Common.a.a.a("DimeFocusManagerIsEnabled")&&this.i("wacDimeContainer",!1),t.a.parentElementId="wacDimeContainer",r=this,u=this,t.b.launch(t.a,t.e).then(function(n){r.g();document.body.removeChild(i);t.d(n)}).catch(function(n){u.g();document.body.removeChild(i);t.c(n)});else throw Error.argument("DimeExperienceUISettings");},i:function(n,t){var u,i,r;this.e&&n&&(u=document.getElementById(n),this.j("InProductMessagingFocusId",u,!1),i=this.e.h("InProductMessagingFocusId"),i&&(r=this.e.d(),r&&r.a==="InProductMessagingFocusId"||this.e.f("InProductMessagingFocusId",!1),t&&this.l(i.e)))},j:function(n,t,i){var f=this.e.a(n),e,r,o,u;f.d="app";e=this;r=new Common.Y(function(){return t});r.m=i;r.i(3);r.i(2);r.i(4);o=this;u=this.e.e(function(){return t},f,r);u.i();u.b=!0;u.c=!0},l:function(n){n.b(Common.q.a().r);n.b(Common.q.a().s);n.c(Common.q.a().r,1501863744);n.c(Common.q.a().s,3016992658)},g:function(){this.e&&(this.e.i("InProductMessagingFocusId",!0),this.e.k("InProductMessagingFocusId"))},k:function(n,t){this.f=!1;this.g();var i,r=(i=new Common.App.InProductMessaging.c,i.a=n,i.b=t,i);Common.a.c().c(1486778386,2,r,null)},b:function(){var t=document.activeElement,n=this.e.j();return t&&n&&n.a&&t===n.a.e()?(n.a.a(t),n.d()?32:8):4},a:function(){var t=document.activeElement,n=this.e.j();return t&&n&&n.a&&t===n.a.d()?(n.a.a(t),n.f()?32:8):4}};Common.App.InProductMessaging.e=function(){this.a={}};Common.App.InProductMessaging.e.prototype={d:!0,e:!0,f:!0,a:null,c:!1,b:null};Common.App.InProductMessaging.c.registerClass("Common.App.InProductMessaging.c",null,Common.hz);Common.App.InProductMessaging.d.registerClass("Common.App.InProductMessaging.d");Common.App.InProductMessaging.a.registerClass("Common.App.InProductMessaging.a",null,Common.App.InProductMessaging.f);Common.App.InProductMessaging.i.registerClass("Common.App.InProductMessaging.i");Common.App.InProductMessaging.b.registerClass("Common.App.InProductMessaging.b",null,Common.cE);Common.App.InProductMessaging.g.registerClass("Common.App.InProductMessaging.g",null,Common.fP);Common.App.InProductMessaging.e.registerClass("Common.App.InProductMessaging.e",null,Common.hy);Common.App.InProductMessaging.j.a();Type.registerNamespace("Common.App.InsertFile");Common.App.InsertFile.a=function(n,t){var i,r;this.o=Function.createDelegate(this,this.bA);this.w=Function.createDelegate(this,this.bC);this.t=Function.createDelegate(this,this.bq);this.i=Function.createDelegate(this,this.bp);this.u=Function.createDelegate(this,this.bx);this.v=Function.createDelegate(this,this.bB);this.b=[];Common.App.InsertFile.a.initializeBase(this,[!1,!1,Common.App.InsertFile.a.a(),!1]);this.e=n;this.q=t;this.dT=!1;this.U=!1;this.f=null;this.j=!1;this.M=this.y();this.H="InsertFileDialog";this.E(1,this.x());Common.App.InsertFile.a.a()?(this.c={id:this.H,bodyControls:{uploadButtonProps:{label:$a.ft,onExecute:this.v}},uploadStatusLabel:$a.fx,onFrameReady:this.u},this.G(this.k(),this.i,this.c),this.cL=!0):(this.bz(this.k(),this.i),t&&this.B(),i=this.bl(1),i&&this.b.push(i),r=this.bl(0),r&&this.b.push(r),this.V(),this.cL=!1)};Common.App.InsertFile.a.a=function(){return Common.a.b().a().d()&&Common.a.b().a().Y()};Common.App.InsertFile.a.b=function(n){var t=document.getElementById("errorText");t.innerText=n;t.style.display="inline-block"};Common.App.InsertFile.a.prototype={e:null,f:null,j:!1,q:!1,c:null,p:!1,a:null,bV:function(){this.a.a||Diag.a.a(25798091,322,10,"UploadFrame.FileInputElement is null");var n=this.a.a.value;return n?!0:(Common.App.InsertFile.a.b($a.br),!1)},bx:function(n){this.q&&(this.a=this.r(n,this.e))},bB:function(){this.a&&this.a.a&&(this.p||(this.a.bl(this.t),this.p=!0),this.a.P())},bq:function(n){this.c.uploadStatusLabel=n;this.dh(this.k(),this.i,this.c)},bp:function(n){if(n===1&&this.z()){if(Common.App.InsertFile.a.a()&&this.a.a&&!this.a.a.value){this.c.uploadStatusLabel=$a.br;this.dh(this.k(),this.i,this.c);return}this.dw();this.e.f(this.a,this.eJ)}else n||this.F()},B:function(){this.j=!1;this.a=this.r(document.getElementById("uploadFrameContainer"),this.e);Common.a.a.a("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.f=this.w,Common.m.b(this.a.b,"load",this.f));this.a.a||Diag.a.a(25798092,322,15,"UploadFrame.FileInputElement is null");this.A()},bC:function(){this.A()},A:function(){var n,t;this.a&&!this.j&&(n=this.a.a,n&&(Common.m.b(n,"keydown",this.o),t=[n],this.b=t.concat.apply(t,this.b),this.V(),this.j=!0))},dispose:function(){if(this.a&&!Common.App.InsertFile.a.a()){var n=this.a.a;n&&Common.m.c(n,"keydown",this.o);this.f&&Common.m.c(this.a.b,"load",this.f)}this.a=null;CommonUI.b.prototype.dispose.call(this)},V:function(){if(this.b.length>0){var t=new CommonUI.l(this.b),i=Common.q.a(),n=i.j();n&&(this.b[0].focus(),n.a=t,n.b=!0)}},bA:function(n){var t=Common.q.a().W(n);t!==4&&n.preventDefault()}};Common.App.InsertFile.c=function(n,t,i){this.g=Function.createDelegate(this,this.z);this.m=Function.createDelegate(this,this.R);this.K=Function.createDelegate(this,this.ba);this.L=n;this.Q=t;this.c=i;this.e=!1;this.n=!0;this.bb();this.t=this.c.a("NativeFileOpenDialogIsEnabled")};Common.App.InsertFile.c.prototype={Q:null,L:null,c:null,e:!1,u:null,n:!1,b:null,t:!1,M:0,N:0,O:0,P:0,o:null,R:function(n){if(this.b=n,!this.e){if(this.n){if(this.t&&Common.c.k()){this.o=n.x(this.K);return}if(this.o=n.x(null),!this.h(this.o,n))return}this.f(n,null)}},ba:function(n){this.h(n,this.b)&&((Common.c.k()||Common.c.b())&&(this.o=n),this.f(this.b,null))},p:function(){this.u&&this.u()},bb:function(){this.M=0;this.N=this.c.c("Box4UploadRetryCount",20);this.O=this.c.c("Box4UploadRetryDelayStart",200);this.P=this.c.c("Box4UploadRetryDelayMax",3200);this.b&&(this.b.dispose(),this.b=null)}};Common.App.InsertFile.b=function(n,t){this.a=n;this.b=t};Common.App.InsertFile.b.prototype={a:null,b:null};Common.App.InsertFile.d=function(n,t,i,r,u,f,e,o,s,h,c){this.H=Function.createDelegate(this,this.bc);this.I=Function.createDelegate(this,this.be);this.L=Function.createDelegate(this,this.bn);this.J=Function.createDelegate(this,this.P);this.K=Function.createDelegate(this,this.bk);this.g=n;this.y=t;this.u=i;this.s=u;this.v=e;this.o=o;this.p=h;this.m=!1;this.z=r.a("CanaryRenewalForFileUploadIsEnabled");this.n=!1;this.e=c;this.e||this.Y(f);s&&this.T()};Common.App.InsertFile.d.prototype={D:"FileUpload.ashx",b:null,t:!1,y:null,u:null,g:null,c:null,a:null,k:null,l:null,q:null,i:null,s:!1,v:null,o:null,p:null,d:null,A:!1,m:!1,z:!1,e:!1,w:null,r:null,f:null,n:!1,E:function(){return Common.a.a?Common.a.a.a("NativeFileOpenDialogIsEnabled"):!1},Q:function(){return Common.a.a?Common.a.a.a("FileInputDescriptionAccessibilityIsEnabled"):!1},bg:function(){return this.e?!1:this.b.contentWindow.location.pathname.endsWith(this.D)},bf:function(){return!Common.c.j()&&Common.a.a?Common.a.a.d("Microsoft.Office.WordOnline.MultipleImageInsertFromLocalIsEnabled",!1)&&Common.a.a.a("AllowMultipleImageInsertFromLocalDevice"):!1},T:function(){this.f=Common.u.a().a;this.e?this.C():this.N()},Y:function(n){this.b=document.createElement("iframe");this.b.className=n;this.b.id=n;this.s&&(this.b.style.visibility="visible",this.b.style.height="30px",this.b.setAttribute("frameborder","0"));this.l=this.K;Common.m.b(this.b,"load",this.l)},x:function(n){if(Common.a.b().y(),!this.a)return Diag.a.a(25798093,322,50,"_fileInput is null"),"";var t=this,i=function(){t.bd(n)};return Common.m.b(this.a,"change",i),Common.ip.a(this.J,1,"DoFileOpenDialog"),this.a.value},bd:function(n){n&&n(this.a.value)},be:function(){this.k&&(this.k.innerText=this.R())},bl:function(n){var t=this;Common.m.b(this.a,"change",function(){n(t.R())})},R:function(){var t=null,n,i;return this.a.value&&(n=this.a.value,i=n.lastIndexOf("\\"),i>0&&(t=n.substring(i+1,n.length))),t?t:""},P:function(){try{Diag.a.a(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element.");this.a.click()}catch(n){Diag.a.a(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",n.message);throw n;}},bm:function(){this.bi()?this.X():(this.G(),this.c.submit())},bi:function(){return(this.z||this.e)&&!isNullOrUndefined(window.self.FormData)},U:function(n){if(n){var t=this.O();this.d=new XMLHttpRequest;this.d.open("POST",t);this.d.setRequestHeader("X-CorrelationId",this.f);this.bj(n);this.d.onreadystatechange=this.L;this.d.send(n)}},bj:function(n){var i;if(!Common.c.j()&&n.get){var u=n.get("ImageId"),t=window.self.navigator,r={CorrelationId:this.f,Canary:Common.a.x,ImageNodeId:u};t&&(i=t.connection?t.connection:t.mozConnection?t.mozConnection:t.webkitConnection?t.webkitConnection:null,i&&(r.effectiveType=i.effectiveType,r.downlink=i.downlink,r.type=i.type,r.rtt=i.rtt));Diag.a.a(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",r)}},X:function(){try{this.G();Diag.a.a(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var n=new(Type.parse("FormData"))(this.c);this.U(n)}catch(t){Diag.a.a(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+t.message);this.h(null)}},W:function(n){try{if(this.G(),Diag.a.a(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),!this.bp(n)){this.h(null);return}this.r=n;this.c.contains(this.a)&&this.c.removeChild(this.a);var t=new(Type.parse("FormData"))(this.c);t.append("applicationfileInput",n.b,n.a);this.U(t)}catch(i){Diag.a.a(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+i.message);this.h(null)}},bp:function(n){if(!n||isNullOrUndefined(n.b)||isNullOrUndefined(n.a)||n.a===""){var t=n?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",isNullOrUndefined(n.b),isNullOrUndefined(n.a)||n.a===""):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]";return Diag.a.a(578380441,322,10,String.format("Content of the blob is empty {0}",t)),!1}return isNullOrUndefined(window.self.FormData)?(Diag.a.a(578380442,322,10,"FormData isn't supported"),!1):!0},bn:function(){if(this.d.readyState===4)if(this.d.status===200){Diag.a.a(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.f);var n=this.d.getResponseHeader("X-NewKey"),i=this.bh(this.d),t=!1;if(!isNullOrUndefined(n)&&i&&(t=this.bo(n),!this.m&&t)){Diag.a.a(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.f);this.m=!0;this.B();isNullOrUndefined(this.r)?this.X():this.W(this.r);return}Diag.a.a(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.m,i,!isNullOrUndefined(n),t,this.f);this.h(this.d.responseText)}else Diag.a.a(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.d.status,this.d.responseText?!1:!0,this.f),this.h(null)},bh:function(n){var r,t,i,u;try{if(r=JSON.parse(n.responseText),t=r.Responses,!isNullOrUndefined(t)&&t.length===1&&(i=t[0],!isNullOrUndefined(i)&&i.length===2&&(u=i[1].StatusCode,u===28)))return!0}catch(f){}return!1},bo:function(n){return(Common.bf.e(n),Common.a.x!==n)?!1:!0},G:function(){this.w||(this.w=new Date)},dispose:function(){this.A||(this.e?this.g.removeChild(this.c):(this.g.removeChild(this.b),Common.m.c(this.b,"load",this.l),this.l=null),this.q&&(Common.m.c(this.a,"change",this.q),this.q=null),this.Q()&&(this.i&&(Common.m.c(this.a,"change",this.i),this.i=null),this.k=null),this.b=null,this.g=null,this.c=null,this.a=null,this.A=!0,this.w=null,Diag.a.a(25798094,322,50,"UploadFrame disposed"))},bc:function(){this.dispose()},ba:function(n,t){if(this.c){var i,r="input[name="+n+"]";if(i=this.c.querySelector(r),i){i.value=t;return}i=this.bb();i.type="hidden";i.id=n;i.name=n;i.value=t;this.c.appendChild(i)}},bb:function(){return this.e?document.createElement("input"):this.b.contentWindow.document.createElement("input")},bk:function(){var t,i;try{if(!this.b.contentWindow.document.body)return}catch(f){this.S();return}if(this.t||this.E()&&Common.c.k()){if(!(this.E()&&Common.c.k())||this.bg()){t=Common.c.a()?this.b.contentWindow.document.body.innerText:this.n?this.b.contentWindow.document.body.firstChild.innerText:this.b.contentWindow.document.body.firstChild.innerHTML;var n=this.b.contentWindow.document.body.innerText.toLowerCase(),r=n.indexOf("responses")>=0||n.indexOf("wopisrc")>=0,u=n.indexOf("http error")>=0;!r&&u&&(i=this.b.contentWindow.document.body.innerText,Diag.a.a(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+i));this.h(t)}}else this.C()},C:function(){var n,t,i;if(!this.t){var u=this.F("uploadForm"),r=this.F("fileInput"),f=this.O();this.Z();this.c.id=u;this.c.method="post";this.c.encoding="multipart/form-data";this.c.action=f;this.a.type="file";this.o&&(this.a.accept=this.o,this.p&&(this.a.capture=this.p));this.a.id=r;this.a.name=r;this.bf()&&(this.a.multiple=!0);!this.Q()||Common.c.a()||Common.c.m()||(this.i=this.I,Common.m.b(this.a,"change",this.i),this.k=Common.K.b(this.c,this.a,"InputFileDescription",""));this.s&&(this.e||(n=this.b.contentWindow.document.body,n.style.margin="0",n.style.overflow="hidden"),t=Common.a.b(),this.a.style.fontFamily=t.N(),this.a.style.fontSize=t.O(),this.a.style.margin="0");i=document.getElementById("__REQUESTDIGEST");i&&this.ba("__REQUESTDIGEST",i.value);this.B();this.c.appendChild(this.a);this.t=!0;this.y(this)}},Z:function(){if(this.e)this.c=document.createElement("form"),this.g.appendChild(this.c),this.a=document.createElement("input");else{this.c=this.b.contentWindow.document.createElement("form");var n=this.b.contentWindow.document;n.body.appendChild(this.c);this.a=n.createElement("input")}},N:function(){this.g.appendChild(this.b);this.E()&&Common.c.k()&&this.C()},O:function(){var t=new Common.bF(this.D),n;return Common.a.bX(t),this.V(t),n=t.toString(),(Common.c.b()||Common.c.k()||Common.c.m())&&(n=Common.k.l(n)),n},M:function(){var n=new Common.V(2,1,0,this.H,4,null,!1,0);Common.a.k().a(n)}};Common.App.InsertFile.a.registerClass("Common.App.InsertFile.a",CommonUI.b);Common.App.InsertFile.c.registerClass("Common.App.InsertFile.c");Common.App.InsertFile.b.registerClass("Common.App.InsertFile.b");Common.App.InsertFile.d.registerClass("Common.App.InsertFile.d",null,Sys.IDisposable);Type.registerNamespace("Common.App.InsertPicture");Common.App.InsertPicture.c=function(n,t){Common.App.InsertPicture.c.initializeBase(this,[n,t])};Common.App.InsertPicture.c.prototype={x:function(){return $a.ig},k:function(){return $a.ij},y:function(){return Common.App.InsertPicture.b.b()},bV:function(){var n,t,i;return(this.a.a||Diag.a.a(25798095,322,10,"UploadFrame.FileInputElement is null"),n=$$as(Common.App.InsertPicture.a,this.e),t=n.T(this.a.a.value),t)?(i=n.S(t),Common.App.InsertFile.a.b(i),!1):!0}};Common.App.InsertPicture.a=function(n,t,i){Common.App.InsertPicture.a.initializeBase(this,[n,t,i])};Common.App.InsertPicture.a.c=function(n,t){for(var r=n.toLowerCase(),i=0;i<t.length;++i)if(r.endsWith(t[i]))return!0;return!1};Common.App.InsertPicture.a.b=function(n,t){return(t||(t=Common.App.InsertPicture.a.a),!n)?1:Common.App.InsertPicture.a.c(n,t)?0:2};Common.App.InsertPicture.a.prototype={d:null,q:null,bd:function(){return Common.a.b().d()},S:function(n){switch(n){case 1:return $a.by;case 2:return $a.ik;default:return""}},T:function(n){return Common.App.InsertPicture.a.b(n,this.be())},be:function(){return Common.App.InsertPicture.a.a},h:function(n,t){var i=this.T(n),r,u;return i?(t&&t.M(),i===2&&(r=this.S(i),u=this.A(i),this.bf(u,r)),!1):!0},f:function(n,t){Diag.a.a(36783360,322,50,"PictureUploader.FinalizeUpload");this.u=t;this.C()&&this.bg();Common.PerfMetrics.a(5576);this.q=this.bd().a("LoadResource","PictureUploadTime");var i=this.D();i?this.y(n):this.p()},bf:function(n,t){var i=new CommonUI.d;i.D(0);i.bg(n,$a.ii,t,null)},p:function(){Diag.a.a(36783361,322,50,"PictureUploader.OnUploadComplete");Common.App.InsertFile.c.prototype.p.call(this);this.q&&(this.q.a(),this.q=null);this.B()&&this.bc()},bg:function(){var n=new CommonUI.g;this.d=n.a(!1);this.d.d($a.il);this.d.b(5);this.d.c(!1);this.d.e(null,null,null)},bc:function(){return this.d?(this.d.a(),this.d=null,!0):!1}};Common.App.InsertPicture.b=function(){};Common.App.InsertPicture.b.b=function(){return CommonUI.b.a(Common.App.InsertPicture.b.a,$a.ih,$a.by)};Common.App.InsertPicture.c.registerClass("Common.App.InsertPicture.c",Common.App.InsertFile.a);Common.App.InsertPicture.a.registerClass("Common.App.InsertPicture.a",Common.App.InsertFile.c);Common.App.InsertPicture.a.a=[".jpg",".jpeg",".png",".gif",".bmp",".tif",".tiff"];Common.App.InsertPicture.b.a="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'><\/div> <div class='WACDialogError' id='errorText' role='alert'>{1}<\/div> <\/div>";Type.registerNamespace("_Ewa");_Ewa.bjK=function(){};_Ewa.bjK.a=function(){Common.M.a(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}")};_Ewa.bjK.a();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Common.App.FirstRunExperienceLauncher.a=function(){};Common.App.FirstRunExperienceLauncher.a.registerInterface("Common.App.FirstRunExperienceLauncher.a");Common.App.FirstRunExperienceLauncher.e=function(){};Common.App.FirstRunExperienceLauncher.e.registerInterface("Common.App.FirstRunExperienceLauncher.e");Common.App.FirstRunExperienceLauncher.b=function(){this.h=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m)};Common.App.FirstRunExperienceLauncher.b.prototype={b:null,d:null,c:null,a:function(n){if(!n){Diag.a.a(51675531,306,10,"Invalid launcherSettings");return}if(this.b=n,this.n()){Diag.a.a(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service");var t,i=(t=new($$sc.v.$$(String)),t.b(this.b.a()),t);this.d=new Common.App.FirstRunExperienceLauncher.d(this.b,this.g,this.f,null,this.i);this.d.k(i)}(this.b.d()||Common.a.a.d("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.e()},n:function(){var t,i,r,n,u;try{return this.b.d()?!0:(t=Common.a.a.d("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0),!t)?!1:(i=Common.a.a.a("IsAnonymousUser"),i)?!1:this.b.i()||this.b.j()?!0:(r=Common.a.a.a("IsO365ConsumerHost"),r)?!0:(n=Common.a.a.b("FlightId"),u=n?n.toString().toLowerCase():"",u.indexOf("firstrunexperienceui")!==-1)}catch(f){Diag.a.a(576582624,306,10,"Error checking setting {0}",f?f.toString():null)}return!1},j:function(n,t){var r={},i={};i.FREDisplayedDate=(new Date).toUTCString();i.VersionDisplayed=n;i.RemindMeLater=t;r[this.b.a()]=JSON.stringify(i);Diag.a.a(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.d&&this.d.l(r)},m:function(n,t){var i=n?n.i-n.h:-1;if(i>this.b.g()){Diag.a.a(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",i,this.b.g());return}if(!t){Diag.a.a(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed.");this.e();return}if(this.q(t)){Diag.a.a(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.b.e());this.e();return}Diag.a.a(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")},l:function(n){Diag.a.a(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",n?n.a:-1)},p:function(n){Diag.a.a(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",n?n.a:-1)},e:function(){var t=Common.Utils.a.a().d(Common.bn,null),n,i;if(t){this.k(t);return}if(Diag.a.a(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Common.a.a.d("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)){if(n=Common.Utils.a.a().b(Common.bn,null),!n){Diag.a.a(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future");return}i=this;n.a(function(n){i.k(n)})}},k:function(n){if(!n)return Diag.a.a(539494112,306,50,"Invalid ISystemInitiatedFeedback"),!1;var t=this.b.h();return t&&(Common.a.Z(t),Common.a.ch(t)),Diag.a.a(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",t),n.a("ShowFirstRunExperienceUIV2",null,null),window.addEventListener?(this.c=this.h,window.addEventListener("FGWebSurfaceEvent",this.c,!0),window.addEventListener("FRELaunchedEvent",this.c,!0)):(Diag.a.a(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.j(this.b.c(),!1)),!0},o:function(n){var r;if(n){var t=n.detail,u=n.type,i=this.b&&this.b.b()?this.b.b().split("-")[0]:null;(u==="FRELaunchedEvent"||i&&t&&t.id&&t.id.indexOf(i)!==-1)&&(r=t.success,r&&(Diag.a.a(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.j(this.b.c(),!1)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.c,!0),window.removeEventListener("FRELaunchedEvent",this.c,!0)))}},q:function(n){if("RemindMeLater"in n&&"FREDisplayedDate"in n&&n.RemindMeLater.toString()==="true"){var t=new Date(n.FREDisplayedDate.toString()),i=new Date,r=(i-t)/36e5;if(r>this.b.e())return!0}return!1}};Common.App.FirstRunExperienceLauncher.c=function(){};Common.App.FirstRunExperienceLauncher.c.a=function(){Common.App.a.a().a(new Common.App.FirstRunExperienceLauncher.c,0,!1)};Common.App.FirstRunExperienceLauncher.c.prototype={d:null,a:function(){return"Common.App.FirstRunExperienceLauncher"},c:function(n){this.d=n;var t=this;this.d.c(Common.App.FirstRunExperienceLauncher.a,null).a().b(function(){return new Common.App.FirstRunExperienceLauncher.b})},b:function(){}};Common.App.FirstRunExperienceLauncher.d=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.n);this.a=n;this.c=t;this.b=i;this.e=r;this.d=u};Common.App.FirstRunExperienceLauncher.d.prototype={a:null,c:null,b:null,e:null,d:null,k:function(n){var t=new Sys.StringBuilder(this.a.f()),i;t.append("RoamingServiceHandler.ashx?action=");t.append("getFirstRunExperienceSettings");t.append("&");t.append(this.m(n));t.append("&");t.append(Common.a.i);i=t.toString();Common.a.e.a(i,1,null,null,!0,2,this.g,this.f,null,null,!1,null,null,null,null,!1,null,!1,null)},l:function(n){var t=new Sys.StringBuilder(this.a.f()),i,r;t.append("RoamingServiceHandler.ashx?action=");t.append("saveFirstRunExperienceSettings");t.append("&");t.append(Common.a.i);i=t.toString();r=JSON.stringify(n);Common.a.e.a(i,2,r,null,!0,4,this.i,this.h,null,null,!1,null,null,null,null,!1,null,!1,null)},n:function(n){var r=!1,u=null,t,i;try{n.b.b.length>0&&(t=$$as(Object,JSON.parse(n.b.b)),i=t?t[this.a.a()]:null,i&&(u=$$as(Object,JSON.parse(i.toString()))));r=!0}catch(f){this.j(null)}r&&this.c&&this.c(n.b,u)},j:function(n){this.b&&this.b(n?n.b:null)},p:function(n){this.e&&this.e(n?n.b:null)},o:function(n){this.d&&this.d(n?n.b:null)},m:function(n){for(var i=new Sys.StringBuilder("requestedsettings="),t=0;t<n.f.length;t++)i.append(n.a(t)),t<n.f.length-1&&i.append(";");return i.toString()}};Common.App.FirstRunExperienceLauncher.d.registerClass("Common.App.FirstRunExperienceLauncher.d");Common.App.FirstRunExperienceLauncher.c.a();Type.registerNamespace("_Ewa");_Ewa.Lp=function(n){this.k=n};_Ewa.Lp.prototype={k:null,a:function(){return"Excel"},b:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"},c:function(){return 0},i:function(){return this.l()&&this.k.L(358)},j:function(){return this.l()&&this.k.L(360)},d:function(){return this.k.L(359)},h:function(){return null},e:function(){return 24},g:function(){return 4e3},f:function(){return this.k.e().WebServiceBase||""},l:function(){var t=Common.a.a?Common.a.a.a("IsAnonymousUser"):!0,n;return t?!1:(n=Common.a.d?$$as(String,Common.a.d.AudienceGroup):"",n!=="Unknown"&&n!=="Automation")}};_Ewa.FirstRunExperienceManager=function(n,t){this.a=n;this.b=t};_Ewa.FirstRunExperienceManager.prototype={a:null,b:null,c:function(){this.a&&this.a.a(this.b)}};_Ewa.xO=function(n){_Ewa.xO.initializeBase(this);this.h=n;this.l()};_Ewa.xO.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.nf),312,new _Ewa.xO(n))};_Ewa.xO.prototype={h:null,a:function(){this.k(this.h.a().a(_Ewa.nf,311,!1,null)||this.m())},m:function(){var t=new _Ewa.Lp(this.h),n=new _Ewa.FirstRunExperienceManager(Common.Utils.a.a().a(Common.App.FirstRunExperienceLauncher.a,null),t);return n.c(),n}};_Ewa.FirstRunExperienceManager.registerClass("_Ewa.FirstRunExperienceManager",null,_Ewa.nf);_Ewa.xO.registerClass("_Ewa.xO",_Ewa.sX.$$(_Ewa.nf));Type.registerNamespace("_Ewa");_Ewa.bhk=function(){};_Ewa.bhk.a=function(){_Ewa.m.a(function(){_Ewa.m.a(_Ewa.xO.a)})};_Ewa.bhk.a();Type.registerNamespace("_Ewa");_Ewa.yU=function(n){_Ewa.yU.initializeBase(this);this.m=n;this.l()};_Ewa.yU.a=function(n){n.a().b(_Ewa.bkq.$$(Common.cE),362,new _Ewa.yU(n))};_Ewa.yU.prototype={m:null,h:null,a:function(){this.k(this.m.a().a(Common.cE,361,!1,null)||this.p())},p:function(){if(this.h=Common.Utils.a.a().d(Common.cE,null),_Ewa.Q.a().c()){var n=this;Common.App.AppLifecycleManager.get_instance().a(16,function(){n.n()},3)}else this.n();return this.h},n:function(){var n=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.a("MsoPremiumBadge",!0).then(function(i){return!i&&t.b()&&n.h.d(),null})})}};_Ewa.yU.registerClass("_Ewa.yU",_Ewa.sX.$$(Common.cE));Type.registerNamespace("_Ewa");_Ewa.bjF=function(){};_Ewa.bjF.a=function(){_Ewa.m.a(function(){_Ewa.m.a(_Ewa.yU.a)})};_Ewa.bjF.a();Type.registerNamespace("_Ewa");_Ewa.St=function(n,t){this.sheetName=n;this.dataUri=t};_Ewa.St.prototype={sheetName:null,dataUri:null};_Ewa.po=function(){};_Ewa.po.prototype={unknown:0,bing:1,m365:2};_Ewa.po.registerEnum("_Ewa.po",!1);_Ewa.bjH=function(){};_Ewa.bjH.registerInterface("_Ewa.bjH");_Ewa.NR=function(){};_Ewa.yX=function(n,t,i,r,u,f,e){_Ewa.yX.initializeBase(this,[n,t,i,r,u,!1]);this.n=!1;this.j=e;this.i=_Ewa.yX.a(f);var o=this.J(this.i.name,this.i.size);if(o){this.X(o);this.j.SX(Error.create("DataUrlUploaderWrapper: Invlid data url"));this.dispose();return}this.b=new _Ewa.nt(this.a.q(),this.m,this.g,r,!1,this.a,!1)};_Ewa.yX.a=function(n){var i=n.split(","),r,e,u,t,o,f;for(r=i[0].indexOf("base64")>=0?window.self.atob(i[1]):window.self.decodeURI(i[1]),e=i[0].split(":")[1].split(";")[0],u=new Uint8Array(r.length),t=0;t<r.length;t++)u[t]=r.charCodeAt(t);return o=new Blob([u],{type:e}),f=o,f.name="Image.png",f};_Ewa.yX.prototype={j:null,i:null,I:function(n,t,i){_Ewa.lL.prototype.I.call(this,n,t,i);this.j.SX(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))},x:function(n,t,i){_Ewa.lL.prototype.x.call(this,n,t,i);_Ewa.i.c(n.Errors)?this.j.SX(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",_Ewa.i.a(n.Errors,",")))):this.j.a(!0)},Y:function(n){var t=new Common.App.InsertFile.b(this.i.name,this.i);n.W(t)}};_Ewa.NO=function(n,t,i){this.l=Function.createDelegate(this,this.bJ);_Ewa.NO.initializeBase(this,[n,!1]);this.m=t;this.h=n;this.d=Common.s.a();this.s=i;Common.App.InsertFile.a.prototype.B.call(this);this.bD();this.m.n().i(!0)};_Ewa.NO.prototype={m:null,h:null,g:null,n:!1,d:null,s:null,r:function(n,t){return new _Ewa.nt(n,t.m,t.g,this.s,!0,this.m,!1)},dispose:function(){this.bg();this.h=null;this.d=null;Common.App.InsertFile.a.prototype.dispose.call(this)},F:function(){CommonUI.c.prototype.F.call(this);this.m.n().i(!1)},bV:function(){var i=this.h.Z(this.a),n=this.h.J(this.a.a.value,i),t;return n?(t=this.h.F(n).Description,this.g.innerHTML=t,this.bK(),!1):!0},z:function(){return!0},bD:function(){this.g=document.getElementById("errorText");this.g.style.display="inline-block";this.n=!1;this.g.innerHTML="";this.bH().style.maxWidth=this.bH().currentStyle.minWidth},bK:function(){this.d.a("click",this.a.a,this.l);this.d.a("keydown",this.a.a,this.l);this.n=!0},bg:function(){this.n&&(this.d.b("click",this.a.a,this.l),this.d.b("keydown",this.a.a,this.l),this.n=!1)},bJ:function(){return this.g.innerHTML="",this.bg(),!1}};_Ewa.NS=function(n,t,i,r,u,f){this.r=Function.createDelegate(this,this.w);this.s=Function.createDelegate(this,this.x);_Ewa.NS.initializeBase(this,[null,i,r]);this.a=n;this.i=t;this.j=f;this.k=Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null);this.E()};_Ewa.NS.prototype={k:null,a:null,i:null,j:null,l:0,z:function(n){var u,i,t,r,f;if(!n){Diag.a.a(556864836,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null");return}for(u=n,i=new Array(u.length),t=0;t<u.length;t++)r=u[t],i[t]={},i[t].SourceUrl=r.SourceUrl,Common.d.j(r.LicenseUrl,!1)&&Common.d.j(r.PageUrl,!1)&&(i[t].LicenseUrl=r.LicenseUrl,i[t].LicenseDisplayName=r.LicenseDisplayName,i[t].PageUrl=r.PageUrl),i[t].AltText=this.i.a===-2053056795?r.Caption:"";var o=this.i.a===-2009825598?_Ewa.po.toString(1):_Ewa.po.toString(2),s=_Ewa.c.a(this.a),h=_Ewa.h.c(s.a().a().a(),this.a),l=this,c=function(n){return new _Ewa.v(595,0,n,0,null)},e=this;_Ewa.H.a(this.a.f(),function(n,t,r){return _Ewa.k.W(e.a.c().a(),h,i,o,_Ewa.n.a(n,e.s),_Ewa.n.b(t,e.r),r,null)},c,this.i);_Ewa.j.j()?(f=new Map,f.set("MediaProvider",o),f.set("ImagesCount",u.length.toString()),f.set("TimeTakenToOpenDialog",this.l.toString()),Common.i.a().recordKpiUsage(_Ewa.fy.b.e,1,_Ewa.fy.c.a,f)):Diag.a.a(555033361,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");Common.App.InsertPicture.a.prototype.p.call(this)},dispose:function(){this.a=null},A:function(){return 0},D:function(){return!0},C:function(){return!0},B:function(){return!0},y:function(){},E:function(){var n=null,t;n=this.a.o().a("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.i.a){case-2009825598:this.F();break;case-2053056795:t=this;this.k.a(function(n){n.a("MsoPremiumStockImages",!1).catch(function(n){return Diag.a.a(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",n)}).then(function(n){return t.G(n),null})})}n.a();this.l=n.b()},F:function(){var n=this.a.e().InsertOnlineBingPictureEndpoint,t=Common.e.b(Common.a.n),r=Common.u.a(),i;!n||!n.length?(Diag.a.a(557200642,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.j.SX(Error.create("Failed to access the Bing service endpoint"))):(i=new RegExp("insertmedia.bing.office.net","gi"),n=n.search(i)>0?_Ewa.rO.b(1,1,n):String.format(n,1,Common.a.n,t?t.a:"en-us",Common.a.m,r.a,1,this.a.e().DocumentHostInfo.LoggableUserId),this.v(n,1,-1,_Ewa.ClientStringManager.a().a(1667)))},G:function(n){var t=this.a.e().InsertOnlineM365PictureEndpoint,u=Common.u.a(),i=-1;if(!t||!t.length)Diag.a.a(557200641,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.j.SX(Error.create("Failed to access the M365 service endpoint"));else{var r=this.a.e().DocumentHostInfo.UserId,f=!r||!r.length?"0":Common.d.e(r).toString(),e=this.k.b().b();i=n?1:e?0:-1;t=_Ewa.rO.a(1,t,i,1,u.a,f);t+="&disabledpivots=illustrations,icons";this.v(t,2,i,_Ewa.ClientStringManager.a().a(1666))}},v:function(n,t,i,r){try{var f=new _Ewa.NQ(this.a,n,Common.Utils.a.a().d(Common.App.ApplicationFeatureHelper.a,null),t,i,r);f.w(this);this.j.a(!0)}catch(u){Diag.a.a(557200640,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",u,t,i);this.j.SX(u)}},x:function(n){_Ewa.O.a(n)?Diag.a.a(556864833,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",_Ewa.i.a(n.Errors,",")):(Diag.a.a(556864835,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),n.Result?_Ewa.R.a(this.a).c(1,n.Result,!1):Diag.a.a(556864834,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))},w:function(){Diag.a.a(556864832,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")}};_Ewa.NT=function(n){this.a=n};_Ewa.NT.prototype={a:null,x:function(n,t,i){var f=t.a,r,u;switch(f){case 1403967063:return i&&"dataUrl"in i?(r=new($$sc.D.$$(Boolean)),new _Ewa.yX(this.a,null,Common.S.a(),Common.a.a,i,i.dataUrl,r),r.b):(new _Ewa.lL(this.a,t,Common.S.a(),Common.a.a,i,!0),$$sc.a.a(Boolean,!0));case-2053056795:case-2009825598:return u=new($$sc.D.$$(Boolean)),new _Ewa.NS(this.a,t,Common.S.a(),Common.a.a,i,u),u.b;default:return _Ewa.Y.a(f)}},w:function(n,t){var i=this.a.j();if(i)switch(t.a){case 1403967063:i=!0;break;case-2053056795:i=_Ewa.a.c("Microsoft.Office.Excel.InsertOnlinePictures",!1);break;case-2009825598:i=_Ewa.a.c("Microsoft.Office.Excel.InsertOnlinePictures",!1);i=i&&_Ewa.a.c("Microsoft.Office.Excel.InsertBingPictures",!1);break;default:i=!1}return i},y:function(){return!1},z:function(){return!1}};_Ewa.yY=function(n){_Ewa.yY.initializeBase(this,[n])};_Ewa.yY.a=function(n){_Ewa.bh.a(90,new _Ewa.yY(n))};_Ewa.yY.prototype={n:function(){this.m([new _Ewa.NT(this.h)],null)}};_Ewa.lL=function(n,t,i,r,u,f){this.U=Function.createDelegate(this,this.bk);this.V=Function.createDelegate(this,this.bl);_Ewa.lL.initializeBase(this,[null,i,r]);this.a=n;this.v=t;this.s=n.o().b("WebServiceCall","InsertPictureOperation");this.k=_Ewa.B.a().a(this.V,1e5,_Ewa.o.cb,!1,!1);this.l=!1;this.r=this.a.e().InsertPictureMaxFileSizeBytes;u&&(this.G="TestOnly"in u);f&&this.bn()};_Ewa.lL.d=function(n){if(n&&n.length&&!_Ewa.f.b(n,"UnknownError",!0)){if(_Ewa.f.b(n,"NoFileSelectedError",!0))return 1;if(_Ewa.f.b(n,"FileTooBig",!0))return 3;if(_Ewa.f.b(n,"MaxConnectionsReached",!0))return 5}else return 2;return 0};_Ewa.lL.c=function(n,t,i,r){return _Ewa.i.b(1,0,0,n,t,i,r)};_Ewa.lL.b=function(n){switch(n){case 1:return 1;case 2:return 6}return 0};_Ewa.lL.a=function(){return _Ewa.a.a("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!isNullOrUndefined(window.self.FormData)?!0:!1};_Ewa.lL.prototype={s:null,v:null,H:null,E:null,k:null,l:!1,r:0,G:!1,w:null,a:null,bh:function(){return this.r/1048576},z:function(n){var t,u,i,r;this.s.a();this.k.a();t=n;u=!_Ewa.nt.a(t);u?(i=_Ewa.lL.d(t),i?(Diag.a.a(34193863,0,50,"Server returned error, response: {0}",t),this.W(i)):this.bi(t)):(this.l?this.W(4):(r=new Common.gh(0,2,null,null,!1,null,null,null),r.c=8,this.I(new Common.eV(r),null,"InsertPictureWebMethod")),Diag.a.a(33863624,0,50,"Http Error occurred, isTimeoutError: {0}",this.l));Common.App.InsertPicture.a.prototype.p.call(this);this.dispose()},dispose:function(){System.a.a(this.k);this.b&&this.b.M();this.a=null;this.k=null;this.b=null},bk:function(n){this.h(n,this.b)&&this.f(this.b,null)},R:function(n){if(Diag.a.a(544815180,0,50,"Upload frame initialized"),this.b=n,!this.e){if(this.n){if(_Ewa.lL.a()||this.t&&Common.c.k()){n.x(this.U);return}var t=n.x(null);if(!this.h(t,n))return}this.f(n,null)}},f:function(n,t){Common.App.InsertPicture.a.prototype.f.call(this,n,t);var i=this,u=function(t,r){return i.H=t,i.E=r,i.s.d(),i.k.c(-1),i.l=!1,i.Y(n),i.bm(n)},r=this,f=function(n){var i={};r.a.A(i);var f=i.SheetName,u=function(){return new _Ewa.St(f,r.w?r.w:"")},t=_Ewa.a.d()?new _Ewa.v(510,0,n,72,u):new _Ewa.ba(510,0,n,8,u);return t.T=function(){return!0},t.I=r.v,t};_Ewa.H.a(this.a.f(),u,f,this.v)},bm:function(n){if(!this.a)return Diag.a.a(572269585,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),$$sc.a.a(Boolean,!0);if(!this.a.bv())return $$sc.a.a(Boolean,!0);var i=new($$sc.D.$$(Boolean)),t=new FileReader,u=n.a.files[0],f=this,e=function(){f.w=t.result;i.d(!0)},o=this,r=function(){i.d(!0)};return t.onload=e,t.onerror=r,t.onabort=r,t.readAsDataURL(u),i.b},Z:function(n){var i=-1,t=n.a;return t&&t.files&&t.files.length>0&&(i=t.files[0].size),i},J:function(n,t){var i=_Ewa.lL.b(Common.App.InsertPicture.a.b(n,null));return i?i===6&&this.bj(n):t!==-1&&(Diag.a.a(34193864,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",t,this.r,this.a.b().bI()),t>this.r?i=3:t>this.a.b().bI()&&(i=7)),Diag.a.a(34193865,0,50,"Validated file on client, validation result: {0}",i),i},A:function(){return 0},D:function(){return!0},C:function(){return!0},B:function(){return!0},y:function(){},h:function(n,t){var r=this.Z(t),i=this.J(n,r);return i?(this.e||i===1||this.X(i),!1):!0},Y:function(n){n.bm()},F:function(n){var u=0,t=1,i=-1100324317,r="InsertPictureUnknownError",f=null,e;switch(n){case 1:u=1661;t=0;i=940870981;r="InsertPictureNoFileSelected";break;case 3:t=0;i=1250467391;r="InsertPicturePictureTooBig";f=String.format(_Ewa.ClientStringManager.a().c(170),this.bh().toLocaleString());break;case 6:u=1665;t=0;i=1380041209;r="InsertPictureUnsupportedFormat";break;case 7:u=1662;t=0;i=-903115058;r="InsertPictureExceedWorkbookSize";break;case 4:u=1663;t=0;i=1218352119;r="InsertPictureUploadTimeout";break;case 5:u=1664;t=0;i=1979899005;r="InsertPictureServiceNonDeterministicError"}return e=_Ewa.lL.c(u,t,i,r),f&&(e.Description=f),e},bn:function(){if(_Ewa.lL.a())this.e=!1,this.b=new _Ewa.nt(this.a.q(),this.m,this.g,this.c,!1,this.a,!0);else if(Diag.a.a(34193866,0,50,"Showing Insert Picture dialog"),!this.G&&(Common.c.h()||Common.c.k()&&Common.c.bh()<72))this.e=!1,this.b=new _Ewa.nt(this.a.q(),this.m,this.g,this.c,!1,this.a,!1);else{this.e=!0;var n=new _Ewa.NO(this,this.a,this.c);this.b=n.a}},bi:function(n){var t={},r,i;try{t=_Ewa.E.b(n);_Ewa.F.a().c(this.s.c(),t.ServerCorrelationId,_Ewa.bo.toString(0),"ServerActions",!0);!_Ewa.i.c(t.Errors)&&t.Result&&(this.a.b().Q(t.StateId,"PictureUploaderWrapper.UploadResponseReceived"),r=t.Result,_Ewa.R.a(this.a).c(1,r,!1),i=this.a.a().a(_Ewa.kK,277,!1,null),i&&i.b(this.a,1,t.Result,t,"InsertPicture"),Diag.a.a(34193867,0,50,"Insert picture completed successfully :)"))}catch(u){Diag.a.a(25801035,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:-1,u)}this.x(t,null,"InsertPictureWebMethod")},W:function(n){var i=this.F(n),t={};t.Errors=[i];this.x(t,null,"InsertPictureWebMethod")},x:function(n,t,i){this.H(n,t,i)},I:function(n,t,i){this.E(n,t,i)},X:function(n){var t=this.F(n),r,i;_Ewa.a.f()?r=new _Ewa.es(this.a,t,null):(i=new _Ewa.dt(this.a,t),i.z(!1))},bl:function(){this.l=!0},bj:function(n){for(var i=this.a.e().InsertPicturUnsupportedExtensionsForLogging,r=n.toLowerCase(),t=0;t<i.length;++t)if(r.endsWith(i[t])){Diag.a.a(34193868,0,50,"Insert picture blocked invalid extension: {0}",i[t]);return}}};_Ewa.nt=function(n,t,i,r,u,f,e){_Ewa.nt.initializeBase(this,[n,t,i,r,u,"UploadFrame",f.b().k(),"image/*",!1,null,e]);this.j=f;this.n=!0;_Ewa.a.a("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?Common.App.InsertFile.d.prototype.T.call(this):Common.App.InsertFile.d.prototype.N.call(this)};_Ewa.nt.a=function(n){return!n||!n.length||_Ewa.f.b(n,"ServerUploadError",!1)};_Ewa.nt.prototype={j:null,F:function(n){return n},V:function(n){Diag.a.b(33863626,0,!!this.v,"SessionId shouldn't be null.");_Ewa.X.g(n,this.j.e());n.b("sessionId",this.v);var i=_Ewa.c.a(this.j).a(),t=_Ewa.h.c(i.a().h(),this.j);n.b("sheetName",this.j.d().a().a());n.b("row",t.FirstRow.toString());n.b("col",t.FirstColumn.toString())},B:function(){},S:function(){this.u("ServerUploadError")},h:function(n){this.u(n)}};_Ewa.NQ=function(n,t,i,r,u,f){this.o=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);this.m=Function.createDelegate(this,this.q);_Ewa.NQ.initializeBase(this,[!1,!1,!1,!1]);this.l=f;this.e=n;this.i=t;this.d=i;this.b=[];this.g=r;this.k=u;this.h=this.e.e().InsertOnlinePictureMaxCountOfImagesToInsert;this.M=this.p()};_Ewa.NQ.prototype={d:null,i:null,b:null,l:null,f:!1,c:null,a:null,h:0,j:null,e:null,k:0,g:0,w:function(n){var r,t,i,u,f,e,o,s,h,c;if(this.f=!1,this.bz(this.l,null),this.c=document.getElementById(this.K+"InsertMediaFrame"),!this.c){this.bR(this.W,0);throw Error.invalidOperation("Couldn't get InsertMediaIframe.");}if(r=document.getElementById(this.K+"WACDialogPanel"),r&&r.setAttribute("role","dialog"),t=document.createElement("div"),t.id="KeepFocusStartDiv",t.tabIndex=0,t.className="keep-focus-start",this.c.parentNode.insertBefore(t,this.c.parentNode.firstChild),i=document.createElement("div"),i.id="KeepFocusDiv",i.tabIndex=0,i.className="keep-focus",this.c.parentNode.appendChild(i),$addHandler(this.bH(),"keydown",this.m),this.c.src=this.i,this.c.frameBorder="0",u=document.getElementById(this.K+"WACDialogButtonPanel"),!u)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");if(u.className="display-none",f=document.getElementById(this.K+"WACDialogTitleText"),!f)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");f.className="display-none";this.g===2&&(e=document.getElementById(this.K+"WACDialogTitlePanel"),e.className="display-none",o=document.getElementById(this.K+"WACDialogBodyPanel"),o.className="padding-zero");Common.q.a().j().e.e=!0;this.a=new _Ewa.NP(this.c.contentWindow,this.i);s=this;this.a.e("AddItem",function(t){s.r(t,n.g)});h=this;this.a.e("Insert",function(t){h.t(t,n.g)});this.a.e("CancelDialog",this.n);this.g!==2||this.k||(this.a.e("LaunchM365Upsell",this.o),c=this,this.j=this.d.c("MsoPremiumStockImages",function(n){Diag.a.a(556328527,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");n.isEnabled?c.a.a("UpgradeFeatureTier",{LicenseTier:n.toString()},""):Diag.a.a(556328526,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))},dispose:function(){this.b=null;this.d&&this.j&&this.d.e("MsoPremiumStockImages",this.j);this.a&&(this.a.dispose(),this.a=null);CommonUI.b.prototype.dispose.call(this)},F:function(){CommonUI.c.prototype.F.call(this);_Ewa.bZ.f(this.e)},bu:function(){return"dialog/InsertMediaDialog"},bo:function(){return!1},r:function(n,t){var i=_Ewa.rO.c(n);i&&(Array.add(this.b,i),this.f&&(Diag.a.a(556864803,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),t(this.b),this.f=!1,this.bR(this.W,0)))},s:function(){this.bR(this.W,0)},t:function(n,t){this.b&&this.b.length>0?this.b.length<=this.h?(t(this.b),this.bR(this.W,0)):(this.v(),Diag.a.a(557160267,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.b)):this.f=!0},q:function(n){var t,i;n.keyCode===9&&(n.target.id!=="KeepFocusDiv"||n.shiftKey?!(n.target.id==="KeepFocusStartDiv"&n.shiftKey)||(n.preventDefault(),i=document.getElementById("KeepFocusDiv"),i.focus()):(n.preventDefault(),t=document.getElementById("KeepFocusStartDiv"),t.focus()))},p:function(){var t=document.createElement("div"),n,i;return t.id="InsertMediaDialog",t.className=_Ewa.a.c("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old",n=document.createElement("div"),n.id="InsertMediaPanel",n.className=_Ewa.a.c("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old",i=document.createElement("iframe"),i.id="InsertMediaFrame",i.className="insert-media-frame",t.appendChild(n),n.appendChild(i),Common.bL.b(t)},u:function(){this.d&&(this.d.d("stockimages",null),Diag.a.a(556328525,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))},v:function(){var n=_Ewa.i.b(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount"),i,t;n.Description=String.format(_Ewa.ClientStringManager.a().c(195),this.h.toLocaleString());_Ewa.a.f()?i=new _Ewa.es(this.e,n,null):(t=new _Ewa.dt(this.e,n),t.z(!1))}};_Ewa.rO=function(){};_Ewa.rO.b=function(n,t,i){return String.format(i,t,n)};_Ewa.rO.a=function(n,t,i,r,u,f){var e=Common.e.b(Common.a.n).a,o=Common.a.m;return String.format(t,Common.a.n,e,o,u,n,f,i,r)};_Ewa.rO.c=function(n){var t,i;return!n||!n.Values?null:(t=n.Values,!t)?null:(i=new _Ewa.NR,i.Action=t.action||"",i.Caption=t.caption||"",i.ContentType=t.contentType||"",i.FileExtension=t.extension||"",i.PageUrl=t.pageUrl||"",i.SourceUrl=t.sourceUrl||"",i.ThumbnailUrl=t.thumbnailUrl||"",i.LicenseUrl=t.licenseUrl||"",i.LicenseDisplayName=t.licenseDisplayName||"",i.Height=t.height||0,i.Width=t.width||0,i)};_Ewa.NP=function(n,t){_Ewa.NP.initializeBase(this,[n,Common.k.h(t),null])};_Ewa.NP.prototype={e:function(n,t){if(this.n&&this.h(this.u)){this.c(n);var i=this.b(n,t)}}};_Ewa.St.registerClass("_Ewa.St");_Ewa.NR.registerClass("_Ewa.NR");_Ewa.lL.registerClass("_Ewa.lL",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.yX.registerClass("_Ewa.yX",_Ewa.lL);_Ewa.NO.registerClass("_Ewa.NO",Common.App.InsertPicture.c);_Ewa.NS.registerClass("_Ewa.NS",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.NT.registerClass("_Ewa.NT",null,_Ewa.lI);_Ewa.yY.registerClass("_Ewa.yY",_Ewa.bh);_Ewa.nt.registerClass("_Ewa.nt",Common.App.InsertFile.d);_Ewa.NQ.registerClass("_Ewa.NQ",CommonUI.b);_Ewa.NP.registerClass("_Ewa.NP",Common.dl,_Ewa.bjH,Common.mc,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.bjI=function(){};_Ewa.bjI.a=function(){_Ewa.m.a(function(n){_Ewa.yY.a(n)})};_Ewa.bjI.a();Type.registerNamespace("_Ewa");_Ewa.Un=function(n){this.e=Function.createDelegate(this,this.h);this.d=Function.createDelegate(this,this.g);this.c=n;this.b=_Ewa.A.a(this.c).a();this.b.k(this.d);this.b.n(this.e)};_Ewa.Un.prototype={c:null,a:null,b:null,dispose:function(){this.b.m(this.d);this.b.q(this.e);this.c=null;this.b=null;this.a=null},h:function(n,t){this.f(t,3)},g:function(n,t){this.f(t,2)},f:function(n,t){n.a?this.a=new _Ewa.Un.a(_Ewa.q.a().a(),this.c,!!n.b,t):(n.b===5&&(this.a.wasInteruptedByOfflineMode=!0),(n.b===3||n.b===2)&&Diag.a.a(542782152,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.a.e(this.c),t===2?_Ewa.a.a("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?_Ewa.F.a().m(571289604,0,50,_Ewa.fy.g.a,this.a.durationMs,this.a):Diag.a.a(571289604,0,50,_Ewa.E.a(this.a)):_Ewa.a.a("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?_Ewa.F.a().m(542782150,0,50,_Ewa.fy.g.c,this.a.durationMs,this.a):Diag.a.a(542782150,0,50,_Ewa.E.a(this.a)),this.a=null)}};_Ewa.Un.a=function(n,t,i,r){_Ewa.Un.a.initializeBase(this,[n,t,i]);this.type=r;this.wasInteruptedByOfflineMode=!1};_Ewa.Un.a.prototype={wasInteruptedByOfflineMode:!1};_Ewa.Ui=function(n){this.h=Function.createDelegate(this,this.n);this.d=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.l);this.a=n;_Ewa.A.a(this.a).a().j(this.g);this.a.K().f(this.f)};_Ewa.Ui.prototype={a:null,b:null,c:null,e:0,i:null,dispose:function(){this.a&&(_Ewa.A.a(this.a).a().l(this.g),this.a.K()&&this.a.K().k(this.f));this.b&&this.a.c().f().l(this.d);this.a=null},l:function(n,t){var i;if(t.a){var r=t.b===5,u=!!t.b,f=this.a.K().h();this.b=new _Ewa.Ui.a(_Ewa.q.a().a(),this.a,r,u,f,this.i);this.c=this.a.K().i();this.e=1;this.a.c().f().p(this.d);_Ewa.dK.a(this.a).c(this.h)}else i=t.b===5,this.b.g(this.a,i),this.a.c().f().l(this.d),this.b.lastFailedRequestToOnlineTimeGapSec=_Ewa.bi.b(this.c,_Ewa.q.a().a()),_Ewa.a.a("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?_Ewa.F.a().l(557682689,0,50,_Ewa.fy.g.b,this.b.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",_Ewa.E.a(this.b)):Diag.a.a(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",_Ewa.E.a(this.b)),_Ewa.a.a("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.b&&this.b.isToastShown&&Common.i.a().recordQosError(_Ewa.boY.b.d,[_Ewa.boY.a.c],!0,!1,!1,!1,null),_Ewa.dK.a(this.a).e(this.h),this.b=null},n:function(n,t){this.b.errorDataDuringConnectivityIssuesMode=t.a},m:function(n,t){this.b.h(t.a.a);var r=_Ewa.q.a().a(),i=_Ewa.bi.b(this.c,r);this.c=r;i>this.b.longestDurationBetweenFailedRequestsSec&&(this.b.longestDurationBetweenFailedRequestsSec=i);this.e++;this.b.averageDurationBetweenFailedRequestsSec=this.j(i)},j:function(n){var t=this.e-1,i=this.b.averageDurationBetweenFailedRequestsSec;return(i*(t-1)+n)/t},k:function(n,t){this.i=t.a}};_Ewa.Ui.a=function(n,t,i,r,u,f){this.failedRequests=[];_Ewa.Ui.a.initializeBase(this,[n,t,r]);this.type=4;this.swappedOffline=i;this.disconnectionSource=Enum.toString(_Ewa.wE,u);this.triggeringRequest=f};_Ewa.Ui.a.prototype={swappedByOffline:!1,swappedOffline:!1,averageDurationBetweenFailedRequestsSec:0,longestDurationBetweenFailedRequestsSec:0,lastFailedRequestToOnlineTimeGapSec:0,disconnectionSource:null,errorDataDuringConnectivityIssuesMode:null,triggeringRequest:null,g:function(n,t){this.swappedByOffline=t;this.e(n)},h:function(n){if(this.failedRequests.length<10){var t=n+"_"+_Ewa.bi.b(this.startTime,_Ewa.q.a().a()).toString();this.failedRequests.push(t)}}};_Ewa.Uj=function(n){this.j=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.r);this.k=Function.createDelegate(this,this.x);this.i=Function.createDelegate(this,this.v);this.h=Function.createDelegate(this,this.u);this.c=n;this.b=this.c.c();this.a=new _Ewa.dS;this.e=!1;this.c.b().l(this.h);this.b.f().c(this.i);this.b.d(this.k);var t=this;this.c.a().c(_Ewa.cR,5,function(n){t.g=n;n.h(t.n)},null);this.b.g(this.j)};_Ewa.Uj.prototype={a:null,c:null,b:null,d:null,g:null,e:!1,dispose:function(){this.c&&(this.c.b()&&this.c.b().p(this.h),this.b&&(this.b.f().d(this.i),this.b.h(this.j),this.b.e(this.k)))},r:function(n,t){t.c?this.t(t):this.s(t)},t:function(n){var t={},i;t.Timestamp=Date.now().toString();i=n.a;switch(i){case 21:this.d=n.b.FailedMethod;t.FailedMethod=this.d;this.m("ServerCommunicationFailureBBShown",JSON.stringify(t));break;case 51:this.m("NetworkDownBBShown",JSON.stringify(t))}},s:function(n){var t=n.a;switch(t){case 21:this.f("ServerCommunicationFailureBBShown",!0);break;case 51:this.f("NetworkDownBBShown",!0)}},m:function(n,t){try{this.a.a()&&this.a.b(n,t)}catch(i){Diag.a.a(573851747,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",i.message||"Unknown")}},l:function(n,t){var i,r,u;return this.a.a()&&(i=this.a.f(n),i&&i!=="null"&&(r=JSON.parse(i),u=parseInt(r.Timestamp),u!==Number.NaN))?(t.val=Sys.Serialization.JavaScriptSerializer.serialize(r),u):(t.val=null,-1)},x:function(n,t){var i=t.b.a;this.d&&i===this.d&&(Diag.a.a(573851746,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',this.d),this.f("ServerCommunicationFailureBBShown",!0),this.d=null);this.o(!1);this.e=!1},w:function(n,t){_Ewa.i.d(t.b,[-1387426400])&&!this.e&&(this.e=!0,this.p()&&window.performance.mark("offMoStMa"),new _Ewa.Uj.b(this).h("OnNetworkDownImmediatePing"))},u:function(){this.o(!0);this.f("NetworkDownBBShown",!1);this.f("ServerCommunicationFailureBBShown",!1)},o:function(n){var t,i;this.a.a()&&(t=this.a.f("ConnectionHealthPingRsults"),t&&t!=="null"&&(i=-1,this.e&&(i=this.q("offMoStMa","offMoDuMea")),Diag.a.a(573851745,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(t),i,n),this.a.c("ConnectionHealthPingRsults")))},q:function(n,t){if(!this.p())return-1;window.performance.measure(t,n);var i=window.performance.getEntriesByName(t);return!i.length||!i[i.length-1]?(Diag.a.a(573851744,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",t),-1):i[i.length-1].duration},f:function(n,t){var r,f,e,u,i,o;try{u=(e=this.l(n,f={val:r}),r=f.val,e);u!==-1&&(o=(i=new _Ewa.Uj.a,i.timeElapsed=Date.now()-u,i.scenario=n,i.isNewSession=!t,i.rawData=r,i),Diag.a.a(573851743,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(o)));this.a.c(n)}catch(s){Diag.a.a(573851742,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",s.message||"Unknown")}},v:function(){Diag.a.a(573851741,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");this.f("NetworkDownBBShown",!0)},p:function(){return _Ewa.j.U()&&Common.ba.c()}};_Ewa.Uj.b=function(n){this.e=Function.createDelegate(this,this.f);this.d=["cdn_static_resource_ewa_image","b-ring_Apc_Trans"];this.b=n;this.c=n.c;this.a={}};_Ewa.Uj.b.prototype={b:null,c:null,a:null,h:function(n){for(var r,u=this.e,f=_Ewa.jo.b(u,n,this.c,this.d),i=f,e=i.length,t=0;t<e;++t)r=i[t],r.i()},f:function(n,t){this.a[t]=n;this.g()&&this.i(n.caller==="OnNetworkDownImmediatePing")},g:function(){for(var i,t=this.d,r=t.length,n=0;n<r;++n)if(i=t[n],isNullOrUndefined(this.a[i]))return!1;return!0},i:function(n){var f=this.c.K().a(),i;n&&this.j(f);for(var e=this.d,y=e.length,t=0;t<y;++t)i=e[t],this.a[i]=Sys.Serialization.JavaScriptSerializer.serialize(this.a[i]);var o=Date.now(),s,h,c,l,r=(l=this.b.l("NetworkDownBBShown",c={val:s}),s=c.val,l),a,v,u=(v=this.b.l("ServerCommunicationFailureBBShown",a={val:h}),h=a.val,v);this.a.isOfflineMode=f;this.a.networkDownBBAge=r===-1?r:o-r;this.a.transientServerCommunicationFailuresBBAge=u===-1?u:o-u;this.b.g?(this.a.isNetworkDownBBShown=this.b.g.c(51).toString(),this.a.isServerErrorBBShown=this.b.g.c(21).toString()):(this.a.isNetworkDownBBShown="unknown",this.a.isServerErrorBBShown="unknown");Diag.a.a(573851740,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",Sys.Serialization.JavaScriptSerializer.serialize(this.a))},j:function(n){for(var f,r,t={},u=Object.keys(this.a),e=u.length,i=0;i<e;++i)f=u[i],r=this.a[f],t[r.testName]=r.isSuccess;t.isOfflineMode=n;this.b.m("ConnectionHealthPingRsults",Sys.Serialization.JavaScriptSerializer.serialize(t))}};_Ewa.Uj.a=function(){};_Ewa.Uj.a.prototype={scenario:null,timeElapsed:0,isNewSession:!1,rawData:null};_Ewa.jo=function(){};_Ewa.jo.b=function(n,t,i,r){var o,f,u,e;_Ewa.jo.a||(_Ewa.jo.a=$$as(Array,_Ewa.E.b(i.e().NetworkMeasurementUrlList)));var s=new Array(0);for(o=0;o<_Ewa.jo.a.length;o++)(f=_Ewa.jo.a[o],u=f["key"],u||(u=f["Key"]),!r||Array.contains(r,u))&&(e=f["value"],e||(e=f["Value"]),u&&e&&s.push(new _Ewa.sv(i,u,e,n,t)));return s};_Ewa.zV=function(n){_Ewa.zV.initializeBase(this);this.h=n;this.l()};_Ewa.zV.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.ks),401,new _Ewa.zV(n))};_Ewa.zV.prototype={h:null,a:function(){var n=this;_Ewa.g.a(_Ewa.l.a(_Ewa.ki,this.h.a(),395,396,this.j,null),function(t){n.k(n.h.a().a(_Ewa.ks,400,!1,null)||new _Ewa.NetworkConnectionStateManager(n.h,t.a(),!0))},this.h.g(),3,null,null)}};_Ewa.NetworkConnectionStateManager=function(n,t,i){var r,u;this.K=Function.createDelegate(this,this.bn);this.H=Function.createDelegate(this,this.bk);this.p=Function.createDelegate(this,this.bh);this.w=Function.createDelegate(this,this.bg);this.J=Function.createDelegate(this,this.bm);this.I=Function.createDelegate(this,this.bl);this.E=Function.createDelegate(this,this.bf);this.D=Function.createDelegate(this,this.be);this.G=Function.createDelegate(this,this.bj);this.F=Function.createDelegate(this,this.bi);_Ewa.NetworkConnectionStateManager.initializeBase(this,[!1]);this.d=3;this.t=0;this.c=n;this.g=n.c().f();this.A=_Ewa.a.a("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");this.o=_Ewa.a.c("Microsoft.Office.Excel.SilentReopenDuringWorkUI",!1);this.r=_Ewa.a.a("OfficeVSO:5618594_OfflineModeUXEnabled");i&&(this.N=new _Ewa.Uk(n,t));_Ewa.a.a("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&(r=this,this.c.a().c(_Ewa.dD,291,function(n){r.h=n},null));this.r&&(_Ewa.a.a("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||(u=this,this.c.a().c(_Ewa.dD,291,function(n){u.h=n},null)),this.M=this.c.e().ExcelNetworkCheckAfterTabActivationDelayMs,this.g.n(this.F),this.g.c(this.G),this.g.f(this.D),this.g.m(this.E));(this.A||this.o)&&(this.X=new _Ewa.Un(this.c,this));this.y=this.c.e().LongInactivityTimePeriodSeconds;this.c.b().bn(this.I);this.c.b().i().b(this.J);this.o&&(this.O=this.c.e().SilentReopenDuringWorkDelayMs)};_Ewa.NetworkConnectionStateManager.prototype={l:null,j:null,k:null,u:null,e:null,M:0,y:0,d:0,t:0,c:null,g:null,n:!1,m:!1,v:!1,h:null,N:null,X:null,i:!1,s:0,x:0,A:!1,q:!1,O:0,o:!1,B:!1,r:!1,f:null,a:function(){return this.i},L:function(){return!!(this.t&2)},dispose:function(){this.g&&(this.r&&(this.g.s(this.F),this.g.d(this.G)),this.g.k(this.D),this.g.r(this.E));this.q&&this.h&&(this.h.f(this.w),this.q=!1);this.c&&(this.v&&this.C(),this.c.b()&&(this.c.b().bY(this.I),this.c.b().i()&&this.c.b().i().c(this.J)));_Ewa.a.a("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.f&&(this.f.dispose(),this.f=null);System.a.a(this.N);this.c=null;_Ewa.bW.prototype.dispose.call(this)},b:function(){this.B=!0},Q:function(){this.j||(this.j=_Ewa.A.a(this.c).a().d(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity",null,null))},bd:function(){if(this.B)return this.B=!1,!0;var n=this.s>this.y||this.x>this.y&&this.s<10;return Diag.a.a(571289602,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",this.s,this.x,n),n},bp:function(){if(_Ewa.a.a("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")){var n=this;this.f=_Ewa.B.a().a(function(){Common.i.a().recordQosError(_Ewa.boY.b.t,[_Ewa.boY.a.c],!0,!0,!1,!1,null)},6e3,"ReportLongSilentReopenBackToWorkVeto",!0,!0)}},bb:function(){if(this.j||this.e){Diag.a.a(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon.");return}var n=this;this.e=_Ewa.B.a().a(function(){if(!n.c){Diag.a.a(542782154,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null");return}if(n.j){Diag.a.a(542782153,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object");return}_Ewa.c.a(n.c).m()?(n.m||(_Ewa.c.a(n.c).k().h(n.p),Diag.a.a(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),n.n=!0,Diag.a.a(541193986,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):n.Q()},this.O,_Ewa.o.cD,!0,!0)},bi:function(){Diag.a.a(541193988,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.z(1,!1)},bg:function(){if(!this.L()&&this.d&1)this.P();else{var n=this;window.setTimeout(function(){n.P()},this.M)}this.h.f(this.w);this.q=!1},W:function(n,t){this.t=this.T(n,t,!0);this.S()},z:function(n,t){this.d=this.T(n,t,!1);this.S()},T:function(n,t,i){var r=i?this.t:this.d;return t?r|n:r&~n},P:function(){var n=!!this.k,t=!!this.l,i=!!this.j,r=!!this.u;this.d&1||n?!!(this.d&1)&&n&&this.bc():this.ba();this.d&2||t||i?!(this.d&2)||(t?this.U():(i||this.e&&this.e.b())&&this.V()):this.A&&this.i?this.Z():!this.o||this.i||_Ewa.a.a("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.e||this.bb();this.L()&&!r?this.Y(!0):!this.L()&&r&&this.Y(!1)},bh:function(){Diag.a.a(541193987,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",!(this.d&1)&&this.r,!(this.d&2)&&!this.i&&this.o);this.d&1||!this.r||this.R();this.d&2||this.i||!this.o||this.Q();_Ewa.c.a(this.c).k().f(this.p);this.m=!1;this.n=!1},ba:function(){this.c?this.k?Diag.a.a(571289603,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):_Ewa.c.a(this.c).m()?(this.n||(_Ewa.c.a(this.c).k().h(this.p),Diag.a.a(541893721,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.m=!0,Diag.a.a(541193985,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.R():Diag.a.a(570949835,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")},R:function(){this.k||(this.k=_Ewa.A.a(this.c).a().d(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity",null,null))},bj:function(){Diag.a.a(541193984,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.z(1,!0);this.m&&!this.n&&_Ewa.c.a(this.c).k().f(this.p);this.m=!1},bc:function(){this.k&&(System.a.a(this.k),this.k=null)},U:function(){this.l&&(System.a.a(this.l),this.l=null);_Ewa.a.a("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.f&&this.f.b()&&this.f.a();this.f=null},V:function(){this.j&&(System.a.a(this.j),this.j=null);this.e&&(System.a.a(this.e),this.e=null);this.n&&!this.m&&_Ewa.c.a(this.c).k().f(this.p);this.n=!1},bm:function(n,t){this.x=this.s;this.s=t.a},bl:function(){this.c&&(this.v||(_Ewa.S.a(this.c).c("cw27").i(this.H),this.c.B(this.K),this.v=!0),this.i=this.bd(),this.z(2,!1))},bk:function(){var n=_Ewa.S.a(this.c).b(),t=n.r(),r=this,i=_Ewa.bs.d(n.c().a().c(),function(n){return n.MessageIdName});Diag.a.a(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",t,this.i,_Ewa.E.a(i));t&&(this.l?(this.i=!1,this.U(),this.C()):this.j&&(this.V(),this.C()))},bn:function(){this.c?(Diag.a.a(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.i=!1,_Ewa.a.a("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&this.e&&this.e.b()&&(System.a.a(this.e),this.e=null),_Ewa.a.a("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.f&&this.f.b()&&(System.a.a(this.f),this.f=null),this.z(2,!0),this.C()):Diag.a.a(554717603,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")},Z:function(){this.l||(this.l=_Ewa.A.a(this.c).a().d(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",null,_Ewa.ClientStringManager.a().a(2070)));this.bp()},be:function(){this.W(2,!0)},bf:function(){this.W(2,!1)},Y:function(n){n?(this.u=_Ewa.A.a(this.c).a().d(4,"NetworkConnectionStateManager.ConnectivityIssues",null,null),this.bo()):(System.a.a(this.u),this.u=null)},bo:function(){if(this.c&&this.c.c()){var n=this.c.c().a().b(!1);_Ewa.k.bl(this.c.c().a(),null,null,null,n)}},C:function(){_Ewa.S.a(this.c).c("cw27").e(this.H);this.c.C(this.K);this.v=!1},S:function(){this.h||Diag.a.a(540641346,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.h&&this.h.a()?this.q||(this.h.e(this.w),this.q=!0,Diag.a.a(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.P()}};_Ewa.Uk=function(n,t){this.a=n;!_Ewa.a.a("OfficeVSO:5618594_OfflineModeUXEnabled")||_Ewa.a.a("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Common.c.b()||(this.e=new _Ewa.Um(n,t));_Ewa.a.b(217)&&(this.b=new _Ewa.su(this.a),this.b.x());!_Ewa.a.b(609)||_Ewa.a.a("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Common.c.b()||(this.d=new _Ewa.Uj(this.a));this.c=new _Ewa.Ui(this.a)};_Ewa.Uk.prototype={a:null,e:null,b:null,d:null,c:null,dispose:function(){System.a.a(this.e);System.a.a(this.b);System.a.a(this.d);System.a.a(this.c);this.a=null}};_Ewa.su=function(n){if(this.t=Function.createDelegate(this,this.F),this.v=Function.createDelegate(this,this.H),this.u=Function.createDelegate(this,this.G),this.n=Function.createDelegate(this,this.C),this.s=Function.createDelegate(this,this.A),this.r=Function.createDelegate(this,this.z),this.m=Function.createDelegate(this,this.B),this.a=n,this.f=_Ewa.a.a("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.w(),this.f){this.o=["b-ring_Apc_Trans"];this.i=1;this.h={};this.a.b().i().b(this.m);var t=this;this.a.a().c(_Ewa.dD,291,function(n){n.c(t.r);n.e(t.s)},null)}};_Ewa.su.a=function(n){return Math.random()*100<n};_Ewa.su.prototype={o:null,e:0,d:0,k:0,j:0,a:null,l:!1,f:!1,c:null,g:null,b:null,h:null,i:0,dispose:function(){this.a&&(this.l&&this.a.c()&&this.c.f.length>0&&this.a.c().e(this.n),this.f&&(this.q("Dispose"),this.a.b().i().c(this.m)))},x:function(){_Ewa.a.b(217)&&this.D();this.f&&this.E()},y:function(){var t,r,n,f;if(this.d=this.e,this.j=0,t={},!this.c){this.c=new($$sc.v.$$(_Ewa.sv));r=_Ewa.jo.b(this.u,"InitSampleMeasurement",this.a,null);for(var u=r,e=u.length,i=0;i<e;++i)n=u[i],t[n.d]=n.g,this.c.b(n)}f=Sys.Serialization.JavaScriptSerializer.serialize(t);Diag.a.a(573851739,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.e,this.d,f);this.c.f.length>0&&this.a.c().d(this.n)},J:function(){for(var n=this.c.$$lge(),t;n.$$mn();)t=n.$$cu(),t.i()},H:function(){var n,t;if(this.a.b().i().d()<12e4)for(n=this.g.$$lge();n.$$mn();)t=n.$$cu(),t.i();else this.q("UserInactive")},G:function(n){var t=Sys.Serialization.JavaScriptSerializer.serialize(n);Diag.a.a(388821830,0,50,t)},F:function(n){var t,i;if(n&&(t=this.h[n.testIteration.toString()],t?t.push(n):(t=[n],this.h[n.testIteration.toString()]=t),t.length===this.o.length)){if(i=Sys.Serialization.JavaScriptSerializer.serialize(t),this.a&&this.a.K()){if(n.EstimatedLatency=this.a.K().g(),this.a.K().g()>this.a.bb().ExcelRountripThresholdMs){Diag.a.a(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",i,this.i++);return}}else Diag.a.a(570712143,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");Diag.a.a(570712142,0,50,"Periodic ping tests results: {0}",i);this.i=1}},C:function(n,t){var r=t.b.a,i;(r==="GetRangeContent"||r==="GetRangeContentJson")&&(this.d++,i=Date.now(),this.I(i)&&(this.d=0,this.j=i,this.J()))},B:function(){this.p("OnThrottledUserActivity")},z:function(){this.q("OnDocumentHidden")},A:function(){this.p("OnDocumentUnhidden")},p:function(n){this.b&&this.b.b()||(Diag.a.a(570712141,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",n),this.b=_Ewa.B.a().b(this.v,5e3,_Ewa.o.cN,!0,!1),this.b.d())},q:function(n){this.b&&this.b.b()&&(Diag.a.a(570712140,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",n),this.b.a())},I:function(n){return this.d>=this.e&&n-this.j>this.k},w:function(){var n=this.a.e().SlowNetworkMeasurementsSamplePercentage;return _Ewa.su.a(n)},D:function(){this.e=this.a.e().NumberOfRequestToWaitPerNetworkMeasurement;this.k=this.a.e().MinTimeBetweenNetworkMeasurementInSec*1e3;var n=this.a.e().NetworkMeasurementsSamplePercentage;this.e>0&&this.k>0&&(this.l=_Ewa.su.a(n),this.l&&this.y())},E:function(){var t,r;if(!this.g){this.g=new($$sc.v.$$(_Ewa.sv));t=_Ewa.jo.b(this.t,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.a,["b-ring_Apc_Trans"]);for(var i=t,u=i.length,n=0;n<u;++n)r=i[n],this.g.b(r);this.a.b().i().a()&&this.p("PrepareAndInitSlowNetworkTests")}}};_Ewa.sv=function(n,t,i,r,u){this.c=-1;this.g=i;this.h=r;this.d=t;this.a=new _Ewa.Ul(t,u)};_Ewa.sv.prototype={f:"",a:null,h:null,b:!1,j:0,g:null,d:null,i:function(){try{if(this.b)return Diag.a.a(573851738,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.d),!1;this.n();this.b=!0;this.a.startTimeMs=Date.now();var n=new Common.bF(this.g);return n.b("tid",this.a.startTimeMs.toString()),this.f=n.toString(),this.o(),this.j++,this.a.testIteration=this.j,!0}catch(t){return this.e("Exeption: "+t.message,null),!1}},n:function(){this.f="";this.a.a();this.b=!1;this.c=-1},k:function(){this.c!==-1&&(window.clearTimeout(this.c),this.c=-1)},o:function(){var n,t,r,u,i;try{n=new XMLHttpRequest;t=this;n.onreadystatechange=function(){n.readyState===4&&(n.status===200?t.m():t.e(String.format("Error when downloading resource. status code: {0}, status text: {1}",n.status,n.statusText),n.status.toString()))};r=this;u=function(){r.e(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",n.status,n.statusText),null)};n.onerror=u;i=this;this.c=window.setTimeout(function(){i.c=-1;i.e("Request timeout",null)},1e4);n.open("GET",this.f,!0);n.send(null)}catch(f){this.e("Exeption: "+f.message,null)}},m:function(){this.b&&(this.a.reqTotalDurationMs=Date.now()-this.a.startTimeMs,this.k(),this.a.browserResourceTiming=_Ewa.md.a(this.f),this.a.isSuccess=!0,this.l())},e:function(n,t){this.b&&(this.k(),this.a.errorMessage=n,this.a.isSuccess=!1,this.a.errorStatusCode=t,this.l())},l:function(){this.b=!1;this.h&&this.h(this.a,this.d)}};_Ewa.Ul=function(n,t){this.testName=n;this.caller=t;this.a()};_Ewa.Ul.prototype={a:function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorMessage="";this.errorStatusCode="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null},testName:null,startTimeMs:0,isSuccess:!1,errorMessage:null,errorStatusCode:null,caller:null,reqTotalDurationMs:0,browserResourceTiming:null,testIteration:0};_Ewa.Um=function(n,t){this.p=Function.createDelegate(this,this.w);this.q=Function.createDelegate(this,this.z);this.k=Function.createDelegate(this,this.A);this.n=Function.createDelegate(this,this.f);this.j=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.s);this.g=-1;this.l=$$sc.a.b(0);this.a=n;this.d=t;this.h=!1;this.d.b()&&(this.d.d("NetworkAvailability","NetworkAvailabilityData"),this.x(),this.c=new _Ewa.Um.OfflinePartialInteractivitiesDataForLog(this.a.e().UserSessionId),_Ewa.A.a(this.a).a().f(this.i));this.m=_Ewa.bL.a().b(null);this.m.a("beforeunload",this.o,!1)};_Ewa.Um.prototype={a:null,d:null,b:null,c:null,e:null,h:!1,m:null,dispose:function(){this.a&&_Ewa.A.a(this.a)&&_Ewa.A.a(this.a).a().h(this.i);System.a.a(this.e);this.e=null;this.a=null},s:function(n,t){t.a?this.t(t.b):this.u()},v:function(n,t){t.a===5&&this.f()},A:function(n,t){this.b.errorDataDuringOfflineMode=t.a},t:function(n){var t=!!n;this.b=new _Ewa.Um.OfflinePartialInteractivityData(_Ewa.q.a().a(),this.a,t);this.b.timeFromLastOffline=this.g!==-1?window.performance.now()-this.g:-1;this.c.b(this.b);_Ewa.A.a(this.a).a().g(this.j);this.f();this.e=_Ewa.B.a().b(this.n,3e3,_Ewa.o.bf,!0,!1);_Ewa.dK.a(this.a).c(this.k)},f:function(){this.c.c();this.B("partialInteractivityData",Sys.Serialization.JavaScriptSerializer.serialize(this.c))},u:function(){this.b.e(this.a);this.f();System.a.a(this.e);this.e=null;this.g=window.performance.now();_Ewa.A.a(this.a).a().e(this.j);_Ewa.dK.a(this.a).e(this.k);this.y()},B:function(n,t){if(this.a){var i=this;this.l=_Ewa.g.a(this.l,function(){i.d.c(new _Ewa.lK(n,t))},this.a.g(),3,null,null)}else Diag.a.a(573387486,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")},x:function(){var n=this.a.g();_Ewa.g.a(_Ewa.g.a(this.d.a("partialInteractivityData"),this.q,n,3,null,null),this.p,n,3,null,null)},z:function(n){var t=n.a();!t||!t.length||(this.h=!0,Diag.a.a(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",t))},y:function(){if(this.b){var n=Sys.Serialization.JavaScriptSerializer.serialize(this.b);_Ewa.a.a("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?_Ewa.F.a().l(560791645,0,50,_Ewa.fy.g.a,this.b.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",n):Diag.a.a(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",n)}_Ewa.a.a("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.b&&this.b.isToastShown&&Common.i.a().recordQosError(_Ewa.boY.b.w,[_Ewa.boY.a.c],!0,!1,!1,!1,null)},w:function(){if(this.h)if(this.a){var n=this;_Ewa.g.a(this.d.e("partialInteractivityData"),function(){Diag.a.a(576811914,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.a.g(),3,null,null)}else Diag.a.a(573387485,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB.")},r:function(){if(this.c&&this.c.count>0){var n=Sys.Serialization.JavaScriptSerializer.serialize(this.c);Diag.a.a(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",n)}}};_Ewa.Um.OfflinePartialInteractivitiesDataForLog=function(n){this.allOfflinePartialInteractivitiesDataInSession=new Array(0);this.sessionID=n};_Ewa.Um.OfflinePartialInteractivitiesDataForLog.prototype={count:0,allOfflinePartialInteractivitiesDataInSession:null,sessionID:null,a:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]},c:function(){this.a()&&this.a().f()},b:function(n){this.allOfflinePartialInteractivitiesDataInSession.push(n);this.count++}};_Ewa.Um.OfflinePartialInteractivityData=function(n,t,i){_Ewa.Um.OfflinePartialInteractivityData.initializeBase(this,[n,t,i]);this.timeFromLastOffline=-1;this.type=5};_Ewa.Um.OfflinePartialInteractivityData.prototype={timeFromLastOffline:0,errorDataDuringOfflineMode:null};_Ewa.blA=function(n,t,i){if(this.a=Function.createDelegate(this,this.l),this.c=Function.createDelegate(this,this.j),this.d=Function.createDelegate(this,this.k),this.b=Function.createDelegate(this,this.i),this.durationUntilUserInactive=-1,this.startTime=n,this.durationUntilToastShownMs=0,this.blockedActions={},this.isToastShown=i,t.b()&&t.b().i()&&(this.wasUserActiveOnPIStart=t.b().i().a()),this.m(t),_Ewa.a.a("OfficeVSO:5340853_ImprovePIData")){this.isDialogShown=t.n().c()>0;var r=t.a().a(_Ewa.dU,183,!1,null);this.isTaskPaneShown=!!r&&r.k()&&!r.e();this.isTaskPaneCollapsed=!!r&&r.k()&&r.e()}else this.isDialogShown=!1,this.isTaskPaneShown=!1,this.isTaskPaneCollapsed=!1};_Ewa.blA.prototype={type:0,startTime:null,durationMs:0,blockedOperationsCount:0,blockedActions:null,durationUntilToastShownMs:0,blockedUserOperationsWhileToastShown:0,toastRaiser:null,isToastShown:!1,hasTabbedOut:!1,wasUserActiveOnPIStart:!1,wasUserActiveOnPIEnd:!1,isDialogShown:!1,isTaskPaneShown:!1,isTaskPaneCollapsed:!1,i:function(n,t){this.blockedOperationsCount++;var i=String.format("{0}_{1}_{2})",t.c,t.b,t.a);this.blockedActions[i]=this.blockedActions[i]?this.blockedActions[i]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++},f:function(){this.durationMs=_Ewa.bX.a(_Ewa.q.a(),this.startTime)},e:function(n){this.f();_Ewa.A.a(n).o(this.b);_Ewa.A.a(n).a().e(this.d);var t=this;n.a().c(_Ewa.dD,291,function(n){n.d(t.c)},null);n.b()&&n.b().i()&&(n.b().i().e(this.a),this.wasUserActiveOnPIEnd=n.b().i().a())},m:function(n){_Ewa.A.a(n).n(this.b);this.isToastShown?this.toastRaiser="Immediate":_Ewa.A.a(n).a().g(this.d);var t=this;n.a().c(_Ewa.dD,291,function(n){t.hasTabbedOut=n.a();n.c(t.c)},null);this.wasUserActiveOnPIStart&&n.b().i().f(this.a)},l:function(n){this.durationUntilUserInactive=_Ewa.bi.b(this.startTime,_Ewa.q.a().a());n.e(this.a)},j:function(){this.hasTabbedOut=!0},k:function(n,t){t.a!==this.type||this.isToastShown||(this.durationUntilToastShownMs=_Ewa.bX.a(_Ewa.q.a(),this.startTime),this.toastRaiser=t.b,this.isToastShown=!0)}};_Ewa.blA.registerClass("_Ewa.blA");_Ewa.Un.a.registerClass("_Ewa.Un.a",_Ewa.blA);_Ewa.Ui.registerClass("_Ewa.Ui",null,Sys.IDisposable);_Ewa.Ui.a.registerClass("_Ewa.Ui.a",_Ewa.blA);_Ewa.Uj.registerClass("_Ewa.Uj",null,Sys.IDisposable);_Ewa.Uj.a.registerClass("_Ewa.Uj.a");_Ewa.zV.registerClass("_Ewa.zV",_Ewa.sX.$$(_Ewa.ks));_Ewa.NetworkConnectionStateManager.registerClass("_Ewa.NetworkConnectionStateManager",_Ewa.bW,_Ewa.ks,Sys.IDisposable);_Ewa.Uk.registerClass("_Ewa.Uk",null,Sys.IDisposable);_Ewa.su.registerClass("_Ewa.su",null,Sys.IDisposable);_Ewa.sv.registerClass("_Ewa.sv");_Ewa.Ul.registerClass("_Ewa.Ul");_Ewa.Um.registerClass("_Ewa.Um",null,Sys.IDisposable);_Ewa.Um.OfflinePartialInteractivitiesDataForLog.registerClass("_Ewa.Um.OfflinePartialInteractivitiesDataForLog");_Ewa.Um.OfflinePartialInteractivityData.registerClass("_Ewa.Um.OfflinePartialInteractivityData",_Ewa.blA);_Ewa.jo.a=null;Type.registerNamespace("_Ewa");_Ewa.bly=function(){};_Ewa.bly.a=function(){_Ewa.m.a(_Ewa.zV.a)};_Ewa.bly.a();Type.registerNamespace("_Ewa");_Ewa.RecoveryUIController=function(n,t,i,r){this.w=Function.createDelegate(this,this.L);this.v=Function.createDelegate(this,this.K);this.r=Function.createDelegate(this,this.D);this.t=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.J);this.y=Function.createDelegate(this,this.E);this.s=Function.createDelegate(this,this.F);this.x=Function.createDelegate(this,this.N);this.f=n;this.l=t;this.h=i;this.q=r;this.m=null;this.o=null;this.k=!1;this.i=!1;this.j=!1;this.n=!1;this.p=0;this.f.a().b(_Ewa.mc,406,this)};_Ewa.RecoveryUIController.prototype={f:null,l:null,q:null,h:null,e:null,m:null,o:null,k:!1,i:!1,j:!1,n:!1,p:0,dispose:function(){this.B();this.C();this.f=null;this.l=null;this.h=null;this.q=null;this.e=null;this.m=null;this.o=null;this.p=0},a:function(n){this.e=n;this.m=n.c();this.o=n.e()},g:function(){this.e&&(this.z(),this.B(),this.e=null)},b:function(){return this.m},c:function(){return this.o},I:function(){return!!this.e&&this.l.e()},d:function(n){this.e?this.A(n):Diag.a.b(577279773,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")},H:function(){return this.e?this.e.d():null},A:function(n){var i=this.e.g(),t;i?(this.l.c((t=new Common.IPoint,t.x=i.x,t.y=i.y,t),this.e.f(),n),this.M()):Diag.a.a(577279772,0,100,"RecoveryUIController.Show: point is null.")},z:function(){this.I()&&this.l.b();this.C()},M:function(){var t,n;this.i||(t=_Ewa.c.a(this.f),t.i().c(this.x),t.w().d(this.s),this.q.a("blur",this.y,!1),this.f.i().i(this.u),this.f.d().c(this.t),n=this.f.a().a(_Ewa.di,65,!1,null),n&&n.i()&&n.i().registerForCommentEvents(this.r),this.i=!0);this.k||(this.h.f("keydown",this.f.q(),this.v,!0),this.h.f("keyup",this.f.q(),this.w,!0),this.k=!0)},B:function(){var t,n;this.i&&(t=_Ewa.c.a(this.f),t.i().b(this.x),t.w().c(this.s),this.q.b("blur",!1),this.f.i().f(this.u),this.f.d().d(this.t),n=this.f.a().a(_Ewa.di,65,!1,null),n&&n.i()&&n.i().unregisterForCommentEvents(this.r),this.i=!1)},C:function(){this.k&&(this.h.i("keydown",this.f.q(),this.v,!0),this.h.i("keyup",this.f.q(),this.w,!0),this.j=!1,this.n=!1,this.k=!1)},N:function(){if(this.e){this.p=_Ewa.q.a().b().m;this.z();var n=this;_Ewa.B.a().a(function(){n.O(-1)},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",!0,!0)}},O:function(n){if(this.e){var t=_Ewa.q.a().b().m;t-this.p>=250&&this.A(n)}},D:function(n){n===10&&this.g()},E:function(){if(this.e){var n=document.getElementById(this.e.b());n&&"true"===n.getAttribute("aria-expanded")&&n.click();this.g()}},F:function(){this.g()},G:function(){this.g()},L:function(n){var i,t,r,u;if(this.e){if(i=n.a.keyCode,this.e.a()===17&&this.n)return!1;if(i===this.e.a()&&this.j){if(t=document.getElementById(this.e.b()),!t)return Diag.a.b(577279771,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;if(r=t.getAttribute("aria-expanded")||"",u="false"===r,u)return t.click(),!0}}return!1},K:function(n){if(this.e){this.j=!1;this.n=n.i();var t=n.a.keyCode;if(t===27)return this.g(),!0;if(t===this.e.a())return this.j=!0,!0}return!1},J:function(n,t){var r=t.a,i;if(r.a!==-1027730316&&r.a!==-1059615499){this.g();return}i=t.b;i&&i.launcherId!==this.H()&&this.g()}};_Ewa.Bh=function(n){_Ewa.Bh.initializeBase(this);this.h=n;this.l()};_Ewa.Bh.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.mc),405,new _Ewa.Bh(n))};_Ewa.Bh.prototype={h:null,a:function(){var n=this.h,t=this;n.V(function(i){i.c().then(function(i){t.k(_Ewa.Bi.a(n)||new _Ewa.RecoveryUIController(n,i,Common.h.a(),_Ewa.bL.a().b(null)))})})}};_Ewa.RecoveryUIController.registerClass("_Ewa.RecoveryUIController",null,_Ewa.mc,Sys.IDisposable);_Ewa.Bh.registerClass("_Ewa.Bh",_Ewa.sX.$$(_Ewa.mc));Type.registerNamespace("_Ewa");_Ewa.bnc=function(){};_Ewa.bnc.a=function(){_Ewa.m.a(function(n){_Ewa.Bh.a(n)})};_Ewa.bnc.a();Type.registerNamespace("_Ewa");_Ewa.Vm=function(n,t){var i,r;this.a=new($$sc.w.$$(_Ewa.AA));this.b=n;this.c=t;i=this;this.e=function(n){return Promise.resolve(n)};r=this;this.d=function(n){return Promise.reject(n)}};_Ewa.Vm.prototype={a:null,b:null,e:null,d:null,c:null,j:function(n){var t,i;return this.k(n.a)?(Diag.a.a(37364047,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",n.a),t=this.a.a(n.a),this.a.b(n.a,n),i=t.g,t.f=!1,this.h(n,i)):(this.a.b(n.a,n),this.l(n))},k:function(n){return this.a.c(n)},l:function(n){var t=this;return new Promise(function(i,r){n.g=t.b.a(n).then(function(r){return i(null),t.f(n,r)},function(n){return r(null),t.d(n)})})},h:function(n,t){var i=this;return new Promise(function(r,u){n.g=t.then(function(t){return i.n(n,t),i.b.a(n).then(function(t){return r(null),i.f(n,t)},function(n){return u(null),i.d(n)})},function(n){return i.d(n)})})},f:function(n,t){return n.f&&(this.g(n.a),this.m(n,t)),this.e(t)},g:function(n){this.a.e(n)},m:function(n,t){var i=this.i();n.a===i&&this.b.c(n.c,t,n.b.b)},i:function(){var n=_Ewa.c.a(this.c).a().b().f(),t;return n||(t=_Ewa.h.a(_Ewa.c.a(this.c).a().a().a(),this.c),n=t.FirstRow+"_"+t.FirstColumn),n},n:function(n,t){n.c=null;n.e=t}};_Ewa.Sr=function(n,t,i){this.sourceRange=n;this.destinationRange=t;this.pasteFlags=i};_Ewa.Sr.prototype={sourceRange:null,destinationRange:null,pasteFlags:0};_Ewa.Ss=function(n,t){this.destinationRange=n;this.content=t};_Ewa.Ss.prototype={destinationRange:null,content:null};_Ewa.SG=function(n){this.parameters=n};_Ewa.SG.prototype={parameters:null};_Ewa.hg=function(){};_Ewa.hg.prototype={range:0,art:1};_Ewa.hg.registerEnum("_Ewa.hg",!1);_Ewa.beM=function(){};_Ewa.Hr=function(n,t,i,r){_Ewa.Hr.initializeBase(this,[n,t,i,"AcrossSessionRangeCopyPasteHandler",r]);this.h=new _Ewa.vA(n)};_Ewa.Hr.prototype={h:null,serialize:function(n){var r=n.sourceItem,t={},i=this.g.d(r),u,e,f;if(i)t.synchronousResult=i,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else{if(u=null,e=_Ewa.h.u(r.a),!_Ewa.s.z(this.c)&&this.x(e)){Diag.a.a(26035413,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");f=this.i.a(e);try{u=f.toString();i=this.f.a();i.setItem("text/plain",u);this.g.e(r,i);t.synchronousResult=i;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{f&&f.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.f.a(),t.synchronousResult.setItem("text/plain",this.p());t.asynchronousResult=this.m(n,r,u)}return n.syncClipboardItemsKeys=_Ewa.iV.a(t.synchronousResult),t},shouldWaitForCopyToComplete:function(n){return!n||!n.copyContextSnapshot?(Diag.a.a(39084501,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1):(Diag.a.b(41562511,0,!!this.c.e(),"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null"),n.copyContextSnapshot.sessionId===this.c.e().UserSessionId)?(Diag.a.a(41562513,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1):(Diag.a.a(41562514,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0)},onDeferredPasteStarted:function(n){this.h.d(n)},onDeferredPasteCompleted:function(n){this.h.c(n)},deserialize:function(n){var s,r,u,f,t,i,h,c,e,o;if(n.isClipboardDataContainShadowWorkbook=!isNullOrUndefined(n.clipboardItems.getItem("data/shadow-workbook")),s=!!(_Ewa.c.a(this.c).a().c()&326),s)return _Ewa.cE.b(n)&&(n.wasLastCopyExternal=!0),Promise.reject(new _Ewa.cA(17,null,null,"",100));if(r=this.u(n,!1),r)return Promise.reject(new _Ewa.cA(_Ewa.cE.b(n)?18:n.isSameSession?19:20,null,null,"",r));if(u=n.copyContextSnapshot,f=this.e.a(u),_Ewa.cE.b(n))return this.l(n);if(t=n.commandParameters.originalDestinations,f&&n.isSameSession)return this.A(n,u,f,t);if(n.commandParameters.commandType!==516){if(i=null,c=this.w(n.clipboardItems,h={val:i}),i=h.val,c)return n.isShadowWorkbookParsedSuccessfully=!0,e=null,o=null,_Ewa.a.c("Microsoft.Office.Excel.CrossSessionDiscontinuousCCPEnabled",!1)?e=_Ewa.h.d(t,this.c):o=_Ewa.h.a(_Ewa.h.g(t),this.c),this.s(n,o,e,i);if(n.isClipboardInaccessible)return Promise.reject(new _Ewa.cA(8,null,null,"",100));if(n.commandParameters.commandType!==36)return this.q(n)}return Promise.reject(new _Ewa.cA(6,null,null,"",100))},beforePaste:function(n){this.c.a().a(_Ewa.qM,373,!1,null).c(n);n.indicationDisplayScheduled=!0},v:function(n,t){var u,r,i;if(!n||!n.SourceRanges||!n.SourceRanges.Ranges||!n.SourceRanges.Ranges.length||!n.OriginalSourceRangesCountExceedsLimit&&(!n.OriginalSourceMultiRange||!n.OriginalSourceMultiRange.Ranges||!n.OriginalSourceMultiRange.Ranges.length))return t.val=null,!1;if(u=n.SourceRanges.Ranges[0],t.val=null,_Ewa.f.a(n.ShadowWorkbookBase64)&&!n.ShadowWorkbookSizeExceedsLimit)return!1;if(t.val=this.t(n),t.val.rangeRowStart=u.FirstRow,t.val.rangeRowEnd=u.LastRow,t.val.rangeColumnStart=u.FirstColumn,t.val.rangeColumnEnd=u.LastColumn,t.val.sourceClientPath=n.SourceClientPath,t.val.sourceSheetName=n.SourceSheetName,t.val.sourceWorkbookName=n.SourceWorkbookName,!n.OriginalSourceRangesCountExceedsLimit)for(r=n.OriginalSourceMultiRange.Ranges,t.val.originalSourceRanges=new Array(r.length),i=0;i<r.length;++i)t.val.originalSourceRanges[i]=[r[i].FirstRow,r[i].FirstColumn,r[i].LastRow,r[i].LastColumn];return!0},w:function(n,t){t.val=null;var i=n.getItem("data/shadow-workbook");return!i||!i.length?!1:(t.val=JSON.parse(i),this.r(t.val))},r:function(n){return!!n&&(!_Ewa.f.a(n.shadowWorkbookBase64)||n.shadowWorkbookSizeExceedsLimit)&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)},s:function(n,t,i,r){return Diag.a.b(33863617,0,!!r,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null"),Common.a.G("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions"),n.pasteResult="CrossSessionPaste",n.payloadOrigin="CrossSession",n.payloadType="ShadowWorkbook",n.shadowWorkbookPayloadSize=_Ewa.gj.b(r),n.shadowWorkbookSizeExceedsLimit=_Ewa.gj.a(r),r.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(n.originalSourceRangesCountExceedsLimit=r.originalSourceRangesCountExceedsLimit),n.shadowWorkbookSizeExceedsLimit?(Diag.a.a(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,r.shadowWorkbookSizeExceedsLimit),Promise.reject(new _Ewa.cA(1,null,null,"",100))):n.commandParameters.commandType===1028&&n.originalSourceRangesCountExceedsLimit?(Diag.a.a(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",r.originalSourceRangesCount,15058,r.originalSourceRangesCountExceedsLimit),Promise.reject(new _Ewa.cA(1,null,null,"",100))):(Diag.a.a(33863619,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",n.commandParameters.id),this.e.e(n.commandParameters.ribbonCommandInfo,t,i,r,[n.commandParameters.stopwatch],n))},m:function(n,t,i){Diag.a.b(41805027,0,!!n,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var u=n.commandParameters.stopwatch.b(),r=this;return new Promise(function(f,e){var s=function(o){var h,c,s,l,v,y,p,a;if(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u,_Ewa.i.c(o.Errors))_Ewa.i.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538326,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",_Ewa.i.a(o.Errors,","),n.id)):(Diag.a.a(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.i.a(o.Errors,","),n.id),e(new _Ewa.lt(2,o.Errors)));else{if(Diag.a.a(26035418,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",n.id),n.markForCancellation){e(new _Ewa.lt(3,o.Errors));return}h=o.Result;c=h.PlainTextResult;isNullOrUndefined(i)||(c=i);isNullOrUndefined(c)||(n.plainTextPayloadSize=c.length);s=r.f.a();(y=r.v(h,v={val:l}),l=v.val,y)&&(n.shadowWorkbookPayloadSize=_Ewa.gj.b(l),n.shadowWorkbookSizeExceedsLimit=_Ewa.gj.a(l),n.originalSourceRangesCountExceedsLimit=h.OriginalSourceRangesCountExceedsLimit,p=JSON.stringify(l),s.setItem("data/shadow-workbook",p));s.setItem("text/plain",c);_Ewa.s.z(r.c)&&(a=h.HtmlResult,n.htmlSizeExceedsLimit=h.HtmlSizeExceedsLimit,isNullOrUndefined(a)||(n.htmlPayloadSize=a.length),s.setItem("text/html",a));n.copyTotalSizeExceedsLimit=h.CopyTotalSizeExceedsLimit;s.setItem("copyId",n.commandParameters.id);r.g.e(t,s);n.asyncClipboardItemsKeys=_Ewa.iV.a(s);f(s)}},h=function(t){n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-u;var i=_Ewa.X.a(t.b);Diag.a.a(26035420,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",_Ewa.i.a(i,","),n.id);e(new _Ewa.lt(2,i))},o;Diag.a.a(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",n.id);o=_Ewa.h.i(t.b,null,t.a);r.e.h(o,n.commandParameters,s,h,[n.commandParameters.stopwatch])})}};_Ewa.vw=function(n,t,i,r,u){_Ewa.vw.initializeBase(this,[n,"ArtCopyPasteHandler"]);this.d=n;this.k=new _Ewa.vA(n);this.h=t;this.j=i;this.f=_Ewa.c.a(n).a();this.i=u||new _Ewa.vy(this.h);this.m=new _Ewa.Vm(i,n);this.g=r};_Ewa.vw.a=function(n){return n.b===1||n.b===5};_Ewa.vw.prototype={r:"XLO",s:"3",f:null,d:null,j:null,h:null,i:null,m:null,g:null,k:null,getSourceItem:function(){return Diag.a.b(36227297,0,!!this.f.b().f(),"Expecting a floating object to be currently selected for copy"),Diag.a.a(39682266,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.f.b().f()),new _Ewa.jF(this.f.b().f(),this.d.b().u().b(),this.d.b().d(),this.d.e().UserSessionId,this.f.b().a().a().a)},beforeSerialize:function(n){if(!n||!n.commandParameters){Diag.a.a(36227298,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.");return}_Ewa.Hu.a(n);n.commandParameters.copyPasteTargetType=2},serialize:function(n){var u=n.sourceItem,i={},r,t;return u?this.y()?(Diag.a.a(39682267,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",u.a),this.A(),r=this.i.d(u),r?(i.synchronousResult=r,n.isFromCache=!0,n.isAsyncCopy=!1,n.clientSideCopyTime=n.commandParameters.stopwatch.b(),n.commandParameters.commandType===1&&this.d.u(2045211913,n.commandParameters.ribbonCommandInfo.c,n.commandParameters.ribbonCommandInfo.b,null)):(n.isFromCache=!1,n.isAsyncCopy=!0,r=this.h.a(),_Ewa.a.c("Microsoft.Office.Excel.CopyChartsToPPTOEnabled",!1)&&n.commandParameters.uploadToClipService&&(t={},t["data-clipservice-ccpid"]=n.commandParameters.id,t["data-pkey"]=n.commandParameters.pKey,t["data-clipservice-type"]=n.commandParameters.clipServiceDataType,t["data-clipservice-count"]=n.commandParameters.objectCount.toString(),t["data-clipservice-dc"]=n.commandParameters.clipServiceDataCenter,t["data-clipservice-client"]=this.r,t["data-TimeStamp"]=(new Date).toUTCString(),t["data-clipservice-version"]=this.s,r.setItem("metadata/additional-signature-data-attributes",JSON.stringify(t))),i.synchronousResult=this.v(r),i.asynchronousResult=this.x(n,u,r)),n.syncClipboardItemsKeys=_Ewa.iV.a(i.synchronousResult),i):(Diag.a.a(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),i):(Diag.a.a(36227299,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),i)},v:function(n){var t,i;return Diag.a.b(39977874,0,!!this.f.b().a(),"Expecting a floating object to be currently selected for copy"),n||(n=this.h.a()),t=this.f.b().a().cn(),!t||!t.length||(i=String.format("<img src='{0}'>",t),n.setItem("text/html",i)),n},A:function(){var n=this.f.b().a();this.g.b(_Ewa.P.g(n.a(),null),_Ewa.P.F(n.N()))},shouldWaitForCopyToComplete:function(){return Diag.a.a(41562515,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true"),!0},onDeferredPasteStarted:function(n){this.k.d(n)},onDeferredPasteCompleted:function(n){this.k.c(n)},deserialize:function(n){var u=_Ewa.cE.b(n),f=null,i=null,r=!1,e,o,t,a,s,h,c,l;if(!u){if(f=n.copyContextSnapshot,i=f.sourceItem,!i)return Promise.reject(new _Ewa.cA(10,null,null,"",100));r=i.c(this.d)}if(e=this.u(n,!0),e)return Promise.reject(new _Ewa.cA(u?18:r?19:20,null,null,"",e));if(u)return this.l(n);if(!r&&!_Ewa.vw.a(i))return o=String.format("User attempted to paste art of type [{0}] between sessions.",i.b),Diag.a.a(36229120,0,50,o),Promise.reject(new _Ewa.cA(11,null,null,o,100));if(f.isAsyncSerializeFailed)return Promise.reject(new _Ewa.cA(16,null,null,"Last async serialize failed, therefore no current shadow workbook payload to paste",100));try{a=n.clipboardItems.getItem("data/shadow-workbook");t=JSON.parse(a)}catch(v){return Diag.a.a(38102659,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(v)),Promise.reject(new _Ewa.cA(12,null,v,"",100))}if(t.floatingObjectId!==i.a?Diag.a.a(40134681,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId):Diag.a.a(39682268,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",i.a,t.floatingObjectId),!t||_Ewa.f.a(t.shadowWorkbookBase64))return Promise.reject(new _Ewa.cA(13,null,null,String.format("shadowWorkbookPayload is null = {0}",!t),100));if(n.isShadowWorkbookParsedSuccessfully=!0,n.shadowWorkbookPayloadSize=_Ewa.gj.b(t),n.shadowWorkbookSizeExceedsLimit=_Ewa.gj.a(t),n.payloadOrigin=r?"SameSession":"CrossSession",n.payloadType="GVML",_Ewa.gj.a(t))return s=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,t.shadowWorkbookSizeExceedsLimit),Diag.a.a(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",s),Promise.reject(new _Ewa.cA(1,null,null,s,100));if(h=null,c=null,_Ewa.c.a(this.d).a().c()&326?c=_Ewa.c.a(this.d).a().b().f():h=this.d.h()&&this.d.h().e()?_Ewa.h.a(this.d.h().e(),this.d):_Ewa.h.a(_Ewa.h.g(n.commandParameters.originalDestinations),this.d),l=null,this.g.c(i))try{l=this.g.a()}catch(y){Diag.a.a(37857494,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(y))}return this.m.j(new _Ewa.AA(n.commandParameters.ribbonCommandInfo,h,c,n.commandParameters.commandType,[n.commandParameters.stopwatch],t,i,n,l))},l:function(n){var t,i,r;return(n.wasLastCopyExternal=!0,n.clipboardItems.getItem("image/png"))?(t=n.commandParameters.stopwatch.b(),n.payloadType="Bitmap",i=this,r=this,$$sc.h.toPromise$t(Boolean,this.d.u(1403967063,n.commandParameters.ribbonCommandInfo.c,n.commandParameters.ribbonCommandInfo.b,{dataUrl:n.clipboardItems.getItem("image/png")})).then(function(i){return(n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t,i)?Promise.resolve(null):Promise.reject(new _Ewa.cA(15,null,null,"",100))},function(){return n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-t,Promise.reject(new _Ewa.cA(15,null,null,"",100))})):(Diag.a.b(39965841,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler"),_Ewa.beI.prototype.l.call(this,n))},y:function(){var n=_Ewa.c.a(this.d).a(),t;return!n.b().f()||!n.b().a()||!n.b().a().a()?!1:(t=n.b().a().a(),t.bd())},x:function(n,t,i){var r=this;return new Promise(function(u,f){var e=n.commandParameters.stopwatch.b(),o=function(o){var c,s,l,h;if(n.requestTelemetryData=o.RequestTelemetryData,n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e,_Ewa.i.c(o.Errors))_Ewa.i.h(o.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538327,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.i.a(o.Errors,","))):(Diag.a.a(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.i.a(o.Errors,",")),f(new _Ewa.lt(4,o.Errors)));else{if(Diag.a.a(36229121,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",t.a),n.markForCancellation){f(new _Ewa.lt(3,o.Errors));return}if(_Ewa.i.e(o.Errors)&&Diag.a.a(39688195,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",_Ewa.i.a(o.Errors,",")),c=o.Result,c){s=null;s=r.t(c);s.floatingObjectId=t.a;n.shadowWorkbookPayloadSize=_Ewa.gj.b(s);n.shadowWorkbookSizeExceedsLimit=_Ewa.gj.a(s);try{l=JSON.stringify(s)}catch(a){f(new _Ewa.cA(14,null,a,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",n.shadowWorkbookPayloadSize,s.floatingObjectId),100));return}Diag.a.b(41537862,0,!!i,"Expecting syncClipboardItems to be defined");h=i;h.setItem("data/shadow-workbook",l);n.commandParameters.commandType===1&&(r.z(t.b,t.a,o.StateId),r.w(t.a,t.b));r.i.e(t,h);n.asyncClipboardItemsKeys=_Ewa.iV.a(h);u(h)}else Diag.a.a(36508684,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",t.a),u(r.i.d(t))}},s=function(i){n.serverRequestTimeInMs=n.commandParameters.stopwatch.b()-e;var u=_Ewa.X.a(i.b);n.commandParameters.commandType===1&&r.j.d(t.b,t.a);Diag.a.a(36229123,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.i.a(u,","));f(new _Ewa.lt(4,u))};Diag.a.a(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");r.j.b(new _Ewa.IC(t.a,n.commandParameters,o,n.commandParameters.commandType,t.b,s,[n.commandParameters.stopwatch]))})},w:function(n,t){var u=t+"_"+n,i=_Ewa.R.a(this.d).a(u,null),r;i&&(r=14,_Ewa.R.a(this.d).d(i,r,!0),_Ewa.c.a(this.d).a().b().s(null))},z:function(n,t,i){var f=this.d.a().a(_Ewa.kK,277,!1,null);if(f){var u=null,e=n+"_"+t,r=_Ewa.R.a(this.d).a(e,null);if(r&&r.j()&&(u=r.j().a),!u)return;var o=r.a().h(),h=this,s=function(){return!u.v().e(o)};f.a(s,i,"CutArt")}}};_Ewa.ov=function(n,t){this.e=n;this.f=t};_Ewa.ov.a=function(n){return String.format("{0}.{{{1}}}",n.length+2,n.toUpperCase())};_Ewa.ov.prototype={e:null,f:null,h:function(n,t,i,r,u,f,e){var a=this.e.c().a().b(!1),h=null,c,o={},s,v,l;o.CopyPasteTargetType=2;o.FloatingObjectId=n;o.CopyOperationId=i.id;i.floatingObjectType=t;_Ewa.a.c("Microsoft.Office.Excel.CopyChartsToPPTOEnabled",!1)&&(o.UploadToClipService=i.uploadToClipService,o.PKey=i.pKey,o.ClipServiceDataCenter=i.clipServiceDataCenter);s=0;u===2?(c=505,s=16,v=this,h=function(n,t,u){return _Ewa.lg.a(v.e.c().a(),o,_Ewa.n.a(n,r),f?_Ewa.n.b(t,f):t,u,i.ribbonCommandInfo,a,e)}):(c=179,l=this,h=function(u,s,h){return l.g(t,n),l.e.O(),_Ewa.lg.c(l.e.c().a(),o,_Ewa.n.a(u,r),f?_Ewa.n.b(s,f):s,h,i.ribbonCommandInfo,a,e)});_Ewa.a.d()?(s|=64,this.e.f().a(new _Ewa.v(c,0,h,s,null),i.ribbonCommandInfo)):this.e.f().a(new _Ewa.ba(c,0,h,s,null),i.ribbonCommandInfo)},g:function(n,t){var r=n+"_"+t,i=_Ewa.R.a(this.e).a(r,null);i?(_Ewa.c.a(this.e).a().b().c(i,!0),i.p(!1)):Diag.a.a(37790621,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",n,t)},d:function(n,t){var r=n+"_"+t,i=_Ewa.R.a(this.e).a(r,null);i&&i.p(!0)},b:function(n){var t=n;this.h(t.e,t.b,t.a,t.f,t.c,t.d,t.g)},i:function(n,t,i,r,u,f,e,o,s){var h=this;return new Promise(function(c,l){var a=f.commandParameters.stopwatch.b(),v=function(n){if(f.requestTelemetryData=n.RequestTelemetryData,f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-a,_Ewa.i.h(n.Errors))f&&(f.encounteredDeploymentErrors=!0),Diag.a.a(36538328,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.i.a(n.Errors,","));else if(_Ewa.i.c(n.Errors))Diag.a.a(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.i.a(n.Errors,",")),l(new _Ewa.cA(9,n.Errors,null,"",100));else if(n.Result){var t=n.Result;Diag.a.a(36229124,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");h.j(e,t.FloatingObjectId,n.StateId);c(_Ewa.ov.a(t.FloatingObjectId))}else Diag.a.a(36229125,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),l(new _Ewa.cA(9,n.Errors,null,"",100))},y=function(n){f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-a;var t=_Ewa.X.a(n.b);Diag.a.a(36229126,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.i.a(t,","));l(new _Ewa.cA(9,t,null,"",100))};h.k(n,u,t,i,v,y,r,o,s)})},j:function(n,t,i){var r=this.e.a().a(_Ewa.kK,277,!1,null);if(r){var u=n+"_"+_Ewa.ov.a(t),f=this,e=function(){return!!_Ewa.R.a(f.e).a(u,null)};r.a(e,i,"PasteArt")}},l:function(n,t){!t||!t.length||this.f.d(n,n.b+"_"+t)},a:function(n){var t=n,r=this,i=this;return this.i(t.i,t.c,t.e,t.k,t.j,t.h,t.b.b,t.d,t.b.c(this.e)).then(function(n){return n},function(n){return i.l(t.b,t.d),Promise.reject(n)})},c:function(n,t,i){if(n||(n=_Ewa.h.a(_Ewa.c.a(this.e).a().a().a(),this.e)),_Ewa.c.a(this.e).cl(_Ewa.h.b(n),1))_Ewa.R.a(this.e).c(i,t,!0);else{var r=_Ewa.c.a(this.e).a().b().k(n,t,i),u=this;r.CW(function(n){var i=n.a();i?Diag.a.a(36459653,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",t):Diag.a.a(36459654,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",t)})}},k:function(n,t,i,r,u,f,e,o,s){var y=this.e.c().a().b(!1),h={};h.ShadowWorkbookBase64=t.shadowWorkbookBase64;h.FloatingObjectId=r;h.DestinationRanges=i?_Ewa.h.j(i):null;h.CopyPasteTargetType=2;h.ClientEstimationFloatingObjectId=o;var c=this,l=function(n,t,i){return o||c.e.O(),_Ewa.lg.b(c.e.c().a(),h,_Ewa.n.a(n,u),_Ewa.n.b(t,f),i,null,y,e)},p=this,a=function(){if(s){var n={};return n=_Ewa.E.b(_Ewa.E.a(h)),n.FloatingObjectId=t.floatingObjectId,h.DestinationRanges||(n.DestinationRanges=_Ewa.h.A(p.e.d().a().b(),"",0,0,0,0)),new _Ewa.zt(n,s,0,0)}return new _Ewa.zt(h,s,0,0)},v=_Ewa.a.d()?new _Ewa.v(503,0,l,0,a):new _Ewa.ba(503,0,l,0,a);v.F=_Ewa.a.d()?65:1;this.e.f().a(v,n)}};_Ewa.Hs=function(n){this.e=n};_Ewa.Hs.prototype={e:null,f:null,h:null,g:15,b:function(n,t){this.f=n;this.h=t},a:function(){var n,i,r,u,t;return!this.f||!this.h?(Diag.a.a(37857495,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),""):(n=_Ewa.P.g(new _Ewa.fH(this.f),null),n.Id=_Ewa.ov.a(Common.u.a().a),n.Version=-1,n.Name="",n.IsClientEstimation=!0,i=this.i(n),!i)?null:(r=new _Ewa.fH(n),i.a.v().b(r),r.g=-1,u=_Ewa.R.a(this.e),u.n(r,i),t=u.a(n.Type+"_"+n.Id,null),!t||t.a().f===5||t.a().f===3||t.ca(this.h),u.c(n.Type,n.Id,!0),n.Id)},c:function(n){return _Ewa.a.b(227)&&n.c(this.e)&&!_Ewa.c.a(this.e).d()&&!_Ewa.c.a(this.e).g().c()},d:function(n,t){if(this.c(n)){var i=_Ewa.R.a(this.e).a(t,null);i&&(Diag.a.a(38012936,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",t,i.a().a),_Ewa.R.a(this.e).d(i,15,!0),i.j()&&i.ba(i.j(),!1))}},i:function(n){var u,f,t,r,i;return n?_Ewa.c.a(this.e).a().b().f()?(u=_Ewa.c.a(this.e).a().b().e().a(),n.OriginDeltaX=u.s+this.g,n.OriginDeltaY=u.t+this.g,n.AbsoluteLeft=n.AbsoluteLeft+this.g,n.AbsoluteTop=n.AbsoluteTop+this.g,n.AbsoluteRight=n.AbsoluteRight+this.g,n.AbsoluteBottom=n.AbsoluteBottom+this.g,n.ZOrder=u.p+1,_Ewa.c.a(this.e).a().b().e().j()):!this.e.h()||!this.e.h().e()?(Diag.a.a(37857497,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null):(f=this.e.h().e(),t=_Ewa.c.a(this.e).bj(f),!t)?(Diag.a.a(37857498,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",f.toString()),null):(r=_Ewa.j.m(t.c(),t.e().l()),i=t.m().y(f,2,!1,!1),!r||!i)?(Diag.a.a(37857499,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!r,!i),null):(n.OriginDeltaX=i.a.a-r.x,n.OriginDeltaY=i.a.b-r.y,n.AbsoluteLeft=i.a.a,n.AbsoluteTop=i.a.b,n.AbsoluteRight=n.AbsoluteLeft+Math.abs(this.f.AbsoluteRight-this.f.AbsoluteLeft),n.AbsoluteBottom=n.AbsoluteTop+Math.abs(this.f.AbsoluteBottom-this.f.AbsoluteTop),n.ZOrder=this.f.ZOrder+100,new _Ewa.eN(t.m().b().a(t.b()),t.b())):(Diag.a.a(37857496,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null)}};_Ewa.beI=function(n,t){this.b=this.a;this.n=t;this.c=n;this.o=_Ewa.ClientStringManager.a();this.e=new _Ewa.gC(n,_Ewa.c.a(n))};_Ewa.beI.prototype={c:null,o:null,e:null,n:null,a:function(){return this.n},p:function(){return this.o.b(5)},shouldWaitForCopyToComplete:function(){return!1},onDeferredPasteStarted:function(){},onDeferredPasteCompleted:function(){},beforePaste:function(){},E:function(n,t){t.val=null;try{var i=n.getItem("data/shadow-workbook");return!i||!i.length?!1:(t.val=JSON.parse(i),this.B(t.val))}catch(r){return Diag.a.a(539303949,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+r),!1}},B:function(n){return!!n&&(!_Ewa.f.a(n.shadowWorkbookBase64)||n.shadowWorkbookSizeExceedsLimit)&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)},l:function(n){var o,i,u,f,t,e,r;return(n.wasLastCopyExternal=!0,o=this.c.h().b(),_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&n.commandParameters.commandType!==516&&n.commandParameters.commandType!==1028&&(i=null,f=this.E(n.clipboardItems,u={val:i}),i=u.val,f))?(n.isShadowWorkbookParsedSuccessfully=!0,this.D(n,i)):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?_Ewa.a.b(165)&&n.commandParameters.commandType!==20?(t=n.clipboardItems.getItem("text/html"),e=!isNullOrUndefined(t)&&!(!t||!t.length)&&t.trim()!==this.p()&&(t.startsWith("<")||Common.c.b()&&t.startsWith("\n<")),e?(r=n.clipboardItems.getItem("copyId"),this.C(n,t,isUndefined(r)?null:r)):this.q(n)):this.q(n):Promise.reject(new _Ewa.cA(6,null,null,"",100))},D:function(n,t){Diag.a.a(539303948,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");n.pasteResult="SystemClipboardShadowWorkbookPaste";n.payloadType="ShadowWorkbook";n.payloadOrigin="External";n.shadowWorkbookPayloadSize=_Ewa.gj.b(t);n.shadowWorkbookSizeExceedsLimit=_Ewa.gj.a(t);var i=null,r=null,u=n.commandParameters.originalDestinations;return _Ewa.a.c("Microsoft.Office.Excel.CrossSessionDiscontinuousCCPEnabled",!1)?i=_Ewa.h.d(u,this.c):r=_Ewa.h.a(_Ewa.h.g(u),this.c),t.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(n.originalSourceRangesCountExceedsLimit=t.originalSourceRangesCountExceedsLimit),n.shadowWorkbookSizeExceedsLimit?(Diag.a.a(539303947,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",n.shadowWorkbookPayloadSize,4194304,t.shadowWorkbookSizeExceedsLimit),Promise.reject(new _Ewa.cA(1,null,null,"",100))):(Diag.a.a(539303946,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",n.commandParameters.id),this.e.e(n.commandParameters.ribbonCommandInfo,r,i,t,[n.commandParameters.stopwatch],n))},q:function(n){var t=n.clipboardItems.getItem("text/plain"),r=!isNullOrUndefined(t)&&t.trim()===this.p(),i;return r?Promise.reject(new _Ewa.cA(7,null,null,"",100)):(isNullOrUndefined(t)||(n.plainTextPayloadSize=t.length),n.isPlainTextPaste=!0,n.pasteResult="SystemClipboardPaste",n.payloadOrigin=_Ewa.cE.c(n)?"LegacyCrossSession":"External",n.payloadType="PlainText",Diag.a.a(39186568,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",n.id,n.commandParameters.id),i=this.e.l(_Ewa.h.g(n.commandParameters.originalDestinations),t,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n),Diag.a.a(51668559,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",n.id),i)},C:function(n,t,i){return n.htmlPayloadSize=t.length,n.isHtmlPaste=!0,n.pasteResult="SystemClipboardHtmlPaste",n.payloadType="Html",n.payloadOrigin=_Ewa.cE.c(n)?"LegacyCrossSession":"External",Diag.a.a(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",n.commandParameters.id),this.e.k(_Ewa.h.g(n.commandParameters.originalDestinations),t,i,n.commandParameters.id,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n)},t:function(n){var t={};return n&&(t.shadowWorkbookBase64=n.ShadowWorkbookBase64,t.shadowWorkbookSizeExceedsLimit=n.ShadowWorkbookSizeExceedsLimit,t.originalSourceRangesCountExceedsLimit=n.OriginalSourceRangesCountExceedsLimit,t.originalSourceRangesCount=n.OriginalSourceRangesCount,t.shadowWorkbookBlockedSize=n.ShadowWorkbookBlockedSize),t},u:function(n,t){var f=_Ewa.cE.b(n),c=(n.commandParameters.commandType&64)==64,l=(n.commandParameters.commandType&32)==32,a=(n.commandParameters.commandType&1024)==1024,e=!1,o=null,s=null,r=!1,u,h,i;return f||(e=n.commandParameters.ribbonCommandInfo.a===-1985798686,u=n.copyContextSnapshot,t?(h=u.sourceItem,r=!h.c(this.c)):(i=this.e.a(u),i&&(o=i.a,s=i.b,r=!n.isSameSession))),this.e.f(s,o,this.c.h().b(),n.commandParameters.originalDestinations,n.commandParameters.expandDestinations,r,c,l,a,e,t,f)}};_Ewa.beJ=function(n,t,i,r,u){_Ewa.beJ.initializeBase(this,[n,r]);this.j=t;this.f=i;this.g=u||new _Ewa.vy(this.f);this.d=_Ewa.c.a(n);this.k=this.d.a();this.i=n.a().a(_Ewa.vC,169,!1,null)};_Ewa.beJ.prototype={d:null,k:null,i:null,j:null,g:null,f:null,getSourceItem:function(){var n=Common.x.c(this.d.a().a().b());return new _Ewa.nF(this.c,n,this.c.b().u().b(),this.c.b().d(),this.c.e().UserSessionId)},beforeSerialize:function(n){n.isSelectionAllowed=!1;n.isAsyncCopy=!1;n.isFromCache=!1;n.encounteredDeploymentErrors=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.clientSideCopyTime=0;var i=new _Ewa.bN(this.c.d()),t=n.sourceItem,r=this;n.isSelectionAllowed=Common.x.b(t.a,function(n){return r.y(i,n)});n.isSelectionAllowed&&this.e.d(t.a,n.commandParameters.commandType)},x:function(n){return this.d.b().k()&&_Ewa.c.i(this.d,n)},A:function(n,t,i,r){var u=!1;return i.a.length===1&&r.length===1?_Ewa.a.a("OfficeVSO:5470715_Paste_Instantaneous")&&(u=this.j.h(n,_Ewa.h.g(i.a),i.b,_Ewa.h.g(n.commandParameters.expandDestinations),this.c.b().u().b(),t.commandParameters.commandType===1)):n.cseStatus=5,u&&_Ewa.c.a(this.c).o().d(n.commandParameters.stopwatch.c(),_Ewa.bl.b,!0),this.z(n,i,_Ewa.h.i(this.c.h().b(),null,r),t.commandParameters.commandType,u)},y:function(n,t){return n.f(t,this.d)},z:function(n,t,i,r,u){var f=_Ewa.h.i(t.b,null,t.a);return n.pasteResult="SameSessionPaste",n.payloadOrigin="SameSession",n.payloadType="ActiveSelection",Diag.a.a(37003422,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",n.commandParameters.id),this.e.c(n.commandParameters.ribbonCommandInfo,f,i,r,n.commandParameters.commandType,[n.commandParameters.stopwatch],n,u)}};_Ewa.vx=function(){};_Ewa.vx.prototype={a:function(){var n=window.clipboardPlatform;return n?n.createClipboardItems():null}};_Ewa.ow=function(){};_Ewa.ow.b=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,s);return c.sourceRanges=t,c.destinationRanges=i,c.flags=r,_Ewa.k.a(n,"PasteRange",c,u,f,e,o,64,h,null)};_Ewa.ow.a=function(n,t,i,r,u,f,e,o){var s=n.a(1,e);return s.pasteHtmlParameters=t,_Ewa.k.a(n,"PasteHtmlContent",s,i,r,u,f,64,o,null)};_Ewa.ow.c=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.destinationRange=t,h.source=i,_Ewa.k.a(n,"PasteString",h,r,u,f,e,64,s,null)};_Ewa.Hu=function(){};_Ewa.Hu.a=function(n){if(!n){Diag.a.a(36701969,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.");return}n.isAsyncCopy=!1;n.isSelectionAllowed=!1;n.isFromCache=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.htmlPayloadSize=0;n.htmlSizeExceedsLimit=!1;n.clientSideCopyTime=0;n.encounteredDeploymentErrors=!1;n.shadowWorkbookSizeExceedsLimit=!1;n.originalSourceRangesCountExceedsLimit=!1;n.copyTotalSizeExceedsLimit=!1};_Ewa.vy=function(n){this.b=n};_Ewa.vy.prototype={a:null,c:null,b:null,d:function(n){return this.a&&this.a.g(n)?this.f(this.c):null},e:function(n,t){this.a=n;this.c=this.f(t)},f:function(n){var t=this.b.a(),u=n.getItem("text/plain"),i,r;return u&&t.setItem("text/plain",u),i=n.getItem("data/shadow-workbook"),i&&t.setItem("data/shadow-workbook",i),r=n.getItem("text/html"),r&&t.setItem("text/html",r),t}};_Ewa.cq=function(n,t,i,r,u,f,e,o,s){this.L=Function.createDelegate(this,this.bB);this.U=Function.createDelegate(this,this.bC);this.K=Function.createDelegate(this,this.bA);this.J=Function.createDelegate(this,this.bw);this.I=Function.createDelegate(this,this.bv);this.S=Function.createDelegate(this,this.bu);this.T=Function.createDelegate(this,this.bx);this.bc=_Ewa.a.c("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);_Ewa.cq.initializeBase(this,[!1]);this.u=n;this.C=i;this.v=_Ewa.c.a(n);this.x=u;this.O=f;this.w=t;this.z=r;this.y=s?s:copyPasteInfra.getStringifiedError;this.H=o===1;this.bF();this.D=this.u.a().a(_Ewa.vD,85,!1,null);Diag.a.b(24388233,0,!!this.D,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");e||(Diag.a.a(37033877,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),e="cpiDID");this.B=Common.d.e(e);this.R="CultureTag: "+_Ewa.ClientStringManager.a().f()+" HASH: ";this.w.addMetadataChangeListener("EwaJsMetadataChangeListenerId",this.T);this.P=this.u.e().MaxCopyPasteLength;this.Q=this.bc?_Ewa.a.g("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.u.e().CopyPasteMaxPayloadLength):4194304};_Ewa.cq.l=function(n){var t=n.innerError;return t&&t.pasteErrorName?n.innerError:null};_Ewa.cq.j=function(n){var t=n.innerError;return t&&t.copyErrorName?n.innerError:null};_Ewa.cq.a=function(n){var t="",i,r;return n?(i=n,_Ewa.f.a(i.errorName)||(t=i.errorName,i.innerError&&(t+="_"+_Ewa.cq.a(i.innerError))),t&&t.length||(r=n,t=r&&!_Ewa.f.a(r.name)?r.name:"UnknownError"),t):"UnknownError"};_Ewa.cq.c=function(n){return _Ewa.cq.b||(_Ewa.cq.b=_Ewa.s.C(n)?"Slice6":_Ewa.s.r(n)?"Slice5":"Slice4"),_Ewa.cq.b};_Ewa.cq.e=function(n){switch(n){case 7:case 1:return 2078;case 5:return 2076;case 6:return 2075;case 8:case 3:case 2:case 4:case 9:case 10:return 2072;default:return Diag.a.b(593850376,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",n),2078}};_Ewa.cq.k=function(n){switch(n){case 3:return 2073;case 1:return 2074;case 2:case 4:return 2072;default:return Diag.a.b(593850375,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",n),2078}};_Ewa.cq.prototype={u:null,v:null,w:null,C:null,D:null,z:null,x:null,O:null,P:0,Q:0,B:0,R:null,y:null,H:!1,A:!1,E:function(){return this.u.a().a(_Ewa.qM,373,!1,null)},i:function(n){this.es("cpiOSC",n)},t:function(n){this.eu("cpiOSC",n)},l:function(n){var u,s,f,e,i,o,r,t;return(n.stopwatch=this.u.o().a("UserAction",_Ewa.F.a().b(n.ribbonCommandInfo.a)+"ClientSide"),u=!!_Ewa.cE.a(this.w),_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&(this.A=!1),s=this,this.b("Copy/before/"+Common.m.a.toString(n.ribbonCommandInfo.c),!1,!1,!0,n.copyPasteTargetType).catch(function(){}),f=this.v.bH()===1,e=n.ribbonCommandInfo.a===-1985798686,f&&(i=this.x.i(this.v.a().a().b(),e),i))?(o=_Ewa.cq.k(i),this.F(o,_Ewa.we.toString(i),!1),Promise.reject(!1)):(n.userHash=this.B,n.id=Common.u.a().a,r=this,t=this,this.z.onCopy(n).then(function(t){return t.isAsyncCopy||n.stopwatch.a(),r.E().b(0),Diag.a.a(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",_Ewa.hs.a(n)),r.bq(t,u),Promise.resolve(!0)},function(i){var r=i,f=!1,s="none",o="Unknown",e=!0,h=-1,c="CopyError_",l=!1,a=null,u;return r&&(a=r.copyContext,h=r.reason,c+=_Ewa.cq.a(r),_Ewa.f.a(r.message)||(o=r.message),u=_Ewa.cq.j(r),u&&(u.copyErrorName===3?(f=!0,o=s="Async Copy canceled by the user.",e=!1):_Ewa.i.e(u.ewaErrors)&&(o=t.N(u.ewaErrors),_Ewa.i.d(u.ewaErrors,_Ewa.cq.d)?(f=!0,l=!0):(_Ewa.i.d(u.ewaErrors,_Ewa.cq.h)||_Ewa.i.d(u.ewaErrors,_Ewa.cq.f))&&(f=!0))),r.reason===13?(f=!0,e=!1):r.reason===11&&(e=!1)),f?Diag.a.a(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",e,s,r?t.y(r):"null",_Ewa.hs.a(n)):Diag.a.a(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",e,r?t.y(r):"null",_Ewa.hs.a(n)),e&&t.b("Copy/fail/"+Common.m.a.toString(n.ribbonCommandInfo.c),!0,!1,!1,n.copyPasteTargetType).catch(function(){}),t.bp(n,f,o,c,h,l,a),Promise.reject(i)}))},e:function(n){var u,t,i,r,f,e,o,c,s,h;return n.stopwatch=this.u.o().a("UserAction",_Ewa.F.a().b(n.ribbonCommandInfo.a)+"ClientSide"),_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&(Diag.a.a(539303945,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.A=!1,u=["data/shadow-workbook"],n.clipboardPicklingApiDataFormatsToRead=u),_Ewa.c.a(this.u).o()&&_Ewa.c.a(this.u).o().e(this.bm(n.ribbonCommandInfo.a),n.stopwatch.c(),""),n.isPasteCommandFromRecoveryUI?(i=_Ewa.Bi.a(this.u),t=Common.x.c(i.c()),r=i.b(),n.pasteRecoveryCachedClipboardItems=r?r.PasteRecoveryCachedClipboardItems:null):t=Common.x.c(this.v.a().a().b()),n.originalDestinations=t,n.expandDestinations=this.M(n.originalDestinations,n.commandType),f=this.j(n.commandType,n.expandDestinations),f||this.bh()?(n.userHash=this.B,n.id=Common.u.a().a,_Ewa.a.c("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Common.c.i()&&(n.clipboardReadPermissionPromptShown=!1,e=["text/plainAsync"],n.clipboardAsyncApiDataFormatsToRead=e,o=this,c=this,this.z.shouldShowClipboardReadPermissionDialog().then(function(t){return t&&(n.clipboardReadPermissionPromptShown=!0,new _Ewa.Ht(o.u)),Promise.resolve(!0)},function(){return Promise.resolve(!0)})),s=this,h=this,this.z.onPaste(n).then(function(t){return s.bz(t,n)},function(t){return h.by(n,t)})):(Diag.a.a(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',_Ewa.h.n(n.expandDestinations,",",this.u,!1,!1,!1),n.commandType,n.copyPasteTargetType),Promise.resolve(!0))},g:function(){return this.A},bm:function(n){if(_Ewa.a.a("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(n){case 1804571062:return 6;case-185374993:return 7;case 1766348718:return 8;default:return 3}return 3},bh:function(){return!!_Ewa.c.a(this.u).a().b().f()&&this.u.P(null,!1,470,0)},a:function(){var n=_Ewa.cE.a(this.w);return!n||!n.commandParameters?0:n.commandParameters.copyPasteTargetType},q:function(){return!!_Ewa.cE.a(this.w)&&_Ewa.nc.a(_Ewa.cE.a(this.w),this.u)},b:function(n,t,i,r,u){var e,o,f,s,h,c;try{return(e=u,o=this.bo(),!r&&o===2)?(Diag.a.a(36304158,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),Promise.reject(null)):(e||(e=o),f=this.u.o().a("UserAction","ClearCopyState"),s=f.c(),Diag.a.a(24150914,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),this.x.b(),this.bE(),h=this,c=this,this.z.onCancelCopy(t).then(function(){return t&&_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&(h.A=!1),f.a(),h.be(n,s,!0,i,t,"","",f.b(),e),Promise.resolve(!0)},function(r){Diag.a.a(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",r?c.y(r):"null");f.a();var o="CancelError_",h="Unknown",u=r;return u&&(o+=_Ewa.cq.a(u),_Ewa.f.a(u.message)||(h=u.message)),c.be(n,s,!1,i,t,h,o,f.b(),e),Promise.reject(r)}))}catch(l){return Promise.reject(null)}},k:function(n,t,i,r,u){return!r&&_Ewa.a.b(721)&&!this.bk()?(Diag.a.a(574465173,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null)):this.b(n,t,i,r,u)},F:function(n,t,i){var r,u,f,o,e;Diag.a.a(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",t);_Ewa.a.a("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")&&(r=new($$sc.w.$$(String)),r.b("reason",t),u="",u=i?_Ewa.boY.a.o:_Ewa.boY.a.k,_Ewa.tt.a(_Ewa.boY.b.a,[u],!0,!0,!1,!1,r));f=_Ewa.i.b(1,1,721,n,0,371863010,"DiscontinuousSelectionBlocking");_Ewa.a.f()?o=new _Ewa.es(this.u,f,null):(e=new _Ewa.dt(this.u,f),e.F(),e.z(!1))},bo:function(){var n=_Ewa.cE.a(this.w);return!n||!n.sourceItem?0:Object.getType(n.sourceItem)===_Ewa.jF?2:1},m:function(n,t,i,r,u){var c,e,o,f,s,h;return n.stopwatch=this.u.o().a("UserAction","DragDropClientSide"),c=this,this.b("DragDrop/before/"+Common.m.a.toString(n.ribbonCommandInfo.c),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=u?2:1,o=0,o=u?4:r?256:128,f={},f.encounteredDeploymentErrors=!1,f.commandParameters=n,n.userHash=this.B,n.id=Common.u.a().a,s=this,h=this,this.x.c(n.ribbonCommandInfo,_Ewa.h.e(t,this.u),_Ewa.h.e(i,this.u),e,o,[n.stopwatch],f,!1).then(function(){return Diag.a.a(36975680,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',n.copyPasteTargetType),s.v.a().p(-1),s.bf(n,e,t,i,f),Promise.resolve(!0)},function(r){return Diag.a.a(36975681,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',r?h.y(r):"null",n.copyPasteTargetType),h.bg(r,n,e,t,i,f)})},o:function(n,t,i,r,u){var c,e,o,f,s,h;return n.stopwatch=this.u.o().a("UserAction","DragDropReplaceClientSide"),c=this,this.k("DragDropReplace/before/"+Common.m.a.toString(n.ribbonCommandInfo.c),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=u?2:1,o=0,o=u?4:r?256:128,f={},f.encounteredDeploymentErrors=!1,f.commandParameters=n,n.userHash=this.B,n.id=Common.u.a().a,s=this,h=this,this.x.c(n.ribbonCommandInfo,_Ewa.h.e(t,this.u),_Ewa.h.e(i,this.u),e,o,[n.stopwatch],f,!1).then(function(){return Diag.a.a(540386466,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',n.copyPasteTargetType),s.v.a().p(-1),s.bf(n,e,t,i,f),Promise.resolve(!0)},function(r){return Diag.a.a(540386465,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',r?h.y(r):"null",n.copyPasteTargetType),h.bg(r,n,e,t,i,f)})},n:function(n,t,i,r,u){var l,f,c,e;n.stopwatch=this.u.o().a("UserAction","DragDropInsertClientSide");l=this;this.k("DragDropInsert/before/"+Common.m.a.toString(n.ribbonCommandInfo.c),!1,!1,!1,n.copyPasteTargetType).catch(function(){});var a=u?2:1,o=t,v=i,s=_Ewa.h.g(this.M([v],a)),y=this.u.b().u().b(),p=this.u.b().u().b(),h=_Ewa.h.a(o,this.u);return h.SheetName=y,f=_Ewa.h.a(s,this.u),f.SheetName=p,c=s.k()||o.k()||r?1:0,e=this,this.X(h,f,u,c,n.ribbonCommandInfo).CW(function(){u?e.x.b():e.k("DragDropInsert/success/"+Common.m.a.toString(n.ribbonCommandInfo.c),!0,!1,!1,0)})},p:function(n,t){var r=_Ewa.cE.a(this.w),i,e,c,l,o;if(!r)return Diag.a.a(25518403,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!_Ewa.iq.a(r.sourceItem))return Diag.a.a(36824457,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),$$sc.a.a(Boolean,!1);if(i=r.sourceItem,!i)return Diag.a.b(25518404,0,!!i,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!i.c(this.u))return Diag.a.a(34981187,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),$$sc.a.a(Boolean,!1);if(i.a.length>1)return Diag.a.a(595185888,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.F(2072,"InsertCopiedCutCells",!0),$$sc.a.a(Boolean,!1);var u=_Ewa.h.g(i.a),a=this.v.a().a().c().f(),f=_Ewa.h.g(this.M([a],n)),s=this.r(),v=i.b,y=this.u.b().u().b(),h=_Ewa.h.a(u,this.u);return h.SheetName=v,e=_Ewa.h.a(f,this.u),e.SheetName=y,c=f.p()||u.p()?$$sc.a.a(_Ewa.qt,0):f.k()||u.k()?$$sc.a.a(_Ewa.qt,1):this.O.a(this.u,_Ewa.c.a(this.u).d()),l=this,o=this,c.CWR($$sc.a,function(n){return l.X(h,e,s,n.a(),t)}).CW(function(){s?o.x.b():o.b("InsertCopiedCutCells/success/"+Common.m.a.toString(t.c),!0,!1,!1,0)})},c:function(){var n=_Ewa.cE.a(this.w),t=this.v.a().a().d();return!!n&&_Ewa.iq.a(n.sourceItem)&&t&&n.sourceItem.a.length===1},r:function(){return this.bd(-911352779)},d:function(){return this.bd(-1985798686)},j:function(n,t){var i=new _Ewa.bN(this.u.d()),r=n===36,u=i.a(4),f=this.a()===2&&i.a(1),e=r&&u;return e||f||this.u.P(t,!0,1,0)},f:function(n,t){return this.x.j(n,t)},dispose:function(){_Ewa.bW.prototype.dispose.call(this);this.bJ();this.w.removeMetadataChangeListener("EwaJsMetadataChangeListenerId")},h:function(n,t,i,r,u,f){var o=0,e,s,h;if(!this.bi(n.commandParameters.ribbonCommandInfo.a))return n.cseStatus=2,!1;if(f&&t.h(r))return n.cseStatus=4,!1;if(i!==u)return n.cseStatus=6,!1;if(_Ewa.a.a("OfficeVSO:5593878_PasteCSE_CCPErrorTests")){if(r.m()%t.m()||r.j()%t.j())return n.cseStatus=16,!1;if(f&&!(r.y()===1||r.y()===t.y()))return n.cseStatus=17,!1}return(e=t.l(this.v.s()),s=r.l(this.v.s()),!e||!s)?(n.cseStatus=7,!1):(h=_Ewa.h.a(e,this.u),h.SheetName=i,o=this.C.k(this.v,h,_Ewa.h.a(s,this.u),n.commandParameters.ribbonCommandInfo.a,n.commandParameters.stopwatch),o===1&&(f&&(this.C.c(e,!1,""),this.C.c(e,!0,"")),n.commandParameters.ribbonCommandInfo.a===-185374993&&_Ewa.c.a(this.u).dH(),this.E().a(n.commandParameters.id),this.G(n.commandParameters.expandDestinations,n.commandParameters.isPasteCommandFromRecoveryUI),this.V("DoPasteClientEstimation/"+Common.m.a.toString(n.commandParameters.ribbonCommandInfo.c),n)),n.cseStatus=o,o===1)},s:function(){var n=this.D.a(this.u);n.a(!0,!1,!1,this.S)},bi:function(n){switch(n){case 237279923:case 808159687:return _Ewa.KK.a();case-185374993:return!0;case 1804571062:return!0;default:return!1}},bd:function(n){var t=_Ewa.cE.a(this.w),i;return t?(i=t.sourceItem,i&&!i.c(this.u))?(Diag.a.a(34981188,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):t.commandParameters.ribbonCommandInfo.a===n:!1},bk:function(){var t=_Ewa.cE.a(this.w),n;return t?(n=t.sourceItem,n&&!n.c(this.u))?(Diag.a.a(574465172,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1},X:function(n,t,i,r,u){var f={};f.InsertDirection=r;f.SourceRange=n;f.DestRange=t;f.CopyCutOperation=i?0:1;var e=this.u.c().a(),h=this,o=function(n,t,i){return _Ewa.NI.a(e,f,n,t,i,null,null)},c=this,s=function(){return new _Ewa.SG(f)},l=this;return _Ewa.H.a(this.u.f(),o,function(n){return new _Ewa.v(104,0,n,0,s)},u)},bx:function(n){this.bH(n)&&(this.x.b(),Diag.a.a(38922268,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))},bH:function(n){var t=!n||!n.lastCopy;return t?!0:_Ewa.nc.a(n.lastCopy,this.u)},Z:function(n,t,i,r,u){var f={};return f.a=this.u.e().UserSessionId,f.e=n.stopwatch.c(),f.c=_Ewa.F.a().b(n.ribbonCommandInfo.a),f.b=Common.m.a.toString(n.ribbonCommandInfo.c),f.d=n.id,f.f=i.toString(),f.g=r.toString(),f.h=t.toString(),f.m=n.stopwatch.b(),f.o=!1,f.p=n.copyPasteTargetType.toString(),f.q=u.encounteredDeploymentErrors,f},bf:function(n,t,i,r,u){var f=this.Z(n,t,i,r,u);f.i=!0;_Ewa.F.a().a(45,f,!0)},br:function(n,t,i,r,u,f,e,o,s){var h=this.Z(n,t,i,r,s);h.i=!1;h.j=u;h.l=f;h.n=e;h.o=o;_Ewa.F.a().a(45,h,!0)},be:function(n,t,i,r,u,f,e,o,s){var h={};h.a=this.u.e().UserSessionId;h.b=t;h.c=n;h.f=i;h.e=r;h.d=u;h.g=f;h.h=e;h.i=o;h.j=s.toString();_Ewa.F.a().a(46,h,!0)},bq:function(n,t){var i=this.Y(n.commandParameters,n);i.l=!0;i.j=t;_Ewa.F.a().a(43,i,!0)},bp:function(n,t,i,r,u,f,e){var o=this.Y(n,e);o.l=!1;o.m=t;o.o=i;o.y=r;o.x=u;o.z=f;_Ewa.F.a().a(43,o,!0);Diag.a.a(42768481,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",o.y,o.x,o.m,o.z,o.o)},Y:function(n,t){var i={},u,e;if(i.a=this.u.e().UserSessionId,i.f=n.stopwatch.c(),i.g=n.id,i.c=_Ewa.F.a().b(n.ribbonCommandInfo.a),i.b=Common.m.a.toString(n.ribbonCommandInfo.c),i.q=n.stopwatch.b(),i.bd=_Ewa.cq.c(this.u),i.bg=n.copyPasteHandlerName,i.bj=isNullOrUndefined(n.ribbonCommandInfo.b)?null:Common.n.toString(n.ribbonCommandInfo.b),i.bq=n.uploadToClipService,i.br=n.floatingObjectType,i.s=n.copyPasteTargetType.toString(),i.bc=_Ewa.iV.b(n.copyPasteTargetType),i.z=!1,t){if(i.bk=t.id,i.bl=t.serverRequestTimeInMs,t.requestTelemetryData&&(i.bm=t.requestTelemetryData.EcsOperationDuration,i.bn=t.requestTelemetryData.EcsRequestDuration,i.bo=t.requestTelemetryData.WfeRequestDuration),i.d=t.sourceItem?t.sourceItem.toString():null,i.e=-1,_Ewa.iq.a(t.sourceItem)){i.e=0;u=t.sourceItem.a;for(var f=u,o=f.length,r=0;r<o;++r)e=f[r],i.e+=e.y()}i.h=t.isAsyncCopy;i.i=t.isFromCache;i.k=t.isSelectionAllowed;i.r=t.plainTextPayloadSize;i.u=t.htmlPayloadSize;i.v=t.htmlSizeExceedsLimit;i.w=t.copyTotalSizeExceedsLimit;i.t=t.shadowWorkbookPayloadSize;i.p=t.clientSideCopyTime;i.ba=t.encounteredDeploymentErrors;i.bb=t.shadowWorkbookSizeExceedsLimit;i.be=t.syncClipboardItemsKeys;i.bf=t.asyncClipboardItemsKeys;i.bh=this.W(t.succeededPopulatingSystemClipboardSync);i.bi=this.W(t.succeededPopulatingSystemClipboardAsync)}return i},G:function(n,t){if(!this.v.m()&&!this.v.u()){var i=this.v.a().a(),u=!t&&n.length===1&&_Ewa.h.k(n,i.b()),r=u?i.a():n[0].e();n[0].i(r)||(Diag.a.b(570770703,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",i.b(),i.j(),i.a(),n,u,r,t),r=n[0].e());this.v.a().y(n,0,r,0,!0,_Ewa.I.p,!1,!0,!0)}},ba:function(n,t){var i={},r,f,o;if(i.a=this.u.e().UserSessionId,i.g=n.stopwatch.c(),i.t=n.stopwatch.b(),i.bz=!1,t&&(i.bv=t.id,i.bw=t.serverRequestTimeInMs,i.n=t.commandParameters.clipboardFormatReadTimes,i.o=t.commandParameters.clipboardFormatReadStatus,i.p=t.commandParameters.clipboardReadPermissionPromptShown,i.q=t.commandParameters.asyncApiReadTimedOut,t.requestTelemetryData&&(i.cb=t.requestTelemetryData.EcsOperationDuration,i.cc=t.requestTelemetryData.EcsRequestDuration,i.cd=t.requestTelemetryData.WfeRequestDuration)),i.x=n.copyPasteTargetType.toString(),i.bl=_Ewa.iV.b(n.copyPasteTargetType),i.br=n.copyPasteHandlerName,i.i=_Ewa.h.n(n.expandDestinations,",",this.u,!1,!1,!1),i.h=_Ewa.h.n(n.originalDestinations,",",this.u,!1,!1,!1),i.e=n.id,i.d=n.commandType,i.c=_Ewa.F.a().b(n.ribbonCommandInfo.a),i.b=Common.m.a.toString(n.ribbonCommandInfo.c),i.bf=!1,i.bg=!1,i.bp=_Ewa.cq.c(this.u),i.bt=isNullOrUndefined(n.ribbonCommandInfo.b)?null:Common.n.toString(n.ribbonCommandInfo.b),i.ca=n.isPasteCommandFromRecoveryUI,n.isPasteCommandFromRecoveryUI&&(i.cf=n.pasteRecoveryUndoStopwatch.c(),i.cg=n.pasteRecoveryUndoStopwatch.b()),t){if(r=t.copyContextSnapshot,r&&!t.wasLastCopyExternal){if(i.f=r.commandParameters.id,i.j=r.sourceItem.toString(),i.k=-1,_Ewa.iq.a(r.sourceItem)){i.k=0;f=r.sourceItem.a;for(var e=f,s=e.length,u=0;u<s;++u)o=e[u],i.k+=o.y()}i.bg=r.commandParameters.commandType===1}else t.clipboardItems?i.f=t.clipboardItems.getItem("copyId"):Diag.a.a(50647260,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");i.bz=t.pasteRecoveryUIDisplayed;i.ci=t.cseStatus}else Diag.a.a(50647261,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return i},bs:function(n,t,i,r,u,f,e,o,s){var h=this.ba(n,o);h.l=!1;h.m=t;h.s=i;h.bc=r;h.be=u;h.bd=f;h.bf=e;o?(h.y=_Ewa.cE.b(o)||!o.copyContextSnapshot,h.bi=!h.y&&_Ewa.nc.a(o.copyContextSnapshot,this.u),h.bj=o.shadowWorkbookSizeExceedsLimit,h.v=o.shadowWorkbookPayloadSize,h.w=o.htmlPayloadSize,h.bq=_Ewa.iV.a(o.clipboardItems),h.bb=o.activeSelectionType,h.bs=o.isSameSession,h.bn=o.payloadOrigin,h.bo=o.payloadType,h.bu=o.externalAppSource,h.bx=o.indicationDisplayScheduled,h.by=o.pasteIndicationDisplayStatus):h.bi=_Ewa.nc.a(s,this.u);_Ewa.F.a().a(44,h,!0);Diag.a.a(42768482,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",h.be,h.bd,h.m,h.bf,h.s)},bt:function(n){var t=this.ba(n.commandParameters,n);t.y=n.wasLastCopyExternal;t.l=!0;t.u=n.plainTextPayloadSize;t.v=n.shadowWorkbookPayloadSize;t.w=n.htmlPayloadSize;t.z=n.isClipboardDataContainShadowWorkbook;t.ba=n.isShadowWorkbookParsedSuccessfully;t.bb=n.activeSelectionType;t.bc=n.pasteResult;t.bh=n.encounteredDeploymentErrors;t.bj=n.shadowWorkbookSizeExceedsLimit;t.bk=_Ewa.cE.c(n);t.bq=_Ewa.iV.a(n.clipboardItems);t.bs=n.isSameSession;t.bn=n.payloadOrigin;t.bo=n.payloadType;t.bu=n.externalAppSource;t.bx=n.indicationDisplayScheduled;t.by=n.pasteIndicationDisplayStatus;t.bm=_Ewa.cE.e(n);t.bi=!n.isSameSession&&!n.wasLastCopyExternal;_Ewa.F.a().a(44,t,!0)},bF:function(){this.u.d().c(this.I);this.u.d().T(this.J);this.u.f().d(this.K);this.u.B(this.U);_Ewa.c.a(this.u).f().d(this.L)},bJ:function(){this.u&&this.u.d()&&(this.u.d().d(this.I),this.u.d().bd(this.J));this.u&&this.u.f()&&this.u.f().e(this.K);this.v&&this.v.f()&&this.v.f().c(this.L)},by:function(n,t){var i=null,o=t,r=!1,e=null,f="UnknownFailure",p=-1,u="Unknown",s="PasteError_",w=!1,b,g,h,nt,c,l,a,v,y,k,d;return this.E().a(n.id),b=_Ewa.cE.a(this.w),(n.clearStateOnFinish||n.clearSystemClipboard)&&(g=this,this.b("Paste/fail/"+Common.m.a.toString(n.ribbonCommandInfo.c),!0,!1,!1,n.copyPasteTargetType).catch(function(){})),o&&(p=o.reason,s+=_Ewa.cq.a(o),_Ewa.f.a(o.message)||(u=o.message),i=_Ewa.cq.l(o),i&&(i.pasteErrorName===1?(r=!0,f="CopyPasteLengthTooLongPopup",u=e="The pasted content is too long. Popup a dialog to the user.",Diag.a.a(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e,n.copyPasteTargetType),h=_Ewa.i.b(1,0,26,662,0,1306609195,"CopyPasteOversizeError"),_Ewa.a.f()?nt=new _Ewa.es(this.u,h,null):(c=new _Ewa.dt(this.u,h),c.F(),c.z(!1))):i.pasteErrorName===7?(r=!0,f="No-Op",u=e="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Diag.a.a(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e,n.copyPasteTargetType)):i.pasteErrorName===8?(r=!0,f="UseShortcutsPopup",u=e="Unable to paste content from the system clipboard. Popup dialog to the user.",Diag.a.a(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e,n.copyPasteTargetType),this.s()):i.pasteErrorName===18?(r=!0,f="PasteExternalNotSupportMultipleSelectionPopup",u="Paste external not support multiple selection.",l="Unknown",a=2072,i.validationFailureReason!==100&&(l=_Ewa.oR.toString(i.validationFailureReason),a=_Ewa.cq.e(i.validationFailureReason)),this.F(a,l,!0)):i.pasteErrorName===20||i.pasteErrorName===19?(r=!0,i.pasteErrorName===20?(f="PasteAcrossSessionNotSupportMultipleSelectionPopup",u="Paste across session does not support multiple selection."):(f="PasteInSameSessionNotSupportMultipleSelectionPopup",u="This kind of multiple selection is not supported for same session paste."),v="Unknown",y=2072,i.validationFailureReason!==100&&(v=_Ewa.oR.toString(i.validationFailureReason),y=_Ewa.cq.e(i.validationFailureReason)),k=i.validationFailureReason===6,d=this.j(n.commandType,n.expandDestinations),d&&k&&this.G(n.expandDestinations,!1),this.F(y,v,!0)):i.pasteErrorName===6?(r=!0,f="No-Op",u=e="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Diag.a.a(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e,n.copyPasteTargetType)):i.pasteErrorName===17?(r=!0,f="No-Op",u=e="Paste text on Art is not yet a supported operation",Diag.a.a(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',e,n.copyPasteTargetType)):i.pasteErrorName===16?(r=!0,f="No-Op",u=e="Paste has failed because the previous copy has failed",Diag.a.a(40147082,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',e,n.copyPasteTargetType,this.y(i))):_Ewa.i.e(i.ewaErrors)?(_Ewa.i.i(i.ewaErrors)||_Ewa.i.d(i.ewaErrors,_Ewa.i.o())?(r=!0,f="CommunicationError",e=_Ewa.i.a(i.ewaErrors,","),Diag.a.a(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.i.d(i.ewaErrors,_Ewa.cq.i)?(r=!0,f="SavingWorkbookError",e=_Ewa.i.a(i.ewaErrors,","),Diag.a.a(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.i.d(i.ewaErrors,_Ewa.cq.d)&&(r=!0,w=!0,f="OperationSucceededWithAlert",e=_Ewa.i.a(i.ewaErrors,","),Diag.a.a(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)),r||(u=this.N(i.ewaErrors),r=this.bb(o))):i.pasteErrorName===11&&(r=!0,f="No-Op",u="Paste has failed because user try copy cross-session oart object")),o.reason===15&&(r=!0,f="No-Op",u="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished."),_Ewa.f.b(s,"PasteError_FailedToReadFromClipboard_UserHashMismatchError",!1)&&(r=!0,f="No-Op",u="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")),r||Diag.a.a(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',o?this.y(o):"null",n.copyPasteTargetType),this.bs(n,r,u,f,s,p,w,o.pasteContext,b),Promise.reject(t)},bz:function(n,t){var i;if(Diag.a.a(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',t.copyPasteTargetType),this.E().a(t.id),this.bD(t.copyPasteTargetType,n)&&(_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&n.wasLastCopyExternal&&n.payloadType==="ShadowWorkbook"&&(this.A=!0),i=null,n.pastedRange&&n.pastedRange.Ranges&&n.pastedRange.Ranges.length>0?i=_Ewa.h.t(n.pastedRange.Ranges):n.wasLastCopyExternal||(i=t.expandDestinations),this.bG(n,i),this.bI(n,i))){var f=Common.x.c(t.originalDestinations),e=t.commandType===1028?Common.x.c(t.expandDestinations):Common.x.c(i),r=null;n.wasLastCopyExternal&&(t.isKeyboardEvent||t.isPasteCommandFromRecoveryUI)&&(r={PasteRecoveryCachedClipboardItems:n.clipboardItems});n.pasteRecoveryUIDisplayed=!0;var o=new _Ewa.qN(this.u,f,e,r),u=_Ewa.l.a(_Ewa.mc,this.u.a(),406,405,0,null),s=this;_Ewa.g.a(u,function(){var n=u.a();n.a(o);n.d(t.ribbonCommandInfo.c)},this.ew(),3,null,null)}return this.V("Paste/success/"+Common.m.a.toString(t.ribbonCommandInfo.c),n),this.bt(n),this.H&&(!t.isKeyboardEvent||_Ewa.cE.c(n))&&this.u.b().e().a(66)&&(Diag.a.a(42824788,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.H=!1,this.bj()),Promise.resolve(!0)},bI:function(n,t){if(!t||t.length!==1||n.commandParameters.clearSystemClipboard||n.commandParameters.clearStateOnFinish||n.commandParameters.skipClipboardAccess)return!1;if(_Ewa.cE.b(n)){var i=n.clipboardItems.getItem("text/plain"),r=n.clipboardItems.getItem("text/html");if(isNullOrUndefined(i)||i.length>this.P||isNullOrUndefined(r)||r.length>this.Q)return Diag.a.a(576811736,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1}return!0},bD:function(n,t){return n===1||t.payloadType==="PlainText"||_Ewa.a.b(165)&&t.payloadType==="Html"||_Ewa.a.c("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Common.c.i()&&t.payloadType==="ShadowWorkbook"},V:function(n,t){var i,r,u,f;(u=this.bn(t,r={val:i}),i=r.val,u)&&(f=this,this.b(n,i,!1,!1,t.commandParameters.copyPasteTargetType).catch(function(){}))},bu:function(n,t){Diag.a.a(37364764,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",n,t);this.v.q()},bg:function(n,t,i,r,u,f){Diag.a.a(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",n?this.y(n):"null");var s=!1,h=!1,e=!1,o="Unknown",c="DragAndDropError_";return n&&(c+=_Ewa.cq.a(n),_Ewa.i.e(n.ewaErrors)?(o=this.N(n.ewaErrors),_Ewa.i.d(n.ewaErrors,_Ewa.cq.d)&&(s=!0),_Ewa.i.d(n.ewaErrors,_Ewa.cq.g)&&(h=e=!0)):n.message&&(o=n.message)),e||(e=this.bb(n)),h?this.v.a().p(-1):this.x.m(u),this.br(t,i,r,u,e,o,c,s,f),Promise.reject(n)},M:function(n,t){var r=n,i=this.bl();return i&&i.a&&(r=this.x.g(t,i.a,n)),r},bl:function(){var n=_Ewa.cE.a(this.w);return n&&_Ewa.iq.a(n.sourceItem)?n.sourceItem:null},bE:function(){this.er("cpiOSC",null,null)},bG:function(n,t){var i=n.commandParameters.originalDestinations,r;t&&(r=_Ewa.h.k(this.v.a().a().b(),i),r?(this.G(t,!1),Diag.a.a(24150919,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",_Ewa.j.r(t,";"))):n.commandParameters.isPasteCommandFromRecoveryUI?(this.G(t,!0),Diag.a.a(577279757,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",t,t[0].e())):Diag.a.a(24150920,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",_Ewa.j.r(i,";")))},bn:function(n,t){var i,r,u,f,c;if((t.val=!0,n.isPlainTextPaste||n.isHtmlPaste)||_Ewa.cE.d(n))return t.val=!1,!0;if(i=n.copyContextSnapshot,n.commandParameters.clearStateOnFinish)return!0;if(i&&_Ewa.iq.a(i.sourceItem)){if(r=i.sourceItem,!r.c(this.u))return!1;if(u=i.commandParameters.ribbonCommandInfo.a===-1985798686,f=r.a.length>1||n.commandParameters.expandDestinations.length>1,!f){var e=_Ewa.h.g(r.a),o=_Ewa.h.g(n.commandParameters.expandDestinations),s=this.u.b().u().b(),h=r.b,l=h===s&&o.g(e);if(l)return!1;if(c=h===s&&!!o.l(e),c)return t.val=!1,!0}return u}return!1},bC:function(n,t){if(!t.b&&!t.c){var i=this;this.b("OnWorkbookOpened",!1,!1,!1,0).catch(function(){})}},bv:function(n,t){var r=_Ewa.cE.a(this.w),i=this.x.a(r);i&&(t.a&&t.a.b()===i.b&&i.c(this.u)?this.x.d(i.a,r.commandParameters.commandType):this.x.b())},bw:function(n,t){var r=_Ewa.cE.a(this.w),i=this.x.a(r),u;i&&t.a&&t.a.b()===i.b&&i.c(this.u)&&(u=this,this.b("OnItemDeleting",!1,!1,!1,0).catch(function(){}))},bB:function(){var t=_Ewa.cE.a(this.w),n=this.x.a(t),i;n&&n.c(this.u)&&(i=this,this.b("OnStartEdit",!1,!1,!1,0).catch(function(){}))},bA:function(n,t){if(t.b===1&&t.a.a.b()&2){var i=this;this.b("OnQueueItemChanged/ItemRemoved",!1,!1,!1,0).catch(function(){})}},N:function(n){var t=_Ewa.i.U(n,"_");return this.R+Common.d.e(t).toString()},bb:function(n){var t=_Ewa.cq.a(n);return!(!t||!t.length)&&_Ewa.f.j(t,"MergedCellOverlap")},bj:function(){var t=Common.c.e()?315:Common.c.m()?316:317;var i=_Ewa.i.b(1,2,313,314,t,530046625,"ActivateLocalStorage"),n=_Ewa.l.a(_Ewa.cR,this.u.a(),5,4,0,null),r=this;_Ewa.g.a(n,function(){n.a().a(39,i,null,null)},this.ew(),3,null,null)},W:function(n){return isNullOrUndefined(n)?"NotCalled":n?"Success":"Failed"}};_Ewa.vz=function(n){_Ewa.vz.initializeBase(this);this.h=n;this.n=_Ewa.ClientStringManager.a();this.l()};_Ewa.vz.a=function(n){n.a().b(_Ewa.qM,373,new _Ewa.la(n));n.a().b(_Ewa.bkq.$$(_Ewa.dA),255,new _Ewa.vz(n))};_Ewa.vz.prototype={h:null,n:null,a:function(){var i=_Ewa.x.e([53,54],4,this.j,!1,!1,!0,255),t=_Ewa.l.b(_Ewa.eZ,this.h.a(),18,this.h.g(),this.j,null),n=this;_Ewa.g.a(_Ewa.g.b([t,i],this.i(),3),function(){var r=new _Ewa.tx,i=null;n.q(r).then(function(u){var f,e;i=u.b;f=copyPasteInfra.createCopyPasteInfra(i,new _Ewa.Hx(n.h),r,n.h);Diag.a.b(24970909,0,!!n.h.e(),"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Diag.a.b(24970910,0,!!n.h.e()&&!!n.h.e().DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");e=i.getMetadataManager();n.k(new _Ewa.cq(n.h,e,t.a(),f,new _Ewa.gC(n.h,_Ewa.c.a(n.h)),new _Ewa.Hy,n.h.e().DocumentHostInfo.UserId,i.getInitializationError(),null));u.a?Diag.a.a(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",_Ewa.cq.c(n.h),u.a.dataClipboardStrategyType,JSON.stringify(u.a.dataClipboardCapabilities),u.a.clipboardStrategiesToInitialize[0].clipboardStrategyType===u.a.dataClipboardStrategyType,isNullOrUndefined(window.bsqmXLSPageLoadStartTime)?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):Diag.a.b(41731932,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(t){Diag.a.b(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",_Ewa.cq.c(n.h),t?copyPasteInfra.getStringifiedError(t):"null")})},this.i(),3,null,null)},dispose:function(){_Ewa.sX.prototype.dispose.call(this)},q:function(n){var i=null,u=window.clipboardPlatform,o,s,a,v;if(u&&(i=u.getClipboardPlatformEnvironment()),!i)return Diag.a.b(24970911,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);var t=this.h.e(),h=[t.OfficeOnlineChromeExtensionId,t.ChromeClipboardAccessExtensionId],c=this.n.b(5),f=this.h.y().a(57),e=!f&&this.h.y().a(5),r=this.h.b().c(),l=!!r&&(r.a()||r.r()||r.e());return l&&(e=!1),o=!f,s=this.t(e,o),Diag.a.b(40380624,0,!!t.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null"),a=this,v=this,i.init(this.h,n,h,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardOverrideOrigin,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,c,t.MachineCluster,new _Ewa.Hw(this.h),s,t.DocumentHostInfo.UserId,t.ClipboardTtlInMS,_Ewa.a.b(320),t.UserSessionId).then(function(n){var t;return t=new _Ewa.vz.b,t.b=i,t.a=n,t},function(n){return Promise.reject(n)})},t:function(n,t){var i=[];return n&&t&&Array.add(i,this.s(6)),t&&(Array.add(i,this.m(7)),Array.add(i,this.m(0))),n&&Array.add(i,this.p(5)),Array.add(i,this.r(4)),Diag.a.a(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",n,t,i?i.join(","):"[]"),i},p:function(n){var i=this.h.e(),t={};return t.clipboardStrategyType=n,t.sessionId=i.UserSessionId,t.useSharedClipboardIframe=!0,t.sharedClipboardHostingApp=i.SharedClipboardHostingApp,t.sharedClipboardHostingApps=i.SharedClipboardHostingApps,t.sharedClipboardHostingEnvironments=i.SharedClipboardHostingEnvironments,t.sharedClipboardOverrideOrigin=i.SharedClipboardOverrideOrigin,t.sharedClipboardSchemaVersion=i.SharedClipboardSchemaVersion,t.sharedClipboardExpirationInMinutes=i.SharedClipboardExpirationInMinutes,t.wacCluster=i.MachineCluster,t},s:function(n){var t={};return t.clipboardStrategyType=n,t.localStorageStrategyParameters=this.p(5),t.systemClipboardStrategyParameters=this.m(0),t},m:function(n){var t={};return t.clipboardStrategyType=n,t.skipFilesIfPlainTextExists=!0,t},r:function(n){var t={};return t.clipboardStrategyType=n,t}};_Ewa.vz.b=function(){};_Ewa.vz.b.prototype={b:null,a:null};_Ewa.gC=function(n,t){this.q=_Ewa.a.c("Microsoft.Office.Excel.CrossSessionDiscontinuousCCPEnabled",!1);this.p=_Ewa.a.c("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.n=n;this.o=t};_Ewa.gC.d=function(n,t,i,r,u,f,e,o,s,h){var a=n.c().a().b(h),c=function(t,h,c){return n.O(),_Ewa.ow.b(n.c().a(),i,r,u,_Ewa.n.a(t,e),_Ewa.n.b(h,o),c,f,a,s)},l=function(){return new _Ewa.Sr(i,r,u)},v=_Ewa.a.d()?new _Ewa.v(506,0,c,65,l):new _Ewa.ba(506,0,c,1,l);n.f().a(v,t)};_Ewa.gC.a=function(n,t,i,r,u,f,e){var o,s;Diag.a.a(51668566,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",t.id);t.requestTelemetryData=n.RequestTelemetryData;t.serverRequestTimeInMs=t.commandParameters.stopwatch.b()-u;_Ewa.i.c(n.Errors)?_Ewa.i.h(n.Errors)?(t&&(t.encounteredDeploymentErrors=!0),Diag.a.a(36538329,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.i.a(n.Errors,","))):r(new _Ewa.cA(5,n.Errors,null,"",100)):n.Result?(o=!!n&&!!n.RequestTelemetryData,_Ewa.c.a(f).o().f(t.commandParameters.stopwatch.c(),n.StateId,o?n.RequestTelemetryData.EcsOperationDuration:0,o?n.RequestTelemetryData.EcsRequestDuration:0,o?n.RequestTelemetryData.WfeRequestDuration:0),s=n.Result,t.pastedRange=s.SheetMultiRange,Diag.a.a(51668568,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",t.id),i(!0)):(Diag.a.a(51668567,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",t.id),i(e?e:!0))};_Ewa.gC.e=function(n,t,i,r,u,f,e,o,s,h,c,l){var p=n.c().a().b(!1),a=_Ewa.gC.c(n,i,r,u,h,c,l),v=function(t,i,r){return n.O(),_Ewa.lg.b(n.c().a(),a,_Ewa.n.a(t,e),_Ewa.n.b(i,o),r,f,p,s)},y=function(){return new _Ewa.Sq(a)},w=_Ewa.a.d()?new _Ewa.v(503,0,v,65,y):new _Ewa.ba(503,0,v,1,y);n.f().a(w,t)};_Ewa.gC.c=function(n,t,i,r,u,f,e){var o={},h,s;if(o.ShadowWorkbookBase64=t.shadowWorkbookBase64,o.SourceRanges={},o.SourceRanges.Ranges=new Array(1),o.SourceRanges.Ranges[0]={},o.SourceRanges.Ranges[0].FirstRow=t.rangeRowStart,o.SourceRanges.Ranges[0].LastRow=t.rangeRowEnd,o.SourceRanges.Ranges[0].FirstColumn=t.rangeColumnStart,o.SourceRanges.Ranges[0].LastColumn=t.rangeColumnEnd,_Ewa.a.c("Microsoft.Office.Excel.CrossSessionDiscontinuousCCPEnabled",!1)?r?o.DestinationRanges=_Ewa.h.i(r.SheetName,r.NamedObjectName,_Ewa.h.t(r.Ranges)):(Diag.a.a(542722242,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),o.DestinationRanges=null):o.DestinationRanges=i?_Ewa.h.j(i):null,o.CopyPasteTargetType=1,o.PasteType=u,o.CopyOperationId=f,o.PasteId=e,o.SourceClientPath=t.sourceClientPath,o.SourceSheetName=t.sourceSheetName,o.SourceWorkbookName=t.sourceWorkbookName,!t.originalSourceRangesCountExceedsLimit&&t.originalSourceRanges&&t.originalSourceRanges.length>0&&u===1024){for(o.OriginalSourceMultiRange={},h=new Array(t.originalSourceRanges.length),s=0;s<h.length;++s)h[s]={},h[s].FirstRow=t.originalSourceRanges[s][0],h[s].FirstColumn=t.originalSourceRanges[s][1],h[s].LastRow=t.originalSourceRanges[s][2],h[s].LastColumn=t.originalSourceRanges[s][3];o.OriginalSourceMultiRange.Ranges=h}return o};_Ewa.gC.b=function(n,t,i){var r=i.f();return r.j()<t&&(r.c=Math.min(1048576,r.a+t-1)),r.m()<n&&(r.d=Math.min(16384,r.b+n-1)),r};_Ewa.gC.prototype={n:null,o:null,t:function(){return Diag.a.a(51505284,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.n.e().MaxCopyPasteLength),this.n.e().MaxCopyPasteLength},r:function(){return this.p?_Ewa.a.g("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.n.e().CopyPasteMaxPayloadLength):4194304},h:function(n,t,i,r,u){var e=this.n.c().a().b(!1),f=this,o=function(o,s,h){var c={};return c.CopyPasteTargetType=1,c.SourceRanges=n,c.CopyOperationId=t.id,Diag.a.a(545400160,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",f.p,c.CopyOperationId),f.p?_Ewa.lg.a(f.n.c().i(),c,_Ewa.n.a(o,i),r?_Ewa.n.b(s,r):s,h,t.ribbonCommandInfo,e,u):_Ewa.lg.a(f.n.c().a(),c,_Ewa.n.a(o,i),r?_Ewa.n.b(s,r):s,h,t.ribbonCommandInfo,e,u)};_Ewa.a.d()?this.n.f().a(new _Ewa.v(505,0,o,80,null),t.ribbonCommandInfo):this.n.f().a(new _Ewa.ba(505,0,o,16,null),t.ribbonCommandInfo)},e:function(n,t,i,r,u,f){var e=this;return new Promise(function(o,s){var l=f.commandParameters.stopwatch.b(),a=function(n){_Ewa.gC.a(n,f,o,s,l,e.n,null)},v=function(n){f.serverRequestTimeInMs=f.commandParameters.stopwatch.b()-l;var t=_Ewa.X.a(n.b);s(new _Ewa.cA(5,t,null,"",100))},h=2,c;f.commandParameters.commandType===20&&(h=16);f.commandParameters.commandType===36&&(h=32);_Ewa.s.r(e.n)&&f.commandParameters.commandType===68&&(h=64);_Ewa.s.x(e.n)&&f.commandParameters.commandType===1028&&(h=1024);c=null;f.copyContextSnapshot&&f.copyContextSnapshot.commandParameters&&(c=f.copyContextSnapshot.commandParameters.id);_Ewa.gC.e(e.n,n,r,t,i,null,a,v,u,h,c,f.commandParameters.id)})},c:function(n,t,i,r,u,f,e,o){var s=this;return new Promise(function(h,c){var l=e.commandParameters.stopwatch.b(),a=function(n){_Ewa.gC.a(n,e,h,c,l,s.n,null)},v=function(n){e.serverRequestTimeInMs=e.commandParameters.stopwatch.b()-l;var t=_Ewa.X.a(n.b);c(new _Ewa.cA(5,t,null,"",100))},y=r,p=-5&u,w=y|p;_Ewa.gC.d(s.n,n,t,i,w,null,a,v,f,o)})},k:function(n,t,i,r,u,f,e){var o=this;return new Promise(function(s,h){var c,l,a,v;!t||!t.length?s(""):t.length>o.r()?(c=e.clipboardItems.getItem("text/plain"),l=-1,isNullOrUndefined(c)||(l=c.length),Diag.a.a(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",t.length,o.r(),l),h(new _Ewa.cA(1,null,null,"",100))):(a=function(u,c,l){o.n.O();var v=e.commandParameters.stopwatch.b(),y=_Ewa.n.a(u,function(n){_Ewa.gC.a(n,e,s,h,v,o.n,t)}),p=_Ewa.n.b(c,function(n){e.serverRequestTimeInMs=e.commandParameters.stopwatch.b()-v;var t=_Ewa.X.a(n.b);h(new _Ewa.cA(3,t,null,"",100))}),w=o.n.c().a().b(!1),b=_Ewa.h.a(n,o.n),a={};return a.SourceHtml=t,a.DestinationRanges=b?_Ewa.h.j(b):null,a.CopyOperationId=i,a.PasteId=r,Diag.a.a(545400159,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",o.p,a.PasteId),o.p?_Ewa.ow.a(o.n.c().i(),a,y,p,l,null,w,f):_Ewa.ow.a(o.n.c().a(),a,y,p,l,null,w,f)},v=_Ewa.a.d()?new _Ewa.v(204,0,a,65,null):new _Ewa.ba(204,0,a,1,null),o.n.f().a(v,u))})},l:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var v,h,c,l,a,s,y,p,w,b;Diag.a.a(51505037,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",u.id);!t||!t.length||(t=_Ewa.f.H(t,"\n","\r"));Diag.a.a(51505038,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",u.id);!t||!t.length?e(""):(v=f.t(),t.length>v?(Diag.a.a(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,v),o(new _Ewa.cA(1,null,null,"",100))):(a=_Ewa.h.a(n,f.n),Diag.a.a(51505039,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",u.id),s=!f.n.b().b()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1,Diag.a.a(51505040,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",u.id,s),s=s&&_Ewa.f.C(t),Diag.a.a(51505041,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",u.id,s),y=f.n.c().a().b(!1),s?(l=526,Diag.a.a(51505042,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",u.id),p=_Ewa.bj.e(t,!0),Diag.a.a(51505043,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",u.id),w=_Ewa.h.j(a),h=function(i,s,h){var c=u.commandParameters.stopwatch.b(),l=_Ewa.n.a(i,function(n){Diag.a.a(51668560,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",u.id);u.requestTelemetryData=n.RequestTelemetryData;u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c;n.Errors&&n.Errors.length>0?o(new _Ewa.cA(2,n.Errors,null,"",100)):e(t)}),a=_Ewa.n.b(s,function(n){u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-c;var t=_Ewa.X.a(n.b);o(new _Ewa.cA(2,t,null,"",100))});return f.n.O(),Diag.a.a(51668561,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",u.id),_Ewa.k.f(f.n.c().a(),w,t,p,!1,!1,63,l,a,h,n,y,r)},c=function(){return new _Ewa.rZ(w,t,p)}):(l=180,h=function(n,i,s){f.n.O();var h=u.commandParameters.stopwatch.b(),c=_Ewa.n.a(n,function(n){Diag.a.a(51668562,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",u.id);_Ewa.gC.a(n,u,e,o,h,f.n,t)}),l=_Ewa.n.b(i,function(n){u.serverRequestTimeInMs=u.commandParameters.stopwatch.b()-h;var t=_Ewa.X.a(n.b);o(new _Ewa.cA(4,t,null,"",100))});return Diag.a.a(51668563,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",u.id),_Ewa.ow.c(f.n.c().a(),a,t,c,l,s,null,y,r)},c=function(){return new _Ewa.Ss(a,t)}),Diag.a.a(51668564,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",u.id),b=_Ewa.a.d()?new _Ewa.v(l,0,h,65,c):new _Ewa.ba(l,0,h,1,c),Diag.a.a(51668565,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",u.id),f.n.f().a(b,i)))})},d:function(n,t){var i=[t===1?4:5];this.o.j().c(_Ewa.bP.a(_Ewa.D.a(this.n.h()),n),i,!0,null,!0);this.o.j().d(i,null,null);this.o.j().f(!0,!0)},b:function(){var n=[4,5];this.o.j().a(n);this.o.j().b(null,n,!0);this.o.a().c()===1&&this.o.dX(!1)},g:function(n,t,i){for(var e,u=[],f=i,o=f.length,r=0;r<o;++r)e=f[r],Array.add(u,this.s(n,t,e));return u},s:function(n,t,i){var f,v;Diag.a.b(595185887,0,!!t,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Diag.a.b(595185886,0,t.length>0,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");for(var r=0,u=0,s=new($$sc.n.$$(String))($$sc.d.b()),h=new($$sc.n.$$(String))($$sc.d.b()),c=t,y=c.length,o=0;o<y;++o){var e=c[o],l=String.format("{0}_{1}",e.b,e.d),a=String.format("{0}_{1}",e.a,e.c);h.b(l)||(h.a(l),u+=e.m());s.b(a)||(s.a(a),r+=e.j())}if(36===n)return i.o()?_Ewa.gC.b(u,r,i):i.f();n===516&&(v=r,r=u,u=v);var p=!(i.m()%u)&&!(i.j()%r),w=i.I()&&!(i.m()%u),b=i.F()&&!(i.j()%r);return w||b?f=_Ewa.gC.b(u,r,i):p?f=i.f():(f=i.f(),f.c=Math.min(1048576,f.a+r-1),f.d=Math.min(16384,f.b+u-1)),f},f:function(n,t,i,r,u,f,e,o,s,h,c,l){var a,g,y,w,b;if(!r||!r.length)return 1;if(r.length>1){if(!this.q&&f)return 3;if(c)return 0;if(s)return 9;if(h)return 8;if(l)return 2;if(t.length>1)return 4;if(a=t[0],g=this,!o&&!Common.x.b(r,function(n){return n.o()||!(n.m()%a.m())&&!(n.j()%a.j())}))return 5;if((!this.q||!f)&&_Ewa.f.b(n,i,!0))for(var k=u,nt=k.length,v=0;v<nt;++v)if(y=k[v],y.h(a)&&!y.g(a))return 6}else if(t&&t.length>0){if(this.i(t,h))return 7;if(t.length>1){if(!this.q&&f)return 3;if((!this.q||!f)&&_Ewa.f.b(n,i,!0))for(var d=t,tt=d.length,p=0;p<tt;++p)if(w=d[p],b=u[0],w.h(b)&&!w.g(b))return 6}}return 0},i:function(n,t){var u,i,f;if(!n||n.length<=1)return 0;if(t)return 2;if(!_Ewa.h.I(n))return 1;u=new($$sc.n.$$(String))($$sc.d.a());for(var h=n,a=h.length,e=0;e<a;++e){i=h[e];for(var c=n,v=c.length,o=0;o<v;++o){var r=c[o],y=i.a===r.a&&i.c===r.c,p=i.b===r.b&&i.d===r.d,w=Math.max(i.a,r.a)<Math.min(i.c,r.c),b=Math.max(i.b,r.b)<Math.min(i.d,r.d);if(w&&!y||b&&!p)return 3;u.a(String.format("{0}-{1}-{2}-{3}",i.a,i.c,r.b,r.d));u.a(String.format("{0}-{1}-{2}-{3}",r.a,r.c,i.b,i.d))}}for(var l=n,k=l.length,s=0;s<k;++s)f=l[s],u.g(String.format("{0}-{1}-{2}-{3}",f.a,f.c,f.b,f.d));return u.c>0?3:0},m:function(n){var t=this.o.a();t.d(n,n.e(),0,0,!0,"",!1,!0,!0);t.p(-1)},a:function(n){if(n&&n.sourceItem){if(!_Ewa.iq.a(n.sourceItem))return null;var t=n.sourceItem;if(t&&_Ewa.h.x(t.a,!0))return t}return null},j:function(n,t){return(Diag.a.b(33863620,0,!!n,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null"),t&&"SourceControlId"in t)?!1:n.d?!1:n.c===1}};_Ewa.vA=function(n){this.a=new _Ewa.y(!0);this.b=n};_Ewa.vA.prototype={b:null,d:function(n){if(this.a.d(n.id)||this.a.b(n.id,!0),this.a.a.length>0){var t=_Ewa.l.a(_Ewa.cR,this.b.a(),5,4,0,null),i=this;_Ewa.g.a(t,function(){t.a().a(28,null,null,null)},this.b.g(),3,null,null)}},c:function(n){var i=this.a.a.length>0,t,r;this.a.d(n.id)&&this.a.e(n.id);i&&!this.a.a.length&&(t=_Ewa.l.a(_Ewa.cR,this.b.a(),5,4,0,null),r=this,_Ewa.g.a(t,function(){t.a().b(28)},this.b.g(),3,null,null))}};_Ewa.Hw=function(n){this.l={"SourceItemType.Range":0,"SourceItemType.Art":1};this.d={};this.h={"FloatingObjectType.Unknown":99,"FloatingObjectType.CardView":6,"FloatingObjectType.Chart":0,"FloatingObjectType.Group":7,"FloatingObjectType.Image":1,"FloatingObjectType.Ink":8,"FloatingObjectType.InteractiveReport":4,"FloatingObjectType.ModernOfficeExtension":3,"FloatingObjectType.Shape":5,"FloatingObjectType.Slicer":2,"FloatingObjectType.Unsupported":100};this.e={"99":"FloatingObjectType.Unknown","6":"FloatingObjectType.CardView","0":"FloatingObjectType.Chart","7":"FloatingObjectType.Group","1":"FloatingObjectType.Image","8":"FloatingObjectType.Ink","4":"FloatingObjectType.InteractiveReport","3":"FloatingObjectType.ModernOfficeExtension","5":"FloatingObjectType.Shape","2":"FloatingObjectType.Slicer","100":"FloatingObjectType.Unsupported"};this.k={"RibbonCommand.Copy":-911352779,"RibbonCommand.Cut":-1985798686};this.f={"-911352779":"RibbonCommand.Copy","-1985798686":"RibbonCommand.Cut"};this.j={"InputManager.InputMethod.NotDefined":-1,"InputManager.InputMethod.Unknown":0,"InputManager.InputMethod.Keyboard":1,"InputManager.InputMethod.Mouse":2,"InputManager.InputMethod.Touch":3,"InputManager.InputMethod.CrossSlide":9};this.b={};this.i={"FrameMode.None":0,"FrameMode.Reading":1,"FrameMode.Edit":2};this.c={};this.m={"UILocation.Unknown":0,"UILocation.UpperRibbon":1,"UILocation.Ribbon":2,"UILocation.QAT":3,"UILocation.Jewel":4,"UILocation.NavigationPane":5,"UILocation.KeyboardShortcut":6,"UILocation.StatusBar":7,"UILocation.Dialog":8,"UILocation.Floatie":9,"UILocation.NotificationBar":10,"UILocation.StandaloneCuiRoot":11,"UILocation.TaskPane":12,"UILocation.HeroDock":13,"UILocation.SingleLineRibbon":14,"UILocation.MultilineRibbon":15,"UILocation.Overflow":16,"UILocation.TellMe":17,"UILocation.FarPeripheralControls":18,"UILocation.ContextMenu":19,"UILocation.DialogMenu":20,"UILocation.Header":21,"UILocation.FileMenu":22,"UILocation.Toolbar":26,"UILocation.Canvas":30};this.a={};this.g=n;this.b[Common.m.a.toString(-1)]="InputManager.InputMethod.NotDefined";this.b[Common.m.a.toString(0)]="InputManager.InputMethod.Unknown";this.b[Common.m.a.toString(1)]="InputManager.InputMethod.Keyboard";this.b[Common.m.a.toString(2)]="InputManager.InputMethod.Mouse";this.b[Common.m.a.toString(3)]="InputManager.InputMethod.Touch";this.b[Common.m.a.toString(9)]="InputManager.InputMethod.CrossSlide";this.c[Common.bC.toString(0)]="FrameMode.None";this.c[Common.bC.toString(1)]="FrameMode.Reading";this.c[Common.bC.toString(2)]="FrameMode.Edit";this.a[Common.n.toString(0)]="UILocation.Unknown";this.a[Common.n.toString(1)]="UILocation.UpperRibbon";this.a[Common.n.toString(2)]="UILocation.Ribbon";this.a[Common.n.toString(3)]="UILocation.QAT";this.a[Common.n.toString(4)]="UILocation.Jewel";this.a[Common.n.toString(5)]="UILocation.NavigationPane";this.a[Common.n.toString(6)]="UILocation.KeyboardShortcut";this.a[Common.n.toString(7)]="UILocation.StatusBar";this.a[Common.n.toString(8)]="UILocation.Dialog";this.a[Common.n.toString(9)]="UILocation.Floatie";this.a[Common.n.toString(10)]="UILocation.NotificationBar";this.a[Common.n.toString(11)]="UILocation.StandaloneCuiRoot";this.a[Common.n.toString(12)]="UILocation.TaskPane";this.a[Common.n.toString(13)]="UILocation.HeroDock";this.a[Common.n.toString(14)]="UILocation.SingleLineRibbon";this.a[Common.n.toString(15)]="UILocation.MultilineRibbon";this.a[Common.n.toString(16)]="UILocation.Overflow";this.a[Common.n.toString(17)]="UILocation.TellMe";this.a[Common.n.toString(18)]="UILocation.FarPeripheralControls";this.a[Common.n.toString(21)]="UILocation.Header";this.a[Common.n.toString(22)]="UILocation.FileMenu";this.a[Common.n.toString(19)]="UILocation.ContextMenu";this.a[Common.n.toString(20)]="UILocation.DialogMenu";this.a[Common.n.toString(26)]="UILocation.Toolbar";this.a[Common.n.toString(30)]="UILocation.Canvas";this.d[_Ewa.hg.toString(0)]="SourceItemType.Range";this.d[_Ewa.hg.toString(1)]="SourceItemType.Art"};_Ewa.Hw.prototype={g:null,serializeSourceItem:function(n){var t={},i,u,f,e,o,r;if(n&&Object.getType(n)===_Ewa.nF)i=n,t.sheetName=i.b,u=this,t.topArray=Common.x.d(i.a,function(n){return n.a}),f=this,t.leftArray=Common.x.d(i.a,function(n){return n.b}),e=this,t.bottomArray=Common.x.d(i.a,function(n){return n.c}),o=this,t.rightArray=Common.x.d(i.a,function(n){return n.d}),t.sessionStateId=i.e,t.sessionId=i.d,t.sourceItemType=this.n(0);else if(n&&Object.getType(n)===_Ewa.jF)r=n,t.activeFloatingObjectControlId=r.a,t.sheetName=r.f,t.sessionStateId=r.e,t.sessionId=r.d,t.floatingObjectType=this.w(r.b),t.sourceItemType=this.n(1);else return Diag.a.b(25217025,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(t)},serializeCommandParameters:function(n){if(!n)return Diag.a.b(25217024,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var t={};return t.id=n.id,t.commandType=n.commandType,t.copyPasteTargetType=n.copyPasteTargetType,n.ribbonCommandInfo&&(t.ribbonCommandName=this.z(n.ribbonCommandInfo.a),t.inputMethodName=this.y(n.ribbonCommandInfo.c),t.frameModeName=this.x(n.ribbonCommandInfo.e),t.uiLocationName=this.A(n.ribbonCommandInfo.b),t.tabName=n.ribbonCommandInfo.d),JSON.stringify(t)},deserializeSourceItem:function(n){var t,i;if(!n||!n.length)return null;try{if(t=JSON.parse(n),!t)return Diag.a.b(38847437,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;i=null;switch(this.u(t.sourceItemType)){case 0:i=new _Ewa.nF(this.g,this.r(t),t.sheetName,t.sessionStateId,t.sessionId);break;case 1:i=new _Ewa.jF(t.activeFloatingObjectControlId,t.sheetName,t.sessionStateId,t.sessionId,this.o(t.floatingObjectType))}return i}catch(r){return Diag.a.a(38847438,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},deserializeCommandParameters:function(n){var t,i;if(!n||!n.length)return null;try{return(t=JSON.parse(n),!t)?(Diag.a.b(38847439,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null):(i=_Ewa.hs.c(),i.id=t.id,i.ribbonCommandInfo=this.t(t),i.commandType=t.commandType,i.copyPasteTargetType=t.copyPasteTargetType,i)}catch(r){return Diag.a.a(38847440,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},r:function(n){var i=[],r,t;if(Diag.a.b(595185885,0,!!n.topArray&&n.topArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",n.topArray?"empty":"null"),Diag.a.b(595185884,0,!!n.leftArray&&n.leftArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",n.leftArray?"empty":"null"),Diag.a.b(595185883,0,!!n.bottomArray&&n.bottomArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",n.bottomArray?"empty":"null"),Diag.a.b(595185882,0,!!n.rightArray&&n.rightArray.length>0,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",n.rightArray?"empty":"null"),!n.topArray||!n.leftArray||!n.bottomArray||!n.rightArray)return i;for(Diag.a.b(595185881,0,n.topArray.length===n.bottomArray.length&&n.topArray.length===n.leftArray.length&&n.topArray.length===n.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",n.topArray.length,n.bottomArray.length,n.leftArray.length,n.rightArray.length),r=Math.min(n.topArray.length,n.bottomArray.length,n.leftArray.length,n.rightArray.length),t=0;t<r;t++)Array.add(i,new _Ewa.p(n.topArray[t],n.leftArray[t],n.bottomArray[t],n.rightArray[t],!1,!1));return i},t:function(n){return new _Ewa.L(this.s(n.ribbonCommandName),this.q(n.inputMethodName),this.p(n.frameModeName),this.v(n.uiLocationName),n.tabName)},z:function(n){return isNullOrUndefined(n)||!(n.toString()in this.f)?(Diag.a.b(25217028,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),this.f["-911352779"]):this.f[n.toString()]},s:function(n){return!n||!n.length||!(n in this.k)?(Diag.a.b(25217029,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),-911352779):this.k[n]},y:function(n){return isNullOrUndefined(n)||!(Common.m.a.toString(n)in this.b)?(Diag.a.b(25217030,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",n),this.b[Common.m.a.toString(0)]):this.b[Common.m.a.toString(n)]},q:function(n){return!n||!n.length||!(n in this.j)?(Diag.a.b(25217031,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",n),0):this.j[n]},x:function(n){return isNullOrUndefined(n)||!(Common.bC.toString(n)in this.c)?(Diag.a.b(25217032,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",n),this.c[Common.bC.toString(2)]):this.c[Common.bC.toString(n)]},p:function(n){return!n||!n.length||!(n in this.i)?(Diag.a.b(25217033,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",n),2):this.i[n]},n:function(n){return isNullOrUndefined(n)||!(_Ewa.hg.toString(n)in this.d)?(Diag.a.b(25217034,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",n),this.d[_Ewa.hg.toString(0)]):this.d[_Ewa.hg.toString(n)]},u:function(n){return!n||!n.length||!(n in this.l)?(Diag.a.b(25217035,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",n),0):this.l[n]},w:function(n){return isNullOrUndefined(n)||!(n.toString()in this.e)?(Diag.a.b(36229127,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",n),this.e["99"]):this.e[n.toString()]},o:function(n){return!n||!n.length||!(n in this.h)?(Diag.a.b(36229128,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",n),99):this.h[n]},A:function(n){return isNullOrUndefined(n)||!(Common.n.toString(n)in this.a)?(Diag.a.b(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",n),this.a[Common.n.toString(2)]):this.a[Common.n.toString(n)]},v:function(n){return!n||!n.length||!(n in this.m)?(Diag.a.b(36229130,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",n),2):this.m[n]}};_Ewa.Hx=function(n){this.a=n};_Ewa.Hx.prototype={a:null,c:null,b:null,e:function(){var n,t;return this.c||(n=this.a.a().a(_Ewa.dA,254,!0,null),n&&(t=n,this.c=new _Ewa.Hr(this.a,t,new _Ewa.vx,null))),this.c},d:function(){var t,n;return this.b||(t=this.a.a().a(_Ewa.dA,254,!0,null),t&&(n=new _Ewa.Hs(this.a),this.b=new _Ewa.vw(this.a,new _Ewa.vx,new _Ewa.ov(this.a,n),n,null))),this.b},getCopyFlowHandler:function(n){var t=this.g(_Ewa.c.a(this.a).bH());return n.commandParameters.copyPasteHandlerName=t.a(),t},getPasteFlowHandler:function(n){var t=n.copyContextSnapshot,i=null;return i=_Ewa.cE.d(n)?this.d():_Ewa.cE.b(n)?this.e():t&&t.sourceItem&&Object.getType(t.sourceItem)===_Ewa.jF?this.d():this.e(),n.commandParameters.copyPasteHandlerName=i.b(),i},initializePasteContext:function(n){var r,e,o;if(n&&(n.isSameSession=!1,n.isShadowWorkbookParsedSuccessfully=!1,n.pasteResult="Undefined",n.payloadOrigin="Undefined",n.payloadType="Undefined",n.encounteredDeploymentErrors=!1,n.shadowWorkbookSizeExceedsLimit=!1,n.originalSourceRangesCountExceedsLimit=!1,n.activeSelectionType=this.f(),n.indicationDisplayScheduled=!1,n.pasteIndicationDisplayStatus="DisplayNotInvoked",n.copyContextSnapshot)){var t=n.copyContextSnapshot,u=_Ewa.iq.a(t.sourceItem),s=_Ewa.iq.b(t.sourceItem),i=0,f=!1;u?(r=t.sourceItem,n.isSameSession=r.c(this.a),i=1,f=this.h(r,n)):s&&(e=t.sourceItem,n.isSameSession=e.c(this.a),i=2);n.copyContextSnapshot.commandParameters&&(o=t.commandParameters.ribbonCommandInfo.a===-1985798686,n.commandParameters.clearSystemClipboard=_Ewa.nc.b(t,this.a)&&o&&u&&!f,n.commandParameters.copyPasteTargetType=i)}},getSessionId:function(){return this.a.e().UserSessionId},h:function(n,t){var u=this,f=this,i=_Ewa.bs.b(n.a,function(n){return n.p()})&&_Ewa.bs.b(t.commandParameters.originalDestinations,function(n){return n.a!==1}),e=this,o=this,r=_Ewa.bs.b(n.a,function(n){return n.k()})&&_Ewa.bs.b(t.commandParameters.originalDestinations,function(n){return n.b!==1});return r||i},g:function(n){switch(n){case 1:return this.e();case 64:case 4:case 2:case 256:return this.d();default:throw Error.invalidOperation("Unsupported selection");}},f:function(){return _Ewa.c.a(this.a).a().c()&470?"FloatingObject":_Ewa.c.a(this.a).a().c()===1?"Cells":"Unknown"}};_Ewa.qL=function(n,t){this.A=Function.createDelegate(this,this.bA);_Ewa.qL.initializeBase(this,[n,null,!1,!1,!1]);this.bp(t)};_Ewa.qL.prototype={b:null,f:function(){return"InsertCopiedCutCellsDialog"},bp:function(n){this.b=new($$sc.D.$$(_Ewa.qt));var t=_Ewa.ClientStringManager.a().a(16),i=this.bg(n);this.G(t,this.A,i)},bg:function(n){return{id:this.f(),isRtl:n}},bA:function(n,t){if(n===1){var r=t.direction,i=_Ewa.qL.a[r];Diag.a.a(545124621,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",i?"Vertical":"Horizontal");this.b.a(i)}else Diag.a.a(545124620,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.b.e()}};_Ewa.Hy=function(){};_Ewa.Hy.prototype={a:function(n,t){var i=new _Ewa.qL(n,t);return i.b.b}};_Ewa.Ht=function(n){this.b=Function.createDelegate(this,this.A);_Ewa.Ht.initializeBase(this,[n,null,!1,!1,!1]);Diag.a.a(539760657,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.D(0);this.E(1,_Ewa.ClientStringManager.a().a(2126));var t=_Ewa.ClientStringManager.a().a(2124),i=this.bg();this.G(t,this.b,i)};_Ewa.Ht.prototype={f:function(){return"ClipboardReadPermissionAskDialog"},bg:function(){var n={},t;return n.id=this.f(),t=_Ewa.ClientStringManager.a().a(2125),n.DialogMessage=t,n},A:function(){Diag.a.a(539760656,0,50,"ClipboardReadPermissionAskDialog OK button pressed")}};_Ewa.la=function(n){this.j=Function.createDelegate(this,this.i);this.d=_Ewa.c.a(n);this.d.a().f(this.j)};_Ewa.la.prototype={d:null,h:"",e:null,g:null,f:!1,b:function(n){if(!this.f){Diag.a.a(592528332,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome");var t=this;this.d.c().V(function(i){i.a(n).then(function(){t.f=!0})})}},c:function(n){var t=n.commandParameters.id,i,r;Diag.a.a(593781649,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",t,!this.e,this.f);this.b(0);this.h=t;i=!this.l();(!this.e||i)&&(this.k(),r=this,this.e=_Ewa.B.a().a(function(){r.n(n)},100,_Ewa.o.ca,!0,!1));this.g=n.commandParameters.originalDestinations},n:function(n){this.f?(this.m(n.commandParameters.originalDestinations),n.pasteIndicationDisplayStatus="Displayed"):(Diag.a.a(592528331,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.i(null,null),n.pasteIndicationDisplayStatus="PrerequisitesNotReady")},m:function(n){Diag.a.a(593781648,0,50,"PasteIndicationManager.Display: started");this.d.j().c(_Ewa.bP.a(_Ewa.D.a(this.d.c().h()),n),_Ewa.la.a,!0,null,!0);this.d.j().d(_Ewa.la.a,null,null)},a:function(n){Diag.a.a(593781647,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",n,this.h);n&&_Ewa.f.b(n,this.h,!1)&&this.i(null,null)},i:function(n){var t=!!this.g,i=!!n;t&&i&&this.l()&&Diag.a.a(575010144,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.h="";this.k();this.g=null;this.d.j().a(_Ewa.la.a);this.d.j().b(null,_Ewa.la.a,!0)},l:function(){return _Ewa.h.k(this.d.a().a().b(),this.g)},k:function(){this.e&&(System.a.a(this.e),this.e=null)},dispose:function(){this.i(null,null);this.d.a().g(this.j)}};_Ewa.qN=function(n,t,i,r){this.h=n;this.n=t;this.j=i;this.k=r;this.m=this.n;this.l="PasteRecoveryUI"};_Ewa.qN.prototype={h:null,n:null,j:null,k:null,c:function(){return this.k},l:null,d:function(){return this.l},m:null,e:function(){return this.m},f:function(){return _Ewa.qN.a},g:function(){return!this.j||this.j.length!==1?null:this.o(this.j[0])},b:function(){return"PasteRecoveryUI"},a:function(){return 17},o:function(n){var h=_Ewa.c.a(this.h),u=h.g().e(n),r=h.y(n,u,!1,!1),i=h.d(),f,t,l,a,v,y;if(!r||(f=_Ewa.c.a(this.h).n(u),t=f.v(),!t.i(r)))return null;r=t.h(r);var c=r.a.b,e=r.b.b,s=i?r.b.a:r.a.a,o=i?r.a.a:r.b.a,p=new _Ewa.T(o+(i?-81:81),e+38+6);return t.j(p)?this.i(f,t,u,o,e,i?12:-3,66):(l=new _Ewa.T(o+(i?-81:81),e),t.j(l))?this.i(f,t,u,o,e,i?20:3,22):(a=new _Ewa.T(o,e+38+6),t.j(a))?this.i(f,t,u,o,e,-81+(i?18:0),66):(v=new _Ewa.T(s+(i?81:-81),e),t.j(v))?this.i(f,t,u,s,e,-81+(i?12:-6),22):(y=new _Ewa.T(s,c-44),t.j(y))?this.i(f,t,u,s,c,i?15:0,16):this.i(f,t,u,i?t.a.a:t.b.a,t.b.b,-81+(i?15:-6),22)},i:function(n,t,i,r,u,f,e){var h=_Ewa.c.a(this.h),c=h.d(),l=Sys.UI.DomElement.getLocation(n.l()),o=new Sys.UI.Point(r+(c?0:l.x)-t.a.a,u+l.y-t.a.b),s;return c&&(s=h.i().a(),o.x=s.b.a-s.a.a-o.x,(i===2||i===4)&&(o.x+=t.b.a)),o=_Ewa.u.a(this.h).f(o),new Sys.UI.Point(o.x+f,o.y+e)}};_Ewa.cE=function(){};_Ewa.cE.b=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external");if(!(!t||!t.length)&&t==="1")return!0}return!1};_Ewa.cE.d=function(n){return _Ewa.cE.b(n)&&!isNullOrUndefined(n.clipboardItems)&&!!n.clipboardItems.getItem("image/png")&&_Ewa.f.a(n.clipboardItems.getItem("text/plain"))};_Ewa.cE.c=function(n){if(n.clipboardItems){var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external-XLO-source");if(!(!t||!t.length)&&t==="1")return!0}return!1};_Ewa.cE.e=function(n){return n.clipboardItems?n.clipboardItems.getItem("metadata/chrome-extension-id"):null};_Ewa.cE.a=function(n){if(n){var t=n.getCachedMetadata();if(t&&t.lastCopy)return t.lastCopy}return null};_Ewa.lg=function(){};_Ewa.lg.a=function(n,t,i,r,u,f,e,o){var s=n.a(1,e);return s.copyParameters=t,_Ewa.k.a(n,"Copy",s,i,r,u,f,0,o,null)};_Ewa.lg.c=function(n,t,i,r,u,f,e,o){var s=n.a(1,e);return s.copyParameters=t,_Ewa.k.a(n,"Cut",s,i,r,u,f,0,o,null)};_Ewa.lg.b=function(n,t,i,r,u,f,e,o){var s=n.a(1,e);return s.pasteParameters=t,_Ewa.k.a(n,"Paste",s,i,r,u,f,64,o,null)};_Ewa.NI=function(){};_Ewa.NI.a=function(n,t,i,r,u,f,e){var o=n.a(41,e);return o.insertCopiedCutCellsParameters=t,_Ewa.k.a(n,"InsertCopiedCutCells",o,i,r,u,f,4,null,null)};_Ewa.Sr.registerClass("_Ewa.Sr");_Ewa.Ss.registerClass("_Ewa.Ss");_Ewa.SG.registerClass("_Ewa.SG");_Ewa.beI.registerClass("_Ewa.beI");_Ewa.beJ.registerClass("_Ewa.beJ",_Ewa.beI);_Ewa.Hr.registerClass("_Ewa.Hr",_Ewa.beJ);_Ewa.vw.registerClass("_Ewa.vw",_Ewa.beI);_Ewa.cq.registerClass("_Ewa.cq",_Ewa.bW,_Ewa.dA,_Ewa.biO,Sys.IDisposable);_Ewa.vz.registerClass("_Ewa.vz",_Ewa.sX.$$(_Ewa.dA));_Ewa.qL.registerClass("_Ewa.qL",_Ewa.bfR);_Ewa.Ht.registerClass("_Ewa.Ht",_Ewa.bfR);_Ewa.cq.i=[1352631530,1679665408];_Ewa.cq.d=[-103190598];_Ewa.cq.h=[1306609195];_Ewa.cq.f=[-386183710];_Ewa.cq.g=[563945982];_Ewa.cq.b=null;_Ewa.qL.a={Vertical:1,Horizontal:0};_Ewa.la.a=[30];_Ewa.qN.a=["PasteRecoveryUI"];Type.registerNamespace("_Ewa");_Ewa.beK=function(){};_Ewa.beK.a=function(){_Ewa.m.a(function(n){_Ewa.vz.a(n)})};_Ewa.beK.a();Type.registerNamespace("_Ewa");_Ewa.nx=function(){_Ewa.nx.initializeBase(this,[!1]);this.a=new($$sc.v.$$(_Ewa.nx.a))};_Ewa.nx.prototype={a:null,b:null,d:function(n){this.es("SSC",n)},f:function(n){this.eu("SSC",n)},h:function(n,t){var i=new _Ewa.nx.a(n,t),u,r;this.a.b(i);u=this;r=function(n,t){i.a=t.a;u.c()};n.a(r);i.c=r;this.c()},i:function(n){for(var i=null,r=this.a.$$lge(),t;r.$$mn();)if(t=r.$$cu(),t.b===n){this.g(t);i=t;break}i&&(this.a.e(i),this.c())},dispose:function(){for(var n=this.a.$$lge(),t;n.$$mn();)t=n.$$cu(),this.g(t);this.a.h();_Ewa.bW.prototype.dispose.call(this)},e:function(){for(var n=!0,t=this.a.$$lge(),i;t.$$mn();)if(i=t.$$cu(),n=n&&i.a,!n)break;return n},g:function(n){n.b.b(n.c)},c:function(){var n=this.e();n!==this.b&&(this.er("SSC",new _Ewa.zF(n),null),this.b=n)}};_Ewa.nx.a=function(n,t){this.b=n;this.a=t};_Ewa.nx.a.prototype={b:null,a:!1,c:null};_Ewa.zD=function(n){_Ewa.zD.initializeBase(this);this.h=n;this.l()};_Ewa.zD.a=function(n){Diag.a.a(577572894,0,50,"MergeSuspensionFactory.Attach");n.a().b(_Ewa.bkq.$$(_Ewa.jm),344,new _Ewa.zD(n))};_Ewa.zD.prototype={h:null,a:function(){Diag.a.a(577572893,0,50,"MergeSuspensionFactory.Create");this.k(this.h.a().a(_Ewa.jm,343,!1,null)||this.h.a().b(_Ewa.jm,343,new _Ewa.MergeSuspensionManager(this.h,_Ewa.B.a(),null)))}};_Ewa.MergeSuspensionManager=function(n,t,i){_Ewa.MergeSuspensionManager.initializeBase(this,[!1]);Diag.a.a(577572892,0,50,"MergeSuspensionManager.ctor started");this.n=n;this.i=new _Ewa.lT(n);this.o(n,i);this.g=new _Ewa.Tz(n,this.h,this.i);this.m=new _Ewa.TA(n,this.g,t,null);_Ewa.a.b(260)&&(this.l=new _Ewa.Ty(n,this));Diag.a.a(588276810,0,50,"MergeSuspensionManager created")};_Ewa.MergeSuspensionManager.prototype={n:null,j:null,k:null,l:null,h:null,i:null,m:null,g:null,a:function(n){this.g.k(n)},e:function(n){this.g&&this.g.n(n)},d:function(n,t){this.h.h(n,t)},f:function(n){this.h.i(n)},b:function(n,t){this.i.i(n,t)},dispose:function(){this.l&&(this.l.dispose(),this.l=null);this.m&&(this.m.dispose(),this.m=null);this.g&&(this.g.dispose(),this.g=null);this.i.dispose();this.i=null;this.h.dispose();this.h=null;this.j&&(this.j.dispose(),this.j=null);this.k&&(this.k.dispose(),this.k=null);this.n=null;_Ewa.bgG.prototype.dispose.call(this)},c:function(){this.g.u()},o:function(n,t){this.h=new _Ewa.nx;t?_Ewa.ny.isInstanceOfType(t)?this.d(t,$$as(_Ewa.ny,t).d):_Ewa.nw.isInstanceOfType(t)?this.d(t,$$as(_Ewa.nw,t).d):this.d(t,!0):(this.j=new _Ewa.nw(n),this.k=new _Ewa.ny(n,null),this.d(this.j,this.j.d),this.d(this.k,this.k.d))}};_Ewa.Ty=function(n,t){this.j=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.n);_Ewa.Ty.initializeBase(this,[!1]);this.a=t;this.a.i.j(this.h);this.c="";_Ewa.dF.a(1905775613,1023,0,1);this.e=n.i();this.b=new _Ewa.Ty.a;var i=this;n.a().c(_Ewa.ch,29,function(n){i.a&&(i.d=n,n.c(i),i.a.h.d(i.j))},null);this.e.c(this.b,null)};_Ewa.Ty.prototype={e:null,b:null,d:null,a:null,c:null,f:!1,l:function(n){this.es("MSMSC",n)},k:function(n){this.eu("MSMSC",n)},m:function(){this.er("MSMSC",null,null)},i:function(n){return n==="QueryMergeSuspensionStatus"&&!!this.a},g:function(n,t){return this.i(n,null)?(this.a&&(t.LabelText=this.c,t.On=this.f),!0):!1},dispose:function(){this.b&&(this.e.h(this.b),this.b.dispose(),this.b=null);this.a&&(this.a.i.l(this.h),this.a.h.f(this.j),this.a=null);this.d&&(this.d.b(this),this.d=null);this.c=null;_Ewa.bW.prototype.dispose.call(this)},n:function(n,t){var i=String.format("{0}{1}",t.a.Current===t.a.Pending?"\u26ad":"\u26ae",t.a.Current);_Ewa.f.b(this.c,i,!1)||(this.c=i,this.m())},o:function(n,t){var i=t.a;this.f!==i&&(this.f=i,this.m())}};_Ewa.Ty.a=function(){_Ewa.Ty.a.initializeBase(this,[!1])};_Ewa.Ty.a.prototype={z:function(){return!1},x:function(){return $$sc.a.a(Boolean,!0)},w:function(n,t){return t.a===1905775613},y:function(){return!1}};_Ewa.zE=function(){};_Ewa.zE.a=function(n,t,i,r,u,f){var e=n.a(1,f);return _Ewa.k.a(n,"DoPendingMerge",e,t,i,r,u,0,null,null)};_Ewa.zE.b=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.suspensionStartTimestamp=t,_Ewa.k.a(n,"KeepBlockingPendingMerges",o,i,r,u,f,0,null,null)};_Ewa.lT=function(n){this.e=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.o);this.c=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.q);_Ewa.lT.initializeBase(this,[!1]);this.h=_Ewa.a.a("OfficeVSO:5609713_TraceOnEditCellEndedCommitDuringSuspension");this.m();this.a=n;this.a.c().d(this.g);this.a.b().g(this.c);this.a.b().z(this.c);_Ewa.c.a(this.a).f().h(this.f);var t=this;this.a.a().c(_Ewa.ih,292,function(n){n.a(t.e);Diag.a.a(588276809,0,50,"PendingMergeMonitor initialized")},null)};_Ewa.lT.a=function(n){return n?String.format("({0}/{1} @{2})",n.Current,n.Pending,n.SuspensionStartTimestamp):"null"};_Ewa.lT.prototype={h:!1,a:null,b:null,d:0,j:function(n){this.es("MCU",n)},l:function(n){this.eu("MCU",n)},i:function(n,t){var i=this.b.Current<n.Current||this.b.Pending<n.Pending;if(n.SuspensionStartTimestamp&&this.d!==n.SuspensionStartTimestamp){if(this.d>n.SuspensionStartTimestamp){i&&Diag.a.a(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",t,_Ewa.lT.a(n),_Ewa.lT.a(this.b));return}i||Diag.a.a(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",_Ewa.lT.a(n),_Ewa.lT.a(this.b))}else if(!i)return;this.b=n;this.k(n)},dispose:function(){this.a.b().h(this.c);this.a.b().E(this.c);this.a.c().e(this.g);_Ewa.c.a(this.a).f().f(this.f);var n=this.a.a().a(_Ewa.ih,292,!1,null);n&&n.c(this.e);_Ewa.bW.prototype.dispose.call(this)},k:function(n){n.Pending>n.Current&&n.SuspensionStartTimestamp&&n.SuspensionStartTimestamp>this.d&&(Diag.a.a(554767494,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0} / {1} @{2}",n.Current,n.Pending,n.SuspensionStartTimestamp),this.d=n.SuspensionStartTimestamp);this.er("MCU",new _Ewa.pO(n),null)},q:function(n,t){if(t&&t.a&&t.a.MergeCount){if(!_Ewa.f.b(t.a.SessionId,this.a.b().k(),!1)){Diag.a.a(579737049,0,50,"Stale merge counter ({0}/{1})",t.a.MergeCount.Current,t.a.MergeCount.Pending);return}this.i(t.a.MergeCount,"PMM.EwaResult")}},n:function(n,t){t&&t.a&&this.i(t.a,"PMM.RTC")},p:function(){this.m();this.k(this.b)},m:function(){Diag.a.a(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",_Ewa.lT.a(this.b));var n;this.b=(n=new _Ewa.oe,n.Pending=0,n.Current=0,n.SuspensionStartTimestamp=null,n)},o:function(n,t){this.h&&t.b&&this.b.SuspensionStartTimestamp&&Diag.a.a(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0} / {1} @{2}",this.b.Current,this.b.Pending,this.b.SuspensionStartTimestamp)}};_Ewa.TA=function(n,t,i,r){if(this.n=Function.createDelegate(this,this.w),this.o=Function.createDelegate(this,this.y),this.k=Function.createDelegate(this,this.t),this.m=Function.createDelegate(this,this.v),this.l=Function.createDelegate(this,this.u),_Ewa.TA.initializeBase(this,[!1]),this.b=n,this.i=i,this.e=_Ewa.a.a("OfficeVSO:5597403_StopKeepBlockingRequestsAfterFailures"),this.a=t,this.a.p(this.l),this.a.k(this.m),this.e&&this.a.o(this.k),this.b.c().j(this.o),this.g=this.b.c().a(),this.q=this.b.e().MergeSuspensionRequestThrottlingTimeInMs,this.p=this.b.e().KeepBlockingPendingMergesRequestIntervalMs,r)this.d=r;else{var u=this;_Ewa.g.a(_Ewa.l.b(_Ewa.df,this.b.a(),12,this.b.g(),3,null),function(n){var t=new _Ewa.TA.a(u.g,u.b,null);u.d=n.a().b(t,t,null,"RequestController");Diag.a.a(588276807,0,50,"RequestController initialized");_Ewa.a.a("OfficeVSO:5667869_SendingDPMOnActionAggregatorLoad")&&u.a.f()===2&&u.r(u.a.e())},this.b.g(),3,null,null)}};_Ewa.TA.prototype={b:null,i:null,d:null,a:null,g:null,p:0,q:0,e:!1,c:0,f:null,h:null,dispose:function(){this.b.c().k(this.o);System.a.a(this.d);this.j();this.a.w(this.l);this.a.n(this.m);this.e&&this.a.v(this.k);this.a=null;_Ewa.bW.prototype.dispose.call(this)},u:function(n,t){this.d&&this.r(t.a)},r:function(n){this.d.a(n)},v:function(n,t){t.a?this.x():this.j()},t:function(){this.c=0},x:function(){if(this.j(),this.e&&this.c>5){var n=this.a.e();Diag.a.a(539833802,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} / {1} @{2} fail count: {3}",n.Current,n.Pending,n.SuspensionStartTimestamp,this.c);return}this.h=this.i.a(this.n,this.q,_Ewa.o.bC,!0,!1);this.f=this.i.b(this.n,this.p,_Ewa.o.bD,!0,!1)},j:function(){this.f&&(this.h.a(),this.f.a(),this.h=null,this.f=null)},w:function(){var n=this.a.e(),t=n.SuspensionStartTimestamp!=null?n.SuspensionStartTimestamp:0,i=this;_Ewa.zE.b(this.g,t,null,function(){i.s(n)},null,null,this.g.b(!1))},s:function(n){var t="";this.e&&(t=" fail count: "+this.c,this.c++,this.c>5&&this.j());Diag.a.a(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0} / {1} @{2}{3}",n.Current,n.Pending,n.SuspensionStartTimestamp,t)},y:function(n,t){var r,u,e,o,i,f;t&&(t.a.MergeCount=this.a.e(),_Ewa.c.a(this.b).dC(e={val:r},o={val:u}),r=e.val,u=o.val,t.a.ClientRevisions=_Ewa.a.a("OfficeVSO:5524817_LogOnMergeRaceCondition2")?(i=new _Ewa.tR,i.Min=r,i.Max=u,i.MaxFromBlockCache=_Ewa.c.a(this.b).b().bm(),i):(f=new _Ewa.tR,f.Min=r,f.Max=u,f))}};_Ewa.TA.a=function(n,t,i){_Ewa.TA.a.initializeBase(this);this.e=n;this.h=t.e().MergeSuspensionRequestThrottlingTimeInMs;var r=t.e().GetRangeContentPrefetchDelayForMergeInMs,u=this;this.i=function(){t.dd(r)};this.d=i||_Ewa.q.a();this.f=new Date(0)};_Ewa.TA.a.prototype={h:0,d:null,e:null,i:null,f:null,g:null,a:function(n){return n},b:function(n){var t;if(!n||this.k(n))return t=new($$sc.D.$$(Boolean)),t.a(!0),t.b;var i=this.e.b(!1),u=this,r=function(){Diag.a.a(588276806,0,10,"DoPendingMergeThrottlingStrategy.PerformAction: request failed {0} / {1} @{2}",n.Current,n.Pending,n.SuspensionStartTimestamp)};return this.i(),this.f=this.d.a(),this.g=n,Diag.a.a(554767493,0,50,"DoPendingMergeThrottlingStrategy.PerformAction: Sending DoPendingMerge {0} / {1} @{2}",n.Current,n.Pending,n.SuspensionStartTimestamp),_Ewa.zE.a(this.e,null,r,null,null,i)},k:function(n){return this.j(n,this.g)&&this.d.a()-this.f<this.h},j:function(n,t){return n||t?n&&t?n.Current===t.Current&&n.Pending===t.Pending&&n.SuspensionStartTimestamp===t.SuspensionStartTimestamp:!1:!0}};_Ewa.Tz=function(n,t,i){this.h=Function.createDelegate(this,this.s);this.i=Function.createDelegate(this,this.t);_Ewa.Tz.initializeBase(this,[!1]);this.l=n;this.b=t;this.b.d(this.i);this.d=i;this.d.j(this.h);var r;this.a=(r=new _Ewa.oe,r.Pending=0,r.Current=0,r.SuspensionStartTimestamp=null,r);this.c=this.r();this.g=_Ewa.a.a("OfficeVSO:5597403_StopKeepBlockingRequestsAfterFailures")};_Ewa.Tz.prototype={l:null,b:null,d:null,a:null,c:!1,g:!1,r:function(){return _Ewa.nx.isInstanceOfType(this.b)?$$as(_Ewa.nx,this.b).e():!1},k:function(n){this.es("TPMBBC",n)},n:function(n){this.eu("TPMBBC",n)},p:function(n){this.es("RFPMU",n)},w:function(n){this.eu("RFPMU",n)},o:function(n){this.es("MCC",n)},v:function(n){this.eu("MCC",n)},u:function(){this.j(this.f()===1)},dispose:function(){this.b.f(this.i);this.b=null;this.d.l(this.h);this.d=null;_Ewa.bW.prototype.dispose.call(this)},e:function(){var n;return n=new _Ewa.oe,n.Current=this.a.Current,n.Pending=this.a.Pending,n.SuspensionStartTimestamp=this.a.SuspensionStartTimestamp,n},f:function(){return this.a.Pending===this.a.Current?0:this.c?2:1},m:function(n,t){var u=this.f(),i,r;this.c=t;i=!1;this.g&&(i=this.a.Pending!==n.Pending||this.a.Current!==n.Current);this.a=n;r=this.f();this.q(u,r,i)},q:function(n,t,i){this.g&&i&&this.er("MCC",null,null);n!==t&&(t===1?this.j(!0):n===1&&this.j(!1));t===2?this.er("RFPMU",new _Ewa.pO(this.a),null):this.er("RFPMU",new _Ewa.pO(null),null)},j:function(n){this.er("TPMBBC",new _Ewa.TB(n),null)},s:function(n,t){this.m(t.a,this.c)},t:function(n,t){this.m(this.a,t.a)}};_Ewa.blj=function(){};_Ewa.blj.prototype={c:function(n){return n}};_Ewa.nw=function(n){this.e=Function.createDelegate(this,this.i);this.g=Function.createDelegate(this,this.j);_Ewa.nw.initializeBase(this);this.c=_Ewa.c.a(n);this.c.f().d(this.g);this.c.f().h(this.e);this.h()};_Ewa.nw.prototype={c:null,d:!1,l:function(n){return this.d!==n&&(this.d=n,this.k()),n},dispose:function(){this.c.f().c(this.g);this.c.f().f(this.e);this.c=null;_Ewa.bW.prototype.dispose.call(this)},k:function(){this.f(this.d)},i:function(){this.h()},j:function(){this.h()},h:function(){this.l(!this.c.m())}};_Ewa.ny=function(n,t){this.h=Function.createDelegate(this,this.k);this.g=Function.createDelegate(this,this.j);_Ewa.ny.initializeBase(this);this.e=n;this.c=t?t:_Ewa.S.a(n).c("cw0");_Ewa.S.a(n).g(this.g);this.c.d(this.h);this.i()};_Ewa.ny.prototype={e:null,d:!1,m:function(n){return n!==this.d&&(this.d=n,this.l()),n},c:null,dispose:function(){_Ewa.S.a(this.e).f(this.g);this.c.e(this.h);this.c=null;_Ewa.bW.prototype.dispose.call(this)},l:function(){this.f(this.d)},i:function(){this.m(this.c.b()===1||_Ewa.S.a(this.e).b()===this.c)},k:function(){this.i()},j:function(){this.i()}};_Ewa.nx.registerClass("_Ewa.nx",_Ewa.bW);_Ewa.nx.a.registerClass("_Ewa.nx.a");_Ewa.zD.registerClass("_Ewa.zD",_Ewa.sX.$$(_Ewa.jm));_Ewa.MergeSuspensionManager.registerClass("_Ewa.MergeSuspensionManager",_Ewa.bgG,_Ewa.jm,Sys.IDisposable);_Ewa.Ty.registerClass("_Ewa.Ty",_Ewa.bW,_Ewa.rM,Common.IRootUser,Sys.IDisposable);_Ewa.Ty.a.registerClass("_Ewa.Ty.a",_Ewa.bgG,_Ewa.lI);_Ewa.lT.registerClass("_Ewa.lT",_Ewa.bW);_Ewa.TA.registerClass("_Ewa.TA",_Ewa.bW);_Ewa.blj.registerClass("_Ewa.blj");_Ewa.TA.a.registerClass("_Ewa.TA.a",_Ewa.blj);_Ewa.Tz.registerClass("_Ewa.Tz",_Ewa.bW);_Ewa.nw.registerClass("_Ewa.nw",_Ewa.blg);_Ewa.ny.registerClass("_Ewa.ny",_Ewa.blg);Type.registerNamespace("_Ewa");_Ewa.bli=function(){};_Ewa.bli.a=function(){_Ewa.m.a(_Ewa.zD.a)};_Ewa.bli.a();