/*! For license information please see sharedauthclient.js.LICENSE.txt */
!function(){var e={1817:function(e,t,r){var n=r(4366);e.exports=n},8212:function(e,t,r){var n=r(4681);e.exports=n},180:function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},915:function(e,t,r){var n=r(9398);e.exports=function(e){if(!n(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},9129:function(e,t,r){var n=r(8182),o=r(4351),i=r(448),a=n("unscopables"),s=Array.prototype;null==s[a]&&i.f(s,a,{configurable:!0,value:o(null)}),e.exports=function(e){s[a][e]=!0}},8990:function(e){e.exports=function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return e}},4412:function(e,t,r){var n=r(9398);e.exports=function(e){if(!n(e))throw TypeError(String(e)+" is not an object");return e}},8588:function(e,t,r){"use strict";var n=r(4899),o=r(1403),i=r(4972),a=r(9778),s=r(4352),c=r(3018),u=r(8293);e.exports=function(e){var t,r,l,h,d,p,f=o(e),g="function"==typeof this?this:Array,y=arguments.length,m=y>1?arguments[1]:void 0,v=void 0!==m,E=u(f),w=0;if(v&&(m=n(m,y>2?arguments[2]:void 0,2)),null==E||g==Array&&a(E))for(r=new g(t=s(f.length));t>w;w++)p=v?m(f[w],w):f[w],c(r,w,p);else for(d=(h=E.call(f)).next,r=new g;!(l=d.call(h)).done;w++)p=v?i(h,m,[l.value,w],!0):l.value,c(r,w,p);return r.length=w,r}},3643:function(e,t,r){var n=r(2086),o=r(4352),i=r(544),a=function(e){return function(t,r,a){var s,c=n(t),u=o(c.length),l=i(a,u);if(e&&r!=r){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===r)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},4972:function(e,t,r){var n=r(4412),o=r(4266);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){throw o(e),t}}},7665:function(e,t,r){var n=r(8182)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var i={};i[n]=function(){return{next:function(){return{done:r=!0}}}},e(i)}catch(e){}return r}},2286:function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},7269:function(e,t,r){var n=r(7172),o=r(2286),i=r(8182)("toStringTag"),a="Arguments"==o(function(){return arguments}());e.exports=n?o:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:a?o(t):"Object"==(n=o(t))&&"function"==typeof t.callee?"Arguments":n}},7987:function(e,t,r){var n=r(8044),o=r(3964),i=r(4625),a=r(448);e.exports=function(e,t){for(var r=o(t),s=a.f,c=i.f,u=0;u<r.length;u++){var l=r[u];n(e,l)||s(e,l,c(t,l))}}},32:function(e,t,r){var n=r(207);e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},1166:function(e,t,r){"use strict";var n=r(3273).IteratorPrototype,o=r(4351),i=r(2110),a=r(5986),s=r(7559),c=function(){return this};e.exports=function(e,t,r){var u=t+" Iterator";return e.prototype=o(n,{next:i(1,r)}),a(e,u,!1,!0),s[u]=c,e}},7235:function(e,t,r){var n=r(9911),o=r(448),i=r(2110);e.exports=n?function(e,t,r){return o.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},2110:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},3018:function(e,t,r){"use strict";var n=r(9516),o=r(448),i=r(2110);e.exports=function(e,t,r){var a=n(t);a in e?o.f(e,a,i(0,r)):e[a]=r}},1374:function(e,t,r){"use strict";var n=r(6865),o=r(1166),i=r(6399),a=r(5539),s=r(5986),c=r(7235),u=r(4287),l=r(8182),h=r(9675),d=r(7559),p=r(3273),f=p.IteratorPrototype,g=p.BUGGY_SAFARI_ITERATORS,y=l("iterator"),m="keys",v="values",E="entries",w=function(){return this};e.exports=function(e,t,r,l,p,C,T){o(r,t,l);var S,A,b,I=function(e){if(e===p&&P)return P;if(!g&&e in k)return k[e];switch(e){case m:case v:case E:return function(){return new r(this,e)}}return function(){return new r(this)}},R=t+" Iterator",_=!1,k=e.prototype,O=k[y]||k["@@iterator"]||p&&k[p],P=!g&&O||I(p),U="Array"==t&&k.entries||O;if(U&&(S=i(U.call(new e)),f!==Object.prototype&&S.next&&(h||i(S)===f||(a?a(S,f):"function"!=typeof S[y]&&c(S,y,w)),s(S,R,!0,!0),h&&(d[R]=w))),p==v&&O&&O.name!==v&&(_=!0,P=function(){return O.call(this)}),h&&!T||k[y]===P||c(k,y,P),d[t]=P,p)if(A={values:I(v),keys:C?P:I(m),entries:I(E)},T)for(b in A)(g||_||!(b in k))&&u(k,b,A[b]);else n({target:t,proto:!0,forced:g||_},A);return A}},9911:function(e,t,r){var n=r(207);e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},7092:function(e,t,r){var n=r(2006),o=r(9398),i=n.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},4144:function(e){e.exports="object"==typeof window},3875:function(e,t,r){var n=r(5077);e.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(n)},8369:function(e,t,r){var n=r(2286),o=r(2006);e.exports="process"==n(o.process)},4580:function(e,t,r){var n=r(5077);e.exports=/web0s(?!.*chrome)/i.test(n)},5077:function(e,t,r){var n=r(3780);e.exports=n("navigator","userAgent")||""},2802:function(e,t,r){var n,o,i=r(2006),a=r(5077),s=i.process,c=s&&s.versions,u=c&&c.v8;u?o=(n=u.split("."))[0]<4?1:n[0]+n[1]:a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(o=n[1]),e.exports=o&&+o},7437:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6865:function(e,t,r){var n=r(2006),o=r(4625).f,i=r(7235),a=r(4287),s=r(9143),c=r(7987),u=r(5673);e.exports=function(e,t){var r,l,h,d,p,f=e.target,g=e.global,y=e.stat;if(r=g?n:y?n[f]||s(f,{}):(n[f]||{}).prototype)for(l in t){if(d=t[l],h=e.noTargetGet?(p=o(r,l))&&p.value:r[l],!u(g?l:f+(y?".":"#")+l,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;c(d,h)}(e.sham||h&&h.sham)&&i(d,"sham",!0),a(r,l,d,e)}}},207:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},4899:function(e,t,r){var n=r(180);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},3780:function(e,t,r){var n=r(7410),o=r(2006),i=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?i(n[e])||i(o[e]):n[e]&&n[e][t]||o[e]&&o[e][t]}},8293:function(e,t,r){var n=r(7269),o=r(7559),i=r(8182)("iterator");e.exports=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},1069:function(e,t,r){var n=r(4412),o=r(8293);e.exports=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},2006:function(e,t,r){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},8044:function(e,t,r){var n=r(1403),o={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return o.call(n(e),t)}},9896:function(e){e.exports={}},2801:function(e,t,r){var n=r(2006);e.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},8285:function(e,t,r){var n=r(3780);e.exports=n("document","documentElement")},8414:function(e,t,r){var n=r(9911),o=r(207),i=r(7092);e.exports=!n&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},3092:function(e,t,r){var n=r(207),o=r(2286),i="".split;e.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?i.call(e,""):Object(e)}:Object},253:function(e,t,r){var n=r(4590),o=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(e){return o.call(e)}),e.exports=n.inspectSource},1744:function(e,t,r){var n,o,i,a=r(4828),s=r(2006),c=r(9398),u=r(7235),l=r(8044),h=r(4590),d=r(2947),p=r(9896),f="Object already initialized",g=s.WeakMap;if(a||h.state){var y=h.state||(h.state=new g),m=y.get,v=y.has,E=y.set;n=function(e,t){if(v.call(y,e))throw new TypeError(f);return t.facade=e,E.call(y,e,t),t},o=function(e){return m.call(y,e)||{}},i=function(e){return v.call(y,e)}}else{var w=d("state");p[w]=!0,n=function(e,t){if(l(e,w))throw new TypeError(f);return t.facade=e,u(e,w,t),t},o=function(e){return l(e,w)?e[w]:{}},i=function(e){return l(e,w)}}e.exports={set:n,get:o,has:i,enforce:function(e){return i(e)?o(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!c(t)||(r=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}}},9778:function(e,t,r){var n=r(8182),o=r(7559),i=n("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[i]===e)}},5673:function(e,t,r){var n=r(207),o=/#|\.prototype\./,i=function(e,t){var r=s[a(e)];return r==u||r!=c&&("function"==typeof t?n(t):!!t)},a=i.normalize=function(e){return String(e).replace(o,".").toLowerCase()},s=i.data={},c=i.NATIVE="N",u=i.POLYFILL="P";e.exports=i},9398:function(e){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},9675:function(e){e.exports=!1},7935:function(e,t,r){var n=r(4412),o=r(9778),i=r(4352),a=r(4899),s=r(8293),c=r(4266),u=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,r){var l,h,d,p,f,g,y,m=r&&r.that,v=!(!r||!r.AS_ENTRIES),E=!(!r||!r.IS_ITERATOR),w=!(!r||!r.INTERRUPTED),C=a(t,m,1+v+w),T=function(e){return l&&c(l),new u(!0,e)},S=function(e){return v?(n(e),w?C(e[0],e[1],T):C(e[0],e[1])):w?C(e,T):C(e)};if(E)l=e;else{if("function"!=typeof(h=s(e)))throw TypeError("Target is not iterable");if(o(h)){for(d=0,p=i(e.length);p>d;d++)if((f=S(e[d]))&&f instanceof u)return f;return new u(!1)}l=h.call(e)}for(g=l.next;!(y=g.call(l)).done;){try{f=S(y.value)}catch(e){throw c(l),e}if("object"==typeof f&&f&&f instanceof u)return f}return new u(!1)}},4266:function(e,t,r){var n=r(4412);e.exports=function(e){var t=e.return;if(void 0!==t)return n(t.call(e)).value}},3273:function(e,t,r){"use strict";var n,o,i,a=r(207),s=r(6399),c=r(7235),u=r(8044),l=r(8182),h=r(9675),d=l("iterator"),p=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(n=o):p=!0);var f=null==n||a((function(){var e={};return n[d].call(e)!==e}));f&&(n={}),h&&!f||u(n,d)||c(n,d,(function(){return this})),e.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:p}},7559:function(e){e.exports={}},5872:function(e,t,r){var n,o,i,a,s,c,u,l,h=r(2006),d=r(4625).f,p=r(4249).set,f=r(3875),g=r(4580),y=r(8369),m=h.MutationObserver||h.WebKitMutationObserver,v=h.document,E=h.process,w=h.Promise,C=d(h,"queueMicrotask"),T=C&&C.value;T||(n=function(){var e,t;for(y&&(e=E.domain)&&e.exit();o;){t=o.fn,o=o.next;try{t()}catch(e){throw o?a():i=void 0,e}}i=void 0,e&&e.enter()},f||y||g||!m||!v?w&&w.resolve?((u=w.resolve(void 0)).constructor=w,l=u.then,a=function(){l.call(u,n)}):a=y?function(){E.nextTick(n)}:function(){p.call(h,n)}:(s=!0,c=v.createTextNode(""),new m(n).observe(c,{characterData:!0}),a=function(){c.data=s=!s})),e.exports=T||function(e){var t={fn:e,next:void 0};i&&(i.next=t),o||(o=t,a()),i=t}},6227:function(e,t,r){var n=r(2006);e.exports=n.Promise},1763:function(e,t,r){var n=r(2802),o=r(207);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},8858:function(e,t,r){var n=r(207),o=r(8182),i=r(9675),a=o("iterator");e.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),i&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},4828:function(e,t,r){var n=r(2006),o=r(253),i=n.WeakMap;e.exports="function"==typeof i&&/native code/.test(o(i))},5185:function(e,t,r){"use strict";var n=r(180),o=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)};e.exports.f=function(e){return new o(e)}},9937:function(e,t,r){"use strict";var n=r(9911),o=r(207),i=r(4256),a=r(9609),s=r(5699),c=r(1403),u=r(3092),l=Object.assign,h=Object.defineProperty;e.exports=!l||o((function(){if(n&&1!==l({b:1},l(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),o="abcdefghijklmnopqrst";return e[r]=7,o.split("").forEach((function(e){t[e]=e})),7!=l({},e)[r]||i(l({},t)).join("")!=o}))?function(e,t){for(var r=c(e),o=arguments.length,l=1,h=a.f,d=s.f;o>l;)for(var p,f=u(arguments[l++]),g=h?i(f).concat(h(f)):i(f),y=g.length,m=0;y>m;)p=g[m++],n&&!d.call(f,p)||(r[p]=f[p]);return r}:l},4351:function(e,t,r){var n,o=r(4412),i=r(177),a=r(7437),s=r(9896),c=r(8285),u=r(7092),l=r(2947)("IE_PROTO"),h=function(){},d=function(e){return"<script>"+e+"<\/script>"},p=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;p=n?function(e){e.write(d("")),e.close();var t=e.parentWindow.Object;return e=null,t}(n):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(d("document.F=Object")),e.close(),e.F);for(var r=a.length;r--;)delete p.prototype[a[r]];return p()};s[l]=!0,e.exports=Object.create||function(e,t){var r;return null!==e?(h.prototype=o(e),r=new h,h.prototype=null,r[l]=e):r=p(),void 0===t?r:i(r,t)}},177:function(e,t,r){var n=r(9911),o=r(448),i=r(4412),a=r(4256);e.exports=n?Object.defineProperties:function(e,t){i(e);for(var r,n=a(t),s=n.length,c=0;s>c;)o.f(e,r=n[c++],t[r]);return e}},448:function(e,t,r){var n=r(9911),o=r(8414),i=r(4412),a=r(9516),s=Object.defineProperty;t.f=n?s:function(e,t,r){if(i(e),t=a(t,!0),i(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},4625:function(e,t,r){var n=r(9911),o=r(5699),i=r(2110),a=r(2086),s=r(9516),c=r(8044),u=r(8414),l=Object.getOwnPropertyDescriptor;t.f=n?l:function(e,t){if(e=a(e),t=s(t,!0),u)try{return l(e,t)}catch(e){}if(c(e,t))return i(!o.f.call(e,t),e[t])}},5279:function(e,t,r){var n=r(4115),o=r(7437).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},9609:function(e,t){t.f=Object.getOwnPropertySymbols},6399:function(e,t,r){var n=r(8044),o=r(1403),i=r(2947),a=r(32),s=i("IE_PROTO"),c=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=o(e),n(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?c:null}},4115:function(e,t,r){var n=r(8044),o=r(2086),i=r(3643).indexOf,a=r(9896);e.exports=function(e,t){var r,s=o(e),c=0,u=[];for(r in s)!n(a,r)&&n(s,r)&&u.push(r);for(;t.length>c;)n(s,r=t[c++])&&(~i(u,r)||u.push(r));return u}},4256:function(e,t,r){var n=r(4115),o=r(7437);e.exports=Object.keys||function(e){return n(e,o)}},5699:function(e,t){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!r.call({1:2},1);t.f=o?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},5539:function(e,t,r){var n=r(4412),o=r(915);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,i){return n(r),o(i),t?e.call(r,i):r.__proto__=i,r}}():void 0)},8725:function(e,t,r){"use strict";var n=r(7172),o=r(7269);e.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},3964:function(e,t,r){var n=r(3780),o=r(5279),i=r(9609),a=r(4412);e.exports=n("Reflect","ownKeys")||function(e){var t=o.f(a(e)),r=i.f;return r?t.concat(r(e)):t}},7410:function(e,t,r){var n=r(2006);e.exports=n},8832:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},6199:function(e,t,r){var n=r(4412),o=r(9398),i=r(5185);e.exports=function(e,t){if(n(e),o(t)&&t.constructor===e)return t;var r=i.f(e);return(0,r.resolve)(t),r.promise}},6269:function(e,t,r){var n=r(4287);e.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},4287:function(e,t,r){var n=r(2006),o=r(7235),i=r(8044),a=r(9143),s=r(253),c=r(1744),u=c.get,l=c.enforce,h=String(String).split("String");(e.exports=function(e,t,r,s){var c,u=!!s&&!!s.unsafe,d=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof r&&("string"!=typeof t||i(r,"name")||o(r,"name",t),(c=l(r)).source||(c.source=h.join("string"==typeof t?t:""))),e!==n?(u?!p&&e[t]&&(d=!0):delete e[t],d?e[t]=r:o(e,t,r)):d?e[t]=r:a(t,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},1027:function(e){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},9143:function(e,t,r){var n=r(2006),o=r(7235);e.exports=function(e,t){try{o(n,e,t)}catch(r){n[e]=t}return t}},517:function(e,t,r){"use strict";var n=r(3780),o=r(448),i=r(8182),a=r(9911),s=i("species");e.exports=function(e){var t=n(e),r=o.f;a&&t&&!t[s]&&r(t,s,{configurable:!0,get:function(){return this}})}},5986:function(e,t,r){var n=r(448).f,o=r(8044),i=r(8182)("toStringTag");e.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},2947:function(e,t,r){var n=r(373),o=r(6957),i=n("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},4590:function(e,t,r){var n=r(2006),o=r(9143),i="__core-js_shared__",a=n[i]||o(i,{});e.exports=a},373:function(e,t,r){var n=r(9675),o=r(4590);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.15.2",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},545:function(e,t,r){var n=r(4412),o=r(180),i=r(8182)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[i])?t:o(r)}},4059:function(e,t,r){var n=r(6727),o=r(1027),i=function(e){return function(t,r){var i,a,s=String(o(t)),c=n(r),u=s.length;return c<0||c>=u?e?"":void 0:(i=s.charCodeAt(c))<55296||i>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):i:e?s.slice(c,c+2):a-56320+(i-55296<<10)+65536}};e.exports={codeAt:i(!1),charAt:i(!0)}},4178:function(e){"use strict";var t=2147483647,r=/[^\0-\u007E]/,n=/[.\u3002\uFF0E\uFF61]/g,o="Overflow: input needs wider integers to process",i=Math.floor,a=String.fromCharCode,s=function(e){return e+22+75*(e<26)},c=function(e,t,r){var n=0;for(e=r?i(e/700):e>>1,e+=i(e/t);e>455;n+=36)e=i(e/35);return i(n+36*e/(e+38))},u=function(e){var r,n,u=[],l=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var o=e.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){var i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&o)<<10)+(1023&i)+65536):(t.push(o),r--)}else t.push(o)}return t}(e)).length,h=128,d=0,p=72;for(r=0;r<e.length;r++)(n=e[r])<128&&u.push(a(n));var f=u.length,g=f;for(f&&u.push("-");g<l;){var y=t;for(r=0;r<e.length;r++)(n=e[r])>=h&&n<y&&(y=n);var m=g+1;if(y-h>i((t-d)/m))throw RangeError(o);for(d+=(y-h)*m,h=y,r=0;r<e.length;r++){if((n=e[r])<h&&++d>t)throw RangeError(o);if(n==h){for(var v=d,E=36;;E+=36){var w=E<=p?1:E>=p+26?26:E-p;if(v<w)break;var C=v-w,T=36-w;u.push(a(s(w+C%T))),v=i(C/T)}u.push(a(s(v))),p=c(d,m,g==f),d=0,++g}}++d,++h}return u.join("")};e.exports=function(e){var t,o,i=[],a=e.toLowerCase().replace(n,".").split(".");for(t=0;t<a.length;t++)o=a[t],i.push(r.test(o)?"xn--"+u(o):o);return i.join(".")}},4249:function(e,t,r){var n,o,i,a=r(2006),s=r(207),c=r(4899),u=r(8285),l=r(7092),h=r(3875),d=r(8369),p=a.location,f=a.setImmediate,g=a.clearImmediate,y=a.process,m=a.MessageChannel,v=a.Dispatch,E=0,w={},C=function(e){if(w.hasOwnProperty(e)){var t=w[e];delete w[e],t()}},T=function(e){return function(){C(e)}},S=function(e){C(e.data)},A=function(e){a.postMessage(e+"",p.protocol+"//"+p.host)};f&&g||(f=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return w[++E]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},n(E),E},g=function(e){delete w[e]},d?n=function(e){y.nextTick(T(e))}:v&&v.now?n=function(e){v.now(T(e))}:m&&!h?(i=(o=new m).port2,o.port1.onmessage=S,n=c(i.postMessage,i,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts&&p&&"file:"!==p.protocol&&!s(A)?(n=A,a.addEventListener("message",S,!1)):n="onreadystatechange"in l("script")?function(e){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),C(e)}}:function(e){setTimeout(T(e),0)}),e.exports={set:f,clear:g}},544:function(e,t,r){var n=r(6727),o=Math.max,i=Math.min;e.exports=function(e,t){var r=n(e);return r<0?o(r+t,0):i(r,t)}},2086:function(e,t,r){var n=r(3092),o=r(1027);e.exports=function(e){return n(o(e))}},6727:function(e){var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},4352:function(e,t,r){var n=r(6727),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},1403:function(e,t,r){var n=r(1027);e.exports=function(e){return Object(n(e))}},9516:function(e,t,r){var n=r(9398);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},7172:function(e,t,r){var n={};n[r(8182)("toStringTag")]="z",e.exports="[object z]"===String(n)},6957:function(e){var t=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+r).toString(36)}},8706:function(e,t,r){var n=r(1763);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8182:function(e,t,r){var n=r(2006),o=r(373),i=r(8044),a=r(6957),s=r(1763),c=r(8706),u=o("wks"),l=n.Symbol,h=c?l:l&&l.withoutSetter||a;e.exports=function(e){return i(u,e)&&(s||"string"==typeof u[e])||(s&&i(l,e)?u[e]=l[e]:u[e]=h("Symbol."+e)),u[e]}},7022:function(e,t,r){"use strict";var n=r(2086),o=r(9129),i=r(7559),a=r(1744),s=r(1374),c="Array Iterator",u=a.set,l=a.getterFor(c);e.exports=s(Array,"Array",(function(e,t){u(this,{type:c,target:n(e),index:0,kind:t})}),(function(){var e=l(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},2186:function(e,t,r){var n=r(7172),o=r(4287),i=r(8725);n||o(Object.prototype,"toString",i,{unsafe:!0})},6546:function(e,t,r){"use strict";var n,o,i,a,s=r(6865),c=r(9675),u=r(2006),l=r(3780),h=r(6227),d=r(4287),p=r(6269),f=r(5539),g=r(5986),y=r(517),m=r(9398),v=r(180),E=r(8990),w=r(253),C=r(7935),T=r(7665),S=r(545),A=r(4249).set,b=r(5872),I=r(6199),R=r(2801),_=r(5185),k=r(8832),O=r(1744),P=r(5673),U=r(8182),N=r(4144),L=r(8369),M=r(2802),x=U("species"),q="Promise",D=O.get,F=O.set,j=O.getterFor(q),H=h&&h.prototype,K=h,G=H,B=u.TypeError,z=u.document,W=u.process,J=_.f,V=J,Q=!!(z&&z.createEvent&&u.dispatchEvent),Y="function"==typeof PromiseRejectionEvent,X="unhandledrejection",Z=!1,$=P(q,(function(){var e=w(K),t=e!==String(K);if(!t&&66===M)return!0;if(c&&!G.finally)return!0;if(M>=51&&/native code/.test(e))return!1;var r=new K((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};return(r.constructor={})[x]=n,!(Z=r.then((function(){}))instanceof n)||!t&&N&&!Y})),ee=$||!T((function(e){K.all(e).catch((function(){}))})),te=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},re=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;b((function(){for(var n=e.value,o=1==e.state,i=0;r.length>i;){var a,s,c,u=r[i++],l=o?u.ok:u.fail,h=u.resolve,d=u.reject,p=u.domain;try{l?(o||(2===e.rejection&&ae(e),e.rejection=1),!0===l?a=n:(p&&p.enter(),a=l(n),p&&(p.exit(),c=!0)),a===u.promise?d(B("Promise-chain cycle")):(s=te(a))?s.call(a,h,d):h(a)):d(n)}catch(e){p&&!c&&p.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&oe(e)}))}},ne=function(e,t,r){var n,o;Q?((n=z.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),u.dispatchEvent(n)):n={promise:t,reason:r},!Y&&(o=u["on"+e])?o(n):e===X&&R("Unhandled promise rejection",r)},oe=function(e){A.call(u,(function(){var t,r=e.facade,n=e.value;if(ie(e)&&(t=k((function(){L?W.emit("unhandledRejection",n,r):ne(X,r,n)})),e.rejection=L||ie(e)?2:1,t.error))throw t.value}))},ie=function(e){return 1!==e.rejection&&!e.parent},ae=function(e){A.call(u,(function(){var t=e.facade;L?W.emit("rejectionHandled",t):ne("rejectionhandled",t,e.value)}))},se=function(e,t,r){return function(n){e(t,n,r)}},ce=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,re(e,!0))},ue=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw B("Promise can't be resolved itself");var n=te(t);n?b((function(){var r={done:!1};try{n.call(t,se(ue,r,e),se(ce,r,e))}catch(t){ce(r,t,e)}})):(e.value=t,e.state=1,re(e,!1))}catch(t){ce({done:!1},t,e)}}};if($&&(G=(K=function(e){E(this,K,q),v(e),n.call(this);var t=D(this);try{e(se(ue,t),se(ce,t))}catch(e){ce(t,e)}}).prototype,(n=function(e){F(this,{type:q,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(G,{then:function(e,t){var r=j(this),n=J(S(this,K));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=L?W.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&re(r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n,t=D(e);this.promise=e,this.resolve=se(ue,t),this.reject=se(ce,t)},_.f=J=function(e){return e===K||e===i?new o(e):V(e)},!c&&"function"==typeof h&&H!==Object.prototype)){a=H.then,Z||(d(H,"then",(function(e,t){var r=this;return new K((function(e,t){a.call(r,e,t)})).then(e,t)}),{unsafe:!0}),d(H,"catch",G.catch,{unsafe:!0}));try{delete H.constructor}catch(e){}f&&f(H,G)}s({global:!0,wrap:!0,forced:$},{Promise:K}),g(K,q,!1,!0),y(q),i=l(q),s({target:q,stat:!0,forced:$},{reject:function(e){var t=J(this);return t.reject.call(void 0,e),t.promise}}),s({target:q,stat:!0,forced:c||$},{resolve:function(e){return I(c&&this===i?K:this,e)}}),s({target:q,stat:!0,forced:ee},{all:function(e){var t=this,r=J(t),n=r.resolve,o=r.reject,i=k((function(){var r=v(t.resolve),i=[],a=0,s=1;C(e,(function(e){var c=a++,u=!1;i.push(void 0),s++,r.call(t,e).then((function(e){u||(u=!0,i[c]=e,--s||n(i))}),o)})),--s||n(i)}));return i.error&&o(i.value),r.promise},race:function(e){var t=this,r=J(t),n=r.reject,o=k((function(){var o=v(t.resolve);C(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}})},7995:function(e,t,r){"use strict";var n=r(4059).charAt,o=r(1744),i=r(1374),a="String Iterator",s=o.set,c=o.getterFor(a);i(String,"String",(function(e){s(this,{type:a,string:String(e),index:0})}),(function(){var e,t=c(this),r=t.string,o=t.index;return o>=r.length?{value:void 0,done:!0}:(e=n(r,o),t.index+=e.length,{value:e,done:!1})}))},1026:function(e,t,r){"use strict";r(7022);var n=r(6865),o=r(3780),i=r(8858),a=r(4287),s=r(6269),c=r(5986),u=r(1166),l=r(1744),h=r(8990),d=r(8044),p=r(4899),f=r(7269),g=r(4412),y=r(9398),m=r(4351),v=r(2110),E=r(1069),w=r(8293),C=r(8182),T=o("fetch"),S=o("Headers"),A=C("iterator"),b="URLSearchParams",I="URLSearchParamsIterator",R=l.set,_=l.getterFor(b),k=l.getterFor(I),O=/\+/g,P=Array(4),U=function(e){return P[e-1]||(P[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},N=function(e){try{return decodeURIComponent(e)}catch(t){return e}},L=function(e){var t=e.replace(O," "),r=4;try{return decodeURIComponent(t)}catch(e){for(;r;)t=t.replace(U(r--),N);return t}},M=/[!'()~]|%20/g,x={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},q=function(e){return x[e]},D=function(e){return encodeURIComponent(e).replace(M,q)},F=function(e,t){if(t)for(var r,n,o=t.split("&"),i=0;i<o.length;)(r=o[i++]).length&&(n=r.split("="),e.push({key:L(n.shift()),value:L(n.join("="))}))},j=function(e){this.entries.length=0,F(this.entries,e)},H=function(e,t){if(e<t)throw TypeError("Not enough arguments")},K=u((function(e,t){R(this,{type:I,iterator:E(_(e).entries),kind:t})}),"Iterator",(function(){var e=k(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r})),G=function(){h(this,G,b);var e,t,r,n,o,i,a,s,c,u=arguments.length>0?arguments[0]:void 0,l=this,p=[];if(R(l,{type:b,entries:p,updateURL:function(){},updateSearchParams:j}),void 0!==u)if(y(u))if("function"==typeof(e=w(u)))for(r=(t=e.call(u)).next;!(n=r.call(t)).done;){if((a=(i=(o=E(g(n.value))).next).call(o)).done||(s=i.call(o)).done||!i.call(o).done)throw TypeError("Expected sequence with length 2");p.push({key:a.value+"",value:s.value+""})}else for(c in u)d(u,c)&&p.push({key:c,value:u[c]+""});else F(p,"string"==typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")},B=G.prototype;s(B,{append:function(e,t){H(arguments.length,2);var r=_(this);r.entries.push({key:e+"",value:t+""}),r.updateURL()},delete:function(e){H(arguments.length,1);for(var t=_(this),r=t.entries,n=e+"",o=0;o<r.length;)r[o].key===n?r.splice(o,1):o++;t.updateURL()},get:function(e){H(arguments.length,1);for(var t=_(this).entries,r=e+"",n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){H(arguments.length,1);for(var t=_(this).entries,r=e+"",n=[],o=0;o<t.length;o++)t[o].key===r&&n.push(t[o].value);return n},has:function(e){H(arguments.length,1);for(var t=_(this).entries,r=e+"",n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){H(arguments.length,1);for(var r,n=_(this),o=n.entries,i=!1,a=e+"",s=t+"",c=0;c<o.length;c++)(r=o[c]).key===a&&(i?o.splice(c--,1):(i=!0,r.value=s));i||o.push({key:a,value:s}),n.updateURL()},sort:function(){var e,t,r,n=_(this),o=n.entries,i=o.slice();for(o.length=0,r=0;r<i.length;r++){for(e=i[r],t=0;t<r;t++)if(o[t].key>e.key){o.splice(t,0,e);break}t===r&&o.push(e)}n.updateURL()},forEach:function(e){for(var t,r=_(this).entries,n=p(e,arguments.length>1?arguments[1]:void 0,3),o=0;o<r.length;)n((t=r[o++]).value,t.key,this)},keys:function(){return new K(this,"keys")},values:function(){return new K(this,"values")},entries:function(){return new K(this,"entries")}},{enumerable:!0}),a(B,A,B.entries),a(B,"toString",(function(){for(var e,t=_(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(D(e.key)+"="+D(e.value));return r.join("&")}),{enumerable:!0}),c(G,b),n({global:!0,forced:!i},{URLSearchParams:G}),i||"function"!=typeof T||"function"!=typeof S||n({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,r,n,o=[e];return arguments.length>1&&(y(t=arguments[1])&&(r=t.body,f(r)===b&&((n=t.headers?new S(t.headers):new S).has("content-type")||n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=m(t,{body:v(0,String(r)),headers:v(0,n)}))),o.push(t)),T.apply(this,o)}}),e.exports={URLSearchParams:G,getState:_}},6490:function(e,t,r){"use strict";r(7995);var n,o=r(6865),i=r(9911),a=r(8858),s=r(2006),c=r(177),u=r(4287),l=r(8990),h=r(8044),d=r(9937),p=r(8588),f=r(4059).codeAt,g=r(4178),y=r(5986),m=r(1026),v=r(1744),E=s.URL,w=m.URLSearchParams,C=m.getState,T=v.set,S=v.getterFor("URL"),A=Math.floor,b=Math.pow,I="Invalid scheme",R="Invalid host",_="Invalid port",k=/[A-Za-z]/,O=/[\d+-.A-Za-z]/,P=/\d/,U=/^0x/i,N=/^[0-7]+$/,L=/^\d+$/,M=/^[\dA-Fa-f]+$/,x=/[\0\t\n\r #%/:<>?@[\\\]^|]/,q=/[\0\t\n\r #/:<>?@[\\\]^|]/,D=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,F=/[\t\n\r]/g,j=function(e,t){var r,n,o;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return R;if(!(r=K(t.slice(1,-1))))return R;e.host=r}else if(Y(e)){if(t=g(t),x.test(t))return R;if(null===(r=H(t)))return R;e.host=r}else{if(q.test(t))return R;for(r="",n=p(t),o=0;o<n.length;o++)r+=V(n[o],B);e.host=r}},H=function(e){var t,r,n,o,i,a,s,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(t=c.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(o=c[n]))return e;if(i=10,o.length>1&&"0"==o.charAt(0)&&(i=U.test(o)?16:8,o=o.slice(8==i?1:2)),""===o)a=0;else{if(!(10==i?L:8==i?N:M).test(o))return e;a=parseInt(o,i)}r.push(a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=b(256,5-t))return null}else if(a>255)return null;for(s=r.pop(),n=0;n<r.length;n++)s+=r[n]*b(256,3-n);return s},K=function(e){var t,r,n,o,i,a,s,c=[0,0,0,0,0,0,0,0],u=0,l=null,h=0,d=function(){return e.charAt(h)};if(":"==d()){if(":"!=e.charAt(1))return;h+=2,l=++u}for(;d();){if(8==u)return;if(":"!=d()){for(t=r=0;r<4&&M.test(d());)t=16*t+parseInt(d(),16),h++,r++;if("."==d()){if(0==r)return;if(h-=r,u>6)return;for(n=0;d();){if(o=null,n>0){if(!("."==d()&&n<4))return;h++}if(!P.test(d()))return;for(;P.test(d());){if(i=parseInt(d(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;h++}c[u]=256*c[u]+o,2!=++n&&4!=n||u++}if(4!=n)return;break}if(":"==d()){if(h++,!d())return}else if(d())return;c[u++]=t}else{if(null!==l)return;h++,l=++u}}if(null!==l)for(a=u-l,u=7;0!=u&&a>0;)s=c[u],c[u--]=c[l+a-1],c[l+--a]=s;else if(8!=u)return;return c},G=function(e){var t,r,n,o;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=A(e/256);return t.join(".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,o=0,i=0;i<8;i++)0!==e[i]?(o>r&&(t=n,r=o),n=null,o=0):(null===n&&(n=i),++o);return o>r&&(t=n,r=o),t}(e),r=0;r<8;r++)o&&0===e[r]||(o&&(o=!1),n===r?(t+=r?":":"::",o=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}return e},B={},z=d({},B,{" ":1,'"':1,"<":1,">":1,"`":1}),W=d({},z,{"#":1,"?":1,"{":1,"}":1}),J=d({},W,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),V=function(e,t){var r=f(e,0);return r>32&&r<127&&!h(t,e)?e:encodeURIComponent(e)},Q={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Y=function(e){return h(Q,e.scheme)},X=function(e){return""!=e.username||""!=e.password},Z=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},$=function(e,t){var r;return 2==e.length&&k.test(e.charAt(0))&&(":"==(r=e.charAt(1))||!t&&"|"==r)},ee=function(e){var t;return e.length>1&&$(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},te=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&$(t[0],!0)||t.pop()},re=function(e){return"."===e||"%2e"===e.toLowerCase()},ne={},oe={},ie={},ae={},se={},ce={},ue={},le={},he={},de={},pe={},fe={},ge={},ye={},me={},ve={},Ee={},we={},Ce={},Te={},Se={},Ae=function(e,t,r,o){var i,a,s,c,u,l=r||ne,d=0,f="",g=!1,y=!1,m=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(D,"")),t=t.replace(F,""),i=p(t);d<=i.length;){switch(a=i[d],l){case ne:if(!a||!k.test(a)){if(r)return I;l=ie;continue}f+=a.toLowerCase(),l=oe;break;case oe:if(a&&(O.test(a)||"+"==a||"-"==a||"."==a))f+=a.toLowerCase();else{if(":"!=a){if(r)return I;f="",l=ie,d=0;continue}if(r&&(Y(e)!=h(Q,f)||"file"==f&&(X(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,r)return void(Y(e)&&Q[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?l=ye:Y(e)&&o&&o.scheme==e.scheme?l=ae:Y(e)?l=le:"/"==i[d+1]?(l=se,d++):(e.cannotBeABaseURL=!0,e.path.push(""),l=Ce)}break;case ie:if(!o||o.cannotBeABaseURL&&"#"!=a)return I;if(o.cannotBeABaseURL&&"#"==a){e.scheme=o.scheme,e.path=o.path.slice(),e.query=o.query,e.fragment="",e.cannotBeABaseURL=!0,l=Se;break}l="file"==o.scheme?ye:ce;continue;case ae:if("/"!=a||"/"!=i[d+1]){l=ce;continue}l=he,d++;break;case se:if("/"==a){l=de;break}l=we;continue;case ce:if(e.scheme=o.scheme,a==n)e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=o.path.slice(),e.query=o.query;else if("/"==a||"\\"==a&&Y(e))l=ue;else if("?"==a)e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=o.path.slice(),e.query="",l=Te;else{if("#"!=a){e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=o.path.slice(),e.path.pop(),l=we;continue}e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=o.path.slice(),e.query=o.query,e.fragment="",l=Se}break;case ue:if(!Y(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,l=we;continue}l=de}else l=he;break;case le:if(l=he,"/"!=a||"/"!=f.charAt(d+1))continue;d++;break;case he:if("/"!=a&&"\\"!=a){l=de;continue}break;case de:if("@"==a){g&&(f="%40"+f),g=!0,s=p(f);for(var v=0;v<s.length;v++){var E=s[v];if(":"!=E||m){var w=V(E,J);m?e.password+=w:e.username+=w}else m=!0}f=""}else if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&Y(e)){if(g&&""==f)return"Invalid authority";d-=p(f).length+1,f="",l=pe}else f+=a;break;case pe:case fe:if(r&&"file"==e.scheme){l=ve;continue}if(":"!=a||y){if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&Y(e)){if(Y(e)&&""==f)return R;if(r&&""==f&&(X(e)||null!==e.port))return;if(c=j(e,f))return c;if(f="",l=Ee,r)return;continue}"["==a?y=!0:"]"==a&&(y=!1),f+=a}else{if(""==f)return R;if(c=j(e,f))return c;if(f="",l=ge,r==fe)return}break;case ge:if(!P.test(a)){if(a==n||"/"==a||"?"==a||"#"==a||"\\"==a&&Y(e)||r){if(""!=f){var C=parseInt(f,10);if(C>65535)return _;e.port=Y(e)&&C===Q[e.scheme]?null:C,f=""}if(r)return;l=Ee;continue}return _}f+=a;break;case ye:if(e.scheme="file","/"==a||"\\"==a)l=me;else{if(!o||"file"!=o.scheme){l=we;continue}if(a==n)e.host=o.host,e.path=o.path.slice(),e.query=o.query;else if("?"==a)e.host=o.host,e.path=o.path.slice(),e.query="",l=Te;else{if("#"!=a){ee(i.slice(d).join(""))||(e.host=o.host,e.path=o.path.slice(),te(e)),l=we;continue}e.host=o.host,e.path=o.path.slice(),e.query=o.query,e.fragment="",l=Se}}break;case me:if("/"==a||"\\"==a){l=ve;break}o&&"file"==o.scheme&&!ee(i.slice(d).join(""))&&($(o.path[0],!0)?e.path.push(o.path[0]):e.host=o.host),l=we;continue;case ve:if(a==n||"/"==a||"\\"==a||"?"==a||"#"==a){if(!r&&$(f))l=we;else if(""==f){if(e.host="",r)return;l=Ee}else{if(c=j(e,f))return c;if("localhost"==e.host&&(e.host=""),r)return;f="",l=Ee}continue}f+=a;break;case Ee:if(Y(e)){if(l=we,"/"!=a&&"\\"!=a)continue}else if(r||"?"!=a)if(r||"#"!=a){if(a!=n&&(l=we,"/"!=a))continue}else e.fragment="",l=Se;else e.query="",l=Te;break;case we:if(a==n||"/"==a||"\\"==a&&Y(e)||!r&&("?"==a||"#"==a)){if(".."===(u=(u=f).toLowerCase())||"%2e."===u||".%2e"===u||"%2e%2e"===u?(te(e),"/"==a||"\\"==a&&Y(e)||e.path.push("")):re(f)?"/"==a||"\\"==a&&Y(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&$(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(a==n||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",l=Te):"#"==a&&(e.fragment="",l=Se)}else f+=V(a,W);break;case Ce:"?"==a?(e.query="",l=Te):"#"==a?(e.fragment="",l=Se):a!=n&&(e.path[0]+=V(a,B));break;case Te:r||"#"!=a?a!=n&&("'"==a&&Y(e)?e.query+="%27":e.query+="#"==a?"%23":V(a,B)):(e.fragment="",l=Se);break;case Se:a!=n&&(e.fragment+=V(a,z))}d++}},be=function(e){var t,r,n=l(this,be,"URL"),o=arguments.length>1?arguments[1]:void 0,a=String(e),s=T(n,{type:"URL"});if(void 0!==o)if(o instanceof be)t=S(o);else if(r=Ae(t={},String(o)))throw TypeError(r);if(r=Ae(s,a,null,t))throw TypeError(r);var c=s.searchParams=new w,u=C(c);u.updateSearchParams(s.query),u.updateURL=function(){s.query=String(c)||null},i||(n.href=Re.call(n),n.origin=_e.call(n),n.protocol=ke.call(n),n.username=Oe.call(n),n.password=Pe.call(n),n.host=Ue.call(n),n.hostname=Ne.call(n),n.port=Le.call(n),n.pathname=Me.call(n),n.search=xe.call(n),n.searchParams=qe.call(n),n.hash=De.call(n))},Ie=be.prototype,Re=function(){var e=S(this),t=e.scheme,r=e.username,n=e.password,o=e.host,i=e.port,a=e.path,s=e.query,c=e.fragment,u=t+":";return null!==o?(u+="//",X(e)&&(u+=r+(n?":"+n:"")+"@"),u+=G(o),null!==i&&(u+=":"+i)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+a.join("/"):"",null!==s&&(u+="?"+s),null!==c&&(u+="#"+c),u},_e=function(){var e=S(this),t=e.scheme,r=e.port;if("blob"==t)try{return new be(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&Y(e)?t+"://"+G(e.host)+(null!==r?":"+r:""):"null"},ke=function(){return S(this).scheme+":"},Oe=function(){return S(this).username},Pe=function(){return S(this).password},Ue=function(){var e=S(this),t=e.host,r=e.port;return null===t?"":null===r?G(t):G(t)+":"+r},Ne=function(){var e=S(this).host;return null===e?"":G(e)},Le=function(){var e=S(this).port;return null===e?"":String(e)},Me=function(){var e=S(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},xe=function(){var e=S(this).query;return e?"?"+e:""},qe=function(){return S(this).searchParams},De=function(){var e=S(this).fragment;return e?"#"+e:""},Fe=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(i&&c(Ie,{href:Fe(Re,(function(e){var t=S(this),r=String(e),n=Ae(t,r);if(n)throw TypeError(n);C(t.searchParams).updateSearchParams(t.query)})),origin:Fe(_e),protocol:Fe(ke,(function(e){var t=S(this);Ae(t,String(e)+":",ne)})),username:Fe(Oe,(function(e){var t=S(this),r=p(String(e));if(!Z(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=V(r[n],J)}})),password:Fe(Pe,(function(e){var t=S(this),r=p(String(e));if(!Z(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=V(r[n],J)}})),host:Fe(Ue,(function(e){var t=S(this);t.cannotBeABaseURL||Ae(t,String(e),pe)})),hostname:Fe(Ne,(function(e){var t=S(this);t.cannotBeABaseURL||Ae(t,String(e),fe)})),port:Fe(Le,(function(e){var t=S(this);Z(t)||(""==(e=String(e))?t.port=null:Ae(t,e,ge))})),pathname:Fe(Me,(function(e){var t=S(this);t.cannotBeABaseURL||(t.path=[],Ae(t,e+"",Ee))})),search:Fe(xe,(function(e){var t=S(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",Ae(t,e,Te)),C(t.searchParams).updateSearchParams(t.query)})),searchParams:Fe(qe),hash:Fe(De,(function(e){var t=S(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",Ae(t,e,Se)):t.fragment=null}))}),u(Ie,"toJSON",(function(){return Re.call(this)}),{enumerable:!0}),u(Ie,"toString",(function(){return Re.call(this)}),{enumerable:!0}),E){var je=E.createObjectURL,He=E.revokeObjectURL;je&&u(be,"createObjectURL",(function(e){return je.apply(E,arguments)})),He&&u(be,"revokeObjectURL",(function(e){return He.apply(E,arguments)}))}y(be,"URL"),o({global:!0,forced:!a,sham:!i},{URL:be})},2621:function(e,t,r){"use strict";r(6865)({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},4366:function(e,t,r){var n=r(4692);e.exports=n},4681:function(e,t,r){var n=r(3443);e.exports=n},4692:function(e,t,r){r(1026);var n=r(7410);e.exports=n.URLSearchParams},3443:function(e,t,r){r(6490),r(2621),r(1026);var n=r(7410);e.exports=n.URL},2309:function(e){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./node_modules/@azure/msal-browser/dist/index.es.js":function(e,t,r){"use strict";r.r(t),r.d(t,"AccountEntity",(function(){return wr})),r.d(t,"AuthError",(function(){return re})),r.d(t,"AuthErrorMessage",(function(){return te})),r.d(t,"AuthenticationScheme",(function(){return Y})),r.d(t,"BrowserAuthError",(function(){return An})),r.d(t,"BrowserAuthErrorMessage",(function(){return Sn})),r.d(t,"BrowserCacheLocation",(function(){return en})),r.d(t,"BrowserConfigurationAuthError",(function(){return Un})),r.d(t,"BrowserConfigurationAuthErrorMessage",(function(){return Pn})),r.d(t,"BrowserUtils",(function(){return Fn})),r.d(t,"EventMessageUtils",(function(){return Qn})),r.d(t,"EventType",(function(){return mn})),r.d(t,"InteractionRequiredAuthError",(function(){return Hr})),r.d(t,"InteractionStatus",(function(){return an})),r.d(t,"InteractionType",(function(){return on})),r.d(t,"LogLevel",(function(){return ee})),r.d(t,"Logger",(function(){return kt})),r.d(t,"ProtocolMode",(function(){return zr})),r.d(t,"PublicClientApplication",(function(){return Jn})),r.d(t,"StringUtils",(function(){return Rt})),r.d(t,"UrlString",(function(){return Br})),r.d(t,"WrapperSKU",(function(){return gn})),r.d(t,"stubbedPublicClientApplication",(function(){return Vn}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function h(e,t){function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function p(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function f(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}var y,m,v,E,w,C="msal.js.common",T="msal",S="https://login.microsoftonline.com/common/",A="adfs",b="https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",I="|",R="openid",_="profile",k="offline_access",O="code",P="S256",U="application/x-www-form-urlencoded;charset=utf-8",N="authorization_pending",L="not_defined",M="",x="/";!function(e){e.CONTENT_TYPE="Content-Type",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.RETRY_AFTER="Retry-After",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.X_MS_LIB_CAPABILITY_VALUE="retry-after, h429"}(y||(y={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description"}(m||(m={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(v||(v={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci"}(E||(E={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(w||(w={}));var q,D={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(q||(q={})),q.SID,q.LOGIN_HINT;var F,j,H,K,G,B,z,W={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(F||(F={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(j||(j={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(H||(H={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(K||(K={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken"}(G||(G={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(B||(B={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(z||(z={}));var J,V="authority-metadata",Q=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(J||(J={}));var Y,X={SCHEMA_VERSION:2,MAX_HEADER_BYTES:4e3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(Y||(Y={}));var Z,$="throttling";!function(e){e.username="username",e.password="password"}(Z||(Z={}));var ee,te={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},re=function(e){function t(r,n,o){var i=this,a=n?r+": "+n:r;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||M,i.errorMessage=n||"",i.subError=o||"",i.name="AuthError",i}return h(t,e),t.createUnexpectedError=function(e){return new t(te.unexpectedError.code,te.unexpectedError.desc+": "+e)},t}(Error),ne={createNewGuid:function(){throw re.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw re.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw re.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return p(this,void 0,void 0,(function(){return f(this,(function(e){throw re.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return p(this,void 0,void 0,(function(){return f(this,(function(e){throw re.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},signJwt:function(){return p(this,void 0,void 0,(function(){return f(this,(function(e){throw re.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}},oe="client_info_decoding_error",ie="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",ae="client_info_empty_error",se="The client info was empty. Please review the trace to determine the root cause.",ce="token_parsing_error",ue="Token cannot be parsed. Please review stack trace to determine root cause.",le="null_or_empty_token",he="The token is null or empty. Please review the trace to determine the root cause.",de="endpoints_resolution_error",pe="Error: could not resolve endpoints. Please check network and try again.",fe="openid_config_error",ge="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",ye="hash_not_deserialized",me="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",ve="invalid_state",Ee="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",we="state_mismatch",Ce="State mismatch error. Please check your network. Continued requests may cause cache overflow.",Te="state_not_found",Se="State not found",Ae="nonce_mismatch",be="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",Ie="nonce_not_found",Re="nonce not found",_e="no_tokens_found",ke="No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken().",Oe="multiple_matching_tokens",Pe="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",Ue="multiple_matching_accounts",Ne="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",Le="multiple_matching_appMetadata",Me="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",xe="request_cannot_be_made",qe="Token request cannot be made without authorization code or refresh token.",De="cannot_append_empty_scope",Fe="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",je="cannot_remove_empty_scope",He="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",Ke="cannot_append_scopeset",Ge="Cannot append ScopeSet due to error.",Be="empty_input_scopeset",ze="Empty input ScopeSet cannot be processed.",We="device_code_polling_cancelled",Je="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",Ve="device_code_expired",Qe="Device code is expired.",Ye="no_account_in_silent_request",Xe="Please pass an account object, silent flow is not supported without account information",Ze="invalid_cache_record",$e="Cache record object was null or undefined.",et="invalid_cache_environment",tt="Invalid environment when attempting to create cache entry",rt="no_account_found",nt="No account found in cache for given key.",ot="no cache plugin set on CacheManager",it="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",at="no_crypto_object",st="No crypto object detected. This is required for the following operation: ",ct="invalid_cache_type",ut="Invalid cache type",lt="unexpected_account_type",ht="Unexpected account type.",dt="unexpected_credential_type",pt="Unexpected credential type.",ft="invalid_assertion",gt="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",yt="invalid_client_credential",mt="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",vt="token_refresh_required",Et="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",wt="user_timeout_reached",Ct="User defined timeout for device code polling reached",Tt="token_claims_cnf_required_for_signedjwt",St="Cannot generate a POP jwt if the token_claims are not populated",At="authorization_code_missing_from_server_response",bt="Srver response does not contain an authorization code to proceed",It=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.createClientInfoDecodingError=function(e){return new t(oe,ie+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ae,""+se)},t.createTokenParsingError=function(e){return new t(ce,ue+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(le,he+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(de,pe+" Detail: "+e)},t.createUnableToGetOpenidConfigError=function(e){return new t(fe,ge+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(ye,me+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(ve,Ee+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(we,Ce)},t.createStateNotFoundError=function(e){return new t(Te,Se+":  "+e)},t.createNonceMismatchError=function(){return new t(Ae,be)},t.createNonceNotFoundError=function(e){return new t(Ie,Re+":  "+e)},t.createNoTokensFoundError=function(){return new t(_e,ke)},t.createMultipleMatchingTokensInCacheError=function(){return new t(Oe,Pe+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(Ue,Ne)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(Le,Me)},t.createTokenRequestCannotBeMadeError=function(){return new t(xe,qe)},t.createAppendEmptyScopeToSetError=function(e){return new t(De,Fe+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(je,He+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(Ke,Ge+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(e){return new t(Be,ze+" Given ScopeSet: "+e)},t.createDeviceCodeCancelledError=function(){return new t(We,""+Je)},t.createDeviceCodeExpiredError=function(){return new t(Ve,""+Qe)},t.createNoAccountInSilentRequestError=function(){return new t(Ye,""+Xe)},t.createNullOrUndefinedCacheRecord=function(){return new t(Ze,$e)},t.createInvalidCacheEnvironmentError=function(){return new t(et,tt)},t.createNoAccountFoundError=function(){return new t(rt,nt)},t.createCachePluginError=function(){return new t(ot,""+it)},t.createNoCryptoObjectError=function(e){return new t(at,""+st+e)},t.createInvalidCacheTypeError=function(){return new t(ct,""+ut)},t.createUnexpectedAccountTypeError=function(){return new t(lt,""+ht)},t.createUnexpectedCredentialTypeError=function(){return new t(dt,""+pt)},t.createInvalidAssertionError=function(){return new t(ft,""+gt)},t.createInvalidCredentialError=function(){return new t(yt,""+mt)},t.createRefreshRequiredError=function(){return new t(vt,Et)},t.createUserTimeoutReachedError=function(){return new t(wt,Ct)},t.createTokenClaimsRequiredError=function(){return new t(Tt,St)},t.createNoAuthCodeInServerResponseError=function(){return new t(At,bt)},t}(re),Rt=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw It.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw It.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(decodeURIComponent(e.replace(r," ")))},i={};for(t=n.exec(e);t;)i[o(t[1])]=o(t[2]),t=n.exec(e);return i},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\*/g,"[^ ]*")).test(t)},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(ee||(ee={}));var _t,kt=function(){function e(e,t,r){this.level=ee.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level=e.logLevel||ee.Info,this.packageName=t||M,this.packageVersion=r||M}return e.prototype.clone=function(t,r){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Rt.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+ee[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:ee.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:ee.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:ee.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:ee.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:ee.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:ee.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:ee.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:ee.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),Ot="3.1.0",Pt=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},e.prototype.generateType=function(){switch(this.credentialType){case G.ID_TOKEN:return z.ID_TOKEN;case G.ACCESS_TOKEN:return z.ACCESS_TOKEN;case G.REFRESH_TOKEN:return z.REFRESH_TOKEN;default:throw It.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(G.ACCESS_TOKEN.toLowerCase())?G.ACCESS_TOKEN:-1!==e.indexOf(G.ID_TOKEN.toLowerCase())?G.ID_TOKEN:-1!==e.indexOf(G.REFRESH_TOKEN.toLowerCase())?G.REFRESH_TOKEN:L},e.generateCredentialCacheKey=function(e,t,r,n,o,i,a){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===G.REFRESH_TOKEN&&n||t,r||""].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),Ut="redirect_uri_empty",Nt="A redirect URI is required for all calls, and none has been set.",Lt="post_logout_uri_empty",Mt="A post logout redirect has not been set.",xt="claims_request_parsing_error",qt="Could not parse the given claims request object.",Dt="authority_uri_insecure",Ft="Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",jt="url_parse_error",Ht="URL could not be parsed into appropriate segments.",Kt="empty_url_error",Gt="URL was empty or null.",Bt="empty_input_scopes_error",zt="Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",Wt="nonarray_input_scopes_error",Jt="Scopes cannot be passed as non-array.",Vt="clientid_input_scopes_error",Qt="Client ID can only be provided as a single scope.",Yt="invalid_prompt_value",Xt="Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",Zt="invalid_claims",$t="Given claims parameter must be a stringified JSON object.",er="token_request_empty",tr="Token request was empty and not found in cache.",rr="logout_request_empty",nr="The logout request was null or undefined.",or="invalid_code_challenge_method",ir='code_challenge_method passed is invalid. Valid values are "plain" and "S256".',ar="pkce_params_missing",sr="Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",cr="invalid_cloud_discovery_metadata",ur="Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields",lr="invalid_authority_metadata",hr="Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields.",dr="untrusted_authority",pr="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",fr="resourceRequest_parameters_required",gr="resourceRequestMethod and resourceRequestUri are required",yr=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.createRedirectUriEmptyError=function(){return new t(Ut,Nt)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Lt,Mt)},t.createClaimsRequestParsingError=function(e){return new t(xt,qt+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(Dt,Ft+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(jt,Ht+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(Kt,Gt)},t.createScopesNonArrayError=function(e){return new t(Wt,Jt+" Given Scopes: "+e)},t.createEmptyScopesArrayError=function(e){return new t(Bt,zt+" Given Scopes: "+e)},t.createClientIdSingleScopeError=function(e){return new t(Vt,Qt+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(Yt,Xt+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(Zt,$t)},t.createEmptyLogoutRequestError=function(){return new t(rr,nr)},t.createEmptyTokenRequestError=function(){return new t(er,tr)},t.createInvalidCodeChallengeMethodError=function(){return new t(or,ir)},t.createInvalidCodeChallengeParamsError=function(){return new t(ar,sr)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(cr,ur)},t.createInvalidAuthorityMetadataError=function(){return new t(lr,hr)},t.createUntrustedAuthorityError=function(){return new t(dr,pr)},t.createResourceRequestParametersRequiredError=function(){return new t(fr,gr)},t}(It),mr=function(){function e(e){var t=this,r=e?Rt.trimArrayEntries(g(e)):[],n=r?Rt.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t=t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw yr.createEmptyScopesArrayError(e)},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!Rt.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)}))},e.prototype.containsOnlyDefaultScopes=function(){var e=0;return this.containsScope(R)&&(e+=1),this.containsScope(_)&&(e+=1),this.containsScope(k)&&(e+=1),this.scopes.size===e},e.prototype.appendScope=function(e){Rt.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw It.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(Rt.isEmpty(e))throw It.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeDefaultScopes=function(){this.scopes.delete(k),this.scopes.delete(R),this.scopes.delete(_)},e.prototype.unionScopeSets=function(e){if(!e)throw It.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw It.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e);e.containsOnlyDefaultScopes()||e.removeDefaultScopes();var r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();function vr(e,t){if(Rt.isEmpty(e))throw It.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw It.createClientInfoDecodingError(e)}}!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(_t||(_t={}));var Er,wr=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case H.ADFS_ACCOUNT_TYPE:return z.ADFS;case H.MSAV1_ACCOUNT_TYPE:return z.MSA;case H.MSSTS_ACCOUNT_TYPE:return z.MSSTS;case H.GENERIC_ACCOUNT_TYPE:return z.GENERIC;default:throw It.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s){var c,u,l,h,d,p,f=new e;f.authorityType=H.MSSTS_ACCOUNT_TYPE,f.clientInfo=t,f.homeAccountId=r;var g=n.getPreferredCache();if(Rt.isEmpty(g))throw It.createInvalidCacheEnvironmentError();return f.environment=g,f.realm=(null===(c=null==o?void 0:o.claims)||void 0===c?void 0:c.tid)||"",f.oboAssertion=i,o&&(f.idTokenClaims=o.claims,f.localAccountId=(null===(u=null==o?void 0:o.claims)||void 0===u?void 0:u.oid)||(null===(l=null==o?void 0:o.claims)||void 0===l?void 0:l.sub)||"",f.username=(null===(h=null==o?void 0:o.claims)||void 0===h?void 0:h.preferred_username)||((null===(d=null==o?void 0:o.claims)||void 0===d?void 0:d.emails)?o.claims.emails[0]:""),f.name=null===(p=null==o?void 0:o.claims)||void 0===p?void 0:p.name),f.cloudGraphHostName=a,f.msGraphHost=s,f},e.createGenericAccount=function(t,r,n,o,i,a){var s,c,u,l,h=new e;h.authorityType=t.authorityType===_t.Adfs?H.ADFS_ACCOUNT_TYPE:H.GENERIC_ACCOUNT_TYPE,h.homeAccountId=r,h.realm="",h.oboAssertion=o;var d=t.getPreferredCache();if(Rt.isEmpty(d))throw It.createInvalidCacheEnvironmentError();return n&&(h.localAccountId=(null===(s=null==n?void 0:n.claims)||void 0===s?void 0:s.oid)||(null===(c=null==n?void 0:n.claims)||void 0===c?void 0:c.sub)||"",h.username=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.upn)||"",h.name=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.name)||"",h.idTokenClaims=null==n?void 0:n.claims),h.environment=d,h.cloudGraphHostName=i,h.msGraphHost=a,h},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:M;if(t===_t.Adfs)return a;if(e){var s=vr(e,n);if(!Rt.isEmpty(s.uid)&&!Rt.isEmpty(s.utid))return""+s.uid+K.CLIENT_INFO_SEPARATOR+s.utid}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},e.accountInfoIsEqual=function(e,t){return!(!e||!t)&&e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment},e}(),Cr=function(){function e(t,r){if(Rt.isEmpty(t))throw It.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=Rt.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw It.createTokenParsingError(e)}},e}(),Tr=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new wr,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new Cr(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){if(!e)throw It.createNullOrUndefinedCacheRecord();e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)},e.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:G.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=mr.fromString(e.target),o=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]}));o&&o.forEach((function(e){mr.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)})),this.setAccessTokenCredential(e)},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=n.getAccount(o);a&&(e&&!n.matchHomeAccountId(a,e)||t&&!n.matchEnvironment(a,t)||r&&!n.matchRealm(a,r)||(i[o]=a))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,a,s){var c=this,u=this.getKeys(),l={idTokens:{},accessTokens:{},refreshTokens:{}};return u.forEach((function(u){var h=Pt.getCredentialType(u);if(h!==L){var d=c.getSpecificCredential(u,h);if(d&&(!s||c.matchOboAssertion(d,s))&&(!e||c.matchHomeAccountId(d,e))&&(!t||c.matchEnvironment(d,t))&&(!i||c.matchRealm(d,i))&&(!r||c.matchCredentialType(d,r))&&(!n||c.matchClientId(d,n))&&(!o||c.matchFamilyId(d,o))&&(!a||c.matchTarget(d,a)))switch(h){case G.ID_TOKEN:l.idTokens[u]=d;break;case G.ACCESS_TOKEN:l.accessTokens[u]=d;break;case G.REFRESH_TOKEN:l.refreshTokens[u]=d}}})),l},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){var e=this;return this.getKeys().forEach((function(t){e.getAccount(t)&&e.removeAccount(t)})),!0},e.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw It.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,B.ACCOUNT)},e.prototype.removeAccountContext=function(e){var t=this,r=this.getKeys(),n=e.generateAccountId();return r.forEach((function(e){var r=Pt.getCredentialType(e);if(r!==L){var o=t.getSpecificCredential(e,r);o&&n===o.generateAccountId()&&t.removeCredential(o)}})),!0},e.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,B.CREDENTIAL)},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,B.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n){var o=this.readAccountFromCache(e),i=this.readIdTokenFromCache(t,e),a=this.readAccessTokenFromCache(t,e,r),s=this.readRefreshTokenFromCache(t,e,!1),c=this.readAppMetadataFromCache(n,t);return o&&i&&(o.idTokenClaims=new Cr(i.secret,this.cryptoImpl).claims),{account:o,idToken:i,accessToken:a,refreshToken:s,appMetadata:c}},e.prototype.readAccountFromCache=function(e){var t=wr.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:G.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw It.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:G.ACCESS_TOKEN,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},o=this.getCredentialsFilteredBy(n),i=Object.keys(o.accessTokens).map((function(e){return o.accessTokens[e]})),a=i.length;if(a<1)return null;if(a>1)throw It.createMultipleMatchingTokensInCacheError();return i[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?"1":void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:G.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return a.length<1?null:a[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw It.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||"1"!==r.familyId)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==G.ACCESS_TOKEN||!e.target)return!1;var r=mr.fromString(e.target),n=mr.fromString(t);return n.containsOnlyDefaultScopes()||n.removeDefaultScopes(),r.containsScopeSet(n)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf("appmetadata")},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(V)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return V+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case G.ID_TOKEN:return this.getIdTokenCredential(e);case G.ACCESS_TOKEN:return this.getAccessTokenCredential(e);case G.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),Sr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.prototype.setAccount=function(){throw re.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw re.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw re.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw re.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw re.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw re.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw re.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw re.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw re.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw re.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw re.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw re.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw re.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw re.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw re.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw re.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw re.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw re.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw re.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw re.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){throw re.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},t}(Tr),Ar={tokenRenewalOffsetSeconds:300},br={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:ee.Info},Ir={sendGetRequestAsync:function(){return p(this,void 0,void 0,(function(){return f(this,(function(e){throw re.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return p(this,void 0,void 0,(function(){return f(this,(function(e){throw re.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Rr={sku:C,version:Ot,cpu:"",os:""},_r={clientSecret:"",clientAssertion:void 0},kr=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return h(t,e),t}(re),Or=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return $+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,B.THROTTLING);throw new kr((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||M,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[y.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(y.RETRY_AFTER)&&(e.status<200||e.status>=300)},e.calculateThrottleTime=function(e){e<=0&&(e=0);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||60),t+3600))},e.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},a=this.generateThrottlingStorageKey(i);return e.removeItem(a,B.THROTTLING)},e}(),Pr=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return p(this,void 0,void 0,(function(){var n;return f(this,(function(o){switch(o.label){case 0:return Or.preProcess(this.cacheManager,e),[4,this.networkClient.sendPostRequestAsync(t,r)];case 1:return n=o.sent(),Or.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}(),Ur=function(){function e(e){var t,r,n,o,i,a,s,c,u,l,h,p,f;this.config=(n=(t=e).authOptions,o=t.systemOptions,i=t.loggerOptions,a=t.storageInterface,s=t.networkInterface,c=t.cryptoInterface,u=t.clientCredentials,l=t.libraryInfo,h=t.serverTelemetryManager,p=t.persistencePlugin,f=t.serializableCache,{authOptions:(r=n,d({clientCapabilities:[]},r)),systemOptions:d(d({},Ar),o),loggerOptions:d(d({},br),i),storageInterface:a||new Sr(n.clientId,ne),networkInterface:s||Ir,cryptoInterface:c||ne,clientCredentials:u||_r,libraryInfo:d(d({},Rr),l),serverTelemetryManager:h||null,persistencePlugin:p||null,serializableCache:f||null}),this.logger=new kt(this.config.loggerOptions,"@azure/msal-common",Ot),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Pr(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[y.CONTENT_TYPE]=U,e[y.X_MS_LIB_CAPABILITY]=y.X_MS_LIB_CAPABILITY_VALUE,this.serverTelemetryManager&&(e[y.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[y.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},e.prototype.createDefaultLibraryHeaders=function(){var e={};return e[E.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[E.X_CLIENT_VER]=this.config.libraryInfo.version,e[E.X_CLIENT_OS]=this.config.libraryInfo.os,e[E.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return p(this,void 0,void 0,(function(){var o;return f(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw It.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),Nr=function(){function e(){}return e.validateRedirectUri=function(e){if(Rt.isEmpty(e))throw yr.createRedirectUriEmptyError()},e.validatePrompt=function(e){if([D.LOGIN,D.SELECT_ACCOUNT,D.CONSENT,D.NONE].indexOf(e)<0)throw yr.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw yr.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Rt.isEmpty(e)||Rt.isEmpty(t))throw yr.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([W.PLAIN,W.S256].indexOf(e)<0)throw yr.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),Lr=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(E.RESPONSE_TYPE,encodeURIComponent(O))},e.prototype.addResponseMode=function(e){this.parameters.set(E.RESPONSE_MODE,encodeURIComponent(e||F.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?g(e||[],[R,_]):e||[],n=new mr(r);this.parameters.set(E.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(E.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Nr.validateRedirectUri(e),this.parameters.set(E.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Nr.validateRedirectUri(e),this.parameters.set(E.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(E.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(q.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(q.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addSid=function(e){this.parameters.set(q.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Nr.validateClaims(r),this.parameters.set(E.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(E.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(E.X_CLIENT_SKU,e.sku),this.parameters.set(E.X_CLIENT_VER,e.version),this.parameters.set(E.X_CLIENT_OS,e.os),this.parameters.set(E.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){Nr.validatePrompt(e),this.parameters.set(""+E.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Rt.isEmpty(e)||this.parameters.set(E.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(E.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Nr.validateCodeChallengeParams(e,t),!e||!t)throw yr.createInvalidCodeChallengeParamsError();this.parameters.set(E.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(E.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(E.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(E.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(E.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(E.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(E.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(E.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(E.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(E.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(E.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(E.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;Nr.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw yr.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(w.ACCESS_TOKEN)||(r[w.ACCESS_TOKEN]={}),r[w.ACCESS_TOKEN][w.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(Z.username,e)},e.prototype.addPassword=function(e){this.parameters.set(Z.password,e)},e.prototype.addPopToken=function(e){Rt.isEmpty(e)||(this.parameters.set(E.TOKEN_TYPE,Y.POP),this.parameters.set(E.REQ_CNF,encodeURIComponent(e)))},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createIdTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.credentialType=G.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=o,s.secret=n,s.realm=i,s.oboAssertion=a,s},t.isIdTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===G.ID_TOKEN},t}(Pt),xr=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e}(),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,a,s,c,u,l){var h=new t;h.homeAccountId=e,h.credentialType=G.ACCESS_TOKEN,h.secret=n;var d=xr.nowSeconds();return h.cachedAt=d.toString(),h.expiresOn=s.toString(),h.extendedExpiresOn=c.toString(),h.environment=r,h.clientId=o,h.realm=i,h.target=a,h.oboAssertion=l,h.tokenType=Rt.isEmpty(u)?Y.BEARER:u,h},t.isAccessTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===G.ACCESS_TOKEN},t}(Pt),Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.clientId=o,s.credentialType=G.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.oboAssertion=a,i&&(s.familyId=i),s},t.isRefreshTokenEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===G.REFRESH_TOKEN},t}(Pt),Fr=["interaction_required","consent_required","login_required"],jr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Hr=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return h(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&Fr.indexOf(e)>-1,o=!!r&&jr.indexOf(r)>-1,i=!!t&&Fr.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t}(kr),Kr=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},Gr=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return Rt.isEmpty(r)?o:""+o+I+r},e.generateLibraryState=function(e,t){if(!e)throw It.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw It.createNoCryptoObjectError("parseRequestState");if(Rt.isEmpty(t))throw It.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(I),n=r[0],o=r.length>1?r.slice(1).join(I):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:Rt.isEmpty(o)?"":o,libraryState:a}}catch(e){throw It.createInvalidStateError(t,e)}},e}(),Br=function(){function e(t){if(this._urlString=t,Rt.isEmpty(this._urlString))throw yr.createUrlEmptyError();Rt.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),e.canonicalizeUri=function(e){return e&&(e=e.toLowerCase(),Rt.endsWith(e,"?")?e=e.slice(0,-1):Rt.endsWith(e,"?/")&&(e=e.slice(0,-2)),Rt.endsWith(e,"/")||(e+="/")),e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw yr.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw yr.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw yr.createInsecureAuthorityUriError(this.urlString)},e.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==v.COMMON&&n[0]!==v.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw yr.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!Rt.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw yr.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===x){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Rt.isEmpty(t))return{};var r=e.parseHash(t),n=Rt.queryStringToObject(Rt.isEmpty(r)?t:r);if(!n)throw It.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(Rt.isEmpty(t))return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}();!function(e){e.SW="sw",e.UHW="uhw"}(Er||(Er={}));var zr,Wr=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e,t){return p(this,void 0,void 0,(function(){var r,n;return f(this,(function(o){switch(o.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e,t)];case 1:return r=o.sent(),n={kid:r,xms_ksl:Er.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(n))]}}))}))},e.prototype.signPopToken=function(e,t,r){var n;return p(this,void 0,void 0,(function(){var o,i,a;return f(this,(function(s){switch(s.label){case 0:if(o=Cr.extractTokenClaims(e,this.cryptoUtils),i=new Br(r),a=i.getUrlComponents(),!(null===(n=null==o?void 0:o.cnf)||void 0===n?void 0:n.kid))throw It.createTokenClaimsRequiredError();return[4,this.cryptoUtils.signJwt({at:e,ts:""+xr.nowSeconds(),m:t.toUpperCase(),u:a.HostNameAndPort||"",nonce:this.cryptoUtils.createNewGuid(),p:a.AbsolutePath,q:[[],a.QueryString]},o.cnf.kid)];case 1:return[2,s.sent()]}}))}))},e}(),Jr=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return["appmetadata",e,t].join(K.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf("appmetadata")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},e}(),Vr=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!0,configurable:!0}),e}(),Qr=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?It.createStateNotFoundError("Cached State"):It.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw It.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Hr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Hr(e.error||M,e.error_description,e.suberror);throw new kr(e.error||M,e.error_description,e.suberror)}e.client_info&&vr(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Hr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Hr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new kr(e.error,t)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,a,s,c,u){return p(this,void 0,void 0,(function(){var l,h,d,p,g;return f(this,(function(f){switch(f.label){case 0:if(t.id_token&&(l=new Cr(t.id_token||M,this.cryptoObj),a&&!Rt.isEmpty(a.nonce)&&l.claims.nonce!==a.nonce))throw It.createNonceMismatchError();this.homeAccountIdentifier=wr.generateHomeAccountId(t.client_info||M,r.authorityType,this.logger,this.cryptoObj,l),a&&a.state&&(h=Gr.parseRequestState(this.cryptoObj,a.state)),d=this.generateCacheRecord(t,r,n,l,s,c,a),f.label=1;case 1:return f.trys.push([1,,4,7]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Vr(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(p)]):[3,3];case 2:f.sent(),f.label=3;case 3:return u&&d.account&&(g=d.account.generateAccountKey(),!this.cacheStorage.getAccount(g))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,d,!1,l,h,o,i)]):(this.cacheStorage.saveCacheRecord(d),[3,7]);case 4:return this.persistencePlugin&&this.serializableCache&&p?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(p)]):[3,6];case 5:f.sent(),f.label=6;case 6:return[7];case 7:return[2,e.generateAuthenticationResult(this.cryptoObj,r,d,!1,l,h,o,i)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=t.getPreferredCache();if(Rt.isEmpty(u))throw It.createInvalidCacheEnvironmentError();!Rt.isEmpty(e.id_token)&&n&&(s=Mr.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||M,this.clientId,n.claims.tid||M,i),c=this.generateAccountEntity(e,n,t,i,a));var l=null;if(!Rt.isEmpty(e.access_token)){var h=e.scope?mr.fromString(e.scope):new mr(o||[]),d=r+(e.expires_in||0),p=d+(e.ext_expires_in||0);l=qr.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||M,this.clientId,n?n.claims.tid||M:t.tenant,h.printScopes(),d,p,e.token_type,i)}var f=null;Rt.isEmpty(e.refresh_token)||(f=Dr.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||M,this.clientId,e.foci,i));var g=null;return Rt.isEmpty(e.foci)||(g=Jr.createAppMetadataEntity(this.clientId,u,e.foci)),new Kr(c,s,l,f,g)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===_t.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),wr.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s);if(Rt.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw It.createClientInfoEmptyError();return e.client_info?wr.createAccount(e.client_info,this.homeAccountIdentifier,r,t,n,a,s):wr.createGenericAccount(r,this.homeAccountIdentifier,t,n,a,s)},e.generateAuthenticationResult=function(e,t,r,n,o,i,a,s){var c,u,l;return p(this,void 0,void 0,(function(){var h,d,p,g,y,m,v,E;return f(this,(function(f){switch(f.label){case 0:if(h="",d=[],p=null,y=M,!r.accessToken)return[3,4];if(r.accessToken.tokenType!==Y.POP)return[3,2];if(m=new Wr(e),!a||!s)throw yr.createResourceRequestParametersRequiredError();return[4,m.signPopToken(r.accessToken.secret,a,s)];case 1:return h=f.sent(),[3,3];case 2:h=r.accessToken.secret,f.label=3;case 3:d=mr.fromString(r.accessToken.target).asArray(),p=new Date(1e3*Number(r.accessToken.expiresOn)),g=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),f.label=4;case 4:return r.appMetadata&&(y="1"===r.appMetadata.familyId?"1":M),v=(null==o?void 0:o.claims.oid)||(null==o?void 0:o.claims.sub)||M,E=(null==o?void 0:o.claims.tid)||M,[2,{authority:t.canonicalAuthority,uniqueId:v,tenantId:E,scopes:d,account:r.account?r.account.getAccountInfo():null,idToken:o?o.rawToken:M,idTokenClaims:o?o.claims:{},accessToken:h,fromCache:n,expiresOn:p,extExpiresOn:g,familyId:y,tokenType:(null===(c=r.accessToken)||void 0===c?void 0:c.tokenType)||M,state:i?i.userRequestState:M,cloudGraphHostName:(null===(u=r.account)||void 0===u?void 0:u.cloudGraphHostName)||M,msGraphHost:(null===(l=r.account)||void 0===l?void 0:l.msGraphHost)||M}]}}))}))},e}(),Yr=function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.getAuthCodeUrl=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,this.authority.authorizationEndpoint+"?"+t]}))}))},t.prototype.acquireToken=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o;return f(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||Rt.isEmpty(e.code))throw It.createTokenRequestCannotBeMadeError();return r=xr.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[4,o.handleServerTokenResponse(n.body,this.authority,r,e.resourceRequestMethod,e.resourceRequestUri,t)];case 2:return[2,i.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Br(e),o=Br.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw It.createNoAuthCodeInServerResponseError();return d(d({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw yr.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(wr.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=this.createLogoutUrlQueryString(e);return Rt.isEmpty(t)?this.authority.endSessionEndpoint:this.authority.endSessionEndpoint+"?"+t},t.prototype.executeTokenRequest=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o;return f(this,(function(i){switch(i.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},[4,this.createTokenRequestBody(t)];case 1:return n=i.sent(),o=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,n,o,r)]}}))}))},t.prototype.createTokenRequestBody=function(e){return p(this,void 0,void 0,(function(){var t,r,n,o;return f(this,(function(i){switch(i.label){case 0:return(t=new Lr).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(j.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===Y.POP&&e.resourceRequestMethod&&e.resourceRequestUri?[4,new Wr(this.cryptoUtils).generateCnf(e.resourceRequestMethod,e.resourceRequestUri)]:[3,2];case 1:n=i.sent(),t.addPopToken(n),i.label=2;case 2:return o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new Lr;t.addClientId(this.config.authOptions.clientId);var r=g(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.sid?t.addSid(e.sid):e.loginHint?t.addLoginHint(e.loginHint):e.account&&e.account.username&&t.addLoginHint(e.account.username),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new Lr;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),t.createQueryString()},t}(Ur),Xr=(function(e){function t(t){return e.call(this,t)||this}h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t,r,n,o;return f(this,(function(i){switch(i.label){case 0:return[4,this.getDeviceCode(e)];case 1:return t=i.sent(),e.deviceCodeCallback(t),r=xr.nowSeconds(),[4,this.acquireTokenWithDeviceCode(e,t)];case 2:return n=i.sent(),(o=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n),[4,o.handleServerTokenResponse(n,this.authority,r,e.resourceRequestMethod,e.resourceRequestUri)];case 3:return[2,i.sent()]}}))}))},t.prototype.getDeviceCode=function(e){return p(this,void 0,void 0,(function(){var t,r,n;return f(this,(function(o){return t=this.createQueryString(e),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r,n)]}))}))},t.prototype.executePostRequestToDeviceCodeEndpoint=function(e,t,r,n){return p(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return f(this,(function(h){switch(h.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=h.sent().body,i=o.user_code,a=o.device_code,s=o.verification_uri,c=o.expires_in,u=o.interval,l=o.message,[2,{userCode:i,deviceCode:a,verificationUri:s,expiresIn:c,interval:u,message:l}]}}))}))},t.prototype.createQueryString=function(e){var t=new Lr;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},t.prototype.acquireTokenWithDeviceCode=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o,i,a,s=this;return f(this,(function(c){return r=this.createTokenRequestBody(e,t),n=this.createDefaultTokenRequestHeaders(),o=e.timeout?xr.nowSeconds()+e.timeout:void 0,i=xr.nowSeconds()+t.expiresIn,a=1e3*t.interval,[2,new Promise((function(t,c){var u=setInterval((function(){return p(s,void 0,void 0,(function(){var a,s,l;return f(this,(function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),e.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(u),c(It.createDeviceCodeCancelledError()),[3,5]):[3,1];case 1:return o&&o<i&&xr.nowSeconds()>o?(this.logger.error("User defined timeout for device code polling reached. The timeout was set for "+o),clearInterval(u),c(It.createUserTimeoutReachedError()),[3,5]):[3,2];case 2:return xr.nowSeconds()>i?(o&&this.logger.verbose("User specified timeout ignored as the device code has expired before the timeout elapsed. The user specified timeout was set for "+o),this.logger.error("Device code expired. Expiration time of device code was "+i),clearInterval(u),c(It.createDeviceCodeExpiredError()),[3,5]):[3,3];case 3:return a={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,r,n,a)];case 4:(s=h.sent()).body&&s.body.error===N?this.logger.info(s.body.error_description||"no_error_description"):(clearInterval(u),t(s.body)),h.label=5;case 5:return[3,7];case 6:return l=h.sent(),clearInterval(u),c(l),[3,7];case 7:return[2]}}))}))}),a)}))]}))}))},t.prototype.createTokenRequestBody=function(e,t){var r=new Lr;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType(j.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()}}(Ur),function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t,r,n;return f(this,(function(o){switch(o.label){case 0:return t=xr.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t,e.resourceRequestMethod,e.resourceRequestUri,void 0,[],void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return p(this,void 0,void 0,(function(){var t,r;return f(this,(function(n){if(!e)throw yr.createEmptyTokenRequestError();if(!e.account)throw It.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(n){if(t=n instanceof It&&n.errorCode===_e,r=n instanceof kr&&"invalid_grant"===n.errorCode&&"client_mismatch"===n.subError,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw n}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return p(this,void 0,void 0,(function(){var r,n;return f(this,(function(o){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw It.createNoTokensFoundError();return n=d(d({},e),{refreshToken:r.secret,authenticationScheme:Y.BEARER}),[2,this.acquireToken(n)]}))}))},t.prototype.executeTokenRequest=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o;return f(this,(function(i){switch(i.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=i.sent(),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes},[2,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)]}}))}))},t.prototype.createTokenRequestBody=function(e){return p(this,void 0,void 0,(function(){var t,r,n,o,i,a;return f(this,(function(s){switch(s.label){case 0:if((t=new Lr).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(j.REFRESH_TOKEN_GRANT),t.addClientInfo(),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),e.authenticationScheme!==Y.POP)return[3,2];if(o=new Wr(this.cryptoUtils),!e.resourceRequestMethod||!e.resourceRequestUri)throw yr.createResourceRequestParametersRequiredError();return a=(i=t).addPopToken,[4,o.generateCnf(e.resourceRequestMethod,e.resourceRequestUri)];case 1:a.apply(i,[s.sent()]),s.label=2;case 2:return(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}}))}))},t}(Ur)),Zr=(function(e){function t(t){return e.call(this,t)||this}h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return this.scopeSet=new mr(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:return[2,r.sent()];case 2:return[4,this.getCachedAuthenticationResult()];case 3:return(t=r.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(e,this.authority)];case 5:return[2,r.sent()]}}))}))},t.prototype.getCachedAuthenticationResult=function(){return p(this,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return!(e=this.readAccessTokenFromCache())||xr.isTokenExpired(e.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:[4,Qr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:null,idToken:null,accessToken:e,refreshToken:null,appMetadata:null},!0)];case 1:return[2,t.sent()]}}))}))},t.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:G.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]}));if(r.length<1)return null;if(r.length>1)throw It.createMultipleMatchingTokensInCacheError();return r[0]},t.prototype.executeTokenRequest=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o,i,a,s;return f(this,(function(c){switch(c.label){case 0:return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},i=xr.nowSeconds(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)];case 1:return a=c.sent(),(s=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(a.body),[4,s.handleServerTokenResponse(a.body,this.authority,i,e.resourceRequestMethod,e.resourceRequestUri,void 0,e.scopes)];case 2:return[2,c.sent()]}}))}))},t.prototype.createTokenRequestBody=function(e){var t=new Lr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType(j.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}(Ur),function(e){function t(t){return e.call(this,t)||this}h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return this.scopeSet=new mr(e.scopes||[]),e.skipCache?[4,this.executeTokenRequest(e,this.authority)]:[3,2];case 1:return[2,r.sent()];case 2:return[4,this.getCachedAuthenticationResult(e)];case 3:return(t=r.sent())?[2,t]:[3,4];case 4:return[4,this.executeTokenRequest(e,this.authority)];case 5:return[2,r.sent()]}}))}))},t.prototype.getCachedAuthenticationResult=function(e){return p(this,void 0,void 0,(function(){var t,r,n,o,i,a;return f(this,(function(s){switch(s.label){case 0:return!(t=this.readAccessTokenFromCache(e))||xr.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:(r=this.readIdTokenFromCache(e),o=null,r&&(n=new Cr(r.secret,this.config.cryptoInterface),i=n.claims.oid?n.claims.oid:n.claims.sub,a={homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:M,localAccountId:i||""},o=this.readAccountFromCache(a)),[4,Qr.generateAuthenticationResult(this.cryptoUtils,this.authority,{account:o,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},!0,n)]);case 1:return[2,s.sent()]}}))}))},t.prototype.readAccessTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:G.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase(),oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.accessTokens).map((function(e){return r.accessTokens[e]})),o=n.length;if(o<1)return null;if(o>1)throw It.createMultipleMatchingTokensInCacheError();return n[0]},t.prototype.readIdTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:G.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.idTokens).map((function(e){return r.idTokens[e]}));return n.length<1?null:n[0]},t.prototype.readAccountFromCache=function(e){return this.cacheManager.readAccountFromCache(e)},t.prototype.executeTokenRequest=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o,i,a,s;return f(this,(function(c){switch(c.label){case 0:return r=this.createTokenRequestBody(e),n=this.createDefaultTokenRequestHeaders(),o={clientId:this.config.authOptions.clientId,authority:e.authority,scopes:e.scopes},i=xr.nowSeconds(),[4,this.executePostToTokenEndpoint(t.tokenEndpoint,r,n,o)];case 1:return a=c.sent(),(s=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(a.body),[4,s.handleServerTokenResponse(a.body,this.authority,i,e.resourceRequestMethod,e.resourceRequestUri,void 0,e.scopes,e.oboAssertion)];case 2:return[2,c.sent()]}}))}))},t.prototype.createTokenRequestBody=function(e){var t=new Lr;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(j.JWT_BEARER),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRequestTokenUse(E.ON_BEHALF_OF),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return t.createQueryString()}}(Ur),function(e){function t(t){return e.call(this,t)||this}return h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof It&&t.errorCode===vt)return[2,new Xr(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){return p(this,void 0,void 0,(function(){var t,r,n;return f(this,(function(o){switch(o.label){case 0:if(!e)throw yr.createEmptyTokenRequestError();if(!e.account)throw It.createNoAccountInSilentRequestError();if(t=new mr(e.scopes||[]),r=e.authority||this.authority.getPreferredCache(),n=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,t,r),!this.isRefreshRequired(e,n.accessToken))return[3,1];throw It.createRefreshRequiredError();case 1:return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,e.resourceRequestMethod,e.resourceRequestUri)];case 2:return[2,o.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t,r){return p(this,void 0,void 0,(function(){var n;return f(this,(function(o){switch(o.label){case 0:return e.idToken&&(n=new Cr(e.idToken.secret,this.config.cryptoInterface)),[4,Qr.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,n,void 0,t,r)];case 1:return[2,o.sent()]}}))}))},t.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims&&t&&!xr.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},t}(Ur));function $r(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}!function(e){function t(t){return e.call(this,t)||this}h(t,e),t.prototype.acquireToken=function(e){return p(this,void 0,void 0,(function(){var t,r,n;return f(this,(function(o){switch(o.label){case 0:return this.logger.info("in acquireToken call"),t=xr.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return r=o.sent(),(n=new Qr(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t)]}}))}))},t.prototype.executeTokenRequest=function(e,t){return p(this,void 0,void 0,(function(){var r,n,o;return f(this,(function(i){return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes},n=this.createTokenRequestBody(t),o=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(e.tokenEndpoint,n,o,r)]}))}))},t.prototype.createTokenRequestBody=function(e){var t=new Lr;t.addClientId(this.config.authOptions.clientId),t.addUsername(e.username),t.addPassword(e.password),t.addScopes(e.scopes),t.addGrantType(j.RESOURCE_OWNER_PASSWORD_GRANT),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(r),(!Rt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()}}(Ur),function(e){e.AAD="AAD",e.OIDC="OIDC"}(zr||(zr={}));var en,tn,rn,nn,on,an,sn=function(){function e(){this.expiresAt=xr.nowSeconds()+Q}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=xr.nowSeconds()+Q},e.prototype.isExpired=function(){return this.expiresAt<=xr.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf(V)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},e}(),cn=function(){function e(e,t,r,n){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===A?_t.Adfs:_t.Default},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Br(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new Br(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===_t.Adfs||this.protocolMode===zr.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return p(this,void 0,void 0,(function(){var e,t,r,n;return f(this,(function(o){switch(o.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new sn).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=o.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=o.sent(),t!==J.CACHE&&r!==J.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return(t=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(t,!1),[2,J.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,J.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateEndpointMetadata(t,!0),[2,J.NETWORK];throw It.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new Br(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw yr.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return p(this,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,$r((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return p(this,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,J.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,J.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,J.NETWORK];throw yr.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(e){throw yr.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return p(this,void 0,void 0,(function(){var t,r,n,o;return f(this,(function(i){switch(i.label){case 0:t=""+b+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return n=i.sent(),o=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body)?n.body.metadata:[],r=e.getCloudDiscoveryMetadataFromNetworkResponse(o,this.hostnameAndPort),[3,4];case 3:return i.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Br.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw It.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e}(),un=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o){return p(this,void 0,void 0,(function(){var i,a;return f(this,(function(s){switch(s.label){case 0:i=e.createInstance(t,r,n,o),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.resolveEndpointsAsync()];case 2:return s.sent(),[2,i];case 3:throw a=s.sent(),It.createEndpointDiscoveryIncompleteError(a);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n){if(Rt.isEmpty(e))throw yr.createUrlEmptyError();return new cn(e,t,r,n)},e}(),ln=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(X.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),hn=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf($));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),dn={sendGetRequestAsync:function(){return Promise.reject(re.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(re.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},pn=function(){function e(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.wrapperSKU=e.wrapperSKU||M,this.wrapperVer=e.wrapperVer||M,this.telemetryCacheKey=X.CACHE_KEY+K.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+X.VALUE_SEPARATOR+e,r=[this.wrapperSKU,this.wrapperVer].join(X.VALUE_SEPARATOR);return[X.SCHEMA_VERSION,t,r].join(X.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(X.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(X.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?X.OVERFLOW_TRUE:X.OVERFLOW_FALSE].join(X.VALUE_SEPARATOR);return[X.SCHEMA_VERSION,t.cacheHits,n,o,a].join(X.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),Rt.isEmpty(e.subError)?Rt.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(X.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new ln;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new ln;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||M,a=e.failedRequests[2*t+1]||M,s=e.errors[t]||M;if(!((n+=i.toString().length+a.toString().length+s.length+3)<X.MAX_HEADER_BYTES))break;r+=1}return r},e}(),fn="interaction_in_progress";!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(en||(en={})),function(e){e.GET="GET",e.POST="POST"}(tn||(tn={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status"}(rn||(rn={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout"}(nn||(nn={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(on||(on={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(an||(an={}));var gn,yn={scopes:[R,_]};!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(gn||(gn={}));var mn,vn=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),En=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,vn.decimalToHex(e[0])+vn.decimalToHex(e[1])+vn.decimalToHex(e[2])+vn.decimalToHex(e[3])+"-"+vn.decimalToHex(e[4])+vn.decimalToHex(e[5])+"-"+vn.decimalToHex(e[6])+vn.decimalToHex(e[7])+"-"+vn.decimalToHex(e[8])+vn.decimalToHex(e[9])+"-"+vn.decimalToHex(e[10])+vn.decimalToHex(e[11])+vn.decimalToHex(e[12])+vn.decimalToHex(e[13])+vn.decimalToHex(e[14])+vn.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),wn=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}(),Cn=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=wn.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Tn=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return wn.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<n;l++)if(s=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*s,3===s||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Sn={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},hashDoesNotContainStateError:{code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},unableToParseStateError:{code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},stateInteractionTypeMismatchError:{code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorPopupTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},monitorIframeTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},noAccountError:{code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},noTokenRequestCacheError:{code:"no_token_request_cache_error",desc:"No token request in found in cache."},unableToParseTokenRequestCacheError:{code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},noCachedAuthorityError:{code:"no_cached_authority_error",desc:"No cached authority found."},authRequestNotSet:{code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},databaseNotOpen:{code:"database_not_open",desc:"Database is not open!"}},An=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return o(t,e),t.createPkceNotGeneratedError=function(e){return new t(Sn.pkceNotGenerated.code,Sn.pkceNotGenerated.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(Sn.cryptoDoesNotExist.code,Sn.cryptoDoesNotExist.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Sn.httpMethodNotImplementedError.code,Sn.httpMethodNotImplementedError.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(Sn.emptyNavigateUriError.code,Sn.emptyNavigateUriError.desc)},t.createEmptyHashError=function(e){return new t(Sn.hashEmptyError.code,Sn.hashEmptyError.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Sn.hashDoesNotContainStateError.code,Sn.hashDoesNotContainStateError.desc)},t.createUnableToParseStateError=function(){return new t(Sn.unableToParseStateError.code,Sn.unableToParseStateError.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(Sn.stateInteractionTypeMismatchError.code,Sn.stateInteractionTypeMismatchError.desc)},t.createInteractionInProgressError=function(){return new t(Sn.interactionInProgress.code,Sn.interactionInProgress.desc)},t.createPopupWindowError=function(e){var r=Sn.popUpWindowError.desc;return r=Rt.isEmpty(e)?r:r+" Details: "+e,new t(Sn.popUpWindowError.code,r)},t.createEmptyWindowCreatedError=function(){return new t(Sn.emptyWindowError.code,Sn.emptyWindowError.desc)},t.createUserCancelledError=function(){return new t(Sn.userCancelledError.code,Sn.userCancelledError.desc)},t.createMonitorPopupTimeoutError=function(){return new t(Sn.monitorPopupTimeoutError.code,Sn.monitorPopupTimeoutError.desc)},t.createMonitorIframeTimeoutError=function(){return new t(Sn.monitorIframeTimeoutError.code,Sn.monitorIframeTimeoutError.desc)},t.createRedirectInIframeError=function(e){return new t(Sn.redirectInIframeError.code,Sn.redirectInIframeError.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Sn.blockTokenRequestsInHiddenIframeError.code,Sn.blockTokenRequestsInHiddenIframeError.desc)},t.createIframeClosedPrematurelyError=function(){return new t(Sn.iframeClosedPrematurelyError.code,Sn.iframeClosedPrematurelyError.desc)},t.createSilentSSOInsufficientInfoError=function(){return new t(Sn.silentSSOInsufficientInfoError.code,Sn.silentSSOInsufficientInfoError.desc)},t.createNoAccountError=function(){return new t(Sn.noAccountError.code,Sn.noAccountError.desc)},t.createSilentPromptValueError=function(e){return new t(Sn.silentPromptValueError.code,Sn.silentPromptValueError.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(Sn.unableToParseTokenRequestCacheError.code,Sn.unableToParseTokenRequestCacheError.desc)},t.createNoTokenRequestCacheError=function(){return new t(Sn.noTokenRequestCacheError.code,Sn.noTokenRequestCacheError.desc)},t.createAuthRequestNotSetError=function(){return new t(Sn.authRequestNotSet.code,Sn.authRequestNotSet.desc)},t.createNoCachedAuthorityError=function(){return new t(Sn.noCachedAuthorityError.code,Sn.noCachedAuthorityError.desc)},t.createInvalidCacheTypeError=function(){return new t(Sn.invalidCacheType.code,""+Sn.invalidCacheType.desc)},t.createNonBrowserEnvironmentError=function(){return new t(Sn.notInBrowserEnvironment.code,Sn.notInBrowserEnvironment.desc)},t.createDatabaseNotOpenError=function(){return new t(Sn.databaseNotOpen.code,Sn.databaseNotOpen.desc)},t}(re),bn=function(){function e(e){this.base64Encode=new Cn,this.cryptoObj=e}return e.prototype.generateCodes=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw An.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return a(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),An.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),In="SHA-256",Rn=new Uint8Array([1,0,1]),_n=function(){function e(){if(!this.hasCryptoAPI())throw An.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:In,modulusLength:2048,publicExponent:Rn}}return e.prototype.sha256Digest=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(r){return t=wn.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(In,t):this.getSubtleCryptoDigest(In,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw An.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey("jwk",e)]}))}))},e.prototype.importJwk=function(t,r,n){return a(this,void 0,void 0,(function(){var o,i;return s(this,(function(a){return o=e.getJwkString(t),i=wn.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,n):window.crypto.subtle.importKey("jwk",t,this._keygenAlgorithmOptions,r,n)]}))}))},e.prototype.sign=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return a(this,void 0,void 0,(function(){var r=this;return s(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey("jwk",e);n.addEventListener("complete",(function(e){var n=e.target.result,o=wn.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(o){return[2,new Promise((function(o,i){var a=window.msCrypto.subtle.importKey("jwk",e,n._keygenAlgorithmOptions,t,r);a.addEventListener("complete",(function(e){o(e.target.result)})),a.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return a(this,void 0,void 0,(function(){var r=this;return s(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),kn=function(){function e(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}return e.prototype.open=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(e){return r(e)}))}))]}))}))},e.prototype.get=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!t.db)return n(An.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.put=function(e,t){return a(this,void 0,void 0,(function(){var r=this;return s(this,(function(n){switch(n.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:n.sent(),n.label=2;case 2:return[2,new Promise((function(n,o){if(!r.db)return o(An.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e}(),On=function(){function e(){this.browserCrypto=new _n,this.b64Encode=new Cn,this.b64Decode=new Tn,this.guidGenerator=new En(this.browserCrypto),this.pkceGenerator=new bn(this.browserCrypto),this.cache=new kn(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t,r){return a(this,void 0,void 0,(function(){var n,o,i,a,c,u,l,h;return s(this,(function(s){switch(s.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return n=s.sent(),[4,this.browserCrypto.exportJwk(n.publicKey)];case 2:return o=s.sent(),i={e:o.e,kty:o.kty,n:o.n},a=_n.getJwkString(i),[4,this.browserCrypto.sha256Digest(a)];case 3:return c=s.sent(),u=this.b64Encode.urlEncodeArr(new Uint8Array(c)),[4,this.browserCrypto.exportJwk(n.privateKey)];case 4:return l=s.sent(),[4,this.browserCrypto.importJwk(l,!1,["sign"])];case 5:return h=s.sent(),this.cache.put(u,{privateKey:h,publicKey:n.publicKey,requestMethod:t,requestUri:r}),[2,u]}}))}))},e.prototype.signJwt=function(e,t){return a(this,void 0,void 0,(function(){var r,n,o,i,a,c,u,l,h,d;return s(this,(function(s){switch(s.label){case 0:return[4,this.cache.get(t)];case 1:return r=s.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=s.sent(),o=_n.getJwkString(n),i={alg:n.alg,type:"jwk"},a=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},c=this.b64Encode.urlEncode(JSON.stringify(e)),u=a+"."+c,l=wn.stringToArrayBuffer(u),[4,this.browserCrypto.sign(r.privateKey,l)];case 3:return h=s.sent(),d=this.b64Encode.urlEncodeArr(new Uint8Array(h)),[2,u+"."+d]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}(),Pn={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},stubPcaInstanceCalled:{code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider."},inMemRedirectUnavailable:{code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."}},Un=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return o(t,e),t.createRedirectUriEmptyError=function(){return new t(Pn.redirectUriNotSet.code,Pn.redirectUriNotSet.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(Pn.postLogoutUriNotSet.code,Pn.postLogoutUriNotSet.desc)},t.createStorageNotSupportedError=function(e){return new t(Pn.storageNotSupportedError.code,Pn.storageNotSupportedError.desc+" Given Location: "+e)},t.createInvalidCallbackObjectError=function(e){return new t(Pn.invalidCallbackObject.code,Pn.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Pn.noRedirectCallbacksSet.code,Pn.noRedirectCallbacksSet.desc)},t.createStubPcaInstanceCalledError=function(){return new t(Pn.stubPcaInstanceCalled.code,Pn.stubPcaInstanceCalled.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(Pn.inMemRedirectUnavailable.code,Pn.inMemRedirectUnavailable.desc)},t}(re),Nn=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==en.LocalStorage&&e!==en.SessionStorage)throw Un.createStorageNotSupportedError(e);if(!window[e])throw Un.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),Ln=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),Mn=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Rt.isEmpty(t))return null;try{return Gr.parseRequestState(e,t).libraryState.meta}catch(e){throw It.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Br(e);return Br.getDeserializedHash(t.getHash())},e}(),xn=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Ln,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return o(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case en.LocalStorage:case en.SessionStorage:try{return new Nn(e)}catch(e){this.logger.verbose(e);break}case en.MemoryStorage:}return this.cacheConfig.cacheLocation=en.MemoryStorage,new Ln},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case en.LocalStorage:case en.SessionStorage:try{return new Nn(en.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case en.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=T+"."+m.ID_TOKEN,r=T+"."+m.CLIENT_INFO,n=T+"."+m.ERROR,o=T+"."+m.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[m.ID_TOKEN,m.CLIENT_INFO,m.ERROR,m.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new wr,r);return wr.isAccountEntity(n)?n:null},t.prototype.setAccount=function(e){var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new Mr,r);return Mr.isIdTokenEntity(n)?n:null},t.prototype.setIdTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new qr,r);return qr.isAccessTokenEntity(n)?n:null},t.prototype.setAccessTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new Dr,r);return Dr.isRefreshTokenEntity(n)?n:null},t.prototype.setRefreshTokenCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new Jr,r);return Jr.isAppMetadataEntity(e,n)?n:null},t.prototype.setAppMetadata=function(e){var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new ln,r);return ln.isServerTelemetryEntity(e,n)?n:null},t.prototype.setServerTelemetry=function(e,t){this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&sn.isAuthorityMetadataEntity(e,r)?Tr.toObject(new sn,r):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setAuthorityMetadata=function(e,t){this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);if(!r)return null;var n=Tr.toObject(new hn,r);return hn.isThrottlingEntity(e,n)?n:null},t.prototype.setThrottlingCache=function(e,t){this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return n}return this.temporaryCacheStorage.getItem(r)||null},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(n,t)},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return u(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){var e=this;this.removeAllAccounts(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(T)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear()},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Rt.startsWith(e,T)||Rt.startsWith(e,m.ADAL_ID_TOKEN)?e:T+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Gr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(rn.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Gr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(rn.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Gr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(rn.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r){var n=this.generateStateKey(e);this.setTemporaryCache(n,e,!1);var o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);var i=this.generateAuthorityKey(e);this.setTemporaryCache(i,r,!1)},t.prototype.resetRequestCache=function(e){var t=this;this.getKeys().forEach((function(r){Rt.isEmpty(e)||-1===r.indexOf(e)||t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(rn.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(rn.ORIGIN_URI)),this.removeItem(this.generateCacheKey(rn.URL_HASH)),this.removeItem(this.generateCacheKey(rn.INTERACTION_STATUS_KEY))},t.prototype.cleanRequestByState=function(e){if(e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.info("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.getKeys().forEach((function(r){if(-1!==r.indexOf(rn.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=Mn.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.info("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}}))},t.prototype.cacheCodeRequest=function(e,t){var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(rn.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){var r=this.getTemporaryCache(rn.REQUEST_PARAMS,!0);if(!r)throw An.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw An.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(rn.REQUEST_PARAMS)),Rt.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw An.createNoCachedAuthorityError();n.authority=i}return n},t}(Tr),qn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var r,n;return s(this,(function(o){switch(o.label){case 0:return[4,fetch(e,{method:tn.GET,headers:this.getFetchHeaders(t)})];case 1:return r=o.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=o.sent(),n.status=r.status,n)]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){var r,n,o;return s(this,(function(i){switch(i.label){case 0:return r=t&&t.body||"",[4,fetch(e,{method:tn.POST,headers:this.getFetchHeaders(t),body:r})];case 1:return n=i.sent(),o={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 2:return[2,(o.body=i.sent(),o.status=n.status,o)]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),Dn=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.sendRequestAsync(e,tn.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this.sendRequestAsync(e,tn.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&i(a.responseText);try{var e=JSON.parse(a.responseText),t={headers:n.getHeaderDict(a),body:e,status:a.status};o(t)}catch(e){i(a.responseText)}},a.onerror=function(){i(a.status)},"POST"===t&&r&&r.body)a.send(r.body);else{if("GET"!==t)throw An.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),Fn=function(){function e(){}return e.navigateWindow=function(e,t,r,n){return n?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){r.warning("Expected to navigate away from the current page but timeout occurred."),e()}),t)}))},e.clearHash=function(){"function"==typeof history.replaceState?history.replaceState(null,M,""+window.location.pathname+window.location.search):window.location.hash=""},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new Br(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new qn:new Dn},e.blockReloadInHiddenIframes=function(){if(Br.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw An.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===on.Redirect&&n&&!r)throw An.createRedirectInIframeError(n)},e.blockNonBrowserEnvironment=function(e){if(!e)throw An.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),jn=6e4,Hn=6e3,Kn=function(){function e(e,t,r){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r}return e.prototype.handleCodeResponse=function(e,t,r,n){return a(this,void 0,void 0,(function(){var o,i,a,c,u,l;return s(this,(function(s){switch(s.label){case 0:if(Rt.isEmpty(e))throw An.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw It.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,i),c=this.browserStorage.generateNonceKey(i),u=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:s.sent(),s.label=2;case 2:return a.nonce=u||void 0,a.state=i,[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return l=s.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return a(this,void 0,void 0,(function(){var n,o;return s(this,(function(i){switch(i.label){case 0:return n="https://"+e+"/"+t.tenant+"/",[4,un.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e}(),Gn=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.browserCrypto=o,i}return o(t,e),t.prototype.initiateAuthRequest=function(e,t){if(Rt.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),An.createEmptyNavigationUriError();return t.redirectStartPage&&this.browserStorage.setTemporaryCache(rn.ORIGIN_URI,t.redirectStartPage,!0),this.browserStorage.setTemporaryCache(rn.INTERACTION_STATUS_KEY,fn,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.authModule.logger.infoPii("Navigate to:"+e),"function"==typeof t.onRedirectNavigate?(this.authModule.logger.verbose("Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)?(this.authModule.logger.verbose("onRedirectNavigate did not return false, navigating"),Fn.navigateWindow(e,t.redirectTimeout,this.authModule.logger)):(this.authModule.logger.verbose("onRedirectNavigate returned false, stopping navigation"),Promise.resolve())):(this.authModule.logger.verbose("Navigating window to navigate url"),Fn.navigateWindow(e,t.redirectTimeout,this.authModule.logger))},t.prototype.handleCodeResponse=function(e,t,r,n,o){return a(this,void 0,void 0,(function(){var i,a,c,u,l,h;return s(this,(function(s){switch(s.label){case 0:if(Rt.isEmpty(e))throw An.createEmptyHashError(e);if(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rn.INTERACTION_STATUS_KEY)),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw It.createStateNotFoundError("Cached State");return c=this.authModule.handleFragmentResponse(e,a),u=this.browserStorage.generateNonceKey(a),l=this.browserStorage.getTemporaryCache(u),this.authCodeRequest.code=c.code,c.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(c.cloud_instance_host_name,r,n)]:[3,2];case 1:s.sent(),s.label=2;case 2:return c.nonce=l||void 0,c.state=a,o&&Or.removeThrottle(this.browserStorage,o,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,c)];case 3:return h=s.sent(),this.browserStorage.cleanRequestByState(t),[2,h]}}))}))},t}(Kn),Bn=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.unloadWindow=o.unloadWindow.bind(o),o}return o(t,e),t.prototype.initiateAuthRequest=function(e,t){if(Rt.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),An.createEmptyNavigationUriError();return this.browserStorage.setTemporaryCache(rn.INTERACTION_STATUS_KEY,fn,!0),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,t.popupName,t.popup)},t.prototype.monitorPopupForHash=function(e,t){var r=this;return new Promise((function(n,o){t<jn&&r.authModule.logger.warning("system.loadFrameTimeout or system.windowHashTimeout set to lower ("+t+"ms) than the default ("+jn+"ms). This may result in timeouts.");var i=t/50,a=0,s=setInterval((function(){if(e.closed)return r.cleanPopup(),clearInterval(s),void o(An.createUserCancelledError());var t=M;try{t=e.location.href}catch(e){}if(!Rt.isEmpty(t)&&"about:blank"!==t){a++;var c=e.location.hash;return Br.hashContainsKnownProperties(c)?(r.cleanPopup(e),clearInterval(s),void n(c)):a>i?(r.cleanPopup(e),clearInterval(s),void o(An.createMonitorPopupTimeoutError())):void 0}}),50)}))},t.prototype.openPopup=function(e,r,n){try{var o=void 0;if(n?(o=n).location.assign(e):void 0===n&&(o=t.openSizedPopup(e,r)),!o)throw An.createEmptyWindowCreatedError();return o.focus&&o.focus(),this.currentWindow=o,window.addEventListener("beforeunload",this.unloadWindow),o}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rn.INTERACTION_STATUS_KEY)),An.createPopupWindowError(e.toString())}},t.openSizedPopup=function(e,t){var r=window.screenLeft?window.screenLeft:window.screenX,n=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=Math.max(0,o/2-241.5+r),s=Math.max(0,i/2-300+n);return window.open(e,t,"width=483, height=600, top="+s+", left="+a)},t.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(on.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},t.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rn.INTERACTION_STATUS_KEY))},t.generatePopupName=function(e,t){return"msal."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},t}(Kn),zn=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n)||this;return i.navigateFrameWait=o,i}return o(t,e),t.prototype.initiateAuthRequest=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:if(Rt.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),An.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){t<Hn&&r.authModule.logger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+Hn+"ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(An.createMonitorIframeTimeoutError());var t=M,s=e.contentWindow;try{t=s?s.location.href:M}catch(e){}if(!Rt.isEmpty(t)){var c=s?s.location.hash:M;return Br.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),50)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}(Kn),Wn="2.11.0";!function(e){e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure"}(mn||(mn={}));var Jn=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.loginRedirect=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.acquireTokenRedirect(e||yn)]}))}))},t.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||yn)},t.prototype.acquireTokenSilent=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,a,c;return s(this,(function(s){switch(s.label){case 0:if(this.preflightBrowserEnvironmentCheck(on.Silent),!(t=e.account||this.getActiveAccount()))throw An.createNoAccountError();r=i(i(i({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1}),this.emitEvent(mn.ACQUIRE_TOKEN_START,on.Silent,e),s.label=1;case 1:return s.trys.push([1,4,,9]),n=this.initializeServerTelemetryManager(nn.acquireTokenSilent_silentFlow,r.correlationId),[4,this.createSilentFlowClient(n,r.authority)];case 2:return[4,s.sent().acquireCachedToken(r)];case 3:return o=s.sent(),this.emitEvent(mn.ACQUIRE_TOKEN_SUCCESS,on.Silent,o),[2,o];case 4:s.sent(),s.label=5;case 5:return s.trys.push([5,7,,8]),[4,this.acquireTokenByRefreshToken(r)];case 6:return a=s.sent(),this.emitEvent(mn.ACQUIRE_TOKEN_SUCCESS,on.Silent,a),[2,a];case 7:throw c=s.sent(),this.emitEvent(mn.ACQUIRE_TOKEN_FAILURE,on.Silent,null,c),c;case 8:return[3,9];case 9:return[2]}}))}))},t}(function(){function e(e){var t,r,n,o,a,s,c,u,l;if(this.isBrowserEnvironment="undefined"!=typeof window,this.config=(t=e,r=this.isBrowserEnvironment,n=t.auth,o=t.cache,a=t.system,s={clientId:"",authority:""+S,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:zr.AAD},c={cacheLocation:en.SessionStorage,storeAuthStateInCookie:!1},u={loggerCallback:function(){},logLevel:ee.Info,piiLoggingEnabled:!1},l=i(i({},Ar),{loggerOptions:u,networkClient:r?Fn.getBrowserNetworkClient():dn,loadFrameTimeout:0,windowHashTimeout:a&&a.loadFrameTimeout||jn,iframeHashTimeout:a&&a.loadFrameTimeout||Hn,navigateFrameWait:r&&Fn.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1}),{auth:i(i({},s),n),cache:i(i({},c),o),system:i(i({},l),a)}),this.activeLocalAccountId=null,this.eventCallbacks=new Map,this.logger=new kt(this.config.system.loggerOptions,"@azure/msal-browser",Wn),this.networkClient=this.config.system.networkClient,!this.isBrowserEnvironment)return this.browserStorage=function(e,t){var r={cacheLocation:en.MemoryStorage,storeAuthStateInCookie:!1};return new xn(e,r,ne,t)}(this.config.auth.clientId,this.logger),void(this.browserCrypto=ne);this.browserCrypto=new On,this.browserStorage=new xn(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger)}return e.prototype.handleRedirectPromise=function(e){return a(this,void 0,void 0,(function(){var t,r=this;return s(this,(function(n){return this.emitEvent(mn.HANDLE_REDIRECT_START,on.Redirect),t=this.getAllAccounts(),this.isBrowserEnvironment?[2,this.handleRedirectResponse(e).then((function(e){return e&&(t.length<r.getAllAccounts().length?r.emitEvent(mn.LOGIN_SUCCESS,on.Redirect,e):r.emitEvent(mn.ACQUIRE_TOKEN_SUCCESS,on.Redirect,e)),r.emitEvent(mn.HANDLE_REDIRECT_END,on.Redirect),e})).catch((function(e){throw t.length>0?r.emitEvent(mn.ACQUIRE_TOKEN_FAILURE,on.Redirect,null,e):r.emitEvent(mn.LOGIN_FAILURE,on.Redirect,null,e),r.emitEvent(mn.HANDLE_REDIRECT_END,on.Redirect),e}))]:[2,null]}))}))},e.prototype.handleRedirectResponse=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,i,a,c;return s(this,(function(s){switch(s.label){case 0:if(!this.interactionInProgress())return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(on.Redirect),[2,null];try{r=this.validateAndExtractStateFromHash(t,on.Redirect),Fn.clearHash()}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(on.Redirect),[2,null]}return n=this.browserStorage.getTemporaryCache(rn.ORIGIN_URI,!0)||"",o=Br.removeHashFromUrl(n),i=Br.removeHashFromUrl(window.location.href),o===i&&this.config.auth.navigateToLoginRequestUrl?[4,this.handleHash(t,r)]:[3,2];case 1:return a=s.sent(),n.indexOf("#")>-1&&Fn.replaceHash(n),[2,a];case 2:return this.config.auth.navigateToLoginRequestUrl?[3,3]:[2,this.handleHash(t,r)];case 3:return Fn.isInIframe()?[3,7]:(this.browserStorage.setTemporaryCache(rn.URL_HASH,t,!0),n&&"null"!==n?[3,5]:(c=Fn.getHomepage(),this.browserStorage.setTemporaryCache(rn.ORIGIN_URI,c,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,Fn.navigateWindow(c,this.config.system.redirectNavigationTimeout,this.logger,!0)]));case 4:return s.sent(),[3,7];case 5:return[4,Fn.navigateWindow(n,this.config.system.redirectNavigationTimeout,this.logger,!0)];case 6:s.sent(),s.label=7;case 7:return[2,null]}}))}))},e.prototype.getRedirectResponseHash=function(e){var t=Br.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(rn.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rn.URL_HASH)),t?e:r},e.prototype.validateAndExtractStateFromHash=function(e,t){var r=Br.getDeserializedHash(e);if(!r.state)throw An.createHashDoesNotContainStateError();var n=Mn.extractBrowserRequestState(this.browserCrypto,r.state);if(!n)throw An.createUnableToParseStateError();if(n.interactionType!==t)throw An.createStateInteractionTypeMismatchError();return r.state},e.prototype.handleHash=function(e,t){return a(this,void 0,void 0,(function(){var r,n,o,i,a;return s(this,(function(s){switch(s.label){case 0:r=this.browserStorage.getCachedRequest(t,this.browserCrypto),n=this.initializeServerTelemetryManager(nn.handleRedirectPromise,r.correlationId),s.label=1;case 1:if(s.trys.push([1,4,,5]),!(o=this.browserStorage.getCachedAuthority(t)))throw An.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(n,o)];case 2:return i=s.sent(),[4,new Gn(i,this.browserStorage,r,this.browserCrypto).handleCodeResponse(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 3:return[2,s.sent()];case 4:throw a=s.sent(),n.cacheFailedRequest(a),this.browserStorage.cleanRequestByInteractionType(on.Redirect),a;case 5:return[2]}}))}))},e.prototype.acquireTokenRedirect=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,i,a,c,u,l;return s(this,(function(s){switch(s.label){case 0:this.preflightBrowserEnvironmentCheck(on.Redirect),(t=this.getAllAccounts().length>0)?this.emitEvent(mn.ACQUIRE_TOKEN_START,on.Redirect,e):this.emitEvent(mn.LOGIN_START,on.Redirect,e),r=this.preflightInteractiveRequest(e,on.Redirect),n=this.initializeServerTelemetryManager(nn.acquireTokenRedirect,r.correlationId),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(r)];case 2:return o=s.sent(),[4,this.createAuthCodeClient(n,r.authority)];case 3:return i=s.sent(),a=new Gn(i,this.browserStorage,o,this.browserCrypto),[4,i.getAuthCodeUrl(r)];case 4:return c=s.sent(),u=this.getRedirectStartPage(e.redirectStartPage),[2,a.initiateAuthRequest(c,{redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate})];case 5:throw l=s.sent(),t?this.emitEvent(mn.ACQUIRE_TOKEN_FAILURE,on.Redirect,null,l):this.emitEvent(mn.LOGIN_FAILURE,on.Redirect,null,l),n.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(r.state),l;case 6:return[2]}}))}))},e.prototype.acquireTokenPopup=function(e){var t;try{this.preflightBrowserEnvironmentCheck(on.Popup),t=this.preflightInteractiveRequest(e,on.Popup)}catch(e){return Promise.reject(e)}var r=Bn.generatePopupName(this.config.auth.clientId,t);if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(t,r);var n=Bn.openSizedPopup("about:blank",r);return this.acquireTokenPopupAsync(t,r,n)},e.prototype.acquireTokenPopupAsync=function(e,t,r){return a(this,void 0,void 0,(function(){var n,o,i,a,c,u,l,h,d,p,f,g;return s(this,(function(s){switch(s.label){case 0:(n=this.getAllAccounts()).length>0?this.emitEvent(mn.ACQUIRE_TOKEN_START,on.Popup,e):this.emitEvent(mn.LOGIN_START,on.Popup,e),o=this.initializeServerTelemetryManager(nn.acquireTokenPopup,e.correlationId),s.label=1;case 1:return s.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return i=s.sent(),[4,this.createAuthCodeClient(o,e.authority)];case 3:return[4,(a=s.sent()).getAuthCodeUrl(e)];case 4:return c=s.sent(),u=new Bn(a,this.browserStorage,i),l={popup:r,popupName:t},h=u.initiateAuthRequest(c,l),[4,u.monitorPopupForHash(h,this.config.system.windowHashTimeout)];case 5:return d=s.sent(),p=this.validateAndExtractStateFromHash(d,on.Popup),Or.removeThrottle(this.browserStorage,this.config.auth.clientId,i.authority,i.scopes),[4,u.handleCodeResponse(d,p,a.authority,this.networkClient)];case 6:return f=s.sent(),n.length<this.getAllAccounts().length?this.emitEvent(mn.LOGIN_SUCCESS,on.Popup,f):this.emitEvent(mn.ACQUIRE_TOKEN_SUCCESS,on.Popup,f),[2,f];case 7:throw g=s.sent(),n.length>0?this.emitEvent(mn.ACQUIRE_TOKEN_FAILURE,on.Popup,null,g):this.emitEvent(mn.LOGIN_FAILURE,on.Popup,null,g),o.cacheFailedRequest(g),this.browserStorage.cleanRequestByState(e.state),g;case 8:return[2]}}))}))},e.prototype.ssoSilent=function(e){return a(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(on.Silent),this.emitEvent(mn.SSO_SILENT_START,on.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.acquireTokenByIframe(e)];case 2:return t=n.sent(),this.emitEvent(mn.SSO_SILENT_SUCCESS,on.Silent,t),[2,t];case 3:throw r=n.sent(),this.emitEvent(mn.SSO_SILENT_FAILURE,on.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByIframe=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,a,c;return s(this,(function(s){switch(s.label){case 0:if(Rt.isEmpty(e.loginHint)&&Rt.isEmpty(e.sid)&&(!e.account||Rt.isEmpty(e.account.username)))throw An.createSilentSSOInsufficientInfoError();if(e.prompt&&e.prompt!==D.NONE)throw An.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(i(i({},e),{prompt:D.NONE}),on.Silent),r=this.initializeServerTelemetryManager(nn.ssoSilent,t.correlationId),s.label=1;case 1:return s.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=s.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=s.sent()).getAuthCodeUrl(t)];case 4:return a=s.sent(),[4,this.silentTokenHelper(a,n,o)];case 5:return[2,s.sent()];case 6:throw c=s.sent(),r.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 7:return[2]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,a,c;return s(this,(function(s){switch(s.label){case 0:this.emitEvent(mn.ACQUIRE_TOKEN_NETWORK_START,on.Silent,e),Fn.blockReloadInHiddenIframes(),t=i(i({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(nn.acquireTokenSilent_silentFlow,t.correlationId),s.label=1;case 1:return s.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return[4,s.sent().acquireTokenByRefreshToken(t)];case 3:return[2,s.sent()];case 4:return n=s.sent(),r.cacheFailedRequest(n),o=n instanceof kr,a=n instanceof Hr,c="invalid_grant"===n.errorCode,o&&c&&!a?[4,this.acquireTokenByIframe(e)]:[3,6];case 5:return[2,s.sent()];case 6:throw n;case 7:return[2]}}))}))},e.prototype.silentTokenHelper=function(e,t,r){return a(this,void 0,void 0,(function(){var n,o,i,a;return s(this,(function(s){switch(s.label){case 0:return[4,(n=new zn(r,this.browserStorage,t,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return o=s.sent(),[4,n.monitorIframeForHash(o,this.config.system.iframeHashTimeout)];case 2:return i=s.sent(),a=this.validateAndExtractStateFromHash(i,on.Silent),[2,n.handleCodeResponse(i,a,r.authority,this.networkClient)]}}))}))},e.prototype.logout=function(e){return a(this,void 0,void 0,(function(){var t,r,n,o,i;return s(this,(function(a){switch(a.label){case 0:this.preflightBrowserEnvironmentCheck(on.Redirect),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(nn.logout,t.correlationId),a.label=1;case 1:return a.trys.push([1,3,,4]),this.emitEvent(mn.LOGOUT_START,on.Redirect,e),[4,this.createAuthCodeClient(r,e&&e.authority)];case 2:return n=a.sent(),o=n.getLogoutUri(t),this.emitEvent(mn.LOGOUT_SUCCESS,on.Redirect,t),t.account&&!wr.accountInfoIsEqual(t.account,this.getActiveAccount())||this.setActiveAccount(null),e&&"function"==typeof e.onRedirectNavigate?!1!==e.onRedirectNavigate(o)?(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[2,Fn.navigateWindow(o,this.config.system.redirectNavigationTimeout,this.logger)]):(this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),[3,4]):[2,Fn.navigateWindow(o,this.config.system.redirectNavigationTimeout,this.logger)];case 3:throw i=a.sent(),r.cacheFailedRequest(i),this.emitEvent(mn.LOGOUT_FAILURE,on.Redirect,null,i),i;case 4:return[2]}}))}))},e.prototype.getAllAccounts=function(){return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!Rt.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!Rt.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.homeAccountId===e}))[0]||null},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!Rt.isEmpty(e)&&t&&t.length&&t.filter((function(t){return t.localAccountId===e}))[0]||null},e.prototype.setActiveAccount=function(e){this.activeLocalAccountId=e?e.localAccountId:null},e.prototype.getActiveAccount=function(){return this.activeLocalAccountId?this.getAccountByLocalId(this.activeLocalAccountId):null},e.prototype.getRedirectUri=function(e){var t=e||this.config.auth.redirectUri||Fn.getCurrentUri();return Br.getAbsoluteUrl(t,Fn.getCurrentUri())},e.prototype.getPostLogoutRedirectUri=function(e){var t=e||this.config.auth.postLogoutRedirectUri||Fn.getCurrentUri();return Br.getAbsoluteUrl(t,Fn.getCurrentUri())},e.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Br.getAbsoluteUrl(t,Fn.getCurrentUri())},e.prototype.getDiscoveredAuthority=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?[4,un.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]:[3,2];case 1:return[2,r.sent()];case 2:return[4,un.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)];case 3:return[2,r.sent()]}}))}))},e.prototype.interactionInProgress=function(){return this.browserStorage.getTemporaryCache(rn.INTERACTION_STATUS_KEY,!0)===fn},e.prototype.createAuthCodeClient=function(e,t){return a(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Yr(r)]}}))}))},e.prototype.createSilentFlowClient=function(e,t){return a(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Zr(r)]}}))}))},e.prototype.createRefreshTokenClient=function(e,t){return a(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new Xr(r)]}}))}))},e.prototype.getClientConfiguration=function(e,t){return a(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.getDiscoveredAuthority(t)];case 1:return r=n.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:r,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:"msal.js.browser",version:Wn,cpu:"",os:""}}]}}))}))},e.prototype.preflightInteractiveRequest=function(e,t){if(Fn.blockReloadInHiddenIframes(),this.interactionInProgress())throw An.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(Fn.blockNonBrowserEnvironment(this.isBrowserEnvironment),Fn.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Fn.blockReloadInHiddenIframes(),e===on.Redirect&&this.config.cache.cacheLocation===en.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Un.createInMemoryRedirectUnavailableError()},e.prototype.initializeBaseRequest=function(e){var t=e.authority||this.config.auth.authority,r=u(e&&e.scopes||[]),n=e&&e.correlationId||this.browserCrypto.createNewGuid();return i(i({},e),{correlationId:n,authority:t,scopes:r})},e.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1,wrapperSKU:this.wrapperSKU,wrapperVer:this.wrapperVer};return new pn(n,this.browserStorage)},e.prototype.initializeAuthorizationRequest=function(e,t){var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Gr.setRequestState(this.browserCrypto,e&&e.state||"",n),a=e.authenticationScheme||Y.BEARER,s=i(i({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:F.FRAGMENT,authenticationScheme:a}),c=e.account||this.getActiveAccount();if(c&&(s.account=c),Rt.isEmpty(s.loginHint)){var u=this.browserStorage.getTemporaryCache(m.ADAL_ID_TOKEN);if(u){var l=new Cr(u,this.browserCrypto);this.browserStorage.removeItem(m.ADAL_ID_TOKEN),l.claims&&l.claims.upn&&(s.loginHint=l.claims.upn)}}return this.browserStorage.updateCacheEntries(s.state,s.nonce,s.authority),s},e.prototype.initializeAuthorizationCodeRequest=function(e){return a(this,void 0,void 0,(function(){var t,r;return s(this,(function(n){switch(n.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=i(i({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=P,[2,r]}}))}))},e.prototype.initializeLogoutRequest=function(e){var t=i({correlationId:this.browserCrypto.createNewGuid()},e);return t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},e.prototype.emitEvent=function(e,t,r,n){var o=this;if(this.isBrowserEnvironment){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.addEventCallback=function(e){if(this.isBrowserEnvironment){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.wrapperSKU=e,this.wrapperVer=t},e}()),Vn={acquireTokenPopup:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},acquireTokenRedirect:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},acquireTokenSilent:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},getAllAccounts:function(){return[]},getAccountByHomeId:function(){return null},getAccountByUsername:function(){return null},getAccountByLocalId:function(){return null},handleRedirectPromise:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},loginPopup:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},loginRedirect:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},logout:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},ssoSilent:function(){return Promise.reject(Un.createStubPcaInstanceCalledError)},addEventCallback:function(){return null},removeEventCallback:function(){},getLogger:function(){throw Un.createStubPcaInstanceCalledError()},setLogger:function(){},setActiveAccount:function(){},getActiveAccount:function(){return null},initializeWrapperLibrary:function(){}},Qn=function(){function e(){}return e.getInteractionStatusFromEvent=function(e){switch(e.eventType){case mn.LOGIN_START:return an.Login;case mn.SSO_SILENT_START:return an.SsoSilent;case mn.ACQUIRE_TOKEN_START:if(e.interactionType===on.Redirect||e.interactionType===on.Popup)return an.AcquireToken;break;case mn.HANDLE_REDIRECT_START:return an.HandleRedirect;case mn.LOGOUT_START:return an.Logout;case mn.LOGIN_SUCCESS:case mn.SSO_SILENT_SUCCESS:case mn.HANDLE_REDIRECT_END:case mn.LOGIN_FAILURE:case mn.SSO_SILENT_FAILURE:case mn.LOGOUT_FAILURE:return an.None;case mn.ACQUIRE_TOKEN_SUCCESS:case mn.ACQUIRE_TOKEN_FAILURE:if(e.interactionType===on.Redirect||e.interactionType===on.Popup)return an.None}return null},e}()},"./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,r,n,o,i,a){void 0===t&&(t=!0),void 0===r&&(r=s),void 0===n&&(n=s),void 0===o&&(o=s),void 0===i&&(i=0),void 0===a&&(a=[]),u({name:null,actionName:e,commandSurface:o,parentName:r,triggerMethod:n,durationMs:i,succeeded:t,dataFields:a})},t.logActivity=function(e,t,r,n){void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=[]),c({name:e,succeeded:t,durationMs:r,dataFields:n})},t.sendTelemetryEvent=function(e){l({kind:"event",event:e,timestamp:(new Date).getTime()})},t.sendActivityEvent=c,t.sendOtelEvent=function(e){l({kind:"otel",event:e})},t.sendUserActionEvent=u,t.addNamespaceMapping=function(e,t){l({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})},t.setEnabledState=function(e){(o=e)||(i=[])},t.shutdown=function(){return l({kind:"shutdown"}),i.length+a},t.registerEventHandler=function(e){n=e,i.forEach((function(e){return l(e)})),i=[]};var n,o=!1,i=[],a=0,s="Unknown";function c(e){l({kind:"activity",event:e,timestamp:(new Date).getTime()})}function u(e){l({kind:"action",event:e,timestamp:(new Date).getTime()})}function l(e){o&&(n?n(e):i.length<=2e4?i.push(e):a+=1)}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts":function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i,a,s=r("./node_modules/@azure/msal-browser/dist/index.es.js"),c=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js"),u=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts"),l=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts"),h=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),d=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts");c.addNamespaceMapping("Office.Identity.WebAuth.BrowserAuth","5c65bbc4edbf480d9637ace04d62bd98-12844893-8ab9-4dde-b850-5612cb12e0f2-7822");var p=!1,f=!0;function g(e,t){var r=d.TimerUtils.timer();(a=e).enableConsoleLogging&&(p=a.enableConsoleLogging),a.enableUpnCheck&&(f=a.enableUpnCheck),a.authority&&(a.authority=a.authority.replace(u.Constants.Authority.ProdLegacy,u.Constants.Authority.Prod)),i||window.addEventListener("message",(function(e){if(e.origin&&e.origin==location.origin&&e.data&&e.data.iframe&&e.data.request&&e.data.request==u.Constants.PostMessageType.RequestAuthConfig){var t=u.Constants.PostMessageType.iFramePrefix+e.data.iframe;if(null===(r=document.getElementById(t.replace("+"," ")))){t=u.Constants.PostMessageType.iFrameIdTokenPrefix;var r=document.getElementById(t.replace("+"," "))}if(h.LoggingUtils.log("received from "+t,p),null===r)return void h.LoggingUtils.log("targetiFrame is null",p);var n=r.contentWindow;null!=n&&(h.LoggingUtils.log("returning to "+e.data.iframe,p),n.postMessage({request:u.Constants.PostMessageType.ResponseAuthConfig,config:a},location.origin))}}),!1);var n,o=a.idp.toLowerCase()===u.Constants.IdentityProvider.Msa.toLowerCase();o?a.authority=u.Constants.Authority.Prod+u.Constants.Authority.MsaSuffix:(a.authority||(a.authority=u.Constants.Authority.Prod+u.Constants.Authority.AadSuffix),a.authority.indexOf(u.Constants.Authority.AadSuffix)<0&&("/"==a.authority.charAt(a.authority.length-1)?a.authority+=u.Constants.Authority.AadSuffix:a.authority+="/"+u.Constants.Authority.AadSuffix)),i=new Array;for(var c=0,l=a.appIds;c<l.length;c++){var g=l[c];if(h.LoggingUtils.log("["+a.idp+"] Load->init: "+g,p),g&&T(g)){var y={applicationId:g,application:new s.PublicClientApplication({auth:{clientId:g,authority:a.authority,redirectUri:a.redirectUri?a.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!a.navigateToLoginRequestUrl||a.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:a.timeout?a.timeout:6e3}})};i.push(y),n||(n=g)}}return n?(h.LoggingUtils.log("["+a.idp+"] ssoSilent@Load->init",p),m(n,a.upn,o?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix,t).then((function(e){return h.LoggingUtils.log("["+a.idp+"] ssoSilent@Load->success: "+e.idTokenClaims.aud,p),v(!0,t,i,r)})).catch((function(e){return h.LoggingUtils.log("["+a.idp+"] ssoSilent@Load->error: ["+e.errorCode+"]"+e.errorMessage,p),v(!0,t,i,r,e.errorCode,e.errorMessage)}))):Promise.reject(v(!1,t,i,r))}function y(e,t,r,i,s,c,g){var y=this;void 0===c&&(c=!1);var v=d.TimerUtils.timer(),S=i||s,b=!1,I=w(t),R={},_=a.idp.toLowerCase()===u.Constants.IdentityProvider.Msa.toLowerCase();if(r&&T(r)||(r=void 0),!e)return R.ErrorCode="missing_target",R.ErrorMessage="The provided target for BrowserAuth.GetToken is null, blank or empty",Promise.reject(E(R,r,t,c,v,void 0));var k=[C(e)];if(!t||!T(t))return R.ErrorCode="invalid_application_ID",R.ErrorMessage="The provided application ID for BrowserAuth.GetToken is null, blank, empty or with invalid format",Promise.reject(E(R,r,t,c,v,k));var O=function(e){return new Promise((function(r,i){return n(y,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return h.LoggingUtils.log("["+t+"] acquireToken->init: popup:["+S+"]",p),R={},[4,(S?I.acquireTokenPopup(e):I.acquireTokenSilent(e)).then((function(e){return R.MsalResult=e,e.accessToken&&A(e.idToken)&&(c||_||function(e){if(!f)return h.LoggingUtils.log("Skip Upn check of access token, returning true",p),!0;if(!a||!a.upn)return h.LoggingUtils.log("Upn does not exist in the configuration, returning true",p),!0;var t=l.ExtractUtils.extractToken(e);return!!(!t||t&&t.upn&&t.upn.toLowerCase()===a.upn.toLowerCase())||(h.LoggingUtils.log("provided Upn does not match Upn extracted from access token",p),!1)}(e.accessToken))?(R.Token=e.accessToken,h.LoggingUtils.log("["+t+"] acquireToken->token: "+R.Token,p),r(R)):(R.ErrorCode="upn_mismatch",R.ErrorMessage="upn doesn't match with given upn in config",h.LoggingUtils.log("["+t+"] acquireToken->error: ["+R.ErrorCode+"]"+R.ErrorMessage,p),i(R))})).catch((function(n){if(R.MsalResult=n,R.ErrorCode=n.errorCode,R.ErrorMessage=n.errorMessage,h.LoggingUtils.log("["+t+"] acquireToken->error: ["+R.ErrorCode+"]"+R.ErrorMessage,p),S||!b)return i(R);S=!0,h.LoggingUtils.log("["+t+"] acquireToken->retry: popup:["+S+"]",p),O(e).then((function(e){return r(e)})).catch((function(e){return i(e)}))}))];case 1:return n.sent(),[2]}}))}))}))},P={scopes:k,account:{username:a.upn},loginHint:a.upn,extraQueryParameters:{domain_hint:_?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix},correlationId:r,claims:g};return O(P).catch((function(e){return n(y,void 0,void 0,(function(){var i,s=this;return o(this,(function(l){switch(l.label){case 0:return i=!1,"no_tokens_found"!==e.ErrorCode?[3,2]:(h.LoggingUtils.log("["+t+"] ssoSilent@GetToken->init",p),[4,m(t,a.upn,_?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix,r).then((function(){return n(s,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return h.LoggingUtils.log("["+t+"] ssoSilent@GetToken->success",p),[4,O(P).then((function(e){i=!0,R=e})).catch((function(e){R=e}))];case 1:return e.sent(),[2]}}))}))})).catch((function(e){return n(s,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return R.ErrorCode=e.errorCode,R.ErrorMessage=e.errorMessage,h.LoggingUtils.log("["+t+"] ssoSilent@GetToken->error: ["+R.ErrorCode+"]"+R.ErrorMessage,p),"login_required"===e.errorCode&&(e.errorMessage.startsWith("AADSTS50058")||e.errorMessage.startsWith("Silent authentication was denied"))&&a.autoPopup?(b=!0,[4,O(P).then((function(e){i=!0,R=e})).catch((function(e){h.LoggingUtils.log("["+t+"] acquireToken@GetToken->error",p),R=e}))]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))}))]);case 1:l.sent(),l.label=2;case 2:return h.LoggingUtils.log("["+t+"] GetToken->isSuccess["+i+"]",p),R=E(R,r,t,c,v,k),[2,i?Promise.resolve(R):Promise.reject(R)]}}))}))})).then((function(e){return h.LoggingUtils.log("["+t+"] GetToken->success",p),Promise.resolve(E(e,r,t,c,v,k))}))}function m(e,t,r,n){return w(e).ssoSilent({loginHint:t,extraQueryParameters:{domain_hint:r},correlationId:n})}function v(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var s=[{name:u.Constants.Telemetry.Duration,int64:n.ms},{name:u.Constants.Telemetry.Succeeded,bool:!0},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.LoadedApplicationCount,int64:r.length},{name:u.Constants.Telemetry.ErrorCode,string:o||"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:i||"unknown"}];c.sendTelemetryEvent({name:u.Constants.Telemetry.LoadTelemetryName,dataFields:s})}return{Telemetry:{timeToLoad:n.ms,succeeded:e,idp:a.idp.toLowerCase(),correlationId:t||"",loadedApplicationCount:r.length,errorCode:o||void 0,errorMessage:i||void 0}}}function E(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var s=[{name:u.Constants.Telemetry.Duration,int64:o.ms},{name:u.Constants.Telemetry.Succeeded,string:!e.Token},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.ApplicationId,string:r},{name:u.Constants.Telemetry.TokenScope,string:i&&!n?i.toString():"unknown"},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.ErrorCode,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"},{name:u.Constants.Telemetry.ErrorCodeForGetToken,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:u.Constants.Telemetry.ErrorMessageForGetToken,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"}];c.sendTelemetryEvent({name:u.Constants.Telemetry.GetTokenTelemetryName,dataFields:s})}return e.Telemetry={timeToGetToken:o.ms,succeeded:!e.Token,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:i?i.toString():void 0,correlationId:t,errorCode:e.ErrorCode?e.ErrorCode:void 0,errorMessage:e.ErrorMessage?e.ErrorMessage:void 0,errorCodeForGetToken:e.ErrorCode?e.ErrorCode:void 0,errorMessageForGetToken:e.ErrorMessage?e.ErrorMessage:void 0,fromCache:!!e.MsalResult&&!!e.MsalResult.fromCache,expiresOn:e.MsalResult&&e.MsalResult.expiresOn?e.MsalResult.expiresOn.getTime()/1e3:void 0},e}function w(e){var t;if(i&&i.some((function(r){return!(!e||!r.applicationId||e.toUpperCase()!==r.applicationId.toUpperCase()||(t=r.application,0))})),!t){t=new s.PublicClientApplication({auth:{clientId:e,authority:a.authority,redirectUri:a.redirectUri?a.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!a.navigateToLoginRequestUrl||a.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:a.timeout?a.timeout:6e3}});var r={applicationId:e,application:t};i.push(r)}return t}function C(e){return["HTTPS:","API:"].some((function(t){return e.toLocaleUpperCase().startsWith(t)}))||T(e)?e+"/.default":e}function T(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function S(e,t,r,n,o,i,s){var l=[{name:u.Constants.Telemetry.Duration,int64:n.ms},{name:u.Constants.Telemetry.Succeeded,bool:!i},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.ApplicationId,string:r},{name:u.Constants.Telemetry.TokenScope,string:o?o.toString():"unknown"},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.ErrorCode,string:i||"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:s||"unknown"},{name:u.Constants.Telemetry.ErrorCodeForCheckUpn,string:i||"unknown"},{name:u.Constants.Telemetry.ErrorMessageForCheckUpn,string:s||"unknown"}];a.telemetryInstance||"undefined"!=typeof OTel||c.sendTelemetryEvent({name:u.Constants.Telemetry.CheckUpnTelemetryName,dataFields:l}),e.Telemetry={timeToCheckUPN:n.ms,succeeded:!i,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:o?o.toString():void 0,correlationId:t,errorCode:i,errorMessage:s,errorCodeForCheckUPN:i,errorMessageForCheckUPN:s}}function A(e){if(!f)return h.LoggingUtils.log("Skip Upn check of id token, returning true",p),!0;if(!a||!a.upn)return h.LoggingUtils.log("Upn does not exist in the configuration, returning true",p),!0;var t=l.ExtractUtils.extractToken(e);return!!(!t||t&&t.preferred_username&&t.preferred_username.toLowerCase()===a.upn.toLowerCase())||(h.LoggingUtils.log("provided Upn does not match Upn extracted from id token",p),!1)}t.Load=g,t.GetToken=y,t.GetTokenOnce=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),g({idp:r?u.Constants.IdentityProvider.Msa.toLowerCase():u.Constants.IdentityProvider.Aad.toLowerCase(),appIds:[t],authority:n?u.Constants.Authority.Ppe:u.Constants.Authority.Prod,upn:"",autoPopup:!0,enableConsoleLogging:!0}),y(e,t,void 0,!0)},t.GetApplication=w,t.CheckUpnMatchIdToken=function(e,t){var r=d.TimerUtils.timer();t&&T(t)||(t=void 0);var n={};if(!e||!T(e))return n.ErrorCode="invalid_application_ID",n.ErrorMessage="The provided application ID for BrowserAuth.CheckUpnMatchIdToken is null, blank, empty or with invalid format",S(n,t,e,r,void 0,n.ErrorCode,n.ErrorMessage),Promise.reject(n);var o=w(e),i=[e];return new Promise((function(s,c){h.LoggingUtils.log("Config: "+JSON.stringify(o),p);var u=o.getAccountByUsername(a.upn);h.LoggingUtils.log("application calls acquireTokenSilent",p),o.acquireTokenSilent({scopes:i,account:u,correlationId:t}).then((function(o){if(n.IsUpnMatch=A(o.idToken),n.IsUpnMatch)return S(n,t,e,r,i),s(n)})).catch((function(o){return n.ErrorCode=o.errorCode,n.ErrorMessage=o.errorMessage,h.LoggingUtils.log("acquireToken->error: "+n.ErrorMessage,p),n.IsUpnMatch=!1,S(n,t,e,r,i,o.errorCode,o.errorMessage),c(n)}))}))},t.GetAuthConfig=function(){return new Promise((function(e,t){new Promise((function(e,t){if(window.location.hash){var r=window.location.hash;r.indexOf("#/")>-1?r=r.substring(r.indexOf("#/")+2):r.indexOf("#")>-1&&(r=r.substring(1));for(var n=r.split("&"),o=0;o<n.length;o++){var i=n[o].split("=");if("state"==decodeURIComponent(i[0])){var a=decodeURIComponent(i[i.length-1]).split("|");2==a.length&&e(a[1])}}}t()})).then((function(t){window.addEventListener("message",(function(t){t.origin&&t.origin==location.origin&&t.data&&t.data.config&&t.data.request&&t.data.request==u.Constants.PostMessageType.ResponseAuthConfig&&e(t.data.config)}),!1),parent.postMessage({request:u.Constants.PostMessageType.RequestAuthConfig,iframe:t},location.origin)}),(function(){t({})}))}))},t.Logout=function(){i.forEach((function(e){h.LoggingUtils.log("application calls logout",p),e.application.logout()})),i=new Array}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(){}return e.Aad="aad",e.Msa="msa",e}();e.IdentityProvider=t;var r=function(){function e(){}return e.RequestAuthConfig="RequestAuthConfig",e.ResponseAuthConfig="ResponseAuthConfig",e.iFrameIdTokenPrefix="msalIdTokenFrame",e.iFramePrefix="msalRenewFrame",e}();e.PostMessageType=r;var n=function(){function e(){}return e.Prod="https://login.microsoftonline.com/",e.ProdLegacy="https://login.windows.net/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="organizations",e.MsaSuffix="consumers",e}();e.Authority=n;var o=function(){function e(){}return e.OtelInstance="otel",e.CheckUpnTelemetryName="Office.Identity.WebAuth.BrowserAuth.CheckUpn",e.GetTokenTelemetryName="Office.Identity.WebAuth.BrowserAuth.GetToken",e.LoadTelemetryName="Office.Identity.WebAuth.BrowserAuth.Load",e.Duration="Duration",e.Succeeded="Succeeded",e.ApplicationId="ApplicationId",e.CorrelationId="CorrelationId",e.IdentityProvider="IdentityProvider",e.LoadedApplicationCount="LoadedApplicationCount",e.TokenScope="TokenScope",e.ErrorCode="ErrorCode",e.ErrorMessage="ErrorMessage",e.ErrorCodeForLoad="ErrorCodeForLoad",e.ErrorMessageForLoad="ErrorMessageForLoad",e.ErrorCodeForGetToken="ErrorCodeForGetToken",e.ErrorMessageForGetToken="ErrorMessageForGetToken",e.ErrorCodeForCheckUpn="ErrorCodeForCheckUpn",e.ErrorMessageForCheckUpn="ErrorMessageForCheckUpn",e}();e.Telemetry=o}(t.Constants||(t.Constants={}))},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),o=function(){function e(){}return e.extractToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=this.base64Decode(r);return o?JSON.parse(o):(n.LoggingUtils.log("The returned token could not be base64 url safe decoded."),null)}catch(e){n.LoggingUtils.error("The returned token could not be decoded"+e)}return null},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))},e.decodeJwt=function(e){if("undefined"===e||!e||0===e.length)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(n.LoggingUtils.warn("The returned access_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e}();t.ExtractUtils=o},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.log=function(e,t){return!!this.shouldProceed(t)&&(console.log(e),!0)},e.warn=function(e,t){return!!this.shouldProceed(t)&&(console.warn(e),!0)},e.error=function(e,t){return!!this.shouldProceed(t)&&(console.error(e),!0)},e.shouldProceed=function(e){return!(null!=e&&void 0!==e&&!e)},e}();t.LoggingUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds/1e3)+"s"},get formattedMs(){return this.ms+"ms"}}},e}();t.TimerUtils=n},0:function(e,t,r){r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js"),e.exports=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts")}})},7372:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof y?t:y,i=Object.create(o.prototype),a=new _(n||[]);return i._invoke=function(e,t,r){var n=h;return function(o,i){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===o)throw i;return O()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=b(a,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?f:d,c.arg===g)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",g={};function y(){}function m(){}function v(){}var E={};E[i]=function(){return this};var w=Object.getPrototypeOf,C=w&&w(w(k([])));C&&C!==r&&n.call(C,i)&&(E=C);var T=v.prototype=y.prototype=Object.create(E);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function b(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,b(e,r),"throw"===r.method))return g;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=l(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function k(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:O}}function O(){return{value:t,done:!0}}return m.prototype=T.constructor=v,v.constructor=m,m.displayName=c(v,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,s,"GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},S(A.prototype),A.prototype[a]=function(){return this},e.AsyncIterator=A,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new A(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(T),c(T,s,"Generator"),T[i]=function(){return this},T.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";r(2186),r(6546),r(7372),r(8212),r(1817);var e,t,n,o,i=r(2309);function a(e,t,r){window.parent.postMessage(JSON.stringify(function(e,t){return{MessageId:e,SendTime:Date.now(),Values:t}}(e,r)),t)}function s(e,t){void 0===t&&(t=n.debug),(t===n.error?console.error:console.debug)("sharedauthclient.js: "+e)}function c(e){return e&&["aad","msa"].includes(e)?e:"aad"}function u(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function l(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(e){e.init="SharedAuth_Init",e.tryGetToken="SharedAuth_TryGetToken",e.tryLogin="SharedAuth_TryLogin",e.showSignInCancelButtons="SharedAuth_ShowSignInCancelButtons"}(e||(e={})),function(e){e.scriptLoaded="SharedAuth_ScriptLoaded",e.scriptInitialized="SharedAuth_ScriptInitialized",e.getTokenResponse="SharedAuth_GetTokenResponse",e.loginResponse="SharedAuth_LoginResponse",e.interactiveFlowReady="SharedAuth_InteractiveFlowReady",e.hideDialog="SharedAuth_HideDialog",e.closeDialog="SharedAuth_CloseDialog"}(t||(t={})),function(e){e[e.debug=0]="debug",e[e.error=1]="error"}(n||(n={})),function(e){e.timeout="Timeout",e.general="Token Renewal Failed",e.renewal="token_renewal_error"}(o||(o={})),Object.create,Object.create;var h=function(){function r(t){var r=this;this.receiveMessage=function(t){if(!r.isValidOrigin(t.origin))return!1;var n=!0,o=JSON.parse(t.data);switch(o.MessageId){case e.init:r.init(o);break;case e.tryGetToken:r.tryGetToken(o);break;case e.tryLogin:r.tryLogin(o);break;default:n=!1,s("Unsupported Message ID "+o.MessageId)}return n},this._authLibraryVersion=t.authLibraryVersion,this._validatedReplyUrl=t.validatedReplyUrl,this._load=t.load,this._tryGetToken=t.tryGetToken,this._tryLogin=t.tryLogin,this._interactive=t.interactive,t.interactive||this.reportScriptLoaded(!!this._validatedReplyUrl.hostname)}return r.prototype.start=function(){window.addEventListener("message",this.receiveMessage)},r.prototype.isValidOrigin=function(e){var t,r=new URL(e);return!(!(null===(t=this._validatedReplyUrl)||void 0===t?void 0:t.hostname)||0!==r.hostname.localeCompare(this._validatedReplyUrl.hostname))},r.prototype.reportScriptLoaded=function(e){this._validatedReplyUrl&&a(t.scriptLoaded,this._validatedReplyUrl.toString(),{Success:e,AuthLibrary:this._authLibraryVersion})},r.prototype.init=function(e){return u(this,void 0,void 0,(function(){var r,n,o,i,s;return l(this,(function(c){switch(c.label){case 0:r=e.Values,n=r.interactive,c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,this._load(r)];case 2:return o=c.sent(),i=!0,[3,5];case 3:return s=c.sent(),o=s,i=!1,[3,5];case 4:return a(t.scriptInitialized,this._validatedReplyUrl.toString(),{response:o,isSuccess:i,interactive:n}),[7];case 5:return[2]}}))}))},r.prototype.tryGetToken=function(e){return u(this,void 0,void 0,(function(){var r,n,o=this;return l(this,(function(i){return r=e.Values,n=function(e){return u(o,void 0,void 0,(function(){var r,n;return l(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this._tryGetToken(e)];case 1:return r=o.sent(),a(t.getTokenResponse,this._validatedReplyUrl.toString(),{response:r,messageCorrelationId:e.messageCorrelationId,isSuccess:!0}),[3,3];case 2:return n=o.sent(),a(t.getTokenResponse,this._validatedReplyUrl.toString(),{response:n,messageCorrelationId:e.messageCorrelationId,isSuccess:!1}),[3,3];case 3:return[2]}}))}))},r.withPopup&&this._interactive?this._activeTryGetTokenRequest=function(){return u(o,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,n(r)];case 1:return e.sent(),this._activeInteractiveCorrelationId=this._activeTryGetTokenRequest=void 0,[2]}}))}))}:n(r),[2]}))}))},r.prototype.tryLogin=function(e){return u(this,void 0,void 0,(function(){var r,n=this;return l(this,(function(o){return r=e.Values,this._tryLogin(r).then((function(e){return a(t.loginResponse,n._validatedReplyUrl.toString(),{response:e,messageCorrelationId:r.messageCorrelationId,isSuccess:!0})})).catch((function(e){return a(t.loginResponse,n._validatedReplyUrl.toString(),{response:e,messageCorrelationId:r.messageCorrelationId,isSuccess:!1})})),[2]}))}))},r}();function d(e){var t,r,n,o;return e.authorityType=c(e.authorityType),{upn:e.upn,authority:e.authority,idp:c(e.authorityType),appIds:null!==(t=e.appIds)&&void 0!==t?t:[],enableConsoleLogging:null!==(r=e.enableConsoleLogging)&&void 0!==r&&r,autoPopup:null!==(n=e.enablePopupFlash)&&void 0!==n&&n,enableUpnCheck:null===(o=!e.skipUpnCheck)||void 0===o||o}}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){p(i,n,o,a,s,"next",e)}function s(e){p(i,n,o,a,s,"throw",e)}a(void 0)}))}}var g=function(){var e=f(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.Load)(d(t),t.correlationId);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=f(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.GetToken)(t.target,t.appId,void 0,!1,t.withPopup,"93d53678-613d-4013-afc1-62e9e444a0a5"===t.appId,t.claims);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=f(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.GetApplication)(t.appId).loginPopup(t.claims).then((function(){return y(t)})).catch((function(){return Promise.reject()})),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();!function(e,r,o,i,c){var u,l,d=!1,p="*";try{var f=new URL(window.location.href),g=f.searchParams.get("replyUrl"),y="1"===f.searchParams.get("interactive"),m=null===(u=document.getElementById("sharedauthscript"))||void 0===u?void 0:u.dataset.origin;if(g&&m){s("initializing");var v=new URL(m);(l={authLibraryVersion:e,validatedReplyUrl:v,load:r,tryGetToken:o,tryLogin:i,interactive:y},new h(l)).start(),d=!0,p=v.origin,s("initialized successfully")}}catch(e){s("error during script initialization",n.error)}a(t.scriptLoaded,p,{Success:d,AuthLibrary:e})}("BrowserAuth 1.20210701.2/MSAL 2.11.0",g,y,m)}()}();