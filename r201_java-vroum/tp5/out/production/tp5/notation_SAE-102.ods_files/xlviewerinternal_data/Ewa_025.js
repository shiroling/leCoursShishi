Type.registerNamespace("Common.App.Rename");Common.App.Rename.c=function(){};Common.App.Rename.c.registerInterface("Common.App.Rename.c");Common.App.Rename.x=function(){};Common.App.Rename.x.registerInterface("Common.App.Rename.x");Common.App.Rename.i=function(){};Common.App.Rename.i.registerInterface("Common.App.Rename.i");Common.App.Rename.j=function(){};Common.App.Rename.j.registerInterface("Common.App.Rename.j");Common.App.Rename.k=function(){};Common.App.Rename.k.registerInterface("Common.App.Rename.k");Common.App.Rename.y=function(){};Common.App.Rename.w=function(n,t,i,r,u,f){this.o=Function.createDelegate(this,this.l);this.f=new($$sc.w.$$(Date));this.c=t;this.q=n;this.k=i;this.j=r;this.p=u;this.i=f};Common.App.Rename.w.prototype={f:null,c:null,q:null,k:null,j:null,p:null,i:null,e:!1,a:function(){this.e||(this.b(),this.D(),this.e=!0)},r:function(n,t,i){return String.format("{0}/{1}/{2}",i,n,t)},z:function(){var n=Common.d.d(this.c().a());return this.r(this.c().b(),this.c().d(),n)},A:function(n,t,i){return n&&t?this.r(n,t,i):i},x:function(n,t,i){return n&&n!==this.c().b()?!0:t&&t!==this.c().d()?!0:i!==Common.d.d(this.c().a())},b:function(){var n=this.z();this.f.b(n,new Date)},l:function(n){this.C(n)&&this.w(n)},C:function(n){var t=this.j();return t?this.i&&this.i.c()||!t.c()||!Common.a.bf?(this.E(n),this.e=!1,!1):!0:!1},s:function(n,t,i,r){var u=this.x(n,t,i),f=this.A(n,t,i),e,o,s,h=(s=this.f.f(f,o={val:e},null),e=o.val,s);u&&!h&&(this.B(r),Diag.a.a(591734297,203,50,"{0} forced FileNameUpdate",this.y()));u||this.f.b(f,this.k())}};Common.App.Rename.q=function(){this.f=Function.createDelegate(this,this.h)};Common.App.Rename.q.prototype={d:null,e:null,a:function(){return"Common.App.RenameFile"},c:function(n){var t,r,i,u;this.d=n;this.e=Common.a.a;t=this;this.d.c(Common.App.Rename.m,null).c(Common.App.Rename.i,null).b(function(){return new Common.App.Rename.m(Common.a.c(),t.d.e(Common.App.Rename.j,null))}).a();r=this;this.d.c(Common.App.Rename.d,null).c(Common.App.Rename.j,null).b(function(){return new Common.App.Rename.d(Common.a.c())}).a();i=this;this.d.c(Common.App.Rename.c,null).b(function(){return i.g()}).a();u=this;this.d.c(Common.App.Rename.o,null).c(Common.App.Rename.k,null).b(function(){return new Common.App.Rename.o(Common.a.c())}).a()},g:function(){var n;if(this.e.a("RenamedFileCheckerWithSettingsRefreshIsEnabled")&&(n=this.d.d(Common.dJ,null),n&&n.g())){var r=this,u=this,f=this,e=this,o=this;return new Common.App.Rename.t(function(){return n.c("RenamedFileCheckerMaxCachedAgeInMs",48e4)},function(){return Common.a.l},function(){return new Date},function(){return Common.a.B},n,this.d.d(Common.fU,null),function(){return Common.App.Rename.a.b()},this.d.b(Common.T,null))}var t=this,i=this,s=this,h=this,c=this;return new Common.App.Rename.u(function(){return t.e.c("RenamedFileCheckerMaxCachedAgeInMs",48e4)},function(){return i.e.c("RenamedFileCheckerPingIntervalInMs",12e4)},function(){return Common.a.l},function(){return new Date},function(){return Common.a.B},Common.a.a,Common.a.c(),Common.a.k(),this.d.d(Common.fU,null),this.d.b(Common.App.VisibilityManagement.a,null))},b:function(){this.e.k(this.f)},h:function(){var n=Common.a.b().a().c(),t;Common.a.bK()&&Common.App.Rename.b.b().b(Common.a.cc,n?null:Common.a.bp,n?null:Common.a.cX||$a.cH)&&(t=this,this.d.c(Common.App.Rename.p,null).c(Common.eS,null).b(function(){return new Common.App.Rename.p(function(){return Common.a.df},function(){return Common.a.dv},Common.a.ci,Common.a.bK,new($$sc.z.$$(Common.fK))(function(){return Common.a.B}))}).a(),Common.App.Rename.a.b().K(),this.e.a("RenameDialogIsEnabled")&&(this.d.a(Common.App.Rename.d,null).f(Common.a.l,Common.a.cc),this.d.a(Common.App.Rename.i,null).a()),this.d.a(Common.App.Rename.k,null).a(),Common.a.ci&&this.d.a(Common.App.Rename.c,null).a())}};Common.App.Rename.z=function(){};Common.App.Rename.z.a=function(){Common.App.a.a().a(new Common.App.Rename.q,7,!1)};Common.App.Rename.a=function(n,t,i,r,u,f,e,o,s,h,c,l){this.h=Function.createDelegate(this,this.G);this.i=Function.createDelegate(this,this.H);this.t=Function.createDelegate(this,this.I);this.u=Function.createDelegate(this,this.p);this.r=Function.createDelegate(this,this.E);this.s=Function.createDelegate(this,this.F);this.v=Function.createDelegate(this,this.J);this.w=Function.createDelegate(this,this.L);this.x=Function.createDelegate(this,this.O);this.q=Function.createDelegate(this,this.D);this.z=n;this.j=t;this.k=i;this.a=r;this.d=u;this.n=f;this.c=e;this.f=o;this.l=s;this.e=h;this.y=c;this.m=l};Common.App.Rename.a.b=function(){return Common.App.Rename.a.a||(Common.App.Rename.a.a=Common.App.Rename.a.d())};Common.App.Rename.a.d=function(){var n=Common.App.Rename.b.b();return new Common.App.Rename.a(Common.a.bK,new($$sc.z.$$(Common.fI))(function(){return Common.a.c()}),new($$sc.z.$$(Common.fK))(function(){return Common.a.B}),Common.a.l,Common.a.M,function(){return Common.a.df},Common.a.ci,n.a||(n.a=Function.createDelegate(n,n.c)),Common.Utils.a.a().a(Common.App.Rename.c,null),function(){return Common.a.dv},Common.a.a,Common.Utils.a.a().a(Common.eS,null))};Common.App.Rename.a.c=function(n,t){var i=Common.d.i(n);return t+i};Common.App.Rename.a.f=function(n){var t=n.Values.isMoveSuccessful;Diag.a.a(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",t);t?Common.a.c().c(2482841374,2,n.Values,null):Common.i.a().recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)};Common.App.Rename.a.e=function(n){Common.a.c().c(1897077126,2,n.Values.NewName,null)};Common.App.Rename.a.prototype={j:null,k:null,a:null,d:!1,n:null,c:!1,z:null,f:null,l:null,e:null,y:null,m:null,K:function(){if(Common.a.b()&&Common.a.b().a().c()||this.b().a(3740310824,2147483648,this.q),this.b().a(2638199087,2147483648,this.x),this.b().a(1897077126,2147483648,this.w),this.b().b(3537588550,2147483648,this.v,64),this.b().b(2482841374,2147483648,this.s,64),this.b().a(1182470434,2147483648,this.r),Common.a.b()&&(Common.a.a.a("PostMessageEmbedded")||Common.a.a.a("IsJsApi"))&&Common.a.a.d("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)){var n=this;Common.a.J().a(function(n){n.c("Host_MoveToFolder");n.b("Host_MoveToFolder",Common.App.Rename.a.f);n.c("File_Rename");n.b("File_Rename",Common.App.Rename.a.e)})}},g:function(){return this.m.a()?8:32},R:function(){return this.o()?this.c?this.o().b():this.o().a():!0},D:function(){var n=Common.App.Rename.b.b().b(Common.a.cc,Common.a.bp,Common.a.cX||$a.cH);return n?32:8},O:function(){var n=this.R(),t=this.n();return Diag.a.a(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.d,t,n,this.c),Common.a.b()&&Common.a.b().a().d()&&Common.a.a.a("ReactRenameDisabledDialogIsEnabled")?new Common.App.Rename.s(this.d,!t,!n,this.c,this.e()):new Common.App.Rename.f(this.d,!t,!n,this.c,this.e()),32},L:function(n,t,i,r,u){return i===1?this.g():Common.a.cb?this.g()===8?(this.b().d(2638199087,2,null),8):(Diag.a.a(38114562,203,50,"RenameFileAttempt"),Common.a.cb(u,this.u,this.t),32):8},p:function(n,t){if(!n){this.A(5);return}if(n.OperationResult){this.A(n.OperationResult);return}this.M(t,n.NewName);this.P(n,Common.a.b().a().Q);Common.a.a.a("DocumentNameInJewelInfoMenuIsEnabled")&&Common.a.b().c(!1);this.l.b()},M:function(n,t){var i={};i.NewName=t;n.a("File_Rename",i,"")},P:function(n,t){this.Q(n);Common.a.ca=n.DirectInvokeDavUrl;var r=t(n.EditDocInClientUrl),i=new Common.il;i.c=this.a.a();i.a=r;i.b=n.EditDocInClientUrl;this.b().c(3502386740,2,i,null)},A:function(n){switch(n){case 1:var t=new CommonUI.d;t.D(0);t.bL($a.Q,$a.cy,null);this.B()}},Q:function(n){this.a.f(Common.App.Rename.a.c(this.a.a(),n.NewName));n.BreadcrumbFolderName&&this.a.g(n.BreadcrumbFolderName);n.BreadcrumbFolderUrl&&this.a.h(n.BreadcrumbFolderUrl);this.f(n.NewName)},I:function(n){var t=new CommonUI.d,i;t.D(0);switch(n){case 1:Diag.a.a(38114563,203,50,"OnRenameFileFailure: InvalidFileName");t.cc($a.Q,$a.cy,null);break;case 6:Diag.a.a(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");t.cc($a.Q,$a.lI,null);break;default:Diag.a.a(38114565,203,15,"OnRenameFileFailure: {0}",{Result:n});t.cc($a.lH,$a.lG,null)}i=this;Common.a.J().a(function(t){t.a("File_RenameFailed",{FailureMessage:Common.fv.toString(n)},"")});this.B()},J:function(n,t,i){return i===1?this.g():Common.a.bf?(Common.a.bf(this.i,this.h,!1),32):8},E:function(n,t,i,r,u){var f,v,e,h,c;if(i===1)return Common.a.a.d("Microsoft.Office.SharedOnline.DTTMoveButton",!1)&&Common.a.a.a("UiHostSupportsMoveToFolder")?32:8;if(i===2){var o={},s=Common.a.K,l=Common.a.a.a("UiHostSupportsDocRebootFeatures"),a=(!s||s&&l)&&Common.a.a.d("Microsoft.Office.SharedOnline.CrossSiteMove",!1);return o.supportsCrossSiteMove=a,f=u,f&&f.MoveButtonClickedTime&&(o.moveStartTime=f.MoveButtonClickedTime.getTime()),v=this,Common.a.J().a(function(n){n.a("App_MoveToFolder",o,"")}),f&&f.MoveButtonClickedTime&&(e=this.C(),e&&(h=(new Date).getTime(),c=h-f.MoveButtonClickedTime.getTime(),e.set("MovePostDuration",c.toString())),Common.i.a().recordKpiUsage("MoveToFolder",0,"smartfio",e)),32}return 8},F:function(n,t,i,r,u){var e,o,f,l;if(i===1)return Common.a.a.a("UiHostSupportsMoveToFolder")?this.g():8;if(i===2){if(!Common.a.eB)return Common.i.a().recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!u)return Common.i.a().recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(e=u,o=e.isCrossSiteMove,o)if(e.updatedDocumentUrl){var s=e.updatedDocumentUrl.toLowerCase(),c=Common.a.a.a("UiHostSupportsDocRebootFeatures"),h=Common.a.a.d("Microsoft.Office.SharedOnline.CrossSiteMove",!1);if(c&&Common.a.K&&h)f={},f.rebootMode="1",f.documentUrl=s,f.reason="saveAs",Common.i.a().recordKpiSuccess("MoveToFolder",null),l=this,Common.a.J().a(function(n){n.a("App_DocReboot",f,"")});else if(!Common.a.K&&h)Common.i.a().recordKpiSuccess("MoveToFolder",null),Common.g.b(s,Common.g.g(3),"","RenameActor.MoveToFolderCompleteByHost");else return Common.i.a().recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8}else Common.i.a().recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Common.a.bf(this.i,this.h,!1),Common.a.eB(),Common.i.a().recordKpiSuccess("MoveToFolder",null)}return 32},N:function(n,t){return!n||!t?!1:n!==this.a.b()||t!==this.a.d()},H:function(n,t){n&&(n.NewName!==Common.d.d(this.a.a())||this.N(n.BreadcrumbFolderName,n.BreadcrumbFolderUrl))&&this.p(n,t)},G:function(){},B:function(){this.f(Common.d.d(this.a.a()))},b:function(){return this.j.a()},o:function(){return this.k.a()},C:function(){try{return new Map}catch(n){return null}}};Common.App.Rename.v=function(n,t,i){this.e=Function.createDelegate(this,this.f);Common.App.Rename.v.initializeBase(this,[!1,!1,!1,!1]);this.d=n;this.b=t;this.c=i;this.H="RenameDialog";this.M=Common.App.Rename.e.b()};Common.App.Rename.v.prototype={d:null,b:null,c:0,a:function(){var t={txtDocumentName:Common.d.d(this.b.a())},n;this.G($a.cx,this.e,t);n=document.getElementById("txtDocumentName");this.c>0&&(n.maxLength=this.c);n.focus()},f:function(n,t){if(n===1){var r=Common.d.d(this.b.a()),i=(t.txtDocumentName||"").trim();if(i!==r&&i!==""){this.d.c(1897077126,2,i,null);return}}Common.bQ.b().a("DoNothingResult",{Reason:"FileNameUnchanged"})}};Common.App.Rename.r=function(n,t,i){this.f=Function.createDelegate(this,this.h);this.d=n;this.c=t;this.e=i};Common.App.Rename.r.prototype={b:null,d:null,c:null,e:0,g:function(){var n={};return n.nameInputProps={type:"AppInputProps",id:"txtDocumentName",label:$a.cw,value:Common.d.d(this.c.a()),maxLength:this.e},n},a:function(){var n=this.g(),t={id:"RenameDialog",bodyControls:n};this.b=new CommonUI.b(!1,!1,!0,!1);this.b.D(1);this.b.H="RenameDialog";this.b.G($a.cx,this.f,t)},h:function(n,t){if(t&&n===1){if(t.txtDocumentName){var r=Common.d.d(this.c.a()),i=(t.txtDocumentName||"").trim();if(i!==r&&i!==""){this.d.c(1897077126,2,i,null);return}}Common.bQ.b().a("DoNothingResult",{Reason:"FileNameUnchanged"})}}};Common.App.Rename.m=function(n,t){this.d=Function.createDelegate(this,this.e);this.b=n;this.c=t};Common.App.Rename.m.prototype={b:null,c:null,a:function(){this.b.a(2382951455,2147483648,this.d)},e:function(n,t,i){var r=32,u,f,e;return i===1?Common.bZ.a().a()||Common.a.z?8:32:(i===2&&(u=this.b.d(1897077126,1,null),u!==32?(this.b.d(2638199087,2,null),Common.bQ.b().a("FailedProcessingStep",{Reason:"RenameDisabled"}),r=8):(f=this.b.d(2679862750,1,null),f===32?this.b.d(2679862750,2,null):(e=this.c.a().a(),e.a()))),r)}};Common.App.Rename.d=function(n){this.b=n;this.e=!1};Common.App.Rename.d.prototype={b:null,c:null,d:0,e:!1,f:function(n,t){this.c=n;this.d=t;this.e=!0},a:function(){return this.e?Common.a.b()&&Common.a.b().a().d()&&Common.a.a.a("ReactRenameDialogIsEnabled")?new Common.App.Rename.r(this.b,this.c,this.d):new Common.App.Rename.v(this.b,this.c,this.d):null}};Common.App.Rename.f=function(n,t,i,r,u){Common.App.Rename.f.initializeBase(this,[!1,!1,!1,!1]);this.a=new Common.App.Rename.n(n,t,i);this.c=r;this.b=u;this.H="RenameDisabledDialog";this.D(0);this.E(1,$a.b);this.M=Common.App.Rename.g.b();this.bz($a.cE,null);this.bm("RenameRow")};Common.App.Rename.f.a=function(n,t,i){n.style.display="none";t.innerText=i};Common.App.Rename.f.prototype={a:null,c:!1,b:!1,cr:function(){if(this.a.a){var n="";n=this.c?this.b?$a.cG:$a.cF:$a.cA;Common.App.Rename.f.a(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),n)}else this.a.b?Common.App.Rename.f.a(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),$a.cC):this.d()},d:function(){this.a.e&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.a.d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.a.c&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}};Common.App.Rename.n=function(n,t,i){this.a=!n&&!t;this.b=!n&&!i;this.a||this.b||(this.e=!n,this.d=!t,this.c=!i)};Common.App.Rename.n.prototype={a:!1,b:!1,e:!1,d:!1,c:!1};Common.App.Rename.t=function(n,t,i,r,u,f,e,o){this.g=Function.createDelegate(this,this.n);Common.App.Rename.t.initializeBase(this,[n,t,i,r,u,f]);this.d=u;this.m=e;this.h=o};Common.App.Rename.t.prototype={d:null,m:null,h:null,y:function(){return"RenamedFileCheckerUsingSettingsRefresh"},D:function(){this.d.d(this.g)},n:function(n,t){t&&t.a&&t.d&&(t.b("BreadcrumbDocName")||t.b("BreadcrumbFolderName")||t.b("BreadcrumbFolderUrl")||t.b("DirectInvokeDAVUrl")||t.b("EditDocInClientUrl"))&&(Diag.a.a(591229211,203,50,"{0}: Possible rename detected.",this.y()),this.l(t))},E:function(){this.d.j(this.g)},w:function(n){if(n&&n.a){var t=n.a;this.s(t.b("BreadcrumbFolderName"),t.b("BreadcrumbFolderUrl"),t.b("BreadcrumbDocName"),n)}},B:function(n){var t={},i,r,u;t.OperationResult=0;t.classId=1;i=n.a;t.BreadcrumbFolderName=i.b("BreadcrumbFolderName");t.BreadcrumbFolderUrl=i.b("BreadcrumbFolderUrl");t.DirectInvokeDavUrl=i.b("DirectInvokeDAVUrl");t.EditDocInClientUrl=i.b("EditDocInClientUrl");r=i.b("BreadcrumbDocName");t.NewName=Common.a.R?r:Common.d.d(r);u=this;this.h.a(function(n){u.t(t,n)})},t:function(n,t){this.m().p(n,t)}};Common.App.Rename.u=function(n,t,i,r,u,f,e,o,s,h){if(this.u=Function.createDelegate(this,this.G),this.v=Function.createDelegate(this,this.H),this.t=Function.createDelegate(this,this.F),Common.App.Rename.u.initializeBase(this,[n,i,r,u,f,s]),this.n=t,this.m=e,this.g=o,h){var c=this;h.a(function(n){c.I(n)})}};Common.App.Rename.u.prototype={n:null,m:null,g:null,h:null,d:null,y:function(){return"RenamedFileCheckerUsingTask"},I:function(n){this.h=n;this.h.a(this.t)},F:function(n,t){!this.e||t.b&&t.b!==1||this.d||(this.D(),this.l(this.d))},D:function(){this.d=new Common.V(3,2,this.n(),this.o,89,null,!1,0);this.g.a(this.d)},E:function(n){this.g.b(n)},w:function(n){if(this.h&&this.h.b()===2){this.J(n);return}Common.a.bf(this.v,this.u,!0)},J:function(n){this.g.b(n);this.d=null},H:function(n){n&&this.s(n.BreadcrumbFolderName,n.BreadcrumbFolderUrl,n.NewName,null)},B:function(){this.m.d(3537588550,2,null)},G:function(){}};Common.App.Rename.o=function(n){this.c=Function.createDelegate(this,this.e);this.b=n};Common.App.Rename.o.prototype={b:null,a:function(){this.b.a(2679862750,2147483648,this.c)},d:function(){return Common.F.d("setDocumentTitleFlyoutOpened")&&Common.a.b().a().c()},e:function(n,t,i){return i===1?this.d()?32:8:(appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0)),32)}};Common.App.Rename.p=function(n,t,i,r,u){this.c=u;this.b=i;this.e=r;this.f=n;this.d=t};Common.App.Rename.p.prototype={c:null,b:!1,e:null,d:null,f:null,g:function(){return this.c.a()},a:function(){if(!this.e())return 5;if(this.d())return 1;if(this.g()){if(this.b&&!this.g().b())return 3;if(!this.b&&!this.g().a())return 4}return this.f()?0:2}};Common.App.Rename.h=function(n,t,i,r,u,f,e,o,s,h,c,l){this.B=Function.createDelegate(this,this.L);this.A=Function.createDelegate(this,this.K);this.y=Function.createDelegate(this,this.G);this.z=Function.createDelegate(this,this.J);this.x=Function.createDelegate(this,this.F);this.e=n;this.i=t;this.u=i;this.q=r;this.k=u;this.r=f;this.g=e;this.j=o;this.f=s;this.o=h;this.n=c;this.l=l};Common.App.Rename.h.b=function(){Common.t.p(Common.a.h)};Common.App.Rename.h.a=function(){return new Common.App.Rename.h(Common.a.c(),Common.s.a(),Common.h.a(),Common.f.a(),Common.a.l,Common.App.Rename.h.b,Common.g.P,Common.g.E,Common.Utils.a.a().b(Common.dX,null),Common.c.n(),Common.c.c(),Common.c.b())};Common.App.Rename.h.prototype={t:!1,e:null,i:null,u:null,q:null,f:null,k:null,r:null,g:null,j:null,d:null,p:0,o:!1,n:!1,l:!1,m:!1,s:!1,h:function(){return this.d.getAttribute("contentEditable")==="true"},b:function(n,t,i){return!this.e||!this.k||!this.r||!this.g||!this.j||!t||n<=0?!1:(this.d=t,this.d.title=i,this.d.setAttribute("role","button"),this.d.setAttribute("Unselectable","on"),this.p=n,this.M(),this.t=!0,!0)},M:function(){this.i&&(this.i.a("blur",this.d,this.x),this.i.a("paste",this.d,this.z));this.u.a("keydown",this.d,this.y);this.q.a("msospPointerDown",this.d,this.A);this.q.a("msospPointerUp",this.d,this.B)},F:function(){return this.h()&&!this.m&&(this.o||this.j(this.d),this.C(),this.v(!1)),this.m=!1,!1},J:function(){return Diag.a.a(4281482,203,15,"Attempting to paste into the document title"),!0},G:function(n){return this.h()?this.H(n):this.I(n)},H:function(n){var i=n.a.keyCode,t=!1;switch(i){case 13:this.C();this.v(this.n||this.l);t=!0;break;case 9:this.o&&this.j(this.d);break;case 27:this.w();this.v(this.n||this.l);t=!0}return t},I:function(n){var i=n.a.keyCode,t=!1;switch(i){case 13:case 32:this.D(this.l);this.h()&&this.g(this.d);t=!0}return t},K:function(){return this.h()||(this.D(!1),this.h()&&(this.d.focus(),this.g(this.d),this.s=!0)),!1},L:function(){return this.s?(this.g(this.d),this.s=!1,!0):!1},E:function(){var n=this.e.d(1897077126,1,null);return n===32},C:function(){var i=Common.d.d(this.k.a()),n=this.d.innerText.trim(),t;n.length>this.p&&(n=n.substr(0,this.p));n!==i&&n!==""?(t=this.e.c(1897077126,2,n,null),t!==32?this.w():this.c(n)):this.w()},w:function(){this.c(Common.d.d(this.k.a()))},c:function(n){this.t&&(this.d.innerText=n,this.r())},D:function(n){if(this.E()){if(!this.h()){if(n&&(this.m=!0,this.d.blur()),this.d.setAttribute("contentEditable","true"),this.d.removeAttribute("Unselectable"),this.d.setAttribute("role","textbox"),this.d.style.width="auto",Sys.UI.DomElement.addCssClass(this.d,"EditableBreadcrumbItem"),this.f){var t=this;this.f.a(function(n){n.d(!0)})}n&&this.d.focus();Diag.a.a(9234188,203,50,"Rename document from header.")}}else this.e.d(2638199087,2,null)},v:function(n){if(this.d.removeAttribute("contentEditable"),this.d.setAttribute("Unselectable","on"),this.d.setAttribute("role","button"),Sys.UI.DomElement.removeCssClass(this.d,"EditableBreadcrumbItem"),this.f){var t=this;this.f.a(function(n){n.d(!1)})}n&&(this.d.blur(),this.d.focus())}};Common.App.Rename.A=function(n,t,i,r,u){this.b=[];Common.App.Rename.A.initializeBase(this);this.a=new Common.App.Rename.n(n,t,i);this.d=r;this.c=u;this.H="RenameDisabledDialog";this.D(0);this.E(1,$a.b);this.h();this.e()};Common.App.Rename.A.prototype={a:null,d:!1,c:!1,h:function(){if(this.a.a){var n="";n=this.d?this.c?$a.cG:$a.cF:$a.cA;this.f(n)}else this.a.b?this.f($a.cC):this.g();this.cq(this.b,null)},f:function(n){Array.add(this.b,n)},g:function(){var n=[];this.a.e||Array.add(n,$a.cD);this.a.d||Array.add(n,$a.cB);this.a.c||Array.add(n,$a.cz);n.length>0&&Array.add(this.b,n)}};Common.App.Rename.s=function(n,t,i,r,u){Common.App.Rename.s.initializeBase(this,[n,t,i,r,u])};Common.App.Rename.s.prototype={e:function(){this.cY($a.cE,null,null,null,null,null,!1)}};Common.App.Rename.l=function(n,t){this.g=Function.createDelegate(this,this.h);this.d=n;this.e=t};Common.App.Rename.l.a=function(){return new Common.App.Rename.l(Common.a.c(),Common.a.l)};Common.App.Rename.l.prototype={d:null,e:null,f:0,b:function(n){return!this.d||!this.e?!1:(this.f=n,this.i(),!0)},i:function(){this.d.a(1808554760,2147483648,this.g)},h:function(n,t,i,r,u){var e;if(i===1)return this.d.d(1897077126,1,null);var o=Common.d.d(this.e.a()),s=u.getNewDocumentTitle,f=s();return(f.length>this.f&&(f=f.substr(0,this.f)),e=this.d.c(1897077126,2,f,null),e!==32)?(this.c(o),8):(this.c(f),32)},c:function(n){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(n))}};Common.App.Rename.b=function(){};Common.App.Rename.b.b=function(){return Common.a.b().a().c()?Common.App.Rename.b.a||(Common.App.Rename.b.a=Common.App.Rename.l.a()):Common.App.Rename.b.a||(Common.App.Rename.b.a=Common.App.Rename.h.a())};Common.App.Rename.e=function(){};Common.App.Rename.e.b=function(){return CommonUI.b.a(Common.App.Rename.e.a,$a.cw)};Common.App.Rename.g=function(){};Common.App.Rename.g.b=function(){return CommonUI.b.a(Common.App.Rename.g.a,$a.lJ,$a.cD,$a.cB,$a.cz)};Common.App.Rename.w.registerClass("Common.App.Rename.w",null,Common.App.Rename.c);Common.App.Rename.v.registerClass("Common.App.Rename.v",CommonUI.b);Common.App.Rename.m.registerClass("Common.App.Rename.m",null,Common.App.Rename.i);Common.App.Rename.d.registerClass("Common.App.Rename.d",null,Common.App.Rename.j);Common.App.Rename.f.registerClass("Common.App.Rename.f",CommonUI.b);Common.App.Rename.t.registerClass("Common.App.Rename.t",Common.App.Rename.w);Common.App.Rename.u.registerClass("Common.App.Rename.u",Common.App.Rename.w);Common.App.Rename.o.registerClass("Common.App.Rename.o",null,Common.App.Rename.k);Common.App.Rename.p.registerClass("Common.App.Rename.p",null,Common.eS);Common.App.Rename.A.registerClass("Common.App.Rename.A",CommonUI.d);Common.App.Rename.s.registerClass("Common.App.Rename.s",Common.App.Rename.A);Common.App.Rename.a.a=null;Common.App.Rename.b.a=null;Common.App.Rename.e.a="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}<\/label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> <\/div>";Common.App.Rename.g.a="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}<\/label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}<\/li> <li id='liRenameFileRenameDisabledPermission'>{2}<\/li> <li id='liRenameFileRenameDisabledCoauth'>{3}<\/li> <\/ul> <\/div> <\/div>";Common.App.Rename.z.a();Type.registerNamespace("_Ewa");_Ewa.WK=function(){};_Ewa.WK.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.newFileName=t,_Ewa.k.a(n,"RenameFile",o,i,r,u,f,0,null,null)};_Ewa.WJ=function(n){this.d=n};_Ewa.WJ.prototype={d:null,c:function(){return this.d.k().FileCoauthorable},a:function(){return this.d.b().I()},b:function(){var i;if(this.a())return!0;for(var t=this.d.b().r(),r=t.length,n=0;n<r;++n)if(i=t[n],!i.SupportsRename)return!1;return!0}};_Ewa.bnh=function(){};_Ewa.bnh.a=function(){_Ewa.m.a(function(n){_Ewa.Bn.a(n);_Ewa.Bl.a(n)})};_Ewa.WL=function(n){this.a=n};_Ewa.WL.prototype={a:null,x:function(n,t,i){switch(t.a){case 1808554760:if(_Ewa.Q.a().c()){var r=Common.a.c().c(1808554760,2,i,null);return r!==2?$$sc.a.a(Boolean,!0):_Ewa.Y.a(t.a)}return _Ewa.Y.a(t.a);case 1897077126:return this.a.c(i,t),$$sc.a.a(Boolean,!0);default:return _Ewa.Y.a(t.a)}},w:function(n,t,i,r){switch(t.a){case 1808554760:return _Ewa.Q.a().c();case 1897077126:return!!r&&r.a===2}return!1},y:function(){return!1},z:function(){return!1},dispose:function(){this.a=null}};_Ewa.Bl=function(n){_Ewa.Bl.initializeBase(this,[n])};_Ewa.Bl.a=function(n){_Ewa.bh.a(118,new _Ewa.Bl(n))};_Ewa.Bl.prototype={n:function(){var n=_Ewa.l.b(_Ewa.jr,this.h.a(),119,this.i(),this.j,null),t=this;_Ewa.g.a(n,function(){t.m([new _Ewa.WL(n.a())],null)},this.i(),3,null,null)}};_Ewa.Bm=function(n,t){this.m=Function.createDelegate(this,this.s);this.n=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.p);_Ewa.Bm.initializeBase(this,[!1]);this.d=n;this.g=t;this.d.b().q(this.i)};_Ewa.Bm.a=function(n){var t;switch(n.Errors[0].MessageId){case-414480287:t=2;break;case 650565124:t=1;break;case 1636785843:t=6;break;case-782844485:t=4;break;default:t=5}return t};_Ewa.Bm.prototype={g:null,d:null,f:null,j:null,h:null,e:null,a:function(){Common.a.cb=this.l;Common.a.bf=this.k;this.f=Common.a.B;Common.a.B=new _Ewa.WJ(this.d)},dispose:function(){Common.a.cb=null;Common.a.bf=null;this.d.b().s(this.i);Common.a.B=this.f;this.f=null;this.d=null;_Ewa.bgG.prototype.dispose.call(this)},p:function(){var n=this.d.b().m(),i,r;if(n&&!_Ewa.f.a(n.WorkbookFileName)){var t=Common.d.d(n.WorkbookFileName),u=!!_Ewa.f.f(this.d.k().WorkbookFileName,n.WorkbookFileName,!1),f=_Ewa.a.b(584)&&!_Ewa.f.a(n.BreadcrumbFolderUrl)&&!!_Ewa.f.f(this.d.k().FullDocumentInfo.BreadcrumbFolderUrl,n.BreadcrumbFolderUrl,!1);(u||f)&&(this.e={},this.e.NewFileName=t,this.e.EditDocInClientUrl=n.EditDocInClientUrl,this.e.DirectInvokeDAVUrl=n.DirectInvokeDAVUrl,this.e.DownloadACopyUrl=n.DownloadACopyUrl,i=_Ewa.a.b(584)&&!_Ewa.f.a(n.BreadcrumbFolderUrl),i&&(this.e.BreadcrumbFolderName=n.BreadcrumbFolderName,this.e.BreadcrumbFolderUrl=n.BreadcrumbFolderUrl),r=Common.a.c().c(3537588550,2,t,null),this.e=null,Diag.a.b(42258589,0,r===32,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed"))}},c:function(n,t){var i=n.newFileName;if(!(!i||!i.length)){var u=this.d.c().a().b(!1),r=this,f=this;_Ewa.H.a(this.d.f(),function(n,t,f){return _Ewa.WK.a(r.d.c().a(),i,_Ewa.n.a(n,r.n),_Ewa.n.b(t,r.m),f,null,u)},function(n){return new _Ewa.v(134,0,n,0,null)},t)}},b:function(){var n=Common.a.c().d(1808554760,1,null);return n===32},r:function(n,t,i){this.j=t;this.h=i;this.d.i().a(new _Ewa.L(1897077126,_Ewa.K.a,2,3,null),{newFileName:n},null)},q:function(n){this.e&&n(this.o(this.e),this.g)},t:function(n){var t,i,r;_Ewa.O.a(n)||!n.Result?(t=_Ewa.Bm.a(n),i=[-414480287,650565124,-782844485,1223808266,-62451516,1636785843],_Ewa.S.a(this.d).a().j(i),this.h(t)):(r=n.Result,this.j(this.o(r),this.g))},o:function(n){var i=this.d.k(),r,t;return Common.a.I=n.DownloadACopyUrl,r=_Ewa.a.b(584)&&!_Ewa.f.a(n.BreadcrumbFolderUrl),r&&(Common.a.l.g(n.BreadcrumbFolderName),Common.a.l.h(n.BreadcrumbFolderUrl),i.FullDocumentInfo.BreadcrumbFolderUrl=n.BreadcrumbFolderUrl,i.FullDocumentInfo.BreadcrumbFolderName=n.BreadcrumbFolderName),i.FullDocumentInfo.BreadcrumbDocName=n.NewFileName,_Ewa.hT.d(i,n.NewFileName),t={},t.NewName=n.NewFileName,t.DirectInvokeDavUrl=n.DirectInvokeDAVUrl,t.EditDocInClientUrl=n.EditDocInClientUrl,r&&(t.BreadcrumbFolderName=n.BreadcrumbFolderName,t.BreadcrumbFolderUrl=n.BreadcrumbFolderUrl),t.OperationResult=0,t},s:function(){this.h(5)}};_Ewa.Bn=function(n){_Ewa.Bn.initializeBase(this);this.h=n;this.l()};_Ewa.Bn.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.jr),119,new _Ewa.Bn(n))};_Ewa.Bn.prototype={h:null,n:null,m:null,a:function(){var n,r;if(!this.m){n=_Ewa.eD.a(_Ewa.jr,_Ewa.F.a(),this.i(),"Task","IRenameFileManager");this.m=n.b;var t=_Ewa.l.b(Common.T,this.h.a(),137,this.i(),this.j,null),u=_Ewa.l.b(Object,this.h.a(),155,this.i(),this.j,null),i=this;_Ewa.g.a(_Ewa.g.b([u,t],this.i(),3),function(){var r=new _Ewa.Bm(i.h,t.a());i.h.a().b(_Ewa.jr,120,r);n.a(r)},this.i(),3,null,null)}r=this;this.m.CW(function(n){r.k(n.a())})},dispose:function(){System.a.a(this.n);this.n=null;this.h=null;_Ewa.sX.prototype.dispose.call(this)}};_Ewa.WL.registerClass("_Ewa.WL",null,_Ewa.lI,Sys.IDisposable);_Ewa.Bl.registerClass("_Ewa.Bl",_Ewa.bh);_Ewa.Bm.registerClass("_Ewa.Bm",_Ewa.bgG,_Ewa.jr,Sys.IDisposable);_Ewa.Bn.registerClass("_Ewa.Bn",_Ewa.sX.$$(_Ewa.jr));_Ewa.bnh.a();Type.registerNamespace("_Ewa");_Ewa.WM=function(n){this.a=n};_Ewa.WM.prototype={a:null,z:function(){return!1},x:function(n,t,i){var r=this.a.c(2382951455,2,i,null);return r!==2?$$sc.a.a(Boolean,!0):_Ewa.Y.a(t.a)},w:function(n,t){return t.a===1204860550},y:function(){return!1}};_Ewa.Bo=function(n){_Ewa.Bo.initializeBase(this,[n])};_Ewa.Bo.a=function(n){_Ewa.bh.a(131,new _Ewa.Bo(n))};_Ewa.Bo.prototype={n:function(){var n=this;_Ewa.g.a(_Ewa.l.b(Object,this.h.a(),155,this.i(),this.j,null),function(){n.m([new _Ewa.WM(Common.a.c())],null)},this.i(),3,null,null)}};_Ewa.WM.registerClass("_Ewa.WM",null,_Ewa.lI);_Ewa.Bo.registerClass("_Ewa.Bo",_Ewa.bh);Type.registerNamespace("_Ewa");_Ewa.bnj=function(){};_Ewa.bnj.a=function(){_Ewa.m.a(_Ewa.Bo.a)};_Ewa.bnj.a();