try{Type.registerNamespace("Common.App.AppsForOffice");Common.App.AppsForOffice.w=function(){};Common.App.AppsForOffice.w.registerInterface("Common.App.AppsForOffice.w");Common.App.AppsForOffice.x=function(){};Common.App.AppsForOffice.x.registerInterface("Common.App.AppsForOffice.x");Common.App.AppsForOffice.v=function(){};Common.App.AppsForOffice.A=function(){};Common.App.AppsForOffice.A.registerInterface("Common.App.AppsForOffice.A");Common.App.AppsForOffice.s=function(){};Common.App.AppsForOffice.s.registerInterface("Common.App.AppsForOffice.s");Common.App.AppsForOffice.z=function(){};Common.App.AppsForOffice.u=function(){};Common.App.AppsForOffice.y=function(){};Common.App.AppsForOffice.y.registerInterface("Common.App.AppsForOffice.y");Common.App.AppsForOffice.e=function(n,t,i){this.e=n;this.b=t;this.d=i;this.c=OfficeExt.CommandInvokeMode.Default};Common.App.AppsForOffice.e.prototype={e:0,b:null,d:null,c:0,a:function(n,t,i){i=i||{};i.commandMode=this.c;var r=this;t.a(this.b,this.d,i,function(t,i){n.a(r.e,r.b,t,i)})}};Common.App.AppsForOffice.m=function(){};Common.App.AppsForOffice.m.prototype={b:function(n,t){var i=null;switch(n){case 1:i=new Common.App.AppsForOffice.n(t,this.a().getNativeActionName(n));break;case 2:i=new Common.App.AppsForOffice.e(2,t,this.a().getNativeActionName(n));break;case 3:i=new Common.App.AppsForOffice.e(3,t,this.a().getNativeActionName(n))}return i},a:function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}};Common.App.AppsForOffice.n=function(n,t){Common.App.AppsForOffice.n.initializeBase(this,[1,n,t]);this.c=OfficeExt.CommandInvokeMode.ExclusiveForNew};Common.App.AppsForOffice.c=function(){};Common.App.AppsForOffice.c.b=function(){return Common.App.AppsForOffice.c.a||(Common.App.AppsForOffice.c.a=new Common.App.AppsForOffice.c),Common.App.AppsForOffice.c.a};Common.App.AppsForOffice.c.prototype={a:function(n,t,i,r){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(n,t,i,r)}};Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=function(){};Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance=function(){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.a||(Diag.a.a(0,0,50,"AddinShortcutsPreferenceSettingHelper"),Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.a=new Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper,Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.b=Common.a.e),Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.a};Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.prototype={m:"getAddinShortcutsPreference",n:"saveAddinShortcutsPreference",o:"{0}RoamingServiceHandler.ashx?action={1}&{2}",k:6e4,a:null,b:null,f:null,d:function(){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.d||typeof OSF=="undefined"||(Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.c=OSF.OUtil.checkFlight(23),Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.d=!0),Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.c},l:function(n){var t=Common.a.a.l.d.RoamingServiceHandlerWebServiceBase||"";return String.format(this.o,t,n,Common.a.i)},j:function(n,t,i,r,u){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.b.f(n,t,u,null,!1,2,null,i,r,!1,null,this.k,null,null,!1,null)},saveSetting:function(n,t,i,r,u){var s,f,e,o;return this.d()?this.p(n,t,i,null,r,u):(s=this.e(),f={},f.action=i,f.addinId=t,f.ownerType=n,f.timestamp=(new Date).toUTCString(),e={},e[r.toString()]=f,o=new $$sc.e(u.toString(),e),s?this.r(o):this.s(o))},startBatchUpdateScope:function(){this.f=new Array(0)},saveShortcutInfoArrayBatch:function(n,t,i){this.v(0,"","",i,n,t)},v:function(n,t,i,r,u,f){var e={},o,s,h;e.action=i;e.addinId=t;e.ownerType=n;e.timestamp=(new Date).toUTCString();o=this.getShortcutInfoArray(u.toString(),f.toString());!n&&r?(e.shortcutInfoArray=r,this.h(u,f,r)):o&&(e.shortcutInfoArray=o);s={};s[u.toString()]=e;h=new $$sc.e(f.toString(),s);this.f.push(h)},commitBatchUpdateScope:function(){var n,t;return this.e()?(n=this,this.w().then(function(){return n.c(),Promise.resolve(!0)})):(t=this,this.x().then(function(){return t.c(),Promise.resolve(!0)}))},w:function(){var n=this;return this.getSetting().then(function(t){var i=null,h,c,l,u,r,e,s;if(t&&(l=(c=Common.bp.a(t,h={val:i}),i=h.val,c),!l))return Diag.a.a(0,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);i||(i={});for(var a=n.f,y=a.length,f=0;f<y;++f){u=a[f];r=i[u.b];r||(r={});e=u.a;for(var v=Common.D.e(e),p=v.length,o=0;o<p;++o)s=v[o],r[s]=e[s];i[u.b]=r}n.a=i;try{return localStorage.setItem("AddinShortcutPreferenceData",JSON.stringify(i)),Promise.resolve(!0)}catch(w){return Diag.a.a(0,0,10,"SaveSettingToLocalStorageBatch failed",w),Promise.resolve(!1)}})},x:function(){var n=this;return this.z().then(function(t){return n.g(t)})},z:function(){var n=this;return this.i().then(function(t){var i=null,h,c,l,u,r,e,s;t&&(l=(c=Common.bp.a(t,h={val:i}),i=h.val,c),l||Diag.a.a(0,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));i||(i={});for(var a=n.f,y=a.length,f=0;f<y;++f){u=a[f];r=i[u.b];r||(r={});e=u.a;for(var v=Common.D.e(e),p=v.length,o=0;o<p;++o)s=v[o],r[s]=e[s];i[u.b]=r}return n.a=i,JSON.stringify(i)})},saveShortcutInfoArray:function(n,t,i){return this.p(0,"","",i,n,t)},p:function(n,t,i,r,u,f){var c=this.e(),e={},o,s,h;return e.action=i,e.addinId=t,e.ownerType=n,e.timestamp=(new Date).toUTCString(),o=this.getShortcutInfoArray(u.toString(),f.toString()),!n&&r?(e.shortcutInfoArray=r,this.h(u,f,r)):o&&(e.shortcutInfoArray=o),s={},s[u.toString()]=e,h=new $$sc.e(f.toString(),s),c?this.r(h):this.s(h)},r:function(n){var t=this;return this.getSetting().then(function(i){var r=null,u,f,e;if(i&&(e=(f=Common.bp.a(i,u={val:r}),r=u.val,f),!e))return Diag.a.a(0,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[n.b]=n.a;t.a=r;try{return localStorage.setItem("AddinShortcutPreferenceData",JSON.stringify(r)),Promise.resolve(!0)}catch(o){return Diag.a.a(0,0,10,"SaveSettingToLocalStorage failed",o),Promise.resolve(!1)}})},s:function(n){var t=this;return this.y(n).then(function(n){return t.g(n)})},y:function(n){var t=this;return this.i().then(function(i){var r=null,u,f,e;return i&&(e=(f=Common.bp.a(i,u={val:r}),r=u.val,f),e||Diag.a.a(0,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings")),r||(r={}),r[n.b]=n.a,t.a=r,JSON.stringify(r)})},saveSettings:function(n){var i=JSON.parse(n),t;return this.a=i,this.d()&&this.c(),t=this.e(),t?this.q(n):this.g(n)},q:function(n){try{return localStorage.setItem("AddinShortcutPreferenceData",n),Promise.resolve(!0)}catch(t){return Diag.a.a(0,0,10,"SaveSettingToLocalStorage failed",t),Promise.resolve(!1)}},g:function(n){var r={},t,i;return r.Wac=n,t=JSON.stringify(r),i=this,new Promise(function(n){try{if(isNullOrUndefined(t)||!t.length||t.length>=1e6){n(!1);return}var r=i.j(i.l(i.n),2,"SaveAddinShortcutsPreferenceRequest","38",t);r.CW(function(){if(r.b===4||r.b===5){Diag.a.a(0,0,10,"SaveAddinShortcutsPreference: Request failure");n(!1);return}var t=r.a();isNullOrUndefined(t.a)||isNullOrUndefined(t.a.a())||t.a.a().a!==200?n(!1):n(!0)})}catch(u){Diag.a.a(0,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",u.toString());n(!1)}})},getSetting:function(){var n=this.e();return this.a?Promise.resolve(JSON.stringify(this.a)):n?this.t():this.i()},e:function(){var n=Common.a.a.a("IsAnonymousUser"),t=Common.a.a.a("IsRoamingServiceEnabled");return n||this.d()&&!t},t:function(){try{var n=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(n)}catch(t){return Diag.a.a(0,0,10,"GetSettingFromLocalStorage failed",t),Promise.resolve("")}},i:function(){var n=this;return new Promise(function(t,i){try{var r=n.j(n.l(n.m),1,"GetSettingRequest","37",null);r.CW(function(){var i,n,u;r.b===4||r.b===5?Diag.a.a(0,0,10,"GetSettingFromRoaming : Request failure"):(i="",n=r.a(),n&&n.a&&n.a.a()?n.a.a().a!==200?Diag.a.a(0,0,10,"GetSettingFromRoaming : Received error response {0}",n.a.a().a):n.a.a().b?(u=JSON.parse(n.a.a().b),u.Wac&&(i=u.Wac)):Diag.a.a(0,0,10,"GetSettingFromRoaming : ResponseData is null"):Diag.a.a(0,0,10,"GetSettingFromRoaming : Data is null"),t(i))})}catch(u){Diag.a.a(0,0,10,"GetSettingFromRoaming Exception handling request {0}",u.toString());i("GetSettingFromRoaming Request Exception");return}})},clearSettingByAddinId:function(n){var i=this.e(),t=this;return this.getSetting().then(function(r){var u=null,c,f,a,e,s,v,o,w;if(r&&(u=JSON.parse(r)),!u)return Diag.a.a(0,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(var y=Common.D.e(u),b=y.length,h=0;h<b;++h){c=y[h];f=u[c.toString()];for(var p=Common.D.e(f),k=p.length,l=0;l<k;++l)if(a=p[l],e=f[a],e.addinId===n)delete f[a.toString()];else if(t.d()&&!e.ownerType&&e.shortcutInfoArray){for(s=e.shortcutInfoArray,v=new($$sc.v.$$(Object)),o=0;o<s.length;++o)(w=s[o],w.addinId!==n)&&v.b(s[o]);e.shortcutInfoArray=v.g()}Common.D.c(f)||delete f[c]}return t.a=u,t.d()&&t.u(n),i?t.q(JSON.stringify(u)):t.g(JSON.stringify(u))})},c:function(){var n,t,i,r,u,f,e,o,s;if(this.a){this.b=null;n=this.a;for(t in n){i={key:t,value:n[t]};r=i.value;for(u in r)f={key:u,value:r[u]},e=f.value,e.shortcutInfoArray&&(o=parseInt(i.key),s=parseInt(f.key),this.h(s,o,e.shortcutInfoArray))}}},loadShortcutsPreferenceMappingTable:function(){if(!this.d())return Promise.resolve(!0);var n=this;return this.getSetting().then(function(t){var i=null,r,u;return t&&!(u=Common.bp.a(t,r={val:i}),i=r.val,u)?(Diag.a.a(0,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1)):(n.a=i,n.c(),Promise.resolve(!0))})},getShortcutsPreferenceInfoByAddinId:function(n,t,i){var u,r,f;return this.a&&(u=this.a[i],u&&(r=u[t],r&&(f=r.addinId,f===n)))?r:null},getShortcutInfoArray:function(n,t){var r,i;return this.a&&(r=this.a[t],r&&(i=r[n],i&&i.shortcutInfoArray))?i.shortcutInfoArray:null},setShortcutInfoWithinBatchUpdateScope:function(n,t,i){var r=parseInt(n),u=parseInt(t);this.saveShortcutInfoArrayBatch(r,u,i)},setShortcutInfoArray:function(n,t,i){var r=parseInt(n),u=parseInt(t),f=this;return this.saveShortcutInfoArray(r,u,i).then(function(){return f.c(),Promise.resolve(!0)})},removeActionFromShortcutInfoArray:function(n,t){var u,r,e,l;if(!this.b||(u=this.b[n],!u))return Promise.resolve(!0);var o=u[t],s=o.modifiers,h=o.keyCode,i=this.getShortcutInfoArray(s.toString(),h.toString());if(!i||!i.length)return Promise.resolve(!0);r=0;for(var c=i,a=c.length,f=0;f<a;++f){if(e=c[f],e.addinId===n&&e.action===t)break;++r}return r>=i.length?Promise.resolve(!0):(i.splice(r,1),l=this,this.saveShortcutInfoArray(s,h,i).then(function(){return l.c(),Promise.resolve(!0)}))},h:function(n,t,i){var u;this.b||(this.b={});for(var e=i,h=e.length,f=0;f<h;++f){var o=e[f],s=o.addinId,c=o.action,r=this.b[s];r||(r={});u={};u.modifiers=n;u.keyCode=t;r[c]=u;this.b[s]=r}},u:function(n){n in this.b&&delete this.b[n]},isActionCustomized:function(n,t){if(this.b){var i=this.b[n];if(i&&i[t])return!!i[t]}return!1},getShortcutByCustomizedAction:function(n,t){if(this.b){var i=this.b[n];if(i)return i[t]}return null},getShortcutsPreferenceMappingTable:function(){return this.a}};Common.App.AppsForOffice.o=function(n,t,i){this.f=new Common.bc;this.i=new Common.App.AppsForOffice.m;Common.App.AppsForOffice.o.initializeBase(this,[!1,!1,!1,!1]);this.D(5);this.c=i;this.H=i;this.d=n;this.e=t;this.g=!!Common.a.a&&Common.a.a.a("OfficeAddinEnableInsertDialogAccessibilityFix")};Common.App.AppsForOffice.o.prototype={b:null,o:"WACDialogTitleText",n:"0",l:"15px",m:"0px",j:"calc(100% - 30px)",k:"100%",d:0,e:0,c:null,h:0,g:!1,p:function(n){this.f.m("OnDialogClosedEventKey",n)},bb:function(){CommonUI.b.prototype.bb.call(this);this.O.style.width="100%";this.O.style.height=this.cw?this.j:this.k;this.O.style.marginTop=this.cw?this.l:this.m;this.O.style.padding=this.n},be:function(){CommonUI.b.prototype.be.call(this);this.C.style.width=String.format("{0}px",this.d*window.innerWidth/100);this.C.style.height=String.format("{0}px",this.e*window.innerHeight/100);this.C.style.minWidth="0px";this.g&&Common.a.h&&this.d===100&&(this.C.style.right="0px",this.C.style.marginRight="0px");this.b=document.getElementById(this.K+this.o);this.b.style.position="absolute";this.b.style.whiteSpace="nowrap";this.b.style.textOverflow="ellipsis";Common.a.h?(this.b.style.right="14px",this.b.style.left="44px"):(this.b.style.right="44px",this.b.style.left="14px")},R:function(n){CommonUI.b.prototype.R.call(this,n);this.b&&this.b.setAttribute("title",n)},dZ:function(){this.C.style.width=String.format("{0}px",this.d*window.innerWidth/100);this.C.style.height=String.format("{0}px",this.e*window.innerHeight/100);this.C.style.overflowY="hidden";this.C.style.overflowX="hidden";this.C.style.marginTop="";this.C.style.top="";Common.c.l()&&Common.a.h?(this.C.style.right="",this.C.style.marginRight=""):(this.C.style.left="",this.C.style.marginLeft="")},F:function(){var t=this.i.b(3,this.c),n;t.a(this,Common.App.AppsForOffice.c.b(),{});n=this;this.h=window.setTimeout(function(){n.f.k("OnDialogClosedEventKey",n.c,null);CommonUI.c.prototype.F.call(n)},500)},a:function(n){n===3&&(window.clearTimeout(this.h),this.f.k("OnDialogClosedEventKey",this.c,null),CommonUI.c.prototype.F.call(this))}};Common.App.AppsForOffice.AppsForOfficeDialogManager=function(n){this.i=Function.createDelegate(this,this.k);this.h=new Common.bc;this.g=n};Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance=function(n){return Common.App.AppsForOffice.AppsForOfficeDialogManager.b||(Common.App.AppsForOffice.AppsForOfficeDialogManager.b=new Common.App.AppsForOffice.AppsForOfficeDialogManager(n)),Common.App.AppsForOffice.AppsForOfficeDialogManager.b};Common.App.AppsForOffice.AppsForOfficeDialogManager.prototype={g:null,b:function(n){this.h.m("OnMessageParentEventKey",n)},a:function(n){this.h.m("OnMessageDialogEventKey",n)},f:function(n,t,i,r){var s,h,f,c;if(Common.App.AppsForOffice.AppsForOfficeDialogManager.a.c(t)){Diag.a.a(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{if(s=JSON.parse(n),h=s.url,!this.g.getOsfControl(t).checkAppDomains(h)){Diag.a.a(19940611,344,10,"ShowDialog: dialog url not in app domains list.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains);return}f=new Common.App.AppsForOffice.r;f.e=s.width;f.c=s.height;f.d=h;f.g=s.displayInIframe;f.f=s.hideTitle;f.b=t;f.a=Common.u.a().a;c=new Common.App.AppsForOffice.f;c.b=f.a;var l=this.g.getOsfControl(f.b).getManifest().getDefaultDisplayName(),v=this.g.getOsfControl(f.b).getStoreType().toLowerCase(),a=Common.a.b().a().a()===4&&v==="hardcodedpreinstall"&&f.f?this.createAndShowAppsForOfficeDialog(f.e,f.c,f.a,!0,l):this.createAndShowAppsForOfficeDialog(f.e,f.c,f.a,!1,l);var e=this.g.getOsfControl(f.b),o=e.getManifest(),u={};Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(u.id=f.a,u.solutionId=o.getMarketplaceID(),u.version=o.getMarketplaceVersion(),u.storeType=v,u.storeId=e.getStoreLocator(),u.assetId=e.getAssetId(),u.assetStoreId=e.getAssetStoreId(),u.ownerAddinSolutionId=e.getOwnerAddinSolutionId(),u.ownerAddinStoreType=e.getOwnerAddinStoreType(),u.appDomains=o.getAppDomains(),u.dialogUrl=h,u.osfControlType=OSF.OsfControlTarget.TaskPane,u.marketplaceID=o.getMarketplaceID(),u.marketplaceVersion=o.getMarketplaceVersion(),u.store=e.getStoreLocator(),u.ownerAddinAssetId=e.getOwnerAddinAssetId(),u.agaveName=l,u.div=a.O,Diag.a.a(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==u.ownerAddinStoreType?u.ownerAddinStoreType:u.storeType,u.store,u.solutionId,null,null),Common.d.e(f.d))):(u.id=f.a,u.marketplaceID=o.getMarketplaceID(),u.marketplaceVersion=o.getMarketplaceVersion(),u.appDomains=o.getAppDomains(),u.store=e.getStoreLocator(),u.storeType=v,u.ownerAddinAssetId=e.getOwnerAddinAssetId(),u.ownerAddinStoreType=e.getOwnerAddinStoreType(),u.dialogUrl=h,u.osfControlType=OSF.OsfControlTarget.TaskPane,u.agaveName=l,u.div=a.O,Diag.a.a(540379087,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==u.ownerAddinStoreType?u.ownerAddinStoreType:u.storeType,u.store,u.marketplaceID,null,null),Common.d.e(f.d)));this.g.insertDialogControl(u);a.p(this.i);c.a=a;Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(f.b,c);r&&r(u);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(y){Diag.a.a(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",y.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},d:function(n,t,i,r){Common.a.a.d("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||r===""&&(r=i);try{var u=this.j(n);u&&this.h.k("OnMessageParentEventKey",new Common.App.AppsForOffice.g(u,OSF.DialogMessageType.DialogMessageReceived,t,i,r),null)}catch(f){return Diag.a.a(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",f.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},c:function(n,t){if(!Common.App.AppsForOffice.AppsForOfficeDialogManager.a.c(n)){Diag.a.a(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control.");t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{var i=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.a(n);i.a&&i.a.F();this.g.purgeDialogControl(i.b);Common.App.AppsForOffice.AppsForOfficeDialogManager.a.e(n);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(r){Diag.a.a(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",r.message);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},e:function(n,t,i,r){if(Common.a.a.d("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||r===""&&(r=i),Common.App.AppsForOffice.AppsForOfficeDialogManager.a.c(n)){var u=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.a(n);if(u.a)try{this.h.k("OnMessageDialogEventKey",new Common.App.AppsForOffice.t(u.b,OSF.DialogMessageType.DialogParentMessageReceived,t,i,r),null)}catch(f){Diag.a.a(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",f.message)}}},j:function(n){for(var i=null,r=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge(),t;r.$$mn();)if(t=r.$$cu(),t.a.b===n){i=t.b;break}return i},k:function(n,t){var i=this.j(t),r;i&&(this.g.purgeDialogControl(t),Common.App.AppsForOffice.AppsForOfficeDialogManager.a.e(i),r="*",this.h.k("OnMessageParentEventKey",new Common.App.AppsForOffice.g(i,OSF.DialogMessageType.DialogClosed,null,null,r),null))},createAndShowAppsForOfficeDialog:function(n,t,i,r,u){var f=new Common.App.AppsForOffice.o(n,t,i),e=r?"":String.format($a.ms,u);return r&&(f.cw=!1,f.bk=!1),f.G(e,null,null),f.bP=null,f}};Common.App.AppsForOffice.p=function(){Common.App.AppsForOffice.p.initializeBase(this,[!1,!1,!1,!1]);this.D(5);this.H="AppsForOfficeInsertionDialog";this.g=!!Common.a.a&&Common.a.a.a("OfficeAddinEnableInsertDialogAccessibilityFix")};Common.App.AppsForOffice.p.prototype={c:"calc(100% - 46px)",d:"15px",e:"0",i:"WACDialogPanel",a:695,j:462,f:"80%",h:350,b:"100%",g:!1,bb:function(){CommonUI.b.prototype.bb.call(this);this.O.style.width=this.b;this.O.style.height=this.c;this.O.style.marginTop=this.d;this.O.style.padding=this.e},bT:function(){this.O.style.width=this.b;this.O.style.height=this.c;this.O.style.marginTop=this.d;this.O.style.padding=this.e;this.a>window.document.documentElement.clientWidth?(this.C.style.width=String.format("{0}px",window.document.documentElement.clientWidth),this.C.style.overflowX="scroll",Common.a.h?this.C.style.right="0":this.C.style.left="0"):(this.C.style.width=String.format("{0}px",this.a),this.C.style.overflowX="hidden");this.C.offsetHeight>window.document.documentElement.clientHeight||this.j+50>window.document.documentElement.clientHeight?(this.C.style.height=String.format("{0}px",window.document.documentElement.clientHeight),this.C.style.overflowY="scroll",this.C.style.top="0",Common.a.h?this.C.style.right="0":this.C.style.left="0",this.g||(this.C.style.marginTop="-48px"),this.O.style.minHeight=String.format("{0}px",this.h)):(this.C.style.overflowY="hidden",this.C.style.top="10%",this.C.style.height=this.f);this.cz()},cz:function(){var t,n;if(!this.C){Diag.a.a(19976784,306,10,"_divMessageBox is null in CenterDialog()");return}t=this.C.style.zIndex;this.C.style.zIndex=-9999;this.a>window.document.documentElement.clientWidth?Common.a.h?this.C.style.marginRight="0":this.C.style.marginLeft="0":(n=String.format("{0}px",Math.floor(-this.C.offsetWidth/2)),Common.a.h?this.C.style.marginRight=n:this.C.style.marginLeft=n,Common.a.h?this.C.style.right="50%":this.C.style.left="50%");this.C.style.zIndex=t},be:function(){CommonUI.b.prototype.be.call(this);var n=document.getElementById(this.K+this.i);n.style.width=String.format("{0}px",this.a);n.style.height=this.f}};Common.App.AppsForOffice.b=function(){};Common.App.AppsForOffice.b.prototype={e:null,a:0,g:null,d:null,i:null,h:null,b:null,c:null,f:null};Common.App.AppsForOffice.l=function(){};Common.App.AppsForOffice.l.prototype={b:null,a:function(){return this.b}};Common.App.AppsForOffice.j=function(){};Common.App.AppsForOffice.j.prototype={a:0,b:null};Common.App.AppsForOffice.k=function(n,t,i,r){this.b=new($$sc.v.$$(Common.App.AppsForOffice.k.b));this.a=new($$sc.v.$$(Common.App.AppsForOffice.k.a));this.d=new($$sc.v.$$(Number));this.i=Promise.resolve(null);this.f=t;this.g=n;this.j=i;this.h=r};Common.App.AppsForOffice.k.prototype={c:null,h:null,g:null,j:null,k:!1,o:function(n){if(this.c&&this.c.b===n.a){if(Date.now()/1e3+300>this.c.a)return this.c=null,!1;var t=new Common.App.AppsForOffice.b;return t.e=this.c.d,t.f=this.c.a,t.c=this.c.c,t.b=!0,t.d=0,this.e(t),!0}return!1},n:function(n){for(var r,i,t=0;t<this.a.f.length;t++)if(this.a.a(t).a===n.a&&this.a.a(t).e===n.e)return((r=this.a.a(t)).b=r.b+1,n.b=this.a.a(t).b,this.a.a(t).b<3||!this.a.a(t).c&&n.c||!this.a.a(t).d&&n.d)?((!this.a.a(t).c&&n.c||!this.a.a(t).d&&n.d)&&(n.b=0),this.a.i(t),!1):(i=new Common.App.AppsForOffice.b,i.a=this.a.a(t).g,this.e(i),!0);return!1},l:function(n,t){for(var i,r=0;r<this.a.f.length;r++)if(this.a.a(r).e===n.e&&this.a.a(r).a===n.a)return;this.a.b((i=new Common.App.AppsForOffice.k.a,i.c=n.c,i.d=n.d,i.a=n.a,i.e=n.e,i.g=t,i.b=n.b,i))},f:null,m:function(n,t,i,r,u,f){var s,c,h,o,e;if(i===""&&(i=null),this.k){Common.App.AppsForOffice.a.a(f,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);return}for(s=null,c=this.b.$$lge();c.$$mn();)if(h=c.$$cu(),h.c===n&&h.d===t&&h.a===i&&h.e===u){s=h;break}s||(s=(o=new Common.App.AppsForOffice.k.b,o.c=n,o.d=t,o.a=i,o.h=r,o.e=u,o.b=0,o.i=Common.App.AppsForOffice.a.d(),o),this.b.b(s));s.b=0;s.f.b(f);e=this;this.i=this.i.then(function(){var n,i,r,t,u,f;if(e.b.f.length>0){if(n=e.b.a(0),e.o(n)||e.n(n))return null;for(i=0;i<e.d.f.length;)e.d.a(i)+6e4<Common.App.AppsForOffice.a.d()?e.d.i(i):i++;return e.d.f.length>=6||e.b.f.length>=6?(r=new Common.App.AppsForOffice.b,r.a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,e.e(r),null):(t=null,Common.a.b()&&(u=Common.a.b().d(),u&&(f=e.g+"GetAccessToken",t=u.a("ComponentAttach",f))),n.e.a(e.g,e.f,n.c,n.d,n.a,e.j,e.h,n.h).then(function(n){t&&t.a();e.e(n)},function(){t&&t.a();var n=new Common.App.AppsForOffice.b;n.a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;e.e(n)}))}return null})},e:function(n){var i,f,t,e,s,r,u,o,h;try{if(!this.b.f.length)return;for(i=this.b.a(0),this.b.i(0),f=null,n.a||(f=new Common.App.AppsForOffice.l,f.b=n.e),(n.a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl||n.a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant||n.a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError||n.a===OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError)&&this.l(i,n.a),t={},n.d!=null&&(t.getTokenSilentTime=n.d.toString()),n.i!=null&&(t.getTokenPopupTime=n.i.toString()),n.h!=null&&(t.getIDTokenTime=n.h.toString()),n.b!=null&&(t.tokenCached=n.b.toString()),n.g&&(t.detailedError=n.g),n.c&&(t.authLibrary=n.c),i.b&&(t.retryCount=i.b),e=i.f.$$lge();e.$$mn();)s=e.$$cu(),Common.App.AppsForOffice.a.a(s,n.a,f,t);if(n.b!=null&&n.b||this.d.b(i.i),!n.a)for(n.f!=null&&(this.c=(r=new Common.App.AppsForOffice.k.c,r.d=n.e,r.a=n.f,r.b=i.a,r.c=n.c,r)),this.a.h(),u=0;u<this.b.f.length;)if(this.b.a(u).a===i.a){for(o=this.b.a(u).f.$$lge();o.$$mn();)h=o.$$cu(),Common.App.AppsForOffice.a.a(h,n.a,f,t);this.b.i(u)}else u++}catch(c){Diag.a.a(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",c.message)}}};Common.App.AppsForOffice.k.b=function(){this.f=new($$sc.v.$$(Common.App.AppsForOffice.j))};Common.App.AppsForOffice.k.b.prototype={c:!1,d:!1,a:null,e:null,b:0,i:0,h:null};Common.App.AppsForOffice.k.a=function(){Common.App.AppsForOffice.k.a.initializeBase(this)};Common.App.AppsForOffice.k.a.prototype={g:0};Common.App.AppsForOffice.k.c=function(){};Common.App.AppsForOffice.k.c.prototype={d:null,a:0,b:null,c:null};Common.App.AppsForOffice.a=function(n,t){this.c=new($$sc.w.$$(Common.App.AppsForOffice.k));this.d=n;this.e=t};Common.App.AppsForOffice.a.f=function(){return Common.a.a.d("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2",!1)};Common.App.AppsForOffice.a.i=function(){try{var n={};return Common.c.r()&&Common.App.OAuth.a.f()&&(n.UiHostSupportsAuthTokenAddinList=Common.App.AppsForOffice.a.e),n.UiHostSupportsAuthToken=Common.App.OAuth.a.f(),n}catch(t){Diag.a.a(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",t.message)}return null};Common.App.AppsForOffice.a.g=function(n,t,i){if(!Common.App.AppsForOffice.a.c){var r=new($$sc.v.$$(Common.App.AppsForOffice.s));i&&r.b(i.a());Common.App.AppsForOffice.a.f()||r.b(new Common.App.AppsForOffice.d(t));Common.App.AppsForOffice.a.c=new Common.App.AppsForOffice.a(n,r)}return Common.App.AppsForOffice.a.c};Common.App.AppsForOffice.a.b=function(n){window.console.warn&&window.console.warn(n)};Common.App.AppsForOffice.a.h=function(n,t){var e="https://",o="api://",u="",i,s,f,r,h;if(!n)return u;if(t||(t=""),i=n.toLowerCase(),s=t.toLowerCase(),new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(s)||(Common.App.AppsForOffice.a.b('SSO App Id "'+t+'" is not a valid format. It will be rejected from store submission.'),Diag.a.a(590962907,344,10,"App id does not match a GUID.")),i.endsWith(s)||(Common.App.AppsForOffice.a.b('SSO Resource "'+n+'" does not end with App Id "'+t+'". It will be rejected from store submission.'),Diag.a.a(590962908,344,10,"Resource does not end with app id.")),!i.startsWith(e)&&!i.startsWith(o))return Common.App.AppsForOffice.a.b('SSO Resource "'+n+'" must be https:// or api:// protocol.'),Diag.a.a(590962909,344,10,"Resource not using https or api protocol."),u;for(f=0;f<n.length;f++)if(r=n.charAt(f),h=n.charCodeAt(f),h<33||h>126||r==="&"||r==="?"||r==="#"||r==="%"||r==="\\")return Common.App.AppsForOffice.a.b('SSO Resource "'+n+'" contains an invalid character "'+r+'".'),Diag.a.a(590962910,344,10,"Invalid character '"+r+"' in resource URI."),u;return n.indexOf("::")>=0?(Common.App.AppsForOffice.a.b('SSO Resource "'+n+'" contains an invalid string "::".'),Diag.a.a(590962911,344,10,":: in resource URI."),u):n.length>120?(Common.App.AppsForOffice.a.b('SSO Resource "'+n+'" is '+n.length+" characters and exceeds the max length of 120 characters."),Diag.a.a(590962912,344,10,"Length of resource: "+n.length+"."),u):(i.startsWith(o)&&(i=e+i.substring(o.length,i.length)),i.length===e.length)?u:OfficeExt.WACUtils.getHostSecure(i)||u};Common.App.AppsForOffice.a.a=function(n,t,i,r){var e=n.a,c=0,u,o,s,h,f;if(e>0&&(c=Common.App.AppsForOffice.a.d()-e),u={callInstanceId:e.toString(),callDuration:c.toString(),errorCode:t.toString()},r){o=r;for(s in o)h={key:s,value:o[s]},u[h.key]=h.value}Diag.a.a(51401116,344,50,"{0}",u);Otel.Telemetry.a((f=new Otel.b,f.name="Office.Online.Extensibility.SSO.GetAccessTokenV2End",f.dataFields=Common.J.a(u,null,null),f));n.b(t,i)};Common.App.AppsForOffice.a.d=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(n){}return Date.now()};Common.App.AppsForOffice.a.prototype={d:null,e:null,g:function(n,t,i,r,u,f,e,o,s,h,c){var w,l=(w=new Common.App.AppsForOffice.j,w.a=Common.App.AppsForOffice.a.d(),w.b=c,w),ft,tt,d,p,it,g,rt,nt,et,ut;try{var ot=!!i&&i!=="",st=l.a,v=this.b(n),y=v.getStoreType()||"",b=v.getOwnerAddinStoreType()||"",k=v.getMarketplaceID()||"",ht=v.getMarketplaceVersion()||"";y=y.toLowerCase();b=b.toLowerCase();k=k.toLowerCase();var ct=Common.k.m(t)||"",lt=Common.k.m(v.getIframeUrl())||"",at=ct.toLowerCase()===lt.toLowerCase(),a=y;y===OSF.StoreType.InMemory&&(a=b);ft=Telemetry.PrivacyRules.GetAssetId(a,v.getStoreLocator(),k,null,null);tt={callInstanceId:st.toString(),controlAssetId:ft,controlVersion:ht,storeType:y,ownerStoreType:b,allowConsentPrompt:r.toString(),forMSGraphAccess:u.toString(),allowSignInPrompt:f.toString(),hasAddinAuthChallenge:ot.toString(),securityOriginEqualsSourceLocation:at.toString(),singleSignOnEnabled:e.toString(),accountTypeFilter:s||""};Diag.a.a(51401115,344,50,"{0}",tt);Otel.Telemetry.a((d=new Otel.b,d.name="Office.Online.Extensibility.SSO.GetAccessTokenV2Start",d.dataFields=Common.J.a(tt,null,null),d));p=!0;it=Common.a.a.b("HostAuthType");switch(s){case"aad":p=it==="aad";break;case"msa":p=it==="msa";break;default:p=!s||s==="noFilter"}if(!p){Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null);return}if(g=null,e)for(rt=this.e.$$lge();rt.$$mn();)if(nt=rt.$$cu(),nt.b(k,o)){g=nt;break}else if(nt.c())break;if(!g){Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null);return}if(et=this.k(n),et){if(ut=!0,a===OSF.StoreType.OMEX&&(ut=!1),a===OSF.StoreType.SPApp||a===OSF.StoreType.SPCatalog){Diag.a.a(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported.");Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null);return}if(u&&!ut){Diag.a.a(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access.");Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null);return}u&&a===OSF.StoreType.Exchange&&(r=!1);this.f(n,t,i,a,r,f,h,g,l)}else{Diag.a.a(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin.");Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null);return}}catch(vt){this.l();Diag.a.a(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",vt.message);Common.App.AppsForOffice.a.a(l,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}},a:function(n,t,i,r){var u=i.SecurityOrigin||null,f=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,e=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,o=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,s=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,h=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.EnableNewHosts]||0,c=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,l=i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null;this.g(n,u,f,e,s,o,t,h,c,l,r)},f:function(n,t,i,r,u,f,e,o,s){var h=null;this.c.c(n)?h=this.c.a(n):(h=new Common.App.AppsForOffice.k(n,this.j(n).split(",")[0],r,this.h(n)),this.c.g(n,h));var a=h.f,c=Common.App.AppsForOffice.a.h(a,this.i(n)),l=OfficeExt.WACUtils.getHostSecure(t);if(c&&l)if(c.toLowerCase()===l.toLowerCase())h.m(u,f,i,e,o,s);else{Common.App.AppsForOffice.a.b('SSO Resource "'+a+'" cannot be used from "'+t+'" origin due to domain mismatch.');Diag.a.a(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource.");Common.App.AppsForOffice.a.a(s,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null);return}else c||Diag.a.a(594118746,344,10,"Invalid resource URL for SSO."),l||Diag.a.a(594118745,344,10,"Invalid page URL for SSO."),Common.App.AppsForOffice.a.a(s,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)},l:function(){var n=window.navigator.userAgent;Diag.a.a(39068820,344,50,"Browser information: {0}",{UserAgent:n})},b:function(n){return this.d.getOsfControl(n)},k:function(n){return this.b(n).getManifest().isSSOAddin()},i:function(n){return this.b(n).getManifest().getWebApplicationId()},j:function(n){return this.b(n).getManifest().getWebApplicationResource()},h:function(n){return this.b(n).getManifest().getDefaultDisplayName()}};Common.App.AppsForOffice.d=function(n){this.e=Function.createDelegate(this,this.g);this.d=n;this.d.c("PostAccessToken");this.d.b("PostAccessToken",this.e)};Common.App.AppsForOffice.d.prototype={d:null,a:function(n,t,i,r,u,f,e){var s=Common.u.a().a+"-"+n,o={},h;return o.AddinControlId=s,o.AddinApplicationResource=t,o.AddinStoreType=f,o.AddinSSOAuthChallenge=u,o.AllowConsentPrompt=i,o.AllowSignInPrompt=r,o.AddinName=e,h=this,new Promise(function(n){h.d.a("GetAccessToken",o,"");Common.App.AppsForOffice.d.a.b(s,n)})},c:function(){return!1},b:function(){if(!Common.a.cr)return!1;var n=(Common.a.a.b("UiHost")||"").toLowerCase();return n!=="teams"&&n!=="officecom"&&n!=="officecomhwa"&&n!=="officecompwa"},g:function(n){var e=n.Values.AddinControlId,f=Common.App.AppsForOffice.d.a.a(e),t,i,r,u;f&&(t=new Common.App.AppsForOffice.b,i=n.Values.AccessToken,isNullOrUndefined(n.Values.GetTokenSilentTime)||(t.d=n.Values.GetTokenSilentTime),isNullOrUndefined(n.Values.GetTokenPopupTime)||(t.i=n.Values.GetTokenPopupTime),isNullOrUndefined(n.Values.GetIDTokenTime)||(t.h=n.Values.GetIDTokenTime),isNullOrUndefined(n.Values.TokenCached)||(t.b=n.Values.TokenCached),isNullOrUndefined(n.Values.AuthLibrary)||(t.c=n.Values.AuthLibrary),r=0,i&&typeof i!="undefined"&&i.length?t.e=i:(r=this.f(n),u=this.h(n),u&&(t.g=u)),t.a=r,f(t))},f:function(n){var r=n.Values.HostApplicationType,t=n.Values.AddinSSOError,i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError;return r&&r.toLowerCase()==="OnedriveWOPI".toLowerCase()?t==="login_required"?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn:t==="13002"||t==="access_denied"?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:t==="consent_required"&&(i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant):t.indexOf("AADSTS50058")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:t.indexOf("Popup Window is null")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:t.indexOf("AADSTS50001")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:t.indexOf("13002")>-1||t.indexOf("AADSTS65004")>-1||t.indexOf("Popup Window closed")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:t.indexOf("13001")>-1&&(i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn),i},h:function(n){var t="",u=n.Values.HostApplicationType,r=n.Values.AddinSSOError,f,i;return u&&u.toLowerCase()==="SharepointOnline".toLowerCase()&&(r==="Environment not supported"?t="EnvironmentNotSupported":r==="adal.js load failed"?t="AdalJSFailed":t==="Popup Window is null"?t="PopupWindowNull":(f=new RegExp("AADSTS(\\d+)"),i=f.exec(r),i&&i.length>1&&(t=i[1]))),t}};Common.App.AppsForOffice.f=function(){};Common.App.AppsForOffice.f.prototype={b:null,a:null};Common.App.AppsForOffice.r=function(){};Common.App.AppsForOffice.r.prototype={e:0,c:0,d:null,b:null,a:null,g:!1,f:!1};Common.App.AppsForOffice.g=function(n,t,i,r,u){Common.App.AppsForOffice.g.initializeBase(this);this.a=n;this.b=t;this.c=i;this.d=r;this.e=u};Common.App.AppsForOffice.g.prototype={a:null,b:0,c:null,d:null,e:null};Common.App.AppsForOffice.t=function(n,t,i,r,u){Common.App.AppsForOffice.t.initializeBase(this);this.a=n;this.d=t;this.b=i;this.c=r;this.e=u};Common.App.AppsForOffice.t.prototype={a:null,d:0,b:null,c:null,e:null};Common.App.AppsForOffice.q=function(n){this.b=n};Common.App.AppsForOffice.q.prototype={b:null,tryAuthenticate:function(n,t){var i=this;this.a("identitytoken",function(){n()},t)},tryAuthorize:function(n,t){this.a("authcode",n,t)},getSignInUrl:function(n,t){this.a("signinurl",n,t)},signOut:function(n,t){this.a("signout",n,t)},a:function(n,t,i){var u=new Common.bF("AuthenticationProxyHandler.aspx"),f,r;u.a("responseType",n);Common.a.bX(u);f=String.format("{0}{1}&{2}",this.b,u.toString(),Common.a.i);r=document.createElement("iframe");r.setAttribute("id","privateCatalogIframe");r.setAttribute("name","privateCatalogIframe");r.setAttribute("style","display: none");$$sc.d.a().a(n,"signinurl")||r.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Common.App.AppsForOffice.q.a.a(r,t,i);r.setAttribute("src",f);document.body.appendChild(r)}};Common.App.AppsForOffice.q.a=function(n,t,i){this.b=Function.createDelegate(this,this.f);this.a=n;this.d=t;this.c=i;$addHandler(window,"message",this.b)};Common.App.AppsForOffice.q.a.a=function(n,t,i){new Common.App.AppsForOffice.q.a(n,t,i)};Common.App.AppsForOffice.q.a.prototype={d:null,c:null,a:null,f:function(n){var i,r,t;try{if(n&&n.rawEvent&&n.rawEvent.origin&&this.a&&this.a.id){if(i=this.e(n.rawEvent.origin),r=this.e(document.domain),!$$sc.d.a().a(r,i)){Diag.a.a(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.");return}if(!n.rawEvent.source||!n.rawEvent.source.frameElement||!n.rawEvent.source.frameElement.id||!$$sc.d.a().a(n.rawEvent.source.frameElement.id,this.a.id)){Diag.a.a(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");return}}else{Diag.a.a(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.");return}t=null;try{t=JSON.parse(n.rawEvent.data)}catch(u){Diag.a.a(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",u.message)}if(!t){Diag.a.a(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.");return}t.statusCode===200&&(isUndefined(t.error)||!t.error)?(Diag.a.a(23705827,344,100,"Received response from authentication proxy."),this.d(t.authorizationCode?t.authorizationCode:t.signInUrl)):(Diag.a.a(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",t.statusCode,t.error),this.c());$removeHandler(window,"message",this.b);this.a?document.body.contains(this.a)?document.body.removeChild(this.a):Diag.a.a(24978499,344,15,"The iframe is not a child of Body."):Diag.a.a(24978500,344,15,"The iframe is null.")}catch(f){Diag.a.a(23707649,344,10,"Exception in authentication proxy message handler: {0}.",f.message)}},e:function(n){var t="";try{n&&(t=n.indexOf("//")>-1?n.split("/")[2]:n.split("/")[0],t&&(t=t.split(":")[0],t=t.split("?")[0]))}catch(i){Diag.a.a(51451615,344,10,"Failed to parse host name from url: {0}",i.message)}return t}};Common.App.AppsForOffice.i=function(){};Common.App.AppsForOffice.i.prototype={getUserId:function(n,t){var i,r=(i=new($$sc.v.$$($$sc.e)),i.b(new $$sc.e("corr",n)),i);this.a("getUserId",r,1,t)},getLastStoreUpdate:function(n,t,i){var r,u=(r=new($$sc.v.$$($$sc.e)),r.b(new $$sc.e("lc",n)),r.b(new $$sc.e("corr",t)),r);this.a("laststoreupdate",u,1,i)},getEntitlement:function(n,t,i,r){var u,f=(u=new($$sc.v.$$($$sc.e)),u.b(new $$sc.e("av",t)),u.b(new $$sc.e("corr",i)),u);this.a("getEntitlements",f,1,r)},getEToken:function(n,t,i,r,u,f){var e,o=(e=new($$sc.v.$$($$sc.e)),e.b(new $$sc.e("cmu",n)),e.b(new $$sc.e("cmf",t)),e.b(new $$sc.e("assetid",i)),e.b(new $$sc.e("expver",r)),e.b(new $$sc.e("corr",u)),e);this.a("getEToken",o,1,f)},getManifest:function(n,t,i,r){var u,f=(u=new($$sc.v.$$($$sc.e)),u.b(new $$sc.e("cmu",n)),u.b(new $$sc.e("assetid",t)),u.b(new $$sc.e("corr",i)),u);this.a("getManifest",f,1,r)},getAppState:function(n,t,i){var r,u=(r=new($$sc.v.$$($$sc.e)),r.b(new $$sc.e("ma",n)),r.b(new $$sc.e("corr",t)),r);this.a("getAppState",u,1,i)},getKilledApps:function(n,t){var i,r=(i=new($$sc.v.$$($$sc.e)),i.b(new $$sc.e("corr",n)),i);this.a("getRemovedAddins",r,1,t)},getAppDetails:function(n,t,i,r){var u,f=(u=new($$sc.v.$$($$sc.e)),u.b(new $$sc.e("cmo",n)),u.b(new $$sc.e("corr",i)),u);this.b("getAppDetails",f,t,2,r,!1)},removeApps:function(n,t,i){var r,u=(r=new($$sc.v.$$($$sc.e)),r.b(new $$sc.e("corr",t)),r);this.b("removeAddin",u,n,2,i,!1)},getLastPrivateCatalogUpdate:function(n,t,i,r,u,f){var e,o=(e=new($$sc.v.$$($$sc.e)),e.b(new $$sc.e("catalog","privatecatalog")),e.b(new $$sc.e("clientCode",n)),e.b(new $$sc.e("clientVersion",t)),e.b(new $$sc.e("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.d.a(i):"",r?Common.d.a(r):"");this.b("getLastPrivateCatalogUpdate",o,s,2,f,!0)},getPrivateCatalogAddIns:function(n,t,i,r,u,f){var e,o=(e=new($$sc.v.$$($$sc.e)),e.b(new $$sc.e("catalog","privatecatalog")),e.b(new $$sc.e("clientCode",n)),e.b(new $$sc.e("clientVersion",t)),e.b(new $$sc.e("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.d.a(i):"",r?Common.d.a(r):"");this.b("getAddIns",o,s,2,f,!0)},getPrivateCatalogManifests:function(n,t,i,r,u){var f,e=(f=new($$sc.v.$$($$sc.e)),f.b(new $$sc.e("catalog","privatecatalog")),f.b(new $$sc.e("corr",r)),f),o=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Common.d.a(n),t?Common.d.a(t):"",i?Common.d.a(i):"");this.b("getAppManifests",e,o,2,u,!0)},isStoreDisabled:function(n,t){var i,r=(i=new($$sc.v.$$($$sc.e)),i.b(new $$sc.e("corr",n)),i);this.a("isStoreDisabled",r,2,t)},a:function(n,t,i,r){this.b(n,t,null,i,r,!1)},b:function(n,t,i,r,u,f){var e=new Common.bF("AddinServiceHandler.ashx"),o,s;for(e.a("action",n),e.a("app",Common.bY.toString(Common.a.b().a().a())),o=t.$$ge();o.$$mn();)s=o.$$cu(),e.a(s.b,s.a);var h=Common.a.b().a().n(),c=String.format("{0}{1}&{2}",h,e.toString(),Common.a.i),l=Common.a.e,a=this,v=this;l.a(c,r,i,null,!1,2,function(n){var t=null;n&&n.b&&(n.b.d["X-BlockedForMinor"]&&n.b.d["X-BlockedForMinor"].toString()==="1"&&(n.b.a=451),t=n.b.b);u(n.b.a,t)},function(n){var t=null;f&&n&&n.b&&n.b.b&&(t=n.b.b);u(n.b.a,t);Diag.a.a(18392345,220,50,"S2S web request failed with {0}.",n.b.a)},null,null,!1,null,null,"AddinServiceHandler_"+n,null,!1,null,!1,null)}};Common.App.AppsForOffice.h=function(){};Common.App.AppsForOffice.h.b=function(n){var r=n,i=null,t;i=r;Otel.Telemetry.sendOtelEvent((t=new Otel.d,t.otelEvent=i,t))};Common.App.AppsForOffice.h.a=function(n){var r=n,i=null,t;i=r;Otel.Telemetry.sendOtelCustomerContent((t=new Otel.d,t.otelEvent=i,t))};Common.App.AppsForOffice.ActionService=function(n){if(!n)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.a=n};Common.App.AppsForOffice.ActionService.prototype={a:null,areShortcutsInUse:function(n){var t=this,i=function(i,r){t.a.checkShortcutsInUse(n).then(function(n){i(n)}).catch(function(n){r(n)})};return OfficeExtension.WacRuntime.Utility.createPromise(i)},getShortcuts:function(){var n=this,t=function(t,i){n.a.getShortcuts().then(function(n){t(n)}).catch(function(n){i(n)})};return OfficeExtension.WacRuntime.Utility.createPromise(t)},replaceShortcuts:function(n){var t=this,i=function(i,r){t.a.replaceShortcuts(n).then(function(){i(null)}).catch(function(n){r(n)})};return OfficeExtension.WacRuntime.Utility.createPromise(i)},getTypeName:function(){return"Microsoft.Office.ActionService"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 3:return this.b(t);case 1:return this.getShortcuts();case 2:return this.c(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},b:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"Array<string>");return this.areShortcutsInUse(t)},c:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"any");return this.replaceShortcuts(t)}};Common.App.AppsForOffice.SharedFilePicker=function(){};Common.App.AppsForOffice.SharedFilePicker.prototype={a:null,c:function(){return this.a||(this.a=Common.Utils.b.a(Common.App.SharedFilePicker.a,Common.Utils.a.a().b(Common.App.SharedFilePicker.a,null))),this.a},getSharedFilePickerResponse:function(n){var t=this,i=function(i,r){try{var u=t.c();$$sc.a.WAA.call(null,u).CW(function(){var f=u.a(),t,e,o,s;f?(t={},(o=Common.bp.a(n,e={val:t}),t=e.val,o)?(s=f.a(t),s.then(function(n){n&&n.length>0?i(n):r(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function(n){r(n)})):r(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))):r(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(f){r(f)}};return OfficeExtension.WacRuntime.Utility.createPromise(i)},getTypeName:function(){return"Microsoft.Office.SharedFilePicker"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.b(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},b:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getSharedFilePickerResponse(t)}};Common.App.AppsForOffice.WacApiDelegates=function(){};Common.App.AppsForOffice.WacApiDelegates.prototype={replaceShortcuts:function(){return Promise.reject("ReplaceShortcuts method is not overridden")},getShortcuts:function(){return Promise.reject("GetShortcuts method is not overridden")},checkShortcutsInUse:function(){return Promise.reject("CheckShortcutsInUse method is not overridden")}};Common.App.AppsForOffice.WacApiHost=function(){};Common.App.AppsForOffice.WacApiHost.prototype={createInstance:function(n,t){switch(n){case"Microsoft.Office.ActionService":return new Common.App.AppsForOffice.ActionService(t);case"Microsoft.Office.SharedFilePicker":return new Common.App.AppsForOffice.SharedFilePicker}return null}};Common.App.AppsForOffice.TypeRegister=function(){};Common.App.AppsForOffice.TypeRegister.registerTypes=function(n){var i,t;i=n.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);t=i.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);t.addParameter("shortcuts","String[]",1,null,0);t=i.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);t=i.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);t.addParameter("shortcuts","Object",1,null,0);i=n.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);t=i.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);t.addParameter("pickerCustomizationJsonString","String",1,null,0)};Common.App.AppsForOffice.e.registerClass("Common.App.AppsForOffice.e");Common.App.AppsForOffice.n.registerClass("Common.App.AppsForOffice.n",Common.App.AppsForOffice.e);Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.registerClass("Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper");Common.App.AppsForOffice.o.registerClass("Common.App.AppsForOffice.o",CommonUI.b,Common.App.AppsForOffice.x);Common.App.AppsForOffice.AppsForOfficeDialogManager.registerClass("Common.App.AppsForOffice.AppsForOfficeDialogManager");Common.App.AppsForOffice.p.registerClass("Common.App.AppsForOffice.p",CommonUI.b);Common.App.AppsForOffice.j.registerClass("Common.App.AppsForOffice.j");Common.App.AppsForOffice.k.registerClass("Common.App.AppsForOffice.k");Common.App.AppsForOffice.k.b.registerClass("Common.App.AppsForOffice.k.b");Common.App.AppsForOffice.k.a.registerClass("Common.App.AppsForOffice.k.a",Common.App.AppsForOffice.k.b);Common.App.AppsForOffice.k.c.registerClass("Common.App.AppsForOffice.k.c");Common.App.AppsForOffice.f.registerClass("Common.App.AppsForOffice.f");Common.App.AppsForOffice.g.registerClass("Common.App.AppsForOffice.g",Sys.EventArgs);Common.App.AppsForOffice.t.registerClass("Common.App.AppsForOffice.t",Sys.EventArgs);Common.App.AppsForOffice.q.registerClass("Common.App.AppsForOffice.q");Common.App.AppsForOffice.i.registerClass("Common.App.AppsForOffice.i");Common.App.AppsForOffice.ActionService.registerClass("Common.App.AppsForOffice.ActionService");Common.App.AppsForOffice.SharedFilePicker.registerClass("Common.App.AppsForOffice.SharedFilePicker");Common.App.AppsForOffice.WacApiDelegates.registerClass("Common.App.AppsForOffice.WacApiDelegates");Common.App.AppsForOffice.WacApiHost.registerClass("Common.App.AppsForOffice.WacApiHost");Common.App.AppsForOffice.TypeRegister.registerClass("Common.App.AppsForOffice.TypeRegister");Common.App.AppsForOffice.c.a=null;Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.a=null;Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.b=null;Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.d=!1;Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.c=!1;Common.App.AppsForOffice.AppsForOfficeDialogManager.b=null;Common.App.AppsForOffice.AppsForOfficeDialogManager.a=new($$sc.w.$$(Common.App.AppsForOffice.f));Common.App.AppsForOffice.a.e=["wa200000047","wa104381973","42de5e8d-cfa0-459d-813d-cf777d47ada0","97d94c7b-54e5-4098-8dbb-b486b6c1f049","wa104381526","d98404ac-f9e2-4292-8cb6-eec349559ae5"];Common.App.AppsForOffice.a.c=null;Common.App.AppsForOffice.d.a=new($$sc.w.$$(Function));Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.F=function(){};Common.App.AppsForOfficeCommon.F.registerInterface("Common.App.AppsForOfficeCommon.F");Common.App.AppsForOfficeCommon.m=function(n,t,i,r){this.e=n;this.d=t;this.c=i;this.f=r;this.b=Common.a.c()?Common.a.c():null};Common.App.AppsForOfficeCommon.m.prototype={e:null,d:null,c:null,f:null,b:null,a:null};Common.App.AppsForOfficeCommon.c=function(n,t,i,r){this.c=n;this.f=t;this.d=i;this.e=r};Common.App.AppsForOfficeCommon.c.prototype={c:null,f:null,d:null,e:null,a:function(){return this.c},b:function(){return this.d}};Common.App.AppsForOfficeCommon.d=function(){this.a={};this.b={}};Common.App.AppsForOfficeCommon.d.prototype={a:null,b:null};Common.App.AppsForOfficeCommon.b=function(){this.b=Common.a.c()};Common.App.AppsForOfficeCommon.b.a=function(){return Common.App.AppsForOfficeCommon.b.b||(Common.App.AppsForOfficeCommon.b.b=new Common.App.AppsForOfficeCommon.b),Common.App.AppsForOfficeCommon.b.b};Common.App.AppsForOfficeCommon.b.prototype={b:null,a:function(n,t,i,r,u,f){this.d(n,t,i,r,u,f)},d:function(n,t,i,r,u,f){var e={},s,o;e.extId=n;e.ComponentType=t;e.ComponentId=i;e.HostProps=r;e.OptionalProps=u;s=8;s=t==="Action"?this.b.c(1257657435,2,e,null):this.b.c(2451283737,2,e,null);s===32?(o=Common.br.a().toString(),u.a.InstanceToken&&(o=u.a.InstanceToken),f.val=new Common.App.AppsForOfficeCommon.m(n,t,i,o),Common.App.AppsForOfficeCommon.b.c[o]=f.val):f.val=new Common.App.AppsForOfficeCommon.m(n,t,i,null);f.val.a=e},c:function(n){var f=null,t=n,i=t.ExtId,s=t.ComponentType,h=t.ComponentId,r=t.HostProps,e=t.OptionalProps,c=new Common.App.AppsForOfficeCommon.c(i.Id,i.StoreId,i.StoreType,i.AppVersion),l=new Common.App.AppsForOfficeCommon.e(r.HostType,r.FormFactor,r.Locale),u=new Common.App.AppsForOfficeCommon.d,o;u.a=e.OptionalProperties;u.b=e.DevProperties;Common.App.AppsForOfficeCommon.b.a().a(c,s,h,l,u,o={val:f});f=o.val}};Common.App.AppsForOfficeCommon.e=function(n,t,i){this.b=n;this.a=t;this.c=i};Common.App.AppsForOfficeCommon.e.prototype={b:null,a:null,c:null};Common.App.AppsForOfficeCommon.d.registerClass("Common.App.AppsForOfficeCommon.d");Common.App.AppsForOfficeCommon.e.registerClass("Common.App.AppsForOfficeCommon.e");Common.App.AppsForOfficeCommon.b.b=null;Common.App.AppsForOfficeCommon.b.c={};Type.registerNamespace("Common.App.WopiIdentity");Common.App.WopiIdentity.a=function(){};Common.App.WopiIdentity.a.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};Common.App.WopiIdentity.a.registerEnum("Common.App.WopiIdentity.a",!1);Common.App.WopiIdentity.b=function(){};Common.App.WopiIdentity.f=function(n,t){this.a=Common.App.WopiIdentity.f.T===Number||Type.isEnum(Common.App.WopiIdentity.f.T)?0:Common.App.WopiIdentity.f.T===Boolean?!1:null;this.b=n;this.a=t};Common.App.WopiIdentity.f.$$=function(n){var u=Common.App.WopiIdentity.__tc=Common.App.WopiIdentity.__tc||{},t="f$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.WopiIdentity.f.apply(this,t)};i.registerClass("Common.App.WopiIdentity.__tc."+t);o={"Common.App.WopiIdentity.f":{T:n},ctor:Common.App.WopiIdentity.f};i.prototype.$$gta=o;f=Common.App.WopiIdentity.f.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.WopiIdentity.f.prototype={b:null,get_requestParameters:function(){return this.b},set_requestParameters:function(n){return this.b=n,n},get_requestCallback:function(){return this.a},set_requestCallback:function(n){return this.a=n,n}};Common.App.WopiIdentity.c=function(n){this.g=Function.createDelegate(this,this.o);this.a={};this.b={};this.f=Common.a.b().d();this.d=n};Common.App.WopiIdentity.c.prototype={d:null,a:null,b:null,f:null,c:!1,i:function(n){this.c||(n.c("Host_SetAuthToken"),n.b("Host_SetAuthToken",this.g),this.c=!0)},getAccessToken:function(n,t,i){this.m(n,t);var r=this;return new Promise(function(u,f){if(r.e(t)){if(t in r.a){f(Common.App.WopiIdentity.a.toString(4));return}var e=window.setTimeout(function(){Diag.a.a(37856032,344,10,JSON.stringify({error:"Request timeout.",callerId:t}));f(Common.App.WopiIdentity.a.toString(5));return},12e4);r.j(n,t,i,function(n,t){window.clearTimeout(e);n?u(n):(Diag.a.a(37856033,369,15,JSON.stringify({error:Common.App.WopiIdentity.a.toString(t)})),f(t))})}else Diag.a.a(37856034,344,10,JSON.stringify({error:"Caller is not allowed."})),f(Common.App.WopiIdentity.a.toString(2))})},getPrimaryIdentityInfo:function(n){var t=this;return new Promise(function(i,r){t.e(n)?t.k(function(n,t){n?i(n):(Diag.a.a(37856064,369,10,JSON.stringify({error:t.toString()})),r(t))}):(Diag.a.a(37856065,344,10,JSON.stringify({error:"Caller is not allowed."})),r(Common.App.WopiIdentity.a.toString(2)))})},getAuthContext:function(n){var t=this;return new Promise(function(i,r){var u=t.getAuthContextSync(n);u?i(u):r(Common.App.WopiIdentity.a.toString(2))})},getAuthContextSync:function(n){var t,i;return this.e(n)?(t=new Common.App.WopiIdentity.e,t.f=Common.a.a.b("UserPrincipalName"),t.g=Common.a.a.b("LoggableUserId"),t.b=Common.a.a.b("HostAuthAuthority"),t.e=Common.a.a.b("TenantId"),t.c=Common.a.a.a("IsAnonymousUser"),t.d=this.l(n),i=Common.a.a.b("HostAuthType"),t.a=i.toLowerCase()==="aad"?2:i.toLowerCase()==="msa"?1:0,t):(Diag.a.a(40751647,344,10,JSON.stringify({error:"Caller is not allowed."})),null)},l:function(n){var t=Common.App.OAuth.a.f(),i;return Common.c.r()?(i=Common.a.a.d("Microsoft.Office.SharedOnline.HostSupportsTeamsElectronSSO",!1),t&&i&&Common.App.OAuth.a.p())?Array.contains(Common.App.OAuth.a.p(),n.toLowerCase()):!1:t},j:function(n,t,i,r){var s=new Array(0),f,e,o,u,v,l;Array.add(s,(f=new Otel.a,f.name="CallerId",f.string=t,f));Array.add(s,(e=new Otel.a,e.name="CorrelationId",e.string=n.get_correlationId(),e));Otel.Telemetry.a((o=new Otel.b,o.name="Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",o.dataFields=s,o));var h=Common.br.a().toString(),c="getAccessToken_"+h,a=this.f.a("ComponentAttach",c);this.b[c]=a;u={};v=n.get_options()&&typeof n.get_options()!="undefined"?n.get_options():{};u.RequestId=h;u.Resource=n.get_resource();u.Scope=n.get_scope();u.IdentityType=Common.a.a.b("HostAuthType");u.Upn=Common.a.a.b("UserPrincipalName");u.SilentLogin=n.get_silentLogin();u.Claims=n.get_options();u.CorrelationId=n.get_correlationId();u.ClientId=t;i&&(u.AddinName=i.AddinName,u.AddinTrustId=i.AddinTrustId);l=this;this.d.a(function(n){l.i(n);n.a("App_GetAuthToken",u,"")});this.a[h]=new(Common.App.WopiIdentity.f.$$(Function))(n,r)},k:function(n){var r=Common.a.a.b("UserName"),u=Common.a.a.b("UserPrincipalName"),f=Common.a.a.b("TenantId"),i=Common.a.a.b("LoggableUserIdSpace"),t=new Common.App.WopiIdentity.h;t.c=u;t.b=r;switch(i){case"OrgIdPuid":t.a="AzureActiveDirectoryAccount";break;case"MsaCid":case"MsaPuid":t.a="MicrosoftAccount";break;default:t.a=i}n(t,null)},o:function(n){var t=null,s,f,e,o,a,h;try{var i=n.Values.RequestId,r=n.Values.AuthToken,y=n.Values.IdentityType,p=n.Values.TokenExpiration,c=null,l=null,u=this.a[i];if(typeof u=="undefined"||!u){Diag.a.a(37856066,344,10,JSON.stringify({error:"No matching outstanding request for request ID.",requestId:i}));return}s=new Array(0);Array.add(s,(f=new Otel.a,f.name="CorrelationId",f.string=u.b.get_correlationId(),f));Otel.Telemetry.a((e=new Otel.b,e.name="Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",e.dataFields=s,e));t=u.a;delete this.a[i];typeof r!="undefined"&&r&&r.length?l=new Common.App.WopiIdentity.j(r,y,p):c=Common.App.WopiIdentity.a.toString(this.n(n));o="getAccessToken_"+i;o in this.b&&(a=this.b[o],a.a(),delete this.b[o]);t(l,c)}catch(v){h=n.Values.RequestId;h in this.a&&delete this.a[h];this.h();Diag.a.a(37856067,344,10,JSON.stringify({error:v.message,stack:v.stack}));t&&t(null,Common.App.WopiIdentity.a.toString(0))}},e:function(n){var s=Common.a.bP,f,e,i,r,o;n=n.toLowerCase();for(var u=s,h=u.length,t=0;t<h;++t)if(f=u[t],n===f.toLowerCase())return!0;e=Common.App.OAuth.a.j();i=e;for(r in i)if(o={key:r,value:i[r]},n===o.value.toLowerCase())return!0;return!1},n:function(n){var t=n.Values.Error;return(this.h(),Diag.a.a(39068821,344,15,JSON.stringify({error:t})),!t)?13:t.indexOf("AADSTS50058")>-1?9:t.indexOf("Popup Window is null")>-1||t.indexOf("Popup Window closed")>-1?12:t.indexOf("AADSTS50001")>-1?10:t.indexOf("13002")>-1?8:t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1||t==="tokenRevoked"?11:t.indexOf("Token renewal operation failed due to timeout")>-1?6:0},m:function(n,t){var i=this.p(n.get_resource());Diag.a.a(39921882,344,50,JSON.stringify({callerId:t,resource:i}))},h:function(){var n=window.navigator.userAgent;Diag.a.a(39068822,344,50,JSON.stringify({userAgent:n}))},p:function(n){return n=n?n:"",n.replace("://","__").replace(new RegExp("\\.","g"),"_dot_").replace("/","\\")}};Common.App.WopiIdentity.i=function(){this.e=Function.createDelegate(this,this.f)};Common.App.WopiIdentity.i.a=function(){Common.App.a.a().a(new Common.App.WopiIdentity.i,0,!1)};Common.App.WopiIdentity.i.prototype={d:null,a:function(){return"Common.App.WopiIdentity"},c:function(n){this.d=n;var t=this;n.c(Common.App.WopiIdentity.c,null).c(Common.App.WopiIdentity.d,null).a().b(function(){return new Common.App.WopiIdentity.c(n.b(Common.T,null))})},b:function(){Common.a.a&&Common.a.a.k(this.e)},f:function(){try{this.d.a(Common.App.WopiIdentity.d,null)}catch(n){Diag.a.a(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+n)}}};Common.App.WopiIdentity.c.registerClass("Common.App.WopiIdentity.c",null,Common.App.WopiIdentity.d);Common.App.WopiIdentity.b.i=Common.App.WopiIdentity.a.toString(0);Common.App.WopiIdentity.b.j=Common.App.WopiIdentity.a.toString(1);Common.App.WopiIdentity.b.k=Common.App.WopiIdentity.a.toString(2);Common.App.WopiIdentity.b.g=Common.App.WopiIdentity.a.toString(3);Common.App.WopiIdentity.b.n=Common.App.WopiIdentity.a.toString(4);Common.App.WopiIdentity.b.m=Common.App.WopiIdentity.a.toString(5);Common.App.WopiIdentity.b.f=Common.App.WopiIdentity.a.toString(6);Common.App.WopiIdentity.b.o=Common.App.WopiIdentity.a.toString(7);Common.App.WopiIdentity.b.e=Common.App.WopiIdentity.a.toString(8);Common.App.WopiIdentity.b.d=Common.App.WopiIdentity.a.toString(9);Common.App.WopiIdentity.b.c=Common.App.WopiIdentity.a.toString(10);Common.App.WopiIdentity.b.b=Common.App.WopiIdentity.a.toString(11);Common.App.WopiIdentity.b.a=Common.App.WopiIdentity.a.toString(12);Common.App.WopiIdentity.b.h=Common.App.WopiIdentity.a.toString(13);Common.App.WopiIdentity.b.l=Common.App.WopiIdentity.a.toString(14);Common.App.WopiIdentity.i.a();Type.registerNamespace("_Ewa");_Ewa.bdl=function(){};_Ewa.bdl.a=function(){Common.M.a("")};_Ewa.bdl.a();Type.registerNamespace("_Ewa");_Ewa.bdq=function(){};_Ewa.bdq.a=function(){Common.M.a(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}")};_Ewa.bdq.a();Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.j=function(){};Common.App.AppsForOfficeCommon.H=function(){};Common.App.AppsForOfficeCommon.n=function(n,t,i,r){this.i=Function.createDelegate(this,this.j);this.d=n;this.f=t;this.e=i;this.c=r};Common.App.AppsForOfficeCommon.n.prototype={e:null,d:null,f:null,b:null,a:null,c:null,j:function(n,t){var r,o,s,i,f,l,h,a,e,c;if(n||!t){if(this.a){for(r=0;r<this.a.b();r++)o=this.a.c(r),o(null),o=null;this.a=null}return}if(t.c===200&&t.b){var u=t.b,v=u.lastChild,y=Common.App.AppsForOfficeCommon.f.c(v);for(this.b=new(Common.Collections.c.$$(Common.App.AppsForOfficeCommon.j))(null),s=[],i=u.getElementsByTagName("app"),i&&i.length||(i=u.getElementsByTagName("o:app")),f=0;i&&f<i.length;f++)l=i[f],h=Common.App.AppsForOfficeCommon.f.a(l),this.b.d(h),Array.add(s,h);this.b.b()?(this.l(this.b),a=Sys.Serialization.JavaScriptSerializer.serialize(s),this.d.c(this.e,a,y)):Diag.a.a(6070471,344,50,"Response doesn't contain any preinstalled Apps: {0}",u.xml)}else t.a?Diag.a.a(6070472,344,15,"Error when requesting Apps data: {0}",t.a):Diag.a.a(6070473,344,15,"Error when requesting Apps data, status code: {0}",t.c);if(this.a){for(e=0;e<this.a.b();e++)c=this.a.c(e),c(this.b),c=null;this.a=null}},g:function(n,t){var i,r,f,e,u;return t?(e=this,r=function(){n.iconLoaded32=!0},i=this.c(n.icon32)):(f=this,r=function(){n.iconLoaded16=!0},i=this.c(n.icon16)),i&&(u=this,i.e(function(t,i){u.k(t,i,n,r)})),i},k:function(n,t,i,r){t.a&&i&&r()},l:function(n){for(var t,r=n.a,i=0;i<r.length;i++)t=r[i],this.c&&(!t.iconLoaded16&&t.icon16&&(t.icon16=this.h(t.icon16),this.g(t,0)),!t.iconLoaded32&&t.icon32&&(t.icon32=this.h(t.icon32),this.g(t,1)))},h:function(n){return document.URL.toLowerCase().startsWith("https://")||n.toLowerCase().startsWith("https://")&&(n="http"+n.substring(5,n.length)),n}};Common.App.AppsForOfficeCommon.h=function(){};Common.App.AppsForOfficeCommon.h.prototype={a:null};Common.App.AppsForOfficeCommon.o=function(n,t,i){this.g=Function.createDelegate(this,this.i);this.h=Function.createDelegate(this,this.j);this.d=n;this.e=t;this.f=i};Common.App.AppsForOfficeCommon.o.prototype={d:null,e:null,b:null,c:0,f:null,a:function(n){this.b(this.c,n)},i:function(n){n&&n.b&&n.b.b?(Diag.a.a(6070474,344,15,"Failure request."),this.a(new Common.App.AppsForOfficeCommon.i(n.b.a,n.b.b,null))):(Diag.a.a(6070475,344,15,"Failure request."),this.a(null))},j:function(n){this.a(new Common.App.AppsForOfficeCommon.i(n.b.a,n.b.b,n.b.k))}};Common.App.AppsForOfficeCommon.i=function(n,t,i){this.c=n;this.a=t;this.b=i};Common.App.AppsForOfficeCommon.i.prototype={c:0,a:null,b:null};Common.App.AppsForOfficeCommon.f=function(){};Common.App.AppsForOfficeCommon.f.b=function(n,t){var r=n.prefix+":",i=n.attributes.getNamedItem(r+t);return i?i.nodeValue:""};Common.App.AppsForOfficeCommon.f.d=function(n){var t="0";switch(n){case"1":t="1";break;case"2":t="0";break;case"4":t="1";break;default:Diag.a.a(6850688,344,15,"Omex App SubType is invalid: {0}.",n)}return t};Common.App.AppsForOfficeCommon.f.c=function(n){var t=0;try{t=Number.parseInvariant(Common.App.AppsForOfficeCommon.f.b(n,"rr"))}catch(i){Diag.a.a(6070478,344,15,"Error parsing server response for a preinstalled apps node: {0}.",i.message);t=0}return t===Number.NaN?0:t};Common.App.AppsForOfficeCommon.f.a=function(n){var i=new Common.App.AppsForOfficeCommon.j,r;try{if(n.attributes&&n.attributes.length>0){for(r=0;r<n.attributes.length;r++){var t=n.attributes.item(r),f=t.localName,u=t.baseName?t.baseName:f;if(t&&u)switch(u){case"title":i.title=t.nodeValue;break;case"assetid":i.assetId=t.nodeValue;break;case"cm":i.cm=t.nodeValue;break;case"ver":i.ver=t.nodeValue;break;case"appst":i.appst=Common.App.AppsForOfficeCommon.f.d(t.nodeValue);break;case"defhei":i.defhei=t.nodeValue;break;case"defwid":i.defwid=t.nodeValue;break;case"smallicon":i.icon16=t.nodeValue;break;case"medicon":i.icon32=t.nodeValue;break;case"largeicon":i.icon64=t.nodeValue;break;case"desc":i.desc=t.nodeValue;break;case"ldesc":i.lDesc=t.nodeValue}}i.iconLoaded16=!1;i.iconLoaded32=!1}}catch(e){Diag.a.a(6070479,344,15,"Error parsing server response for a preinstalled app node: {0}.",e.message)}return i};Common.App.AppsForOfficeCommon.j.registerClass("Common.App.AppsForOfficeCommon.j");Common.App.AppsForOfficeCommon.h.a=new Common.App.AppsForOfficeCommon.h;Type.registerNamespace("Common.App.SmartLookup");Common.App.SmartLookup.b=function(){};Common.App.SmartLookup.d=function(){};Common.App.SmartLookup.j=function(){};Common.App.SmartLookup.c=function(){};Common.App.SmartLookup.k=function(){};Common.App.SmartLookup.f=function(){};Common.App.SmartLookup.e=function(){};Common.App.SmartLookup.EntryPoint=function(){};Common.App.SmartLookup.EntryPoint.prototype={other:0,searchBoxSearch:1,searchBoxDictionary:2,searchBoxQuickAnswer:3,smartLookupRibbon:4,smartLookupContextMenu:5,entity:6,dictionary:7,web:8,pictures:9,files:10,bookmarks:11,help:12,chartRecommendation:13,linkSkill:14,searchBoxFindInDocument:15,searchBoxEntity:16,searchSkill:17,controlF:18,ribbonFindButton:19,reuseSlides:20,data:21,contextMenuDictionary:22,contextMenuSearchSuggestion:23,contextMenuSynonyms:24,contextMenuSearchBoxSearch:25,searchBoxSearchZeroTerm:26,contextMenuSearchZeroTerm:27,note:28,smartLookupAutoLaunch:29,contextMenuSmartLookupInSubMenu:30,dataDisambiguate:31,linkFiles:32,searchBoxNoteL2:33};Common.App.SmartLookup.EntryPoint.registerEnum("Common.App.SmartLookup.EntryPoint",!1);Common.App.SmartLookup.p=function(){};Common.App.SmartLookup.LaunchMode=function(){};Common.App.SmartLookup.LaunchMode.prototype={"default":0,documentsView:1,objectsView:2};Common.App.SmartLookup.LaunchMode.registerEnum("Common.App.SmartLookup.LaunchMode",!1);Common.App.SmartLookup.l=function(){};Common.App.SmartLookup.m=function(){};Common.App.SmartLookup.i=function(){};Common.App.SmartLookup.i.prototype={getId:function(){return"SerpletExecutor"}};Common.App.SmartLookup.o=function(){};Common.App.SmartLookup.o.prototype={a:null,addSearchInvokedListener:function(n){this.a=n},notifySearchInvoked:function(n){this.a&&this.a(n)}};Common.App.SmartLookup.n=function(){};Common.App.SmartLookup.n.prototype={landingTab:null,data:null};Common.App.SmartLookup.q=function(){};Common.App.SmartLookup.q.prototype={imageUrl:null,imageBinaryBase64:null};Common.App.SmartLookup.g=function(n,t,i){this.d=Date.now;this.h=n;this.c=t;i&&this.f()};Common.App.SmartLookup.g.prototype={i:9e5,j:3e5,d:null,h:null,c:null,b:null,g:"",e:0,a:function(n){var t=this.d();return t<this.e+this.i?(t>this.e+this.j&&this.f(),this.g):(n&&this.f(),"")},f:function(){var n=this;return this.b=this.b||new Promise(function(t){n.k().then(function(i){n.g=i;n.e=n.d();n.b=null;t(i)})}),this.b},k:function(){if(!this.c||!this.c.length)return Diag.a.a(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve("");var n=this;return new Promise(function(t){n.h.a("SmartLookup",n.c,null).then(function(n){n.IsSuccess?n.Token||(t(""),Diag.a.a(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Diag.a.a(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+n.ErrorCode+": "+n.ErrorMessage),t(""));t(n.Token)}).catch(function(n){var i=JSON.stringify(n);Diag.a.a(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+i);t("")})})}};Common.App.SmartLookup.h=function(n){Diag.a.a(41521353,1313,50,"SmartLookupManager - Initialize");this.c=Common.a.a.a("IsTellMeUpSellEnterpriseEnabled");this.h=Common.a.a.b("SmartLookupApprovedOriginPattern");this.d=Common.a.a.b("SmartLookupShredderServiceEndpoint");this.f=Common.k.g(Common.a.a.b("AppCatalogUrl")||"");this.b=new Common.App.SmartLookup.d;this.b.EnableAllTabV2=!0;this.b.EnableIntentService=!0;this.b.EnableInDocumentSearch=Common.a.a.a("SmartLookupEnableInDocumentSearch");this.b.EnableLocalSearch=Common.a.a.a("SmartLookupEnableLocalSearch");this.b.IntentServiceEndpoint=Common.App.SmartLookup.a.b();this.e=new Common.App.SmartLookup.g(n,this.d,!0)};Common.App.SmartLookup.h.prototype={e:null,c:!1,h:null,d:null,f:null,b:null,a:function(){return Promise.resolve(this.i())},i:function(){var n=new Common.App.SmartLookup.b,r,i,t;return n.anid="",n.applicationVersion=Common.a.m,n.appCorrelationId=Common.u.a().a,n.themePlatform="web",n.lcid=Common.a.n,n.launchUtcTime=(new Date).toUTCString(),n.featureGates=this.b,r=Common.e.b(Common.a.n),i=r?r.a:null,n.market=this.g(i),n.uiLanguage=i,n.sessionId=Common.a.j,n.themeId=0,n.parentalControl="yes",t=new Common.App.SmartLookup.c,t.CountryCode=this.g(i),t.ServiceEndpoint=this.d,t.IsGoLocal=!1,t.IsEnabled=this.c,t.IsEnterpriseEnabled=this.c,t.TenantRoot=this.f,n.enterpriseUserInfo=t,n.accessToken=this.e.a(!0),n},g:function(n){var t=n.split("-");return t[t.length-1]}};Common.App.SmartLookup.a=function(){};Common.App.SmartLookup.a.a=function(){var i=$$as(String,Common.a.d.AudienceGroup)||"",n,t;switch(i){case"Dogfood":return Common.a.a?(n=Common.a.a.b("UserPrincipalName"),n=n.toLowerCase(),t=Common.a.a.f("SmartLookupINTEnabledForSKITeam")?Common.a.a.h("SmartLookupINTEnabledForSKITeam"):new Array(0),Array.indexOf(t,n)>=0?"INT":"EDOG"):"EDOG";case"Microsoft":case"Production":default:return"PROD"}};Common.App.SmartLookup.a.b=function(){var n=Common.a.a.a("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Common.a.a.a("IntentSvcEnableProdSourceLocationOverride")?"PROD":Common.a.a.a("IntentSvcEnableIntSourceLocationOverride")?"INT":Common.App.SmartLookup.a.a();switch(n){case"INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case"EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";case"PROD":default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Common.App.SmartLookup.b.registerClass("Common.App.SmartLookup.b");Common.App.SmartLookup.f.registerClass("Common.App.SmartLookup.f");Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.x=function(){};Common.App.AppsForOfficeCommon.r=function(n,t,i,r,u,f,e){this.taskPaneWidth=330;this.id=n;this.solutionId=t;this.version=i;this.storeType=u;this.storeId=r;this.assetId=null;this.assetStoreId=null;this.ownerAddinSolutionId=null;this.ownerAddinStoreType=null;this.settings=f;this.isAddinCommands=!1;this.addinCommandsActionType=0;this.virtualOsfControlActivationCallback=null;this.isForUILessAction=!1;this.isToBePersisted=e;this.onTaskPaneClose=null;this.featureGates=null;this.activationStart=0;this.isModernPane=!1;this.isResizable=!1;this.resizeMinWidth=330;this.resizeMaxWidth=920;this.hostInfoFlags=0;this.sharedRuntimeId=null;this.backgroundState=0;this.initialDisplayMode=0;this.isPreload=!1;this.isPaneAutoOpened=!1;this.marketplaceID=t;this.marketplaceVersion=i;this.store=r;this.ownerAddinAssetId=null};Common.App.AppsForOfficeCommon.u=function(){};Common.App.AppsForOfficeCommon.w=function(n,t,i,r){this.appName=n;this.appVersion=t;this.clientMode=i;this.formFactor=r||OSF.FormFactor.Default};Common.App.AppsForOfficeCommon.G=function(n,t,i){this.appUILocale=n;this.dataLocale=t;this.lcid=i};Common.App.AppsForOfficeCommon.I=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.osfOmexBaseUrl=n;this.devCatalogUrl=t;this.oneDriveCatalogBaseApiUrl=i;this.spBaseUrl=r;this.docUrl=u;this.pageBaseUrl=f;this.localizedScriptsUrl=e;this.localizedImagesUrl=o;this.localizedStylesUrl=s;this.localizedResourcesUrl=h;this.firstPartyManifestCDNUrl=c;this.sdxCdnUrl=l;this.sdxDmsUrl=a};Common.App.AppsForOfficeCommon.v=function(n,t){this.hostControl=n;this.controlStatusChanged=t.getAppForOfficeStatusChangeHandler();this.notifyHost=t.getAppForOfficeUserActionHandler()};Common.App.AppsForOfficeCommon.J=function(n,t){this.userNameHashCode=n;this.loggableUserId=t};Common.App.AppsForOfficeCommon.z=function(){};Common.App.AppsForOfficeCommon.A=function(){};Common.App.AppsForOfficeCommon.y=function(){};Common.App.AppsForOfficeCommon.B=function(){};Common.App.AppsForOfficeCommon.D=function(){};Common.App.AppsForOfficeCommon.D.registerInterface("Common.App.AppsForOfficeCommon.D");Common.App.AppsForOfficeCommon.E=function(){};Common.App.AppsForOfficeCommon.p=function(){this._handlers=new($$sc.w.$$(Function))};Common.App.AppsForOfficeCommon.q=function(){this.d=Function.createDelegate(this,this.k);this.i=parameters;this.a=callback;this.e=additionalParameters;this.c={};this.h=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError};Common.App.AppsForOfficeCommon.q.prototype={i:null,e:null,a:null,b:null,h:0,c:null,f:null,g:null,k:function(){this.j();this.l()},j:function(){},l:function(){this.a&&(this.c[OSF.DDA.Marshaling.ApiResponseKeys.Error]=this.h,this.a(this.c))}};Common.App.AppsForOfficeCommon.t=function(){this.e=Function.createDelegate(this,this.j);this.d=Function.createDelegate(this,this.i);this.f=taskManager;this.a=apiManager;this.b=afoDataManager};Common.App.AppsForOfficeCommon.t.prototype={f:null,a:null,b:null,invokeDdaMethod:function(n,t,i){var u=n.DdaMethod.DispatchId,r=this.a.b().a(u);r?(r.i=n,r.a=t,r.e=i,r.b=n.DdaMethod.ControlId,r.f=this.b.b(r.b),r.g=this.b.a(r.b),this.c(r.d,null)):(Diag.a.a(5902750,341,10,"API Call for method ID {0} does not exist.",u),this.g(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))},registerDdaEventAsync:function(n,t,i,r,u){this.c(this.d,new Common.App.AppsForOfficeCommon.l(n,t,i,r,u))},unregisterDdaEventAsync:function(n,t,i,r,u){this.c(this.e,new Common.App.AppsForOfficeCommon.l(n,t,i,r,u))},getThrottleForCall:function(n){return this.a.c().a(n)},c:function(n,t){var i=new Common.V(2,1,0,n,116,null,!1,0);i.d=t;this.f.a(i)},i:function(n){var t=this;this.h(n.d,function(n,t){n.a(t.b,t.e,t.a,t.d)})},j:function(n){var t=this;this.h(n.d,function(n,t){n.b(t.b,t.a,t.d)})},h:function(n,t){var i=this.a.a().a(n.c);i?t(i,n):(Diag.a.a(5902751,341,10,"Event for dispatch ID {0} does not exist.",n.c),this.g(n.a,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))},g:function(n,t){if(n){var i={};i[OSF.DDA.Marshaling.ApiResponseKeys.Error]=t;n(i)}}};Common.App.AppsForOfficeCommon.l=function(n,t,i,r,u){this.c=n;this.b=t;this.d=i;this.e=r;this.a=u};Common.App.AppsForOfficeCommon.l.prototype={c:0,b:null,d:null,e:null,a:null};Common.App.AppsForOfficeCommon.a=function(){this.d=330;this.b=null;this.a=null;this.e=null;this.h=null;this.f=null;this.c={};this.i=null;this.l=!1;this.o=!1;this.p=null;this.n=!1;this.m=!1};Common.App.AppsForOfficeCommon.a.prototype={d:0,b:null,a:null,e:null,h:null,f:null,c:null,g:!1,i:null,j:null,k:null,l:!1,o:!1,p:null,n:!1,m:!1};Common.App.AppsForOfficeCommon.p.registerClass("Common.App.AppsForOfficeCommon.p");Common.App.AppsForOfficeCommon.q.registerClass("Common.App.AppsForOfficeCommon.q");Common.App.AppsForOfficeCommon.l.registerClass("Common.App.AppsForOfficeCommon.l");Common.App.AppsForOfficeCommon.a.registerClass("Common.App.AppsForOfficeCommon.a");Type.registerNamespace("Common.App.AppsForOfficeOauth");Common.App.AppsForOfficeOauth.a=function(n){this.b=n};Common.App.AppsForOfficeOauth.a.d=function(){var n,t;if(Common.a.a.a("AppForOfficeSSOV2IsEnabled")){n=null;try{n=Common.Utils.a.a().a(Common.App.OAuth.d,null)}catch(i){Diag.a.a(592061330,1300,10,"Unable to resolve IOAuthManager: "+i)}t=new Common.App.AppsForOfficeOauth.b(n);Common.App.AppsForOfficeOauth.a.b=new Common.App.AppsForOfficeOauth.a(t)}};Common.App.AppsForOfficeOauth.a.c=function(){return Common.App.AppsForOfficeOauth.a.a||(Common.App.AppsForOfficeOauth.a.d(),Common.App.AppsForOfficeOauth.a.a=!0),Common.App.AppsForOfficeOauth.a.b};Common.App.AppsForOfficeOauth.a.prototype={b:null,a:function(){return this.b}};Common.App.AppsForOfficeOauth.b=function(n){this.d=n;this.e=Common.a.a.d("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1);this.g=Common.App.AppsForOffice.a.f();this.f=Common.a.a.d("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2AAD",!1);this.h=Common.a.a.d("Microsoft.Office.SharedOnline.ForceAppForOfficeSSOV2MSA",!1)};Common.App.AppsForOfficeOauth.b.a=function(n){return String.format($a.mO,n)};Common.App.AppsForOfficeOauth.b.b=function(n){var i,u;if(!n)return!1;i=n.toLowerCase();for(var r=Common.App.AppsForOffice.a.e,f=r.length,t=0;t<f;++t)if(u=r[t],u===i)return!0;return!1};Common.App.AppsForOfficeOauth.b.prototype={d:null,e:!1,g:!1,f:!1,h:!1,a:function(n,t,i,r,u,f,e,o){var l,s,h,c,v,a;if(!this.d)return l=new Common.App.AppsForOffice.b,l.a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(l);s=new Common.hQ;s.AddinName=e;s.AddinTrustId=o;h=-1;c=null;u&&this.i()?c=this.d.c("AddinShared",t,u,Common.App.AppsForOfficeOauth.b.a(e),s):(v=Date.now(),a=this,c=this.d.a("AddinShared",t,s).then(function(n){h=Date.now()-v;var u=i&&(n.ErrorCode==="interaction_required"||n.ErrorCode==="consent_required"||n.ErrorCode==="invalid_grant"),f=(i||r)&&n.ErrorCode==="login_required";return(u||f)&&a.i()?a.d.c("AddinShared",t,null,Common.App.AppsForOfficeOauth.b.a(e),s):Promise.resolve(n)}));var y=this,p=this,w=this;return c.then(function(n){var t=new Common.App.AppsForOffice.b;return n.IsSuccess?(t.e=n.Token,n.Telemetry&&(t.b=n.Telemetry.fromCache,t.f=n.Telemetry.expiresOn)):(t.a=y.k(n),t.g=y.l(n)),t}).catch(function(){var n=new Common.App.AppsForOffice.b;return n.a=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(n)}).then(function(n){return n.c="OauthManager",h>=0&&(n.d=h),n})},c:function(){return this.j()},b:function(n,t){var i=(Common.a.a.b("UiHost")||"").toLowerCase();return(Common.c.r()||i==="teams"&&Common.App.OAuth.a.f())&&!Common.App.AppsForOfficeOauth.b.b(n)?!1:!this.d||!this.d.b()?!1:t>0||this.j()||Common.App.AppsForOfficeOauth.b.b(n)},j:function(){var n=Common.App.OAuth.c.a();return this.g||this.h&&n===1||this.f&&n===2},i:function(){return this.e||Common.App.OAuth.c.a()!==1},k:function(n){var t;switch(n.ErrorCode){case"UserCancelled":case"interaction_required":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case"consent_required":case"invalid_grant":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case"login_required":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case"invalid_client":case"invalid_application_ID":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case"invalid_resource":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case"popup_window_error":t=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:t=n.ErrorCode===Common.App.WopiIdentity.b.e?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:n.ErrorCode===Common.App.WopiIdentity.b.d?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:n.ErrorCode===Common.App.WopiIdentity.b.c?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:n.ErrorCode===Common.App.WopiIdentity.b.b?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:n.ErrorCode===Common.App.WopiIdentity.b.a?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return t},l:function(n){var i="",r=new RegExp("AADSTS(\\d+)"),t=r.exec(n.ErrorMessage);return t&&t.length>1&&(i=t[1]),i}};Common.App.AppsForOfficeOauth.a.b=null;Common.App.AppsForOfficeOauth.a.a=!1;Type.registerNamespace("CommandUI.AddInCommands");CommandUI.AddInCommands.Z=function(){};CommandUI.AddInCommands.bi=function(){};CommandUI.AddInCommands.u=function(){};CommandUI.AddInCommands.u.registerInterface("CommandUI.AddInCommands.u");CommandUI.AddInCommands.bb=function(){};CommandUI.AddInCommands.v=function(){};CommandUI.AddInCommands.v.registerInterface("CommandUI.AddInCommands.v");CommandUI.AddInCommands.R=function(){};CommandUI.AddInCommands.R.registerInterface("CommandUI.AddInCommands.R");CommandUI.AddInCommands.p=function(){};CommandUI.AddInCommands.p.registerInterface("CommandUI.AddInCommands.p");CommandUI.AddInCommands.Q=function(){};CommandUI.AddInCommands.Q.registerInterface("CommandUI.AddInCommands.Q");CommandUI.AddInCommands.bj=function(){};CommandUI.AddInCommands.bj.registerInterface("CommandUI.AddInCommands.bj");CommandUI.AddInCommands.bg=function(){};CommandUI.AddInCommands.be=function(){};CommandUI.AddInCommands.bl=function(){};CommandUI.AddInCommands.bl.registerInterface("CommandUI.AddInCommands.bl");CommandUI.AddInCommands.ba=function(){};CommandUI.AddInCommands.bc=function(){};CommandUI.AddInCommands.bd=function(){};CommandUI.AddInCommands.bf=function(){};CommandUI.AddInCommands.bh=function(){};CommandUI.AddInCommands.bk=function(){};CommandUI.AddInCommands.bk.registerInterface("CommandUI.AddInCommands.bk");CommandUI.AddInCommands.bo=function(){};CommandUI.AddInCommands.bn=function(){};CommandUI.AddInCommands.bm=function(){};CommandUI.AddInCommands.br=function(){};CommandUI.AddInCommands.br.registerInterface("CommandUI.AddInCommands.br");CommandUI.AddInCommands.bq=function(){};CommandUI.AddInCommands.bp=function(){};CommandUI.AddInCommands.bs=function(){};CommandUI.AddInCommands.B=function(){this.d=Function.createDelegate(this,this.i)};CommandUI.AddInCommands.B.prototype={e:null,f:null,a:function(){return this.e||(this.e=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},b:function(){return this.f||(this.f=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())},c:function(n,t,i,r,u,f,e){var h,o,s;if(Diag.a.a(17138449,220,50,"Control id: {0}.",n),h=r,o=null,o=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?t.a(u.ownerAddinInfo.storeType,u.ownerAddinInfo.solutionId,0):t.a(u.ownerAddinInfo.storeType,u.ownerAddinInfo.assetId,0),o&&o.a){if(o.a.getIsUpgrading())return;if(s=null,o.a.getNotificationParams().length>0&&(s=this.g(o.a.getNotificationParams()[0])),o.a.getStatus()!==OSF.OsfControlStatus.Activated&&(o.a.getStatus()!==OSF.OsfControlStatus.NotActivated||s&&s.d===OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE))s&&this.h(o,s,e);else try{i.setOwnerAddinEToken(o.a.getEToken());u.action(i,h.a());f&&f()}catch(c){Diag.a.a(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",c.message));CommandUI.AddInCommands.a.g($a.w+" "+$a.x,null)}}},h:function(n,t,i){var r=n.a;if(r.getNotificationParams().length===1||t.h){var f=t.a,u=this,o=function(){var i,e,o;r.removeFirstNotification();r.getNotificationParams().length>0&&(i=u.g(r.getNotificationParams()[0]),u.h(n,i,null));t.d===OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE&&(e=n.b,CommandUI.AddInCommands.l.b(e,r,u.d),o=n.c,CommandUI.AddInCommands.h.a(o,r,u.d));f&&f()},e=t.b,h=this,s=function(){e&&e();i&&i()};t.a=o;t.b=s;CommandUI.AddInCommands.a.h(t)}},i:function(n,t){var i=null,r=this;i=function(){n.getIsUpgrading()?window.setTimeout(i,1e3):n.getUpgradingFailed()?CommandUI.AddInCommands.l.a(t,!0):Common.a.b().c(!1)};window.setTimeout(i,1e3)},g:function(n){var t=new CommandUI.AddInCommands.m;return t.e=n.infoType,t.i=n.id,t.c=n.title,t.f=n.description,t.g=n.buttonTxt,t.a=n.buttonCallback,t.h=n.highPriority,t.b=n.dismissCallback,t.d=n.errorCode,t.j=n.iframeNotificationUrl,t}};CommandUI.AddInCommands.o=function(){};CommandUI.AddInCommands.o.a=function(n){var t=new CommandUI.AddInCommands.K;return t.a=n.b,t.b=t.a?!0:!1,t};CommandUI.AddInCommands.o.b=function(n,t,i,r,u){var f=document.getElementById(i);if(!f){Diag.a.a(17662423,220,100,String.format("{0} element is not availiable",i));return}CommandUI.AddInCommands.o.c(n,t,f,r,u)};CommandUI.AddInCommands.o.c=function(n,t,i,r,u){if(!i){Diag.a.a(543801756,220,100,String.format("addinLabelElement element is not available"));return}n.b===$a.h?CommandUI.AddInCommands.a.m(t,i,r,u):n.b===$a.K&&CommandUI.AddInCommands.a.p(t,i,$a.im,$a.K)};CommandUI.AddInCommands.w=function(n,t,i,r,u,f,e,o){this.j=new Common.bc;this.f=n;this.i=t;this.d=i;this.g=r;this.c=u;this.h=f;this.e=e;this.k=o};CommandUI.AddInCommands.w.prototype={f:null,i:null,d:null,g:null,c:null,h:null,e:null,k:null,a:function(n){this.j.m("ack7",n)},b:function(n,t,i){var u=i.ack2,r=isUndefined(i.ack0)?0:i.ack0;if(!u||!r){Diag.a.a(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.f.a()));this.m(new CommandUI.AddInCommands.q(r,null,null,null,t,null,!0));return}if(u.f.length<=0&&r!==4){this.n(new CommandUI.AddInCommands.q(r,null,null,null,t,null,!0));return}var f=u.f.length,o=new CommandUI.AddInCommands.W(new CommandUI.AddInCommands.U),p=isUndefined(i.ack1)?-1:i.ack1,s=new CommandUI.AddInCommands.G(r,this.d,this.f,o,this.i,this.c,this.e),e=this,h=function(t){return e.g.b(t.assetId,e.e,e.f,n)},w=this,c=function(n){return w.g.a(n.assetId)},l=this,a=function(n,i,u){f--;var e=new CommandUI.AddInCommands.q(r,i,o,null,t,u,f<=0);n&&i?l.n(e):l.m(e);f||Common.a.b().c(!1)},nt=this,b=function(n,t,i,r){a(n,t,r)},v=this,y=function(){v.l(null);u.f.length<=0&&r===4&&v.c.h()};if(r===6){var k=i.OsfControl,d=i.RibbonUpdaterData,tt=this,g=function(n,t,i,r){a(n,t,r)};s.q(u.a(0),k,d,h,c,g,y)}else s.p(u,h,c,p,b,y,this.k)},m:function(n){this.l(n);this.o(!1,n)},n:function(n){var t=n.a,i;this.l(n);t&&(CommandUI.AddInCommands.e.b().a(CommandUI.AddInCommands.j.b(t.currentStoreType.toLowerCase()),!0),t.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog&&(i=this.h.a(t.currentStoreType.toLowerCase(),this.d),i&&(Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?i.localCacheAddinCommands(this.d.a(),t.solutionId||t.id,t.version||t.appVersion,t.storeId):i.localCacheAddinCommands(this.d.a(),t.id,t.appVersion,t.storeId))),this.p(n.c.c,t.currentStoreType,n.b,n.d),Common.bG.a("ak4","true",CommandUI.AddInCommands.j.b(t.currentStoreType.toLowerCase())));this.o(!0,n)},o:function(n,t){var r,i;n?t.b!==3?t.e&&this.c.h():t.c&&t.c.c&&(r=$$as(CommandUI.i,t.d),t.a.currentStoreType!==OSF.StoreType.HardCodedPreinstall&&CommandUI.AddInCommands.a.o(r,t.g,t.f,t.c.c)):t.b===3?t.a&&t.a.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog?(i=this.e.b(t.a.assetId),CommandUI.AddInCommands.a.g(i?i:$a.w+" "+$a.x,null)):this.c.k(!0,!1):t.e&&this.c.h()},l:function(n){var t=n?n.a:null,r=new CommandUI.AddInCommands.S,u,i;r.a=t;t&&(u=n.b===6?1:0,i=null,i=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.c.a(t.storeType||t.currentStoreType,t.solutionId||t.id,u):this.c.a(t.currentStoreType,t.assetId,u),i&&i.b&&(r.b=i.b));this.j.k("ack7",r,null)},p:function(n,t,i,r){var u=$$as(CommandUI.i,r),e,f;n&&u&&(e=n.a().a(0),f=e.b().Id,i===3&&t!==OSF.StoreType.HardCodedPreinstall&&u.v(f,!1),u.fa(f)&&u.fg())}};CommandUI.AddInCommands.S=function(){CommandUI.AddInCommands.S.initializeBase(this)};CommandUI.AddInCommands.S.prototype={a:null,b:null};CommandUI.AddInCommands.q=function(n,t,i,r,u,f,e){this.b=n;this.a=t;this.c=i;this.d=r;this.g=u;this.f=f;this.e=e};CommandUI.AddInCommands.q.prototype={b:0,a:null,c:null,d:null,g:null,f:null,e:!1};CommandUI.AddInCommands.W=function(n){this.d=n};CommandUI.AddInCommands.W.prototype={d:null,c:null,a:function(n,t){this.d.a(n,t);this.c=n},b:function(n){this.d.b(n)}};CommandUI.AddInCommands.F=function(){};CommandUI.AddInCommands.F.prototype={a:null,setErrorMessageForAddin:function(n,t){this.a||(this.a={});this.a[n]=t},b:function(n){return this.a&&n in this.a?this.a[n]:null}};CommandUI.AddInCommands.m=function(){};CommandUI.AddInCommands.m.prototype={e:0,i:null,c:null,f:null,g:null,a:null,d:0,h:!1,b:null,j:null};CommandUI.AddInCommands.n=function(){};CommandUI.AddInCommands.n.prototype={a:null,b:null,c:null,d:null,e:null,f:function(n,t){return this.a.getStoreType().toLowerCase()===n.toLowerCase()&&this.a.getMarketplaceID().toLowerCase()===t.toLowerCase()}};CommandUI.AddInCommands.AddinCommandsUILessDialog=function(){this.b=this.F;this.c=this.initializeAndShowWithTitle;CommandUI.AddInCommands.AddinCommandsUILessDialog.initializeBase(this,[!1,!1,!1,!0]);this.H=this.i;this.D(5);this.e=String.format("{0}px",this.g);this.d=String.format("{0}px",this.f);this.bk=!1;this.dj=!1;this.bb()};CommandUI.AddInCommands.AddinCommandsUILessDialog.prototype={i:"AddinCommandsUILessDialog",j:"WACDialogTitleText",h:"0",e:null,d:null,g:380,f:190,bb:function(){CommonUI.b.prototype.bb.call(this);this.O.style.width=this.e;this.O.style.height=this.d;this.O.style.padding=this.h},R:function(n){this.be();var t=document.getElementById(this.K+this.j);t.innerText=n},be:function(){CommonUI.b.prototype.be.call(this);this.C.style.width=String.format("{0}px",this.g);this.C.style.height=String.format("{0}px",this.f);this.C.removeAttribute("role");this.C.removeAttribute("aria-labelledby")},F:function(){this.dw()},a:function(){return this.O},initializeAndShowWithTitle:function(){this.G($a.jv,null,null)}};CommandUI.AddInCommands.J=function(){};CommandUI.AddInCommands.J.a=function(n){var t={};return Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.solutionId=n.solutionId,t.version=n.version,t.storeType=n.storeType,t.storeId=n.storeId,t.assetId=n.assetId,t.assetStoreId=n.storeType,t.targetType=n.targetType,t.requireConsent=n.requireConsent||!1,t.isAddinCommands=!0,t.id=n.solutionId,t.appVersion=n.version,t.currentStoreType=n.storeType):(t.id=n.assetId,t.assetId=n.assetId,t.appVersion=n.appVersion,t.currentStoreType=n.storeType,t.storeId=n.storeId,t.assetStoreId=n.storeType,t.targetType=n.targetType,t.requireConsent=n.requireConsent||!1,t.isAddinCommands=!0),t};CommandUI.AddInCommands.K=function(){};CommandUI.AddInCommands.K.prototype={a:null,b:!1};CommandUI.AddInCommands.j=function(){};CommandUI.AddInCommands.j.a=function(n){var t=null;switch(n){case 0:t=OSF.StoreType.OMEX;break;case 1:t=OSF.StoreType.SPCatalog;break;case 2:t=OSF.StoreType.SPApp;break;case 3:t=OSF.StoreType.FileSystem;break;case 4:t=OSF.StoreType.Exchange;break;case 6:t=OSF.StoreType.Registry;break;case 7:t=OSF.StoreType.InMemory;break;case 8:t=OSF.StoreType.UploadFileDevCatalog;break;case 9:t=OSF.StoreType.HardCodedPreinstall;break;case 10:t=OSF.StoreType.PrivateCatalog;break;case 16:t=OSF.StoreType.WopiCatalog}return t};CommandUI.AddInCommands.j.b=function(n){var t=-1;switch(n.toLowerCase()){case"omex":t=0;break;case"spcatalog":t=1;break;case"spapp":t=2;break;case"filesystem":t=3;break;case"exchange":t=4;break;case"registry":t=6;break;case"inmemory":t=7;break;case"uploadfiledevcatalog":t=8;break;case"hardcodedpreinstall":t=9;break;case"excatalog":t=10;break;case"wopicatalog":t=16}return t};CommandUI.AddInCommands.c=function(){};CommandUI.AddInCommands.c.e=function(n){var i=new($$sc.v.$$(String)),e,t,s;if(CommandUI.AddInCommands.c.a)for(var f=CommandUI.AddInCommands.c.a,h=f.length,r=0;r<h;++r)e=f[r],i.b(e);t=null;switch(n){case"Workbook":t=CommandUI.AddInCommands.c.d;break;case"Document":t=CommandUI.AddInCommands.c.b;break;case"Presentation":t=CommandUI.AddInCommands.c.c}if(t)for(var o=t,c=o.length,u=0;u<c;++u)s=o[u],i.b(s);return i};CommandUI.AddInCommands.z=function(n){this.c=n;this.b().Id=this.c};CommandUI.AddInCommands.z.prototype={c:null,i:null,g:null,h:null,d:!1,f:null,e:null,b:function(){return this.i||(this.i={})},a:function(){return this.g||(this.g=new($$sc.v.$$(CommandUI.AddInCommands.t)))},j:function(){return this.h||(this.h=new($$sc.v.$$(CommandUI.AddInCommands.r)))},l:function(){for(var t=new($$sc.v.$$(String)),i=new($$sc.v.$$(String)),r=this.j().$$lge(),u,n,f,e,o;r.$$mn();)u=r.$$cu(),t.b(u.d());for(n=this.a().$$lge();n.$$mn();)f=n.$$cu(),i.b(f.h());return e=this.k("Groups",this.e,i.g()),o=this.k("Scaling",this.f,t.g()),Common.Q.c("Tab",this.b(),o,e)},k:function(n,t,i){var r={};return r.Id=t,Common.Q.c.apply(null,[n,r].concat(i))}};CommandUI.AddInCommands.t=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041811,220,10,"GroupDefinition id should not be null or undefined.");throw Error.create("GroupDefinition id should not be null or undefined");}this.e=n;this.b().Id=this.e};CommandUI.AddInCommands.t.prototype={e:null,f:null,d:null,c:null,g:function(n){return this.f=n,this.b().Template=this.f,n},b:function(){return this.d||(this.d={})},a:function(){return this.c||(this.c=new($$sc.v.$$(CommandUI.AddInCommands.v)))},h:function(){for(var n=new($$sc.v.$$(String)),t=this.a().$$lge(),i,r;t.$$mn();)i=t.$$cu(),n.b(i.c());return r=Common.Q.c.apply(null,["Controls",null].concat(n.g())),Common.Q.c("Group",this.b(),r)}};CommandUI.AddInCommands.r=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041813,220,10,"ScalingDefinition type should not be null or undefined.");throw Error.create("ScalingDefinition type should not be null or undefined");}this.c=n};CommandUI.AddInCommands.r.prototype={c:null,b:null,a:function(){return this.b||(this.b={})},d:function(){return Common.Q.i(this.c,null,this.a())}};CommandUI.AddInCommands.i=function(n,t){if(CommandUI.a.a(n)||CommandUI.a.a(t)){Diag.a.a(9175312,220,10,"ControlDefinition id or type should not be null or undefined.");throw Error.create("ControlDefinition id or type should not be null or undefined");}this.f=t;this.d=n;this.a().Id=this.d};CommandUI.AddInCommands.i.prototype={d:null,f:null,g:null,e:null,a:function(){return this.g||(this.g={})},b:function(){return this.e||(this.e=new($$sc.v.$$(CommandUI.AddInCommands.R)))},c:function(){return Common.Q.i(this.f,this.h(),this.a())},h:function(){var n=null,t,i;if(this.e){for(n=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>'),t=this.e.$$lge();t.$$mn();)i=t.$$cu(),n.append(i.b());n.append("<\/Controls><\/MenuSection><\/Menu>")}return n?n.toString():""}};CommandUI.AddInCommands.x=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175313,220,10,"MenuItemDefinition id should not be null or undefined.");throw Error.create("MenuItemDefinition id should not be null or undefined");}this.c=n;this.a().Id=this.c};CommandUI.AddInCommands.x.prototype={c:null,d:null,a:function(){return this.d||(this.d={})},b:function(){return Common.Q.i("Button",null,this.d)}};CommandUI.AddInCommands.y=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined.");throw Error.create("OfficeMenuDefinition id should not be null or undefined");}this.d=n};CommandUI.AddInCommands.y.prototype={d:null,c:null,b:function(){return this.d},a:function(){return this.c||(this.c=new($$sc.v.$$(CommandUI.AddInCommands.v)))}};CommandUI.AddInCommands.L=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175315,220,10,"The agave key should not be null or undefined.");throw Error.create("The agave key should not be null or undefined");}this.c=n};CommandUI.AddInCommands.L.prototype={c:null,d:null,a:function(){return this.d||(this.d=new($$sc.v.$$(CommandUI.AddInCommands.p)))},b:function(){return this.c}};CommandUI.AddInCommands.k=function(n,t,i){this.a=n;this.b=t;this.c=i};CommandUI.AddInCommands.k.a=function(n){var i=n.b(),t;return i?(t=new Common.AddInDataTransferObject,t.tabs=i.a.g(),t.id=i.b,t.title=i.c,t):null};CommandUI.AddInCommands.k.prototype={a:null,b:null,c:null};CommandUI.AddInCommands.V=function(n,t,i,r,u){if(CommandUI.a.a(n)&&CommandUI.a.a(t)){Diag.a.a(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");throw Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");}this.g=n;this.i=t;this.k=i;this.j=r;this.h=u};CommandUI.AddInCommands.V.prototype={i:null,g:null,k:null,j:null,h:0,a:function(){return this.g},b:function(){return this.i},c:function(){return this.k},d:function(){for(var n=new Sys.StringBuilder,t=this.g.$$lge(),i;t.$$mn();)i=t.$$cu(),n.append(i.l());return this.l(n.toString())},f:function(){return this.j},e:function(){return this.h},l:function(n){var t=new Sys.StringBuilder;return t.append("<Ribbon><Tabs>"),t.append(n),t.append("<\/Tabs><\/Ribbon>"),t.toString()}};CommandUI.AddInCommands.h=function(){this.d=new($$sc.v.$$(CommandUI.AddInCommands.Q))};CommandUI.AddInCommands.h.a=function(n,t,i){var r=CommandUI.AddInCommands.h.b(n);r.length>0&&(CommandUI.AddInCommands.h.c(r,!1),i&&i(t,r))};CommandUI.AddInCommands.h.b=function(n){var e=[],r,t,u,i,f,o;if(n&&n.a()&&n.a().f.length>0)for(r=n.a().$$lge();r.$$mn();)if(t=r.$$cu(),t.a()&&t.a().f.length>0)for(u=t.a().$$lge();u.$$mn();)if(i=u.$$cu(),i.b()&&i.b().f.length>0)for(f=i.b().$$lge();f.$$mn();)o=f.$$cu(),Array.add(e,o.c||"");return e};CommandUI.AddInCommands.h.c=function(n,t){var u,f;if(n.length)for(var r=n,e=r.length,i=0;i<e;++i)u=r[i],f=document.querySelector('[id^="'+u+'"]'),CommandUI.b.i(f,t,!1,!1)};CommandUI.AddInCommands.h.prototype={d:null,b:function(n){var t,i,f,r,u;for(Diag.a.a(17306645,220,50,"Context menu id: {0}",n),t=new($$sc.v.$$(CommandUI.AddInCommands.p)),i=this.d.$$lge();i.$$mn();)for(f=i.$$cu(),r=f.a().$$lge();r.$$mn();)u=r.$$cu(),u.b()===n&&t.b(u);return t},a:function(n){this.d.b(n)},c:function(n){for(var i=this.d.$$lge(),t;i.$$mn();)if(t=i.$$cu(),t.b()===n.b()){this.d.e(t);break}}};CommandUI.AddInCommands.U=function(){};CommandUI.AddInCommands.U.prototype={a:function(n,t){var i=CommandUI.AddInCommands.k.a(n),f,o;if(i){appChrome.addInApi.dispatchActionsToInstallAddIn(i,t);for(var u=i.tabs,e=u.length,r=0;r<e;++r)if(f=u[r],f.autoFocus){o=this;appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(i,function(){});break}}},b:function(n){var t=CommandUI.AddInCommands.k.a(n);t&&appChrome.addInApi.dispatchActionsToRemoveAddIn(t)}};CommandUI.AddInCommands.l=function(){this.c=new CommandUI.ck(root)};CommandUI.AddInCommands.l.b=function(n,t,i){var r=CommandUI.AddInCommands.l.c(n);r.length>0&&(CommandUI.AddInCommands.l.a(r,!1),i&&i(t,r))};CommandUI.AddInCommands.l.c=function(n){var u=[],t,f,e,o,s,h,v,c,i,r,w;if(n)if(t=n.b(),t){if(t.a&&t.a.f.length>0)for(c=t.a.$$lge();c.$$mn();)if(i=c.$$cu(),i.groups&&i.groups.length>0)for(var y=i.groups,b=y.length,l=0;l<b;++l)if(r=y[l],r.controls&&r.controls.length>0)for(var p=r.controls,k=p.length,a=0;a<k;++a)w=p[a],Array.add(u,w.id)}else if(n.a()&&n.a().f.length>0)for(f=n.a().$$lge();f.$$mn();)if(e=f.$$cu(),e.a().f.length>0)for(o=e.a().$$lge();o.$$mn();)if(s=o.$$cu(),s.a().f.length>0)for(h=s.a().$$lge();h.$$mn();)v=h.$$cu(),Array.add(u,v.d||"");return u};CommandUI.AddInCommands.l.a=function(n,t){var u,f;if(n.length)for(var r=n,e=r.length,i=0;i<e;++i)u=r[i],f=document.querySelector('[id^="'+u+'"]'),CommandUI.b.i(f,t,!1,!1)};CommandUI.AddInCommands.l.prototype={c:null,a:function(n,t){var i=n.d();this.c.c(i,n.f(),t)},b:function(n){var t=n.d();this.c.f(t)}};CommandUI.AddInCommands.e=function(){this.b=new Common.App.AppsForOfficeCommon.g(Common.Utils.c.a())};CommandUI.AddInCommands.e.b=function(){return CommandUI.AddInCommands.e.a||(CommandUI.AddInCommands.e.a=new CommandUI.AddInCommands.e),CommandUI.AddInCommands.e.a};CommandUI.AddInCommands.e.prototype={b:null,a:function(n,t){var i=Common.dV.b()+n;Common.Utils.c.a().c(i,t.toString())}};CommandUI.AddInCommands.E=function(n){CommandUI.AddInCommands.E.initializeBase(this);this.a=n};CommandUI.AddInCommands.E.prototype={a:null};CommandUI.AddInCommands.H=function(n,t,i){this.e=new Common.bc;this.a=new CommandUI.AddInCommands.I;this.b=n;this.d=t;this.c=i};CommandUI.AddInCommands.H.prototype={b:null,d:null,c:null,g:function(n){this.e.m("ack4",n)},i:function(n){var t,i;null!==n&&(this.a.a=n.ack1,this.a.d=n.ack0,this.a.f=this.a.e=0,t="ak0"in n?n.ak0:0,this.a.a!==-1&&this.a.d&&(this.a.b=new CommandUI.G,this.a.c=this.d.a(CommandUI.AddInCommands.j.a(this.a.a),this.b),this.a.c?(i=this,this.a.c.getEntitlementsAsync(this.b.a(),!0,t,function(n){i.h(n)})):Diag.a.a(17638145,220,10,"Create AddinDataProvider fails for {0}",this.a.a)))},h:function(n){var r=n,u,t,i,f;if(r&&r.length>0)for(this.a.f=r.length,u=0;u<r.length;u++)t=r[u],t&&(t.targetType===OSF.OsfControlTarget.TaskPane||t.targetType===OSF.OsfControlTarget.Undefined)?(i={},Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.marketplaceId=t.solutionId,i.marketplaceVersion=t.version):(i.marketplaceId=t.assetId,i.marketplaceVersion=t.appVersion),i.storeType=t.storeType,i.storeId=t.storeId,i.targetData=t,f=this,this.b.d(i,function(n,t,i){n?t&&f.a.b.e(i.targetData):Diag.a.a(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(i.targetData.storeType,i.targetData.storeId,i.targetData.assetId,null,null),i.targetData.storeType);f.f()})):this.f();else this.f()},f:function(){var t,i,r,n;if(this.a.e++,this.a.e>=this.a.f){if(this.c.a(this.a.a,!1),t=new($$sc.v.$$(Object)),this.a.b)for(i=this.a.b.getEnumerator();i.moveNext();)r=i.get_current(),t.b(CommandUI.AddInCommands.J.a(r));this.a.b&&this.a.b.a<1&&Common.bG.a("ak4","false",this.a.a);n={ack2:t};n.ack1=this.a.a;n.ack0=this.a.d;this.e.k("ack4",new CommandUI.AddInCommands.E(n),this)}}};CommandUI.AddInCommands.I=function(){};CommandUI.AddInCommands.I.prototype={a:0,d:0,c:null,f:0,e:0,b:null};CommandUI.AddInCommands.G=function(n,t,i,r,u,f,e){this.f=new($$sc.w.$$(DiagUse.c));this.b=n;this.e=t;this.a=i;this.g=r;this.j=u;this.c=f;this.h=e;this.d=Common.a.b().d()};CommandUI.AddInCommands.G.prototype={e:null,a:null,g:null,j:null,c:null,b:0,h:null,d:null,p:function(n,t,i,r,u,f,e){var v=this,h=function(n,t,i,r){u(n,t,i,r);var e=Common.bw.toString(v.b)+t.assetId,f,o,s;(s=v.f.f(e,o={val:f},null),f=o.val,s)&&(f.a(),f=null,v.f.e(e))},a=n,y,b,o,s,k,p,d,c,nt,w,g,l,it;if(this.b&&a)for(Diag.a.a(17326351,220,50,"Addin count {0}.",a.f.length),this.b===4&&(Diag.a.a(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",r)),this.o(a,r),f()),y=a.$$lge();y.$$mn();)if(b=y.$$cu(),o=b,Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(o.solutionId=o.solutionId||o.assetId,o.storeType=o.storeType||o.currentStoreType,o.version=o.version||o.appVersion,Diag.a.a(17638144,220,50,String.format("{0}: Install addin {1}",this.a.a(),Telemetry.PrivacyRules.GetAssetId(o.storeType,o.storeId,o.solutionId,null,null)))):Diag.a.a(540379088,220,50,String.format("{0}: Install addin {1}",this.a.a(),Telemetry.PrivacyRules.GetAssetId(o.currentStoreType,o.storeId,o.assetId,null,null))),this.n(o))if(e&&o.requireConsent)s=this,k=function(n){var u,f,r,o;try{s.d&&(u=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Common.bw.toString(s.b)+n.solutionId:Common.bw.toString(s.b)+n.assetId,f=s.d.a("ComponentAttach",u),s.f.b(u,f));r=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?s.c.a(n.storeType,n.solutionId,0):s.c.a(n.currentStoreType,n.id,0);s.b!==6&&(r&&(s.i(r),r.a.purge(!1)),o=s.e.c(s.k(n,t,i,h)),r&&(Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?s.e.b(n.solutionId,n.storeType):s.e.b(n.assetId,n.currentStoreType)))}catch(e){Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Diag.a.a(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",s.a.a(),Telemetry.PrivacyRules.GetAssetId(n.storeType,n.storeId,n.solutionId,null,null),n.version,n.storeType,n.storeId,e.message)):Diag.a.a(540379089,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",s.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.appVersion,n.currentStoreType,n.storeId,e.message));h(!1,n,null,null)}},e(o,k);else if(Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1))try{this.d&&(p=Common.bw.toString(this.b)+o.solutionId,d=this.d.a("ComponentAttach",p),this.f.b(p,d));c=this.c.a(o.storeType,o.solutionId,0);this.b!==6&&(c&&(this.i(c),c.a.purge(!1)),nt=this.e.c(this.k(o,t,i,h)),c&&this.e.b(o.solutionId,o.storeType))}catch(tt){Diag.a.a(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(o.storeType,o.storeId,o.solutionId,null,null),o.version,o.storeType,o.storeId,tt.message));h(!1,o,null,null)}else try{this.d&&(w=Common.bw.toString(this.b)+o.assetId,g=this.d.a("ComponentAttach",w),this.f.b(w,g));l=this.c.a(o.currentStoreType,o.id,0);this.b!==6&&(l&&(this.i(l),l.a.purge(!1)),it=this.e.c(this.k(o,t,i,h)),l&&this.e.b(o.assetId,o.currentStoreType))}catch(rt){Diag.a.a(540379090,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(o.currentStoreType,o.storeId,o.assetId,null,null),o.appVersion,o.currentStoreType,o.storeId,rt.message));h(!1,o,null,null)}else h(!1,o,null,null)},q:function(n,t,i,r,u,f){var s=this,e=function(n,t,i,r){f(n,t,i,r);var e=Common.bw.toString(s.b)+t.assetId,u,o,h;(h=s.f.f(e,o={val:u},null),u=o.val,h)&&(u.a(),u=null,s.f.e(e))},h,c,o,a,l;if(this.b===6&&n)if(Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(n.solutionId=n.solutionId||n.assetId,n.storeType=n.storeType||n.currentStoreType,n.version=n.version||n.appVersion,Diag.a.a(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.storeType,n.storeId,n.solutionId,null,null)))):Diag.a.a(540379091,220,50,String.format("{0}: Install dynamic ribbon {1}",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null))),this.n(n))try{this.d&&(h=Common.bw.toString(this.b)+n.assetId,c=this.d.a("ComponentAttach",h),this.f.b(h,c));o=this.c.a(n.currentStoreType,n.id,0);o||e(!1,n,null,null);Common.a.b()&&Common.a.b().a().U()?(a=this,l=function(t){e(t,n,i,o.d)},this.m(n,t,r,u,i,l)):(this.m(n,t,r,u,i,null),e(!0,n,i,o.d))}catch(v){Diag.a.a(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.appVersion,n.currentStoreType,n.storeId,v.message));e(!1,n,null,null)}else e(!1,n,null,null)},r:function(n,t,i,r,u,f){if(f)if(f._isAddinCommandsManifest(this.a.a()))try{if(Common.a.b()&&Common.a.b().a().U()){var s=this,e=function(t){r(t,n,f,f.getDefaultDisplayName())};this.l(n,t,i,u,f,e)}else this.l(n,t,i,u,f,null),r(!0,n,f,f.getDefaultDisplayName())}catch(o){Diag.a.a(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.appVersion,n.currentStoreType,n.storeId,o.message));r(!1,n,f,f.getDefaultDisplayName())}else Diag.a.a(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null);else Diag.a.a(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.a.a(),Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null)},k:function(n,t,i,r){var f=this,o=function(u,e){var o;o=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?f.c.a(n.storeType||n.currentStoreType,n.solutionId||n.id,0):f.c.a(n.currentStoreType,n.id,0);o&&f.i(o);f.r(n,t,i,r,u,e)},u={},e=document.createElement("div");return e.setAttribute("visible","false"),Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(u.div=e,u.id=n.solutionId||n.id,u.solutionId=n.solutionId||n.id,u.version=n.version||n.appVersion,u.storeType=n.storeType||n.currentStoreType,u.storeId=n.storeId,u.assetId=n.assetId,u.assetStoreId=n.assetStoreId,u.isvirtualOsfControl=!0,u.virtualOsfControlActivationCallback=o,u.reason=this.b===3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,u.marketplaceID=n.id,u.marketplaceVersion=n.appVersion,u.store=n.storeId):(u.div=e,u.id=n.id,u.marketplaceID=n.id,u.marketplaceVersion=n.appVersion,u.store=n.storeId,u.storeType=n.currentStoreType,u.osfControlType=n.targetType,u.isvirtualOsfControl=!0,u.virtualOsfControlActivationCallback=o,u.reason=this.b===3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened),u},l:function(n,t,i,r,u,f){var e={},p,s,h,c,l;Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(e.solutionId=r.getSolutionId(),e.version=r.getVersion(),e.storeType=r.getStoreType(),e.storeId=r.getStoreId(),e.assetId=r.getSolutionId(),e.assetStoreId=r.getAssetStoreId(),e.targetType=r.getOsfControlType(),e.appVersion=r.getMarketplaceVersion()):(e.storeType=r.getStoreType(),e.storeId=r.getStoreLocator(),e.assetId=r.getMarketplaceID(),e.appVersion=r.getMarketplaceVersion(),e.targetType=r.getOsfControlType());var b=new OfficeExt.Parser.AddinCommandsManifestParser(this.a.a(),this.a.c()),k=b.parseExtensions(e,u,this.h),a=CommandUI.AddInCommands.c.e(this.a.a());if(a&&a.f.length>0){for(var d=t(n),g=i(n),nt=!!Common.a.a&&Common.a.a.a("AddinCommandsMultipleCustomTabsEnabled"),o=new CommandUI.AddInCommands.s(d,null,g),y=a.$$lge();y.$$mn();)p=y.$$cu(),o.commandSurface=p,k.apply(o,this.h,nt);if(OSF.OUtil.checkFlight(14))try{s=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?o.a(n.solutionId||n.id,u.getDefaultDisplayName(),0):o.a(n.id,u.getDefaultDisplayName(),0);h=o.c(null);s&&this.g.a(s,f);h&&this.j.a(h);this.c.i(r,s,h,u.getDefaultDisplayName());Diag.a.a(17326353,220,100,"Add-in name: {0}.",u.getDefaultDisplayName())}catch(v){OfficeExt.DevConsole.log(v);Diag.a.a(539870850,220,10,"Error generating ribbon extensibility. Exception: "+v.message);throw v;}else try{c=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?o.a(n.solutionId||n.id,u.getDefaultDisplayName(),0):o.a(n.id,u.getDefaultDisplayName(),0);l=o.c(null);c&&this.g.a(c,null);l&&this.j.a(l);this.c.i(r,c,l,u.getDefaultDisplayName());Diag.a.a(579376721,220,100,"Add-in name: {0}.",u.getDefaultDisplayName())}catch(w){Diag.a.a(539870851,220,10,"Error generating ribbon extensibility. Exception: "+w.message);throw w;}}},m:function(n,t,i,r,u,f){var e={},h,s;Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(e.solutionId=n.solutionId||n.assetId,e.version=n.version||n.appVersion,e.storeType=n.storeType||n.currentStoreType,e.storeId=n.assetStoreId,e.assetId=n.assetId,e.assetStoreId=n.assetStoreId,e.targetType=n.targetType,e.appVersion=n.appVersion):(e.storeType=n.currentStoreType,e.storeId=n.assetStoreId,e.assetId=n.assetId,e.appVersion=n.appVersion,e.targetType=n.targetType);h=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.a.a(),this.a.c());try{var l=t.getManifest(),a=h.parse(e,l,u,this.h,t.getSharedRuntimeId()),v=i(n),y=r(n),o=new CommandUI.AddInCommands.s(v,null,y);o.commandSurface="PrimaryCommandSurface";a.apply(o,this.h,!0);o.ribbonBuilder.a()&&o.ribbonBuilder.a().f.length>0&&(s=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?o.a(n.solutionId||n.id,t.getManifest().getDefaultDisplayName(),1):o.a(n.id,t.getManifest().getDefaultDisplayName(),1),Common.a.a.d("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.g.a(s,f):s&&this.g.a(s,f),this.c.m(t,s,u,t.getManifest().getDefaultDisplayName()),Diag.a.a(592290767,220,100,"Add-in name: {0}.",t.getManifest().getDefaultDisplayName()))}catch(c){Diag.a.a(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",t.getManifest().getDefaultDisplayName(),c.toString());OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(c)}},i:function(n){n.b&&this.g.b(n.b);n.c&&this.j.c(n.c);this.c.o(n.a.getStoreType(),n.a.getMarketplaceID())},o:function(n,t){for(var s=CommandUI.AddInCommands.j.a(t),e=this.c.c.$$lge(),r,u,f,o,i;e.$$mn();)if(r=e.$$cu(),r.a.getStoreType()===s){for(u=!0,f=n.$$lge();f.$$mn();)if(o=f.$$cu(),i=o,Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(i&&r.f(i.storeType||i.currentStoreType,i.solutionId||i.id)){u=!1;break}}else if(i&&r.f(i.currentStoreType,i.id)){u=!1;break}u&&(this.i(r),r.a.purge(!1))}},n:function(n){return Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(n.solutionId!==n.assetId&&Diag.a.a(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId"),n.id!==n.assetId&&Diag.a.a(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId"),!!n&&!!n.solutionId&&!!n.version&&!!n.storeType&&!!n.storeId):!!n&&!!n.currentStoreType&&!!n.storeId&&!!n.id&&!!n.appVersion}};CommandUI.AddInCommands.a=function(){};CommandUI.AddInCommands.a.j=function(){return CommandUI.AddInCommands.a.c||(CommandUI.AddInCommands.a.c=Common.Utils.a.a().d(Common.Utils.h,null))};CommandUI.AddInCommands.a.d=function(n,t,i,r,u,f){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();CommandUI.AddInCommands.a.a=CommonUI.w.a(t,n,n,u,null);CommandUI.AddInCommands.a.a.e(i);CommandUI.a.b(r)||(CommandUI.AddInCommands.a.a.g(r),CommandUI.AddInCommands.a.a.f(!0));var e=new Sys.UI.Bounds(0,0,Common.p.f(),Common.p.j());CommandUI.AddInCommands.a.a.d(CommandUI.AddInCommands.a.l(e,t,CommandUI.AddInCommands.a.a.c(),f));CommandUI.AddInCommands.a.a.h();CommandUI.AddInCommands.a.j()&&CommandUI.AddInCommands.a.j().b(i.innerText,!0,!1)};CommandUI.AddInCommands.a.e=function(n,t,i,r){Common.UISurfaces.b().then(function(u){var h=null,e,f,c,o,s,l;return CommandUI.AddInCommands.a.b&&(u.removeNotification(CommandUI.AddInCommands.a.b),CommandUI.AddInCommands.a.b=null),c=u.callout((f=new Common.cz,f.target=n,f.title=t,f.content=i,f.showCloseIcon=!0,f.hasDynamicSizing=!0,f.jumpToCalloutTargetButtonEnabled=!0,f.calloutProps=(e=new Common.cP,e.onDismiss=function(){u.removeNotification(h)},e.directionalHint=r!=null?r:null,e),f)),l=(s=new Common.dw,s.expirationOptions=(o=new Common.eJ,o.displayTimeoutSeconds=7,o.onExpire=function(){u.removeNotification(CommandUI.AddInCommands.a.b)},o),s),h=CommandUI.AddInCommands.a.b=u.addNotification(c,l),null},function(n){return Diag.a.a(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",n),null})};CommandUI.AddInCommands.a.g=function(n,t){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();var i=new CommonUI.d;i.bW=!1;i.D(0);i.bg(27,$a.f,CommandUI.a.b(n)?CommandUI.AddInCommands.a.k():n,t)};CommandUI.AddInCommands.a.h=function(n){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();Diag.a.a(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",n.d));var r=CommandUI.a.b(n.f)?CommandUI.AddInCommands.a.k():n.f,t=new CommonUI.d,i=null;n.a?(t.D(1),t.E(1,n.g),t.bi=1):t.D(0);i=function(t){t===1?n.a():n.b&&n.b()};t.bW=!1;n.e===OSF.InfoType.Error?t.bg(n.d,n.c?n.c:$a.f,r,i):n.e===OSF.InfoType.Warning?t.bL(n.c?n.c:$a.u,r,i):t.cc(n.c?n.c:$a.g,r,i)};CommandUI.AddInCommands.a.l=function(n,t,i,r){var u=r?4:0,f=t.x-n.x,e=n.x+n.width-t.x-t.width;return f+t.width/2<=i/2?u=r?5:2:e+t.width/2<=i/2&&(u=r?6:3),u};CommandUI.AddInCommands.a.n=function(n,t,i,r,u){var e,f;if(CommandUI.AddInCommands.a.f()){e=CommandUI.AddInCommands.k.a(r);e&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(e,function(n){n&&CommandUI.AddInCommands.a.e(n,u,i,5)});return}if(!n){Diag.a.a(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.");return}if(!r||!r.a().f.length){Diag.a.a(17326355,220,50,"There is no tab or group added to ribbon !");return}var o=r.a().a(0),s=o.b().Id,h=o.a().a(0).b().Id;n.v(s,!1)&&(f=o.d?n.n(s,h):n.o(s),f&&(f.x+f.width/2>Common.p.f()&&(f=new Sys.UI.Bounds(Common.p.f(),f.y+f.height,0,0)),CommandUI.AddInCommands.a.d(t,f,CommandUI.AddInCommands.a.i(i),u,2,0)))};CommandUI.AddInCommands.a.o=function(n,t,i,r){CommandUI.AddInCommands.a.n(n,t,r.c()?r.c().description:String.format($a.jk,i),r,r.c()?r.c().title:String.format($a.jl,i))};CommandUI.AddInCommands.a.m=function(n,t,i,r){var o,f,e,u;if(CommandUI.AddInCommands.a.f()){o=String.format($a.bl,String.format($a.bk,i,r,$a.bz));CommandUI.AddInCommands.a.e(t,o,$a.h,1);return}var c=Common.g.c(t),s=$a.bl.split("{0}"),h=document.createElement("span");h.innerText=s[0];f=document.createElement("span");f.innerText=String.format($a.bk,i,r,$a.bz);f.className="UIFontBold";e=document.createElement("span");e.innerText=s[1];u=document.createElement("div");Sys.UI.DomElement.addCssClass(u,"ModalCalloutControl");u.appendChild(h);u.appendChild(f);u.appendChild(e);CommandUI.AddInCommands.a.d(n,c,u,$a.h,3,1)};CommandUI.AddInCommands.a.p=function(n,t,i,r){if(CommandUI.AddInCommands.a.f()){CommandUI.AddInCommands.a.e(t,i,r,null);return}var u=Common.g.c(t);CommandUI.AddInCommands.a.d(n,u,CommandUI.AddInCommands.a.i(r),i,3,1)};CommandUI.AddInCommands.a.i=function(n){var t=document.createElement("div");return Sys.UI.DomElement.addCssClass(t,"ModalCalloutControl"),t.innerText=n,t};CommandUI.AddInCommands.a.k=function(){return $a.w+" "+$a.x};CommandUI.AddInCommands.a.f=function(){return Common.a.b().a().g()&&Common.a.b().a().h()};CommandUI.AddInCommands.s=function(n,t,i){this.ribbonBuilder=n;this.eventBuilder=t;this.contextMenuBuilder=i};CommandUI.AddInCommands.s.prototype={commandSurface:null,actionBuilder:null,ribbonBuilder:null,contextMenuBuilder:null,eventBuilder:null,b:null,e:function(n){return new CommandUI.AddInCommands.C(n)},d:function(n,t){return OfficeExt.DefaultControlActionBinder.createActionBuilder(n,t.entitlement,t.manifest)},startApplyAddin:function(n){this.b=n;var t=this.e(n);this.actionBuilder=this.d(t,n)},endApplyAddin:function(){},a:function(n,t,i){return this.ribbonBuilder.b()&&this.ribbonBuilder.b().f.length>0||this.ribbonBuilder.a()&&this.ribbonBuilder.a().f.length>0?new CommandUI.AddInCommands.V(this.ribbonBuilder.b(),this.f(n,t),this.b.startedNode,this.ribbonBuilder.c().g(),i):null},c:function(n){var t,i,r;if(this.contextMenuBuilder.a()&&this.contextMenuBuilder.a().f.length>0){for(n||(n=Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.b.entitlement.solutionId:this.b.entitlement.assetId),t=new CommandUI.AddInCommands.L(n),i=this.contextMenuBuilder.a().$$lge();i.$$mn();)r=i.$$cu(),t.a().b(r);return t}return null},f:function(n,t){return this.ribbonBuilder.a()&&this.ribbonBuilder.a().f.length>0?new CommandUI.AddInCommands.k(this.ribbonBuilder.a(),n,t):null}};CommandUI.AddInCommands.C=function(n){this.a=n.entitlement};CommandUI.AddInCommands.C.prototype={a:null,createActionContext:function(n,t){var i={};return i.ownerAddinInfo=this.a,i.action=t,i}};CommandUI.AddInCommands.X=function(){};CommandUI.AddInCommands.D=function(n){CommandUI.AddInCommands.D.initializeBase(this,[!1,!1,!1,!1]);this.H=this.h;this.D(5);this.f=695;this.e=438;this.d="100%";this.a="408px";this.b="15px";this.c="0";this.g=n};CommandUI.AddInCommands.D.prototype={f:0,e:0,d:null,a:null,b:null,c:null,g:null,h:"AddInCommandsDialog",bb:function(){CommonUI.b.prototype.bb.call(this);this.O.style.width=this.d;this.O.style.height=this.a;this.O.style.marginTop=this.b;this.O.style.padding=this.c},be:function(){CommonUI.b.prototype.be.call(this);this.C.style.width=String.format("{0}px",this.f);this.C.style.height=String.format("{0}px",this.e)},dispose:function(){CommonUI.b.prototype.dispose.call(this);this.g()}};CommandUI.AddInCommands.M=function(n,t,i){this.g=n;this.f=t;this.e=i;this.d=new($$sc.v.$$(CommandUI.AddInCommands.p))};CommandUI.AddInCommands.M.prototype={c:null,b:null,g:null,f:null,e:null,addButton:function(n){Diag.a.a(17085952,220,50,"ContextMenu button actiontype: {0}.",n.actionType);this.b=new CommandUI.AddInCommands.i(this.h(n.id),"Button");this.b.a().LabelText=n.label;this.b.a().Alt=n.label;this.b.a().Image16by16=n.icon["16"];this.j(this.b.a().Id,n.action);this.i(this.b.a());this.c.a().b(this.b);this.b=null},startBuildMenu:function(n){if(CommandUI.a.a(this.c))this.c=new CommandUI.AddInCommands.y(n.id);else{var t=this.h(n.id);this.b=new CommandUI.AddInCommands.i(t,"FlyoutAnchor");this.k(this.b.a(),n);this.b.a().Image16by16=n.icon["16"];this.b.a().Command=798637440}},addMenuItem:function(n){Diag.a.a(17085953,220,50,"ContextMenu menu item actiontype: {0}.",n.actionType);var t=new CommandUI.AddInCommands.x(this.h(n.id));this.k(t.a(),n);n.icon&&(t.a().Image16by16=n.icon["16"]);this.j(t.a().Id,n.action);this.i(t.a());this.b.b().b(t)},endBuildMenu:function(){CommandUI.a.a(this.b)?(this.d.b(this.c),this.c=null):(this.c.a().b(this.b),this.b=null)},d:null,a:function(){return this.d},j:function(n,t){this.e.a(n,t)},i:function(n){this.f.a(n)},h:function(n){return this.g.a(n)},k:function(n,t){n.LabelText=t.label;n.Alt=t.label}};CommandUI.AddInCommands.Y=function(){this.d=new($$sc.v.$$(CommandUI.AddInCommands.p))};CommandUI.AddInCommands.Y.prototype={b:null,c:null,d:null,a:function(){return this.d},addButton:function(){},addMenuItem:function(){},startBuildMenu:function(n){CommandUI.a.a(this.b)?this.b=new CommandUI.AddInCommands.y(n.id):this.c=new CommandUI.AddInCommands.i(n.id,"Button")},endBuildMenu:function(){CommandUI.a.a(this.c)?(this.d.b(this.b),this.b=null):this.c=null}};CommandUI.AddInCommands.N=function(n){this.b=n};CommandUI.AddInCommands.N.prototype={b:null,a:function(n){return this.b+n}};CommandUI.AddInCommands.f=function(){this.f=new Common.bc;this.c=new($$sc.v.$$(CommandUI.AddInCommands.n))};CommandUI.AddInCommands.f.b=function(){return CommandUI.AddInCommands.f.a||(CommandUI.AddInCommands.f.a=new CommandUI.AddInCommands.f),CommandUI.AddInCommands.f.a};CommandUI.AddInCommands.f.prototype={b:null,d:0,g:!1,l:function(n){this.f.m("AddinCommandsLoadingMessageChanged",n)},n:function(n){this.f.n("AddinCommandsLoadingMessageChanged",n)},e:function(n){var t=n;return t!==this.b&&(this.b=t,this.f.k("AddinCommandsLoadingMessageChanged",null,null)),n},p:function(){this.d++;this.b||this.e($a.bD)},h:function(){this.d--;this.d<=0&&(this.g?this.b!==$a.h&&this.e($a.h):this.e(null))},k:function(n,t){this.g=!0;n&&this.e(t?$a.K:$a.h)},j:function(){this.g=!1;this.d<=0?this.e(null):this.e($a.bD)},c:null,a:function(n,t,i){for(var u=this.c.$$lge(),r;u.$$mn();)if(r=u.$$cu(),r.f(n,t)){if(r.b&&r.b.e()!==i)continue;return r}return null},i:function(n,t,i,r){var u=new CommandUI.AddInCommands.n;u.a=n;u.b=t;u.c=i;u.d=r;this.c.b(u)},m:function(n,t,i,r){var u=new CommandUI.AddInCommands.n;u.a=n;u.b=t;u.c=null;u.e=i;u.d=r;this.c.b(u)},o:function(n,t){for(var r=0,u=this.c.$$lge(),i;u.$$mn();)i=u.$$cu(),i.a.getStoreType()===n&&i.a.getMarketplaceID()===t?this.c.i(r):r++}};CommandUI.AddInCommands.b=function(n,t,i,r){this.h=n;Common.a.a.a("AddInCommandsMissingTabIsEnabled")?(this.m=i.g(),this.k=i.e(),this.i=i.d()):(this.m=i.f(),this.k=null,this.i=null);this.j=t;this.l=r};CommandUI.AddInCommands.b.prototype={h:null,m:null,j:null,k:null,i:null,l:!1,b:function(n){var t=this.h+this.j+n;return this.l?(t in CommandUI.AddInCommands.b.a||(CommandUI.AddInCommands.b.a[t]="AddinControl"+CommandUI.AddInCommands.b.c++),CommandUI.AddInCommands.b.a[t]):t},a:function(n){var t,i,r;if(this.l){t=CommandUI.AddInCommands.b.a;for(i in t)if(r={key:i,value:t[i]},n===r.value)return r.key.substr(this.h.length+this.j.length)}return n},c:function(n){var t=this.h+this.j+n;return this.l?(t in CommandUI.AddInCommands.b.b||(CommandUI.AddInCommands.b.b[t]="AddinTab"+CommandUI.AddInCommands.b.d++),CommandUI.AddInCommands.b.b[t]):t},f:function(n){return n.toLowerCase()in this.m?(Diag.a.a(17306646,220,50,"Tab id: {0}.",n.toLowerCase()),this.h+this.m[n.toLowerCase()]):null},g:function(){var n,r;if(!this.k)return null;n=[];for(var i=this.k,u=i.length,t=0;t<u;++t)r=i[t],n.push(this.h+r);return n},e:function(n){var t=this.n(n);return null===t?null:t[1]},d:function(n){var t=this.n(n);return null===t?null:t[2]},n:function(n){if(this.i&&n.toLowerCase()in this.i){Diag.a.a(21017039,220,50,"Get attributes for Tab id: {0}.",n.toLowerCase());return this.i[n.toLowerCase()]}return null}};CommandUI.AddInCommands.P=function(n){this.c=n};CommandUI.AddInCommands.P.prototype={c:null,b:function(){return this.c},a:function(n){n.Command=this.c}};CommandUI.AddInCommands.O=function(){};CommandUI.AddInCommands.O.prototype={a:function(n,t){OfficeExt.DefaultControlActionBinder.bindAction(n,t)}};CommandUI.AddInCommands.T=function(n,t,i,r,u,f){this.l=new($$sc.v.$$(Common.AddInTab));this.h=n;this.k=t;this.g=i;this.p=r;this.o=u;this.i=f};CommandUI.AddInCommands.T.prototype={e:null,d:null,f:null,p:null,o:null,i:null,h:null,c:function(){return this.h},a:function(){return this.l},b:function(){return null},k:null,g:null,startBuildTab:function(n){var i=n.isOfficeTab?n.id:this.h.c(n.id),r=n.isOfficeTab?null:n.label,t;this.e=(t=new Common.AddInTab,t.id=i,t.title=r,t.isOfficeTab=n.isOfficeTab,t.visible=n.visible,t.groups=[],t.tabType=n.tabType,t.insertBefore=n.insertBefore,t.insertAfter=n.insertAfter,t.autoFocus=n.autoFocus,t)},startBuildGroup:function(n){var i=this.j(n.id),t;this.d=(t=new Common.AddInGroup,t.id=i,t.title=n.label,t.controls=[],t.groupType=0,t)},addNativeGroup:function(n){var t;this.d=(t=new Common.AddInGroup,t.id=n.id,t.title=n.label,t.controls=[],t.groupType=1,t);this.e.groups.push(this.d)},addButton:function(n){var i=this.j(n.id),t,r;i&&(this.q(i,n.action),Diag.a.a(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",n.actionType),r=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.n(n),t.enabled=n.enabled,t.controlType=0,t.attributes=this.m(),t),this.i.e(new Common.b(i,this.g.b().toString())),this.d.controls.push(r))},addNativeControl:function(n){if(n.id){Diag.a.a(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",n.actionType);var t,i=(t=new Common.AddInControl,t.id=n.id,t.title="",t.iconLocation="",t.enabled=n.enabled,t.controlType=2,t.attributes=this.m(),t);this.d.controls.push(i)}},startBuildMenu:function(n){var i=this.j(n.id),t;i&&(this.f=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.n(n),t.controlType=1,t.attributes={},t.menuItems=[],t))},addMenuItem:function(n){var i=this.j(n.id),t,r;i&&(this.q(i,n.action),Diag.a.a(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",n.actionType),r=(t=new Common.AddInMenuItem,t.id=i,t.title=n.label,t.iconLocation=this.n(n),t.enabled=n.enabled,t.attributes=this.m(),t),this.i.e(new Common.b(i,this.g.b().toString())),this.f.menuItems.push(r))},endBuildMenu:function(){CommandUI.a.a(this.f.id)||this.d.controls.push(this.f);this.f=null},endBuildGroup:function(){CommandUI.a.a(this.d.id)||this.e.groups.push(this.d);this.d=null},endBuildTab:function(){CommandUI.a.a(this.e.id)||this.l.b(this.e);this.e=null},m:function(){var n={};return this.r(n),n},n:function(n){return n.icon["80"]?n.icon["80"]:n.icon["32"]},r:function(n){this.g.a(n)},j:function(n){return this.h.b(n)},q:function(n,t){this.k.a(n,t)}};CommandUI.AddInCommands.d=function(){};CommandUI.AddInCommands.d.b=function(){return CommandUI.AddInCommands.d.a||(CommandUI.AddInCommands.d.a=new CommandUI.AddInCommands.d),CommandUI.AddInCommands.d.a};CommandUI.AddInCommands.d.prototype={a:function(n,t){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(n,t.a())}};CommandUI.AddInCommands.g=function(n){this.e=n};CommandUI.AddInCommands.g.prototype={e:null,a:function(){return this.e},c:function(n){return this.e.insertOsfControl(n)},d:function(n,t){this.e.isAddinCommandsAsync(n,t)},b:function(n,t){this.e.ownerAddinControlRecreated(n,t)}};CommandUI.AddInCommands.bu=function(){this.l=new($$sc.v.$$(CommandUI.AddInCommands.z));this.h=namingProvider;this.t=actionBinder};CommandUI.AddInCommands.bu.prototype={d:null,e:null,a:function(){return null},h:null,c:function(){return this.h},t:null,b:function(){return this.l},startBuildTab:function(n){var t=n.isOfficeTab?this.h.f(n.id):this.h.c(n.id);this.d=new CommandUI.AddInCommands.z(t)},startBuildGroup:function(n){var t=this.j(n.id);this.e=new CommandUI.AddInCommands.t(t)},addButton:function(n){var t=this.j(n.id);this.u(t,n.action)},startBuildMenu:function(){},addMenuItem:function(n){var t=this.j(n.id);this.u(t,n.action)},endBuildMenu:function(){},endBuildGroup:function(){this.d.a().b(this.e);this.e=null},endBuildTab:function(){CommandUI.a.a(this.d.c)||this.l.b(this.d);this.d=null},u:function(n,t){this.t.a(n,t)},j:function(n){return this.h.b(n)}};CommandUI.AddInCommands.bt=function(){CommandUI.AddInCommands.bt.initializeBase(this,[namingProvider,actionBinder]);this.m=commandBinder;this.n=resolver;this.p=assetId;this.o=addinCommandsErrorManager};CommandUI.AddInCommands.bt.prototype={i:null,f:null,g:null,p:null,o:null,n:null,m:null,startBuildTab:function(n){var t,i,r;CommandUI.AddInCommands.bu.prototype.startBuildTab.call(this,n);this.d.d=n.isOfficeTab;this.d.d?this.d.c&&(t=this.h.e(n.id),t&&(this.d.b().Title=t),i=this.h.d(n.id),i&&(this.d.b().Keytip=i)):this.d.b().Title=this.k(n.label);r=this.d.c;this.d.f=r+".Scaling";this.d.e=r+".Groups"},startBuildGroup:function(n){CommandUI.AddInCommands.bu.prototype.startBuildGroup.call(this,n);this.e.b().Title=this.k(n.label)},addButton:function(n){CommandUI.AddInCommands.bu.prototype.addButton.call(this,n);Diag.a.a(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",n.actionType);var t=this.s(n,"Button");this.q(t.a());t.a().Enabled=n.enabled;this.e.a().b(t)},startBuildMenu:function(n){this.i=this.s(n,"FlyoutAnchor")},addMenuItem:function(n){CommandUI.AddInCommands.bu.prototype.addMenuItem.call(this,n);Diag.a.a(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",n.actionType);var i=this.j(n.id),t=new CommandUI.AddInCommands.x(i);this.r(t.a(),n);this.q(t.a());t.a().Enabled=n.enabled;this.i.b().b(t)},endBuildMenu:function(){this.e.a().b(this.i);this.i=null},endBuildGroup:function(){this.v();this.d.j().b(this.f);this.g&&(this.d.j().b(this.g),this.g=null);this.f=null;CommandUI.AddInCommands.bu.prototype.endBuildGroup.call(this)},q:function(n){this.m.a(n)},s:function(n,t){var r=this.j(n.id),i=new CommandUI.AddInCommands.i(r,t);return this.r(i.a(),n),i},r:function(n,t){n.LabelText=this.k(t.label);n.Alt=this.k(t.label);n.Image16by16=t.icon["16"];n.Image32by32=t.icon["32"]},v:function(){var i=this.n.a(this.e),n,t;this.e.g(i.b());n=this.e.a().f.length;Diag.a.a(17085956,220,50,"Control count: {0}.",n);t=this.e.b().Id;this.f=new CommandUI.AddInCommands.r("MaxSize");this.f.a().Id=t+".Scaling.MaxSize";this.f.a().GroupId=this.e.b().Id;n>2&&(this.g=new CommandUI.AddInCommands.r("Scale"),this.g.a().Id=t+".Scaling.Scale",this.g.a().GroupId=this.e.b().Id);this.w(n,i)},w:function(n,t){var u=1,i,r;switch(n){case 1:case 2:this.f.a().Size="Large";break;case 3:this.f.a().Size="Large";this.g.a().Size="Medium";break;case 4:this.f.a().Size="MediumTwoRow";this.g.a().Size="SmallTwoRow";break;case 5:case 6:this.f.a().Size="Medium";this.g.a().Size="Small";break;default:Diag.a.a(9041819,220,10,"Addin commands does not support {0} controls.",n);this.o.setErrorMessageForAddin(this.p,$a.dV);throw Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",n));}for(i=this.e.a().$$lge();i.$$mn();)r=i.$$cu(),r.a().TemplateAlias=t.a(r,u),u+=n!==3?1:2},k:function(n){return n?(n=Common.d.k(n,"&","&amp;"),n=Common.d.k(n,"'","&apos;"),n=Common.d.k(n,'"',"&quot;"),n=Common.d.k(n,">","&gt;"),Common.d.k(n,"<","&lt;")):null}};CommandUI.AddInCommands.A=function(n,t){this.e=n;this.c=new CommandUI.AddInCommands.O;this.d=new CommandUI.AddInCommands.P(t)};CommandUI.AddInCommands.A.prototype={e:null,c:null,d:null,a:function(n){var t=new CommandUI.AddInCommands.N(n);return new CommandUI.AddInCommands.M(t,this.d,this.c)},b:function(n,t,i,r){var u=new CommandUI.AddInCommands.b(this.e,n,i,!0);return new CommandUI.AddInCommands.T(u,this.c,this.d,n,t,r)}};CommandUI.AddInCommands.S.registerClass("CommandUI.AddInCommands.S",Sys.EventArgs);CommandUI.AddInCommands.q.registerClass("CommandUI.AddInCommands.q");CommandUI.AddInCommands.W.registerClass("CommandUI.AddInCommands.W",null,CommandUI.AddInCommands.bl);CommandUI.AddInCommands.m.registerClass("CommandUI.AddInCommands.m");CommandUI.AddInCommands.n.registerClass("CommandUI.AddInCommands.n");CommandUI.AddInCommands.AddinCommandsUILessDialog.registerClass("CommandUI.AddInCommands.AddinCommandsUILessDialog",CommonUI.b);CommandUI.AddInCommands.z.registerClass("CommandUI.AddInCommands.z");CommandUI.AddInCommands.t.registerClass("CommandUI.AddInCommands.t");CommandUI.AddInCommands.r.registerClass("CommandUI.AddInCommands.r");CommandUI.AddInCommands.k.registerClass("CommandUI.AddInCommands.k");CommandUI.AddInCommands.E.registerClass("CommandUI.AddInCommands.E",Sys.EventArgs);CommandUI.AddInCommands.H.registerClass("CommandUI.AddInCommands.H");CommandUI.AddInCommands.X.registerClass("CommandUI.AddInCommands.X");CommandUI.AddInCommands.D.registerClass("CommandUI.AddInCommands.D",CommonUI.b);CommandUI.AddInCommands.f.registerClass("CommandUI.AddInCommands.f");CommandUI.AddInCommands.bu.registerClass("CommandUI.AddInCommands.bu");CommandUI.AddInCommands.bt.registerClass("CommandUI.AddInCommands.bt",CommandUI.AddInCommands.bu);CommandUI.AddInCommands.c.a=["PrimaryCommandSurface","ContextMenu"];CommandUI.AddInCommands.c.d=null;CommandUI.AddInCommands.c.b=null;CommandUI.AddInCommands.c.c=null;CommandUI.AddInCommands.e.a=null;CommandUI.AddInCommands.a.a=null;CommandUI.AddInCommands.a.b=null;CommandUI.AddInCommands.a.c=null;CommandUI.AddInCommands.f.a=null;CommandUI.AddInCommands.b.a={};CommandUI.AddInCommands.b.b={};CommandUI.AddInCommands.b.d=0;CommandUI.AddInCommands.b.c=0;CommandUI.AddInCommands.d.a=null;Type.registerNamespace("_Ewa");_Ewa.wj=function(){};_Ewa.wj.a=function(n,t){var u=!1,i,r,f;return n&&(i=t.osfControl,r=i.getManifest(),r&&(f=r.getSharedRuntimeForCustomFunctions("Workbook"),f&&!i.getIsUpgrading()&&(u=!0))),u};_Ewa.CustomFunctionsInstaller=function(n,t,i){this.g={};this.e=n;this.h=t;this.F().e();this.i=i;this.i.b()&&(this.j=!0,this.i.d("CustomFunctionCache","CustomFunction"))};_Ewa.CustomFunctionsInstaller.l=function(n){try{return $$sc.a.a(String,localStorage.getItem(n))}catch(t){return Diag.a.a(37060758,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",_Ewa.f.a(t.message)?"Unknown":t.message),$$sc.a.a(String,null)}};_Ewa.CustomFunctionsInstaller.e=function(n,t){try{return localStorage.setItem(n,t),$$sc.a.a(Boolean,!0)}catch(i){return Diag.a.a(37060759,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",_Ewa.f.a(i.message)?"Unknown":i.message),$$sc.a.a(Boolean,!1)}};_Ewa.CustomFunctionsInstaller.p=function(n){try{return localStorage.removeItem(n),$$sc.a.a(Boolean,!0)}catch(t){return Diag.a.a(39965665,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",_Ewa.f.a(t.message)?"Unknown":t.message),$$sc.a.a(Boolean,!1)}};_Ewa.CustomFunctionsInstaller.m=function(n){return _Ewa.f.b(n,"registry",!0)||_Ewa.f.b(n,"uploadfiledevcatalog",!0)||Common.a.bw||Common.a.M};_Ewa.CustomFunctionsInstaller.o=function(n){if(!n||!n.length)return!1;try{JSON.parse(n)}catch(t){return!1}return!0};_Ewa.CustomFunctionsInstaller.prototype={e:null,h:null,i:null,j:!1,f:function(){return this.h.H()},a:function(n,t,i,r){var e,u,f;if(!_Ewa.f.a(r.invariantNamespace))for(e=0;e<r.invariantNamespace.length;++e)if(u=r.invariantNamespace.charAt(e),u!=="."&&u!=="_"&&u<"a"&&"z"<u&&u<"A"&&"Z"<u&&u<"0"&&"9"<u){Diag.a.a(39375492,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",u,e);throw Error.create("InvariantNamespace validation failed");}return f=this,_Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.E(i,r.manifest),function(){return _Ewa.cg.cwrtcwithfunc(Object,Boolean,f.o(n),function(u){var e=u.a();return e&&e.isDynamicMetadata?f.p(n,t,e,!1,!1,!1):_Ewa.cg.cwrtcwithfunc(String,Boolean,f.M(n,t,r),function(u){var o;return e=(o=new _Ewa.CustomFunctionsInstaller.n,o.addinId=i,o.locale=r.locale,o.addinInvariantNamespace=r.invariantNamespace,o.addinNamespace=r.namespace,o.addinTitle=r.title,o.isXllCompatible=r.isXllCompatible,o.metadataContent=JSON.stringify(JSON.parse(u.a())),o),f.p(n,t,e,!1,_Ewa.CustomFunctionsInstaller.m(r.osfControl.getStoreType()),_Ewa.wj.a(f.e,r))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")},b:function(n,t,i,r){if(!_Ewa.CustomFunctionsInstaller.o(i)){Diag.a.a(39965660,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON.");throw Error.create("Invalid Metadata JSON");}var u=this;return _Ewa.cg.cwrtcwithfunc(Object,Boolean,this.o(n),function(f){var e=f.a();if(!e&&(e=_Ewa.y.a(u.f(),n,null),!e)){Diag.a.a(42541837,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(t,null,n,null,null)));throw Error.create("Customfunctions dynamic registration failed");}return e.metadataContent=JSON.stringify(JSON.parse(i)),e.isDynamicMetadata=!0,u.p(n,t,e,!0,!0,r)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")},d:function(n,t){this.h.d();var i,u=(i=new _Ewa.CustomFunctionsInstaller.q,i.solutionId=n,i),f=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(t,null,n,null,null)),r=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.q(n),function(){return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,r.r(n),function(){return r.J(r.h,n,t,u)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},f)},M:function(n,t,i){var r=new($$sc.D.$$(String)),u=this,f=this;return OSF.OUtil.xhrGet(i.metadataUrl,function(n){n?r.a(n):r.SX(Error.create("Invalid manifest"))},function(i){Diag.a.a(36721665,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(t,null,n,null,null),i);r.SX(Error.create("Failed to download manifest"))}),r.b},F:function(){var n=this;return _Ewa.cg.cwrtcwithfunc(Array,Boolean,this.k(),function(t){var i=t.a(),f,r,u,e;if(!i.length)return $$sc.a.a(Boolean,!0);for(Diag.a.a(37631833,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted."),f=new($$sc.v.$$($$sc.a)),r=[],u=0;u<i.length;u++)e=$$as(String,i[u]),f.b(_Ewa.cg.cwrtcwithresult(Object,Boolean,n.o(e),function(t){var i=t.a(),u;return i&&(u=_Ewa.y.a(n.g,i.addinId,null),u&&u===i.metadataContent||(n.g[i.addinId]=i.metadataContent,n.f()[e]=i,Array.add(r,i))),!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return _Ewa.cg.cwrtcfortaskwithfunc(Boolean,$$sc.a.WAE(f),function(){if(r.length){var t,u=(t=new _Ewa.CustomFunctionsInstaller.g,t.registrationInfos=r,t);return n.t(n.h,i,u)}return Diag.a.a(41211920,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),$$sc.a.a(Boolean,!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")},c:function(){var i=new($$sc.D.$$(Boolean)),e=new($$sc.v.$$($$sc.a)),r=[],n=[],f=this,t,u;return(Array.forEach(Object.keys(this.f()),function(t){var i=$$as(String,t),u=_Ewa.y.a(f.f(),i,null);Array.add(r,u);Array.add(n,i)}),!n.length)?(i.a(!0),i.b):(u=(t=new _Ewa.CustomFunctionsInstaller.g,t.registrationInfos=r,t),this.t(this.h,n,u))},k:function(){var n=this;return _Ewa.cg.cwrtcwithresult(String,Array,this.m(_Ewa.er.c()),function(n){var t=n.a();return $$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(!t||!t.length?"[]":t))},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")},A:function(n){return this.s(_Ewa.er.c(),Sys.Serialization.JavaScriptSerializer.serialize(n))},o:function(n){var t=this;return _Ewa.cg.cwrtcwithfunc(String,Object,this.m(_Ewa.er.b(n)),function(n){var t=_Ewa.f.a(n.a())?"":n.a();return t.length>0?$$sc.a.a(Object,Sys.Serialization.JavaScriptSerializer.deserialize(t,!0)):$$sc.a.a(Object,null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")},L:function(n,t){var i=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.u(n),function(){return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,i.s(_Ewa.er.b(n),Sys.Serialization.JavaScriptSerializer.serialize(t)),function(){return _Ewa.CustomFunctionsInstaller.e("HasCustomFunctionsCache","true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")},q:function(n){var t=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.w(n),function(){return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,t.x(_Ewa.er.b(n)),function(){return _Ewa.cg.cwrtcwithfunc(Array,Boolean,t.k(),function(n){var t=n.a();return t.length?$$sc.a.a(Boolean,!0):_Ewa.CustomFunctionsInstaller.e("HasCustomFunctionsCache","false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")},v:function(n){return this.m(_Ewa.er.a(n))},z:function(n,t){var i=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.u(n),function(){return i.s(_Ewa.er.a(n),t)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")},r:function(n){var t=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.w(n),function(){return t.x(_Ewa.er.a(n))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")},u:function(n){var t=this;return _Ewa.cg.cwrtcwithfunc(Array,Boolean,this.k(),function(i){var r=i.a(),u=n.toLowerCase();return Array.contains(r,u)?$$sc.a.a(Boolean,!0):(r.push(u),t.A(r))},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")},w:function(n){var t=this;return _Ewa.cg.cwrtcwithfunc(Array,Boolean,this.k(),function(i){var r=i.a(),u=n.toLowerCase();return Array.contains(r,u)?(r.splice(Array.indexOf(r,u),1),t.A(r)):$$sc.a.a(Boolean,!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")},E:function(n,t){var i,r;return _Ewa.a.a("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")?(i=new OSF.AddinIdInfo(n),i.needToRestoreManifest()?this.z(i.getSolutionId(),t):$$sc.a.a(Boolean,!0)):(r=new _Ewa.CustomFunctionsInstaller.f(n),r.d()?this.z(r.a,t):$$sc.a.a(Boolean,!0))},I:function(n){var t,r,i,u;return _Ewa.a.a("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")?(t=new OSF.AddinIdInfo(n),t.needToRestoreManifest()?(r=this,_Ewa.cg.cwrtcwithresult(String,Boolean,this.v(t.getSolutionId()),function(n){var i=n.a();return!i||!i.length||OSF.OsfManifestManager.cacheManifestFromXml(t.getSolutionId(),t.getSolutionVersion(),i,r.e.e().UICultureTag),!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed")):$$sc.a.a(Boolean,!0)):(i=new _Ewa.CustomFunctionsInstaller.f(n),i.d()?(u=this,_Ewa.cg.cwrtcwithresult(String,Boolean,this.v(i.a),function(n){var t=n.a();return!t||!t.length||OSF.OsfManifestManager.cacheManifestFromXml(i.a,i.b,t,u.e.e().UICultureTag),!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed")):$$sc.a.a(Boolean,!0))},x:function(n){return this.j?this.i.e(n):_Ewa.CustomFunctionsInstaller.p(n)},s:function(n,t){return this.j?this.i.c(new _Ewa.lK(n,t)):_Ewa.CustomFunctionsInstaller.e(n,t)},m:function(n){return this.j?this.i.a(n):_Ewa.CustomFunctionsInstaller.l(n)},p:function(n,t,i,r,u,f){var e=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(t,null,n,null,null)),o=this;return _Ewa.g.g(Boolean,_Ewa.cg.cwrtcwithresult(Boolean,$$sc.p.$$(Boolean),this.G(this.h,n,t,i,!1,r,f),function(){return u?o.L(n,i):$$sc.a.a(Boolean,!0)},e))},G:function(n,t,i,r,u,f,e){var o,s;return!f&&(o=_Ewa.y.a(this.g,r.addinId,null),o&&o===r.metadataContent)?$$sc.a.a(Boolean,!0):(this.g[r.addinId]=r.metadataContent,this.f()[t]=r,e||n.g(t),n.d(),s=this,_Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.H(n,t,i,r),function(){return s.n(r.addinId,u)},"Failed to register functions for customfunction addin"))},H:function(n,t,i,r){var f=new($$sc.D.$$(Boolean)),u=this,o=function(n){_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.d,t);var i=n.Result;i&&i.ResponseStatusCode===204?f.a(!0):(delete u.g[r.addinId],delete u.f()[t],_Ewa.cg.cwrtcwithaction(Boolean,u.q(t),function(){_Ewa.cg.cwrtcwithaction(Boolean,u.r(t),function(){u.y()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",t,i?i.ResponseStatusCode.toString():"Unknown")),f.a(!1))},e=this,s=function(n){var u=_Ewa.X.a(n.b);Diag.a.a(36983963,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(i,null,t,null,null),_Ewa.i.a(u,","));_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.c,t);delete e.g[r.addinId];delete e.f()[t];f.a(!1)},h=this.C(r);return this.l(o,s,h,f,!0)},t:function(n,t,i){var u=new($$sc.D.$$(Boolean)),e=_Ewa.q.a().b().m,c=this;Array.forEach(t,function(t){var i=$$as(String,t);n.s(i)});n.d();var r=this,o=function(n){var f,l,a;_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.d,Sys.Serialization.JavaScriptSerializer.serialize(t));var s=n.Result,o=!0,v=Sys.Serialization.JavaScriptSerializer.deserialize(s.ResponseBody.toString()),h=$$as(Array,v.value),c=new($$sc.v.$$($$sc.a));for(f=0;f<h.length;f++)l=h[f],l||(o=!1,a=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",s.ResponseStatusCode),c.b(_Ewa.cg.cwrtcwithfunc(Boolean,Boolean,r.q(t[f]),function(){return delete r.g[i.registrationInfos[f].addinId],delete r.f()[t[f]],r.r(t[f])},a)));_Ewa.cg.cwrtcfortaskwithaction($$sc.a.WAE(c),function(){_Ewa.cg.cwrtcwithaction(Boolean,r.n("",!1),function(){var n=_Ewa.q.a().b().m;Diag.a.a(42541838,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",n-e);o?u.a(o):_Ewa.cg.cwrtcfortaskwithaction(r.y(),function(){u.a(o)},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},f=this,s=function(n){var o=_Ewa.X.a(n.b),r,e;for(Diag.a.a(40185999,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",_Ewa.i.a(o,",")),_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.c,Sys.Serialization.JavaScriptSerializer.serialize(t)),r=0;r<i.registrationInfos.length;r++)e=i.registrationInfos[r],delete f.g[e.addinId],delete f.f()[t[r]];u.a(!1)},h=this.B(i);return this.l(o,s,h,u,!0)},J:function(n,t,i,r){var u=this;return _Ewa.cg.cwrtcwithfunc(Boolean,Boolean,this.K(n,t,i,r),function(){return u.n(r.solutionId,!1)},"Failed to unregister functions for customfunction addin")},K:function(n,t,i,r){var u=new($$sc.D.$$(Boolean)),f;n.g(t);f=_Ewa.y.a(this.f(),t,null);f&&delete this.g[f.addinId];delete this.f()[t];var h=this,e=function(){_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.j,t);u.a(!0)},c=this,o=function(n){var r=_Ewa.X.a(n.b);Diag.a.a(40186001,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(i,i,t,null,null),_Ewa.i.a(r,","));_Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.i,t);u.a(!1)},s=this.D(r);return this.l(e,o,s,u,!1)},l:function(n,t,i,r,u){var e=this.e.f(),f=this.e.c(),o=null,s=null,h=null,y=this,c=function(){var a=e.h()||f.a().e()>0||f.b().e()>0;if(a)return!1;o&&e.e(o);s&&f.e(s);h&&f.h(h);var c=i.request,l=function(r,e,o){return _Ewa.a.b(262)&&_Ewa.CustomFunctionsInstaller.a.a(u?_Ewa.CustomFunctionsInstaller.h:_Ewa.CustomFunctionsInstaller.k,c.RequestBody),_Ewa.k.a(f.a(),"ExecuteRichApiRequest",i,_Ewa.n.a(r,n),_Ewa.n.b(e,t),o,null,0,null,null)},r=0;return _Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?c.RequestFlags&1&&(c.RequestFlags&256)!=256||(r=16):r=(c.RequestFlags&1)?0:16,_Ewa.a.d()?(r|=64,e.b(new _Ewa.v(507,0,l,r,null))):e.b(new _Ewa.ba(507,0,l,r,null)),!0},l,a,v;return c()||(l=this,o=function(){c()},a=this,s=function(){c()},v=this,h=function(){c()},e.d(o),f.d(s),f.g(h)),r.b},C:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="RegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,_Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.e.c().a().a(1,null),i.request=t,i},B:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="BatchRegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,_Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.e.c().a().a(1,null),i.request=t,i},D:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="UnregisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,_Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.e.c().a().a(1,null),i.request=t,i},n:function(n,t){var i=_Ewa.l.b(_Ewa.eY,this.e.a(),153,this.e.g(),1,null),r=this;return _Ewa.cg.cwrtcwithfuncwithcancellationtokenandtaskscheduler(_Ewa.eY,Boolean,i,function(){return i.a().e(!1),!n||!n.length||!t?$$sc.a.a(Boolean,!0):r.I(n)},this.e.g(),_Ewa.eD.b(),"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")},y:function(){var n=new _Ewa.L(1949669462,0,this.e.p(),0,null);return this.e.i().a(n,null,null)}};_Ewa.CustomFunctionsInstaller.g=function(){};_Ewa.CustomFunctionsInstaller.n=function(){};_Ewa.CustomFunctionsInstaller.q=function(){};_Ewa.CustomFunctionsInstaller.f=function(n){var t=n.split("|"),i=t[0];this.a=t[1];this.b=t[2];this.c=t[3]};_Ewa.CustomFunctionsInstaller.f.prototype={c:null,a:null,b:null,d:function(){return this.c===OSF.StoreTypeEnum.Registry.toString()}};_Ewa.CustomFunctionsInstaller.b=function(n,t){this.a=n;this.b=t};_Ewa.CustomFunctionsInstaller.b.prototype={a:0,b:null};_Ewa.CustomFunctionsInstaller.a=function(){};_Ewa.CustomFunctionsInstaller.a.a=function(n,t){_Ewa.cg.cwrtcwithresult(String,Boolean,_Ewa.CustomFunctionsInstaller.l("CustomFunctionsRuntimeLogging"),function(i){var u=i.a(),r;if(u&&window.console){r=_Ewa.CustomFunctionsInstaller.a.b(n.a)+" "+n.b+t;switch(n.a){case 2:window.console.log&&window.console.log(r);break;case 0:window.console.info&&window.console.info(r);break;case 1:window.console.error&&window.console.error(r)}}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")};_Ewa.CustomFunctionsInstaller.a.b=function(n){switch(n){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};_Ewa.CustomFunctionsLegacyInstaller=function(n){this.f={};this.e=n;this.n().e()};_Ewa.CustomFunctionsLegacyInstaller.g=function(){return $$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(_Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.er.c())||"[]"))||[]};_Ewa.CustomFunctionsLegacyInstaller.s=function(n){_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.er.c(),Sys.Serialization.JavaScriptSerializer.serialize(n))};_Ewa.CustomFunctionsLegacyInstaller.f=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.er.b(n))||"";return t.length>0?Sys.Serialization.JavaScriptSerializer.deserialize(t,!0):null};_Ewa.CustomFunctionsLegacyInstaller.z=function(n,t){_Ewa.CustomFunctionsLegacyInstaller.p(n);_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.er.b(n),Sys.Serialization.JavaScriptSerializer.serialize(t))};_Ewa.CustomFunctionsLegacyInstaller.h=function(n){_Ewa.CustomFunctionsLegacyInstaller.q(n);_Ewa.CustomFunctionsLegacyInstaller.r(_Ewa.er.b(n))};_Ewa.CustomFunctionsLegacyInstaller.x=function(n){return _Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.er.a(n))};_Ewa.CustomFunctionsLegacyInstaller.A=function(n,t){_Ewa.CustomFunctionsLegacyInstaller.p(n);_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.er.a(n),t)};_Ewa.CustomFunctionsLegacyInstaller.i=function(n){_Ewa.CustomFunctionsLegacyInstaller.q(n);_Ewa.CustomFunctionsLegacyInstaller.r(_Ewa.er.a(n))};_Ewa.CustomFunctionsLegacyInstaller.p=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.g(),i=n.toLowerCase();Array.contains(t,i)||(t.push(i),_Ewa.CustomFunctionsLegacyInstaller.s(t))};_Ewa.CustomFunctionsLegacyInstaller.q=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.g(),i=n.toLowerCase();Array.contains(t,i)&&(t.splice(Array.indexOf(t,i),1),_Ewa.CustomFunctionsLegacyInstaller.s(t))};_Ewa.CustomFunctionsLegacyInstaller.t=function(n,t){var i=new _Ewa.CustomFunctionsLegacyInstaller.k(n);i.d()&&_Ewa.CustomFunctionsLegacyInstaller.A(i.a,t)};_Ewa.CustomFunctionsLegacyInstaller.c=function(n){try{return localStorage.getItem(n)}catch(t){return Diag.a.a(42541854,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",t.message||"Unknown"),null}};_Ewa.CustomFunctionsLegacyInstaller.j=function(n,t){try{localStorage.setItem(n,t)}catch(i){Diag.a.a(42541855,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",i.message||"Unknown")}};_Ewa.CustomFunctionsLegacyInstaller.r=function(n){try{localStorage.removeItem(n)}catch(t){Diag.a.a(42541856,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",t.message||"Unknown")}};_Ewa.CustomFunctionsLegacyInstaller.w=function(n){if(!n||!n.length)return!1;try{JSON.parse(n)}catch(t){return!1}return!0};_Ewa.CustomFunctionsLegacyInstaller.prototype={e:null,a:function(n,t,i,r){var f=new($$sc.D.$$(Boolean)),o,u,e,s,h;if(!_Ewa.f.a(r.invariantNamespace))for(o=0;o<r.invariantNamespace.length;++o)if(u=r.invariantNamespace.charAt(o),u!=="."&&u!=="_"&&u<"a"&&"z"<u&&u<"A"&&"Z"<u&&u<"0"&&"9"<u)return Diag.a.a(42541841,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",u,o),f.a(!1),f.b;return _Ewa.CustomFunctionsLegacyInstaller.t(i,r.manifest),e=_Ewa.CustomFunctionsLegacyInstaller.f(n),e&&e.isDynamicMetadata?this.i(n,e,f,!1,!1):(s=this,h=this,OSF.OUtil.xhrGet(r.metadataUrl,function(t){var u;e=(u=new _Ewa.CustomFunctionsLegacyInstaller.v,u.addinId=i,u.locale=r.locale,u.addinInvariantNamespace=r.invariantNamespace,u.addinNamespace=r.namespace,u.addinTitle=r.title,u.isXllCompatible=r.isXllCompatible,u.metadataContent=JSON.stringify(JSON.parse(t)),u);s.i(n,e,f,!1,_Ewa.wj.a(s.e,r))},function(t){Diag.a.a(42541843,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",n,t);f.a(!1)})),f.b},b:function(n,t,i,r){var u=new($$sc.D.$$(Boolean)),f;return _Ewa.CustomFunctionsLegacyInstaller.w(i)?(f=_Ewa.CustomFunctionsLegacyInstaller.f(n),!f)?(Diag.a.a(42541845,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),u.a(!1),u.b):(f.metadataContent=JSON.stringify(JSON.parse(i)),f.isDynamicMetadata=!0,this.i(n,f,u,!0,r),u.b):(Diag.a.a(42541844,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),u.a(!1),u.b)},d:function(n){var t=new($$sc.D.$$(Boolean)),i=_Ewa.l.b(_Ewa.bQ,this.e.a(),106,this.e.g(),1,null),r=this;return _Ewa.g.a(i,function(){var f=i.a(),u,e;f.d();e=(u=new _Ewa.CustomFunctionsLegacyInstaller.y,u.solutionId=n,u);_Ewa.CustomFunctionsLegacyInstaller.h(n);_Ewa.CustomFunctionsLegacyInstaller.i(n);_Ewa.g.a(r.q(f,n,e),function(i){_Ewa.cb.a(i)?t.a(i.a()):(i.b===5?Diag.a.a(42541847,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",n):i.b===4&&Diag.a.a(42541848,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",n),t.a(!1))},r.e.g(),0,null,null)},this.e.g(),3,null,null),t.b},n:function(){var n=new($$sc.D.$$(Boolean)),i=_Ewa.CustomFunctionsLegacyInstaller.g(),t,r,u,f;return(i.length>0&&Diag.a.a(42541849,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted."),t=[],r=this,Array.forEach(i,function(n){var f=$$as(String,n),i=_Ewa.CustomFunctionsLegacyInstaller.f(f),u;i&&(u=_Ewa.y.a(r.f,i.addinId,null),u&&u===i.metadataContent||(r.f[i.addinId]=i.metadataContent,Array.add(t,i)))}),!t.length)?(n.a(!0),Diag.a.a(42541850,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),n.b):(u=_Ewa.l.b(_Ewa.bQ,this.e.a(),106,this.e.g(),1,null),f=this,_Ewa.g.a(u,function(){var e=u.a(),r,o=(r=new _Ewa.CustomFunctionsLegacyInstaller.u,r.registrationInfos=t,r);_Ewa.g.a(f.j(e,i,o),function(t){_Ewa.cb.a(t)?n.a(t.a()):(t.b===5?Diag.a.a(42541852,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):t.b===4&&Diag.a.a(42541853,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),n.a(!1))},f.e.g(),0,null,null)},this.e.g(),3,null,null),n.b)},p:function(n){var t=new _Ewa.CustomFunctionsLegacyInstaller.k(n),i;t.d()&&(i=_Ewa.CustomFunctionsLegacyInstaller.x(t.a),OSF.OsfManifestManager.cacheManifestFromXml(t.a,t.b,i,this.e.e().UICultureTag))},i:function(n,t,i,r,u){var f=_Ewa.l.b(_Ewa.bQ,this.e.a(),106,this.e.g(),1,null),e=this;_Ewa.g.a(f,function(){var o=f.a();_Ewa.g.a(e.o(o,n,t,!1,r,u),function(r){if(_Ewa.cb.a(r)){var u=r.a();u&&_Ewa.CustomFunctionsLegacyInstaller.z(n,t);i.a(u)}else r.b===5?Diag.a.a(42541858,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",n):r.b===4&&Diag.a.a(42541859,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",n),i.a(!1)},e.e.g(),0,null,null)},this.e.g(),3,null,null)},o:function(n,t,i,r,u,f){var o,e;if(!u&&(o=_Ewa.y.a(this.f,i.addinId,null),o&&o===i.metadataContent))return $$sc.a.a(Boolean,!0);this.f[i.addinId]=i.metadataContent;e=new($$sc.D.$$(Boolean));f||n.g(t);n.d();var s=this,h=function(n){var f,o,u,h;_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.e,t);f=n.Result;f.ResponseStatusCode===204?_Ewa.g.a(s.h(e,i.addinId,r),function(n){n.b===5?!t||!t.length?Diag.a.a(42541890,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",i.addinId):Diag.a.a(42541889,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",t):n.b===4&&(!t||!t.length?Diag.a.a(42541892,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",i.addinId):Diag.a.a(42541891,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",t));e.a(!1)},s.e.g(),4,null,null):(o=function(){delete s.f[i.addinId];_Ewa.CustomFunctionsLegacyInstaller.h(t);_Ewa.CustomFunctionsLegacyInstaller.i(t);Diag.a.a(42541893,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",t,f.ResponseStatusCode);e.a(!1)},h=(u=new CommandUI.AddInCommands.m,u.e=OSF.InfoType.Error,u.c=i.addinTitle,u.f=String.format(_Ewa.ClientStringManager.a().c(152),_Ewa.ClientStringManager.a().a(1788)),u.g=_Ewa.ClientStringManager.a().a(4),u.a=o,u.h=!1,u.b=o,u.d=OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError,u),CommandUI.AddInCommands.a.h(h))},c=this,l=function(n){var r=_Ewa.X.a(n.b);Diag.a.a(42541894,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.i.a(r,","));_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.d,t);delete c.f[i.addinId];e.a(!1)},a=this.l(i);return this.g(h,l,a,e,!0)},j:function(n,t,i){var r=new($$sc.D.$$(Boolean)),h=this;Array.forEach(t,function(t){var i=$$as(String,t);n.s(i)});n.d();var u=this,f=function(n){var f,h;_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.e,Sys.Serialization.JavaScriptSerializer.serialize(t));var e=n.Result,o=!0,c=Sys.Serialization.JavaScriptSerializer.deserialize(e.ResponseBody.toString()),s=$$as(Array,c.value);for(f=0;f<s.length;f++)h=s[f],h||(o=!1,delete u.f[i.registrationInfos[f].addinId],_Ewa.CustomFunctionsLegacyInstaller.h(t[f]),_Ewa.CustomFunctionsLegacyInstaller.i(t[f]),Diag.a.a(42541896,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",t[f],e.ResponseStatusCode));_Ewa.g.a(u.h(r,"",!1),function(n){n.b===5?Diag.a.a(42541897,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):n.b===4&&Diag.a.a(42541898,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");r.a(!1)},u.e.g(),4,null,null);r.a(o)},e=this,o=function(n){var s=_Ewa.X.a(n.b),o;Diag.a.a(42541899,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(t),_Ewa.i.a(s,","));_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.d,Sys.Serialization.JavaScriptSerializer.serialize(t));for(var f=i.registrationInfos,h=f.length,u=0;u<h;++u)o=f[u],delete e.f[o.addinId];r.a(!1)},s=this.k(i);return this.g(f,o,s,r,!0)},q:function(n,t,i){var r=new($$sc.D.$$(Boolean));n.g(t);var u=this,f=function(){_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.n,t);_Ewa.g.a(u.h(r,i.solutionId,!1),function(n){n.b===5?!t||!t.length||Diag.a.a(42541901,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",t):n.b===4&&(!t||!t.length||Diag.a.a(42541902,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",t));r.a(!1)},u.e.g(),4,null,null)},s=this,e=function(n){var i=_Ewa.X.a(n.b);Diag.a.a(42541903,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.i.a(i,","));_Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.m,t);r.a(!1)},o=this.m(i);return this.g(f,e,o,r,!1)},g:function(n,t,i,r,u){var e=this.e.f(),f=this.e.c(),o=null,s=null,h=null,y=this,c=function(){var a=e.h()||f.a().e()>0||f.b().e()>0;if(a)return!1;o&&e.e(o);s&&f.e(s);h&&f.h(h);var c=i.request,l=function(r,e,o){return _Ewa.a.b(262)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(u?_Ewa.CustomFunctionsLegacyInstaller.l:_Ewa.CustomFunctionsLegacyInstaller.o,c.RequestBody),_Ewa.k.a(f.a(),"ExecuteRichApiRequest",i,_Ewa.n.a(r,n),_Ewa.n.b(e,t),o,null,0,null,null)},r=(c.RequestFlags&1)?0:16;return _Ewa.a.d()?(r|=64,e.b(new _Ewa.v(507,0,l,r,null))):e.b(new _Ewa.ba(507,0,l,r,null)),!0},l,a,v;return c()||(l=this,o=function(){c()},a=this,s=function(){c()},v=this,h=function(){c()},e.d(o),f.d(s),f.g(h)),r.b},l:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="RegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.e.c().a().a(1,null),i.request=t,i},k:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="BatchRegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.e.c().a().a(1,null),i.request=t,i},m:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="UnregisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.e.c().a().a(1,null),i.request=t,i},h:function(n,t,i){var r=_Ewa.l.b(_Ewa.eY,this.e.a(),153,this.e.g(),1,null),u=this;return _Ewa.g.a(r,function(){r.a().e(!1);!t||!t.length||!i||u.p(t);n.a(!0)},this.e.g(),3,null,null),r},c:function(){return $$sc.a.a(Boolean,!0)}};_Ewa.CustomFunctionsLegacyInstaller.u=function(){};_Ewa.CustomFunctionsLegacyInstaller.v=function(){};_Ewa.CustomFunctionsLegacyInstaller.y=function(){};_Ewa.CustomFunctionsLegacyInstaller.k=function(n){var t=n.split("|"),i=t[0];this.a=t[1];this.b=t[2];this.c=t[3]};_Ewa.CustomFunctionsLegacyInstaller.k.prototype={c:null,a:null,b:null,d:function(){return this.c===OSF.StoreTypeEnum.Registry.toString()}};_Ewa.CustomFunctionsLegacyInstaller.b=function(n,t){this.a=n;this.b=t};_Ewa.CustomFunctionsLegacyInstaller.b.prototype={a:0,b:null};_Ewa.CustomFunctionsLegacyInstaller.a=function(){};_Ewa.CustomFunctionsLegacyInstaller.a.a=function(n,t){if(_Ewa.CustomFunctionsLegacyInstaller.c("CustomFunctionsRuntimeLogging")&&window.console){var i=_Ewa.CustomFunctionsLegacyInstaller.a.b(n.a)+" "+n.b+t;switch(n.a){case 2:window.console.log&&window.console.log(i);break;case 0:window.console.info&&window.console.info(i);break;case 1:window.console.error&&window.console.error(i)}}};_Ewa.CustomFunctionsLegacyInstaller.a.b=function(n){switch(n){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};_Ewa.wi=function(n){_Ewa.wi.initializeBase(this);this.h=n;this.l()};_Ewa.wi.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.ef),279,new _Ewa.wi(n))};_Ewa.wi.prototype={h:null,a:function(){var n;if(_Ewa.a.b(426)){var i=_Ewa.l.b(_Ewa.bQ,this.h.a(),106,this.h.g(),this.j,null),r=_Ewa.l.b(_Ewa.ki,this.h.a(),396,this.h.g(),this.j,null),t=this;_Ewa.g.a($$sc.a.WAA(i,r),function(){t.k(t.h.a().a(_Ewa.ef,278,!1,null)||new _Ewa.CustomFunctionsInstaller(t.h,i.a(),r.a()))},this.h.g(),3,null,null)}else n=this.h.a().a(_Ewa.ef,278,!1,null),n||(n=this.h.a().b(_Ewa.ef,278,new _Ewa.CustomFunctionsLegacyInstaller(this.h))),this.k(n)}};_Ewa.cg=function(){};_Ewa.cg.cwrtcwithaction=function(n,t,i,r){return _Ewa.cg.cwrtcwithactionwithcancellationtokenandtaskscheduler(n,t,i,$$sc.f.a,$$sc.c.a,r)};_Ewa.cg.cwrtcwithactionwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f){var e=t.CWCT(function(){i(t)},r,3,u);return e.CWo(function(){Diag.a.a(42541908,0,10,f)},4),e};_Ewa.cg.cwrtcwithfunc=function(n,t,i,r,u){return _Ewa.cg.cwrtcwithfuncwithcancellationtokenandtaskscheduler(n,t,i,r,$$sc.f.a,$$sc.c.a,u)};_Ewa.cg.cwrtcwithfuncwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f,e){var o=i.CWRCT($$sc.p.$$(t),function(){return r(i)},u,3,f);return o.CWo(function(){Diag.a.a(42541909,0,10,e)},4),_Ewa.g.g(t,o)};_Ewa.cg.cwrtcwithresult=function(n,t,i,r,u){return _Ewa.cg.cwrtcwithresultwithcancellationtokenandtaskscheduler(n,t,i,r,$$sc.f.a,$$sc.c.a,u)};_Ewa.cg.cwrtcwithresultwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f,e){var o=i.CWRCT(t,function(){return r(i)},u,3,f);return o.CWo(function(){Diag.a.a(42541910,0,10,e)},4),o};_Ewa.cg.cwrtcfortaskwithfunc=function(n,t,i,r){return _Ewa.cg.cwrtcfortaskwithfuncwithcancellationtokenandtaskscheduler(n,t,i,$$sc.f.a,$$sc.c.a,r)};_Ewa.cg.cwrtcfortaskwithfuncwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f){var e=t.CWRCT($$sc.p.$$(n),function(){return i(t)},r,3,u);return e.CWo(function(){Diag.a.a(42541911,0,10,f)},4),_Ewa.g.g(n,e)};_Ewa.cg.cwrtcfortaskwithaction=function(n,t,i){return _Ewa.cg.cwrtcfortaskwithactionwithcancellationtokenandtaskscheduler(n,t,$$sc.f.a,$$sc.c.a,i)};_Ewa.cg.cwrtcfortaskwithactionwithcancellationtokenandtaskscheduler=function(n,t,i,r,u){var f=n.CWCT(function(){t(n)},i,3,r);return f.CWo(function(){Diag.a.a(42541912,0,10,u)},4),f};_Ewa.CustomFunctionsInstaller.registerClass("_Ewa.CustomFunctionsInstaller",null,_Ewa.ef);_Ewa.CustomFunctionsInstaller.g.registerClass("_Ewa.CustomFunctionsInstaller.g");_Ewa.CustomFunctionsInstaller.n.registerClass("_Ewa.CustomFunctionsInstaller.n");_Ewa.CustomFunctionsInstaller.q.registerClass("_Ewa.CustomFunctionsInstaller.q");_Ewa.CustomFunctionsLegacyInstaller.registerClass("_Ewa.CustomFunctionsLegacyInstaller",null,_Ewa.ef);_Ewa.CustomFunctionsLegacyInstaller.u.registerClass("_Ewa.CustomFunctionsLegacyInstaller.u");_Ewa.CustomFunctionsLegacyInstaller.v.registerClass("_Ewa.CustomFunctionsLegacyInstaller.v");_Ewa.CustomFunctionsLegacyInstaller.y.registerClass("_Ewa.CustomFunctionsLegacyInstaller.y");_Ewa.wi.registerClass("_Ewa.wi",_Ewa.sX.$$(_Ewa.ef));_Ewa.CustomFunctionsInstaller.h=new _Ewa.CustomFunctionsInstaller.b(2,"CustomFunctions [Registration] [Begin] SolutionId=");_Ewa.CustomFunctionsInstaller.d=new _Ewa.CustomFunctionsInstaller.b(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsInstaller.c=new _Ewa.CustomFunctionsInstaller.b(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsInstaller.k=new _Ewa.CustomFunctionsInstaller.b(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");_Ewa.CustomFunctionsInstaller.j=new _Ewa.CustomFunctionsInstaller.b(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsInstaller.i=new _Ewa.CustomFunctionsInstaller.b(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.l=new _Ewa.CustomFunctionsLegacyInstaller.b(2,"CustomFunctions [Registration] [Begin] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.e=new _Ewa.CustomFunctionsLegacyInstaller.b(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.d=new _Ewa.CustomFunctionsLegacyInstaller.b(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.o=new _Ewa.CustomFunctionsLegacyInstaller.b(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.n=new _Ewa.CustomFunctionsLegacyInstaller.b(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.m=new _Ewa.CustomFunctionsLegacyInstaller.b(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Type.registerNamespace("_Ewa");_Ewa.bfu=function(){};_Ewa.bfu.a=function(){_Ewa.m.a(function(n){_Ewa.a.b(124)&&_Ewa.wi.a(n)})};_Ewa.bfu.a();Type.registerNamespace("_Ewa");_Ewa.bfz=function(){};_Ewa.IS=function(n){this.c=n;var t=this;_Ewa.g.a(_Ewa.l.a(_Ewa.eK,this.c.a(),328,327,1,null),function(i){var r=i.a();if(!r){Diag.a.a(538808590,0,10,"DataFromPicturePaneCommandManager::Initialize - Failed to instantiate AugmentationLoopManager.");return}Diag.a.a(538808589,0,50,"DataFromPicturePaneCommandManager::Initialize - AugmentationLoopManager instantiated.");t.a=new _Ewa.IT(n,r);t.b&&(t.a.m(t.d,t.e),t.b=!1)},this.c.g(),3,null,null)};_Ewa.IS.prototype={c:null,a:null,b:!1,d:null,e:null,z:function(){return!1},x:function(n,t,i){var r=!1,u=t.a;switch(u){case 73979048:this.a?this.a.m(t,i):(this.d=t,this.e=i,this.b=!0);r=!0}return r?$$sc.a.a(Boolean,!0):_Ewa.Y.a(t.a)},w:function(n,t){return t.a===73979048&&_Ewa.a.c("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)},y:function(){return!1},dispose:function(){this.a.dispose()}};_Ewa.wp=function(n){_Ewa.wp.initializeBase(this,[n])};_Ewa.wp.a=function(n){_Ewa.bh.a(452,new _Ewa.wp(n))};_Ewa.wp.prototype={n:function(){this.m([new _Ewa.IS(this.h)],null)}};_Ewa.IT=function(n,t){this.l=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.p);this.j=Microsoft.Office.AugLoop.ImageToTable.a.a();_Ewa.IT.initializeBase(this,[!1]);this.b=n;this.f=t;this.r()};_Ewa.IT.prototype={b:null,f:null,d:null,k:0,i:0,c:null,a:null,e:null,g:!1,dispose:function(){window.removeEventListener("message",this.h,!1);_Ewa.bW.prototype.dispose.call(this)},m:function(n,t){this.e=Common.u.a().a;this.d="";this.k=0;this.i=0;this.c="";this.a="";this.g=!1;this.s(n,t);this.u()},p:function(n){var r,e,o,t,f;if(n&&(r={},o=Common.bp.a(n.data,e={val:r}),r=e.val,o)&&(t=$$as(Object,r),t.DataFromPictureWildcard===".")){if(t.SessionId!==this.e){Diag.a.a(538808588,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");return}switch(t.CmdType){case"ACK":this.g=!0;this.t();this.a.length>0?this.n():this.c.length>0&&this.o();break;case"insert_html":Diag.a.a(544265870,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane");var u=this.b.c().a(),i={},s=_Ewa.c.a(this.b).a().a().c().f();i.PasteId=Common.u.a().a;i.DestinationRanges=_Ewa.h.j(_Ewa.h.a(s,this.b));i.SourceHtml=t.Parameters;i.CopyOperationId=null;f=u.a(1,u.b(!1));f.pasteHtmlParameters=i;var c=this,h=function(n,t,i){return _Ewa.k.a(u,"pasteHtmlContent",f,n,t,i,null,64,null,null)},l=this;_Ewa.H.a(this.b.f(),h,function(n){return new _Ewa.v(204,0,n,1,null)},null)}}},u:function(){var t,i,n;if(!this.d.length){Diag.a.a(538808587,0,50,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty");return}for(t=window.self.atob(this.d),i=new Array(t.length),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);this.f.g(i,this.e,2,3,this.k,this.i)},s:function(n,t){t.SessionID=this.e;t.DataFromPictureURL="ImageToDoc.Dogfood.Url";t.DataFromPictureAssetId="FA000000050";t.LoadDataFromPictureTaskpane=!0;var i=new _Ewa.L(-859308420,n.c,n.e,n.b,n.d);return this.b.i().a(i,t,null)},t:function(){var t,n,i;if(!this.d.length){Diag.a.a(544265869,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.");return}t=_Ewa.bJ.a(this.b).c("FA000000050.ImageToDoc.Dogfood.Url");n={DataFromPictureWildcard:"."};n.imageData=this.d;i=this;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",n,function(n){n&&Diag.a.a(544265868,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})},o:function(){var t,n,i;if(!this.c.length){Diag.a.a(544265867,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.");return}t=_Ewa.bJ.a(this.b).c("FA000000050.ImageToDoc.Dogfood.Url");n={DataFromPictureWildcard:"."};n.tableHtml=this.c;i=this;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",n,function(n){n&&Diag.a.a(544265866,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})},n:function(){var t,n,i;if(!this.a.length){Diag.a.a(544265865,0,50,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.");return}t=_Ewa.bJ.a(this.b).c("FA000000050.ImageToDoc.Dogfood.Url");n={DataFromPictureWildcard:"."};n.errorMessage=this.a;i=this;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",n,function(n){n&&Diag.a.a(544265864,0,50,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})},r:function(){window.addEventListener("message",this.h,!1);this.f.a(this.j,null);this.f.b(this.j,this.l)},q:function(n,t){var r=t.a,i;if(!r){Diag.a.a(538808586,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.");return}if(!t.c||t.c.length<=1||t.c[1]!==this.e){Diag.a.a(538808585,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");return}i=r.errorCode;switch(i){case null:case-1:this.a=_Ewa.ClientStringManager.a().a(2136);break;case 1:this.a=_Ewa.ClientStringManager.a().a(2137);break;case 2:this.a=_Ewa.ClientStringManager.a().a(2138)}this.a.length>0&&Diag.a.a(538808584,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",i?i.toString():"null");this.c=r.html;this.g&&(this.a.length>0?this.n():this.c.length>0&&this.o())}};_Ewa.IS.registerClass("_Ewa.IS",null,_Ewa.lI,Sys.IDisposable);_Ewa.wp.registerClass("_Ewa.wp",_Ewa.bh);_Ewa.IT.registerClass("_Ewa.IT",_Ewa.bW);Type.registerNamespace("_Ewa");_Ewa.bfx=function(){};_Ewa.bfx.a=function(){_Ewa.m.a(function(n){_Ewa.wp.a(n)})};_Ewa.bfx.a();Type.registerNamespace("_Ewa");_Ewa.Pb=function(n,t,i){this.f=Function.createDelegate(this,this.j);this.e=t;this.d=i;this.b=n;this.b.bj()&&this.b.cD(this.f);n.a().b(_Ewa.lS,297,this)};_Ewa.Pb.prototype={b:null,c:null,e:null,d:null,a:function(n){if(this.b.bj()){if(!n){Diag.a.a(40232404,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null.");return}this.c=n}},i:function(n){var i,u,f;if(this.h())try{if(this.d.c(n)){i=this.d.d(n);for(var r=i,e=r.length,t=0;t<e;++t)u=r[t],this.g(u)}else this.g(n)}catch(o){f=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",_Ewa.cK.a(n.a()),o.stack);Diag.a.a(40232405,0,10,f)}},g:function(n){var t=this.e.c(n,!0),r,i,u,f;if(t){this.c(t.b(),_Ewa.E.a(n.b()));r=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",t.b());Diag.a.a(42259009,0,50,r);return}i=this.e.c(n,!1);i?(u=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",i.b()),Diag.a.a(579090249,0,50,u)):_Ewa.W.b().b(n.a())||(this.c(0,_Ewa.E.a(n.a())),f=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",_Ewa.cK.a(n.a())),Diag.a.a(40232406,0,50,f))},j:function(n,t){this.h()&&this.i(t)},h:function(){return!this.b.bn()||!this.c||!this.b.bv()?!1:!0}};_Ewa.zr=function(n){_Ewa.zr.initializeBase(this);this.h=n;this.l()};_Ewa.zr.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.lS),298,new _Ewa.zr(n))};_Ewa.zr.prototype={h:null,a:function(){this.k(this.h.a().a(_Ewa.lS,297,!1,null)||new _Ewa.Pb(this.h,new _Ewa.go(this.h),new _Ewa.Pa))}};_Ewa.Oz=function(){_Ewa.Oz.initializeBase(this)};_Ewa.Oz.prototype={b:function(){return 130},c:function(){this.a(100)}};_Ewa.OA=function(){_Ewa.OA.initializeBase(this)};_Ewa.OA.prototype={b:function(){return 160},c:function(){this.a(241)},e:function(){var n=this;this.d(function(n){var t=n;return t.addToPrintArea})}};_Ewa.OB=function(){_Ewa.OB.initializeBase(this)};_Ewa.OB.prototype={b:function(){return 65},c:function(){this.a(516)}};_Ewa.OC=function(){_Ewa.OC.initializeBase(this)};_Ewa.OC.prototype={b:function(){return 118},c:function(){this.a(502)},e:function(){var n=this;this.d(function(n){var t=n,i=t.sharedSheetRange.FirstColumn===t.sharedSheetRange.LastColumn&&t.sharedSheetRange.FirstRow===t.sharedSheetRange.LastRow;return!i})}};_Ewa.OO=function(){_Ewa.OO.initializeBase(this)};_Ewa.OO.prototype={b:function(){return 131},c:function(){this.a(521)}};_Ewa.OQ=function(){_Ewa.OQ.initializeBase(this)};_Ewa.OQ.prototype={b:function(){return 129},c:function(){this.a(109)}};_Ewa.OR=function(){_Ewa.OR.initializeBase(this)};_Ewa.OR.prototype={b:function(){return 49},c:function(){this.a(149);this.a(147)}};_Ewa.OS=function(){_Ewa.OS.initializeBase(this)};_Ewa.OS.prototype={b:function(){return 96},c:function(){this.a(122)}};_Ewa.OT=function(){_Ewa.OT.initializeBase(this)};_Ewa.OT.prototype={b:function(){return 93},c:function(){this.a(522)}};_Ewa.OU=function(){_Ewa.OU.initializeBase(this)};_Ewa.OU.prototype={b:function(){return 94},c:function(){this.a(524)}};_Ewa.OV=function(){_Ewa.OV.initializeBase(this)};_Ewa.OV.prototype={b:function(){return 95},c:function(){this.a(523)}};_Ewa.OD=function(){_Ewa.OD.initializeBase(this,[84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375]])};_Ewa.OE=function(){_Ewa.OE.initializeBase(this,[80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311]])};_Ewa.OF=function(){_Ewa.OF.initializeBase(this,[82,[200,201,202,203,204,205,206,207,208,209,210]])};_Ewa.OG=function(){_Ewa.OG.initializeBase(this,[76,[-100]])};_Ewa.OH=function(){_Ewa.OH.initializeBase(this,[83,[500,501,502]])};_Ewa.kn=function(){_Ewa.kn.initializeBase(this)};_Ewa.kn.prototype={b:function(){return 117},n:function(n){return _Ewa.kn.a||(_Ewa.kn.a=new($$sc.n.$$(String))($$sc.d.a()),_Ewa.kn.a.a("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),_Ewa.kn.a.a("fa000000014")),!!n&&_Ewa.kn.a.b(n.toLowerCase())},c:function(){this.a(507);this.a(10);this.a(576)},e:function(){var n=this;this.d(function(t){if(_Ewa.ft.isInstanceOfType(t)){var i=$$as(_Ewa.ft,t);if(i.a()&&n.n(i.source))return Diag.a.a(589898770,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",i.eventId),!0}return!1})}};_Ewa.OI=function(){_Ewa.OI.initializeBase(this,[85,[328,329,330,331,332,333,334,335]])};_Ewa.Qv=function(){_Ewa.Qv.initializeBase(this)};_Ewa.Qv.prototype={b:function(){return 86},c:function(){this.a(150)}};_Ewa.OJ=function(){_Ewa.OJ.initializeBase(this)};_Ewa.OJ.prototype={b:function(){return 66},c:function(){this.a(528)}};_Ewa.OK=function(){_Ewa.OK.initializeBase(this,[81,[100,101,102,103,104,105,106]])};_Ewa.bkY=function(n,t){_Ewa.bkY.initializeBase(this);this.n=n;this.o=t};_Ewa.bkY.prototype={n:0,o:null,b:function(){return this.n},c:function(){this.a(529);this.a(594)},e:function(){var n=this;this.d(function(t){return Array.contains(n.o,t.operationType)})}};_Ewa.OL=function(){_Ewa.OL.initializeBase(this,[75,[-101]])};_Ewa.OM=function(){_Ewa.OM.initializeBase(this,[79,[0,1,2,-102]])};_Ewa.ON=function(){_Ewa.ON.initializeBase(this,[78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131]])};_Ewa.OP=function(){_Ewa.OP.initializeBase(this)};_Ewa.OP.prototype={b:function(){return 116},c:function(){this.a(507);this.a(576);this.a(10)},e:function(){var n=this;this.d(function(n){if(_Ewa.ft.isInstanceOfType(n)){var t=$$as(_Ewa.ft,n);if(!isNullOrUndefined(t.source)&&!isNullOrUndefined(t.eventId))return Diag.a.a(594105034,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",t.source,t.eventId),!0}return Diag.a.a(594105033,0,50,"[RichApiRecorder]: an invalid event was ignored."),!1})}};_Ewa.OW=function(){_Ewa.OW.initializeBase(this)};_Ewa.OW.prototype={b:function(){return 100},c:function(){this.a(543)}};_Ewa.OX=function(){_Ewa.OX.initializeBase(this)};_Ewa.OX.prototype={b:function(){return 154},c:function(){this.a(125)}};_Ewa.ko=function(){_Ewa.ko.initializeBase(this)};_Ewa.ko.prototype={b:function(){return 125},n:function(n){return _Ewa.ko.a||(_Ewa.ko.a=new($$sc.n.$$(String))($$sc.d.a()),_Ewa.ko.a.a("f438b4e6-2b49-466f-9a91-b75f473eba96"),_Ewa.ko.a.a("fa000000005")),!!n&&_Ewa.ko.a.b(n.toLowerCase())},c:function(){this.a(507);this.a(10);this.a(576)},e:function(){var n=this;this.d(function(t){if(_Ewa.ft.isInstanceOfType(t)){var i=$$as(_Ewa.ft,t);return i.a()&&n.n(i.source)}return!1})}};_Ewa.OY=function(){_Ewa.OY.initializeBase(this)};_Ewa.OY.prototype={b:function(){return 136},c:function(){this.a(115)}};_Ewa.OZ=function(){_Ewa.OZ.initializeBase(this)};_Ewa.OZ.prototype={b:function(){return 148},c:function(){this.a(114)}};_Ewa.Pc=function(){_Ewa.Pc.initializeBase(this)};_Ewa.Pc.prototype={b:function(){return 127},c:function(){this.a(119)}};_Ewa.RS=function(){_Ewa.RS.initializeBase(this)};_Ewa.RS.prototype={b:function(){return 207},c:function(){this.a(238)}};_Ewa.Pd=function(){_Ewa.Pd.initializeBase(this)};_Ewa.Pd.prototype={b:function(){return 135},c:function(){this.a(191)},f:function(){this.h(738)}};_Ewa.Pe=function(){_Ewa.Pe.initializeBase(this)};_Ewa.Pe.prototype={b:function(){return 166},c:function(){this.a(200)},f:function(){this.h(738)}};_Ewa.Pf=function(){_Ewa.Pf.initializeBase(this)};_Ewa.Pf.prototype={b:function(){return 133},c:function(){this.a(192)},f:function(){this.h(738)}};_Ewa.Pg=function(){_Ewa.Pg.initializeBase(this)};_Ewa.Pg.prototype={b:function(){return 162},c:function(){this.a(199)},f:function(){this.h(738)}};_Ewa.Ph=function(){_Ewa.Ph.initializeBase(this)};_Ewa.Ph.prototype={b:function(){return 167},c:function(){this.a(195)},f:function(){this.h(738)}};_Ewa.Pi=function(){_Ewa.Pi.initializeBase(this)};_Ewa.Pi.prototype={b:function(){return 99},c:function(){this.a(174)}};_Ewa.Pj=function(){_Ewa.Pj.initializeBase(this)};_Ewa.Pj.prototype={b:function(){return 156},c:function(){this.a(244)}};_Ewa.Pk=function(){_Ewa.Pk.initializeBase(this)};_Ewa.Pk.prototype={b:function(){return 157},c:function(){this.a(245)}};_Ewa.Pl=function(){_Ewa.Pl.initializeBase(this)};_Ewa.Pl.prototype={b:function(){return 158},c:function(){this.a(246)}};_Ewa.Pm=function(){_Ewa.Pm.initializeBase(this)};_Ewa.Pm.prototype={b:function(){return 112},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return!_Ewa.f.a(t.pasteParameters.ClientEstimationFloatingObjectId)&&t.pasteParameters.CopyPasteTargetType===2&&!t.isFromCurrentSession})}};_Ewa.Pn=function(){_Ewa.Pn.initializeBase(this)};_Ewa.Pn.prototype={b:function(){return 52},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return!_Ewa.f.a(t.pasteParameters.ClientEstimationFloatingObjectId)&&t.pasteParameters.CopyPasteTargetType===2&&t.isFromCurrentSession})}};_Ewa.Po=function(){_Ewa.Po.initializeBase(this)};_Ewa.Po.prototype={b:function(){return 110},c:function(){this.a(204)}};_Ewa.Pp=function(){_Ewa.Pp.initializeBase(this)};_Ewa.Pp.prototype={b:function(){return 35},c:function(){this.a(506)}};_Ewa.Pq=function(){_Ewa.Pq.initializeBase(this)};_Ewa.Pq.prototype={b:function(){return 111},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return t.pasteParameters.CopyPasteTargetType===1})}};_Ewa.Pr=function(){_Ewa.Pr.initializeBase(this)};_Ewa.Pr.prototype={b:function(){return 42},c:function(){this.a(180)}};_Ewa.Ps=function(){_Ewa.Ps.initializeBase(this)};_Ewa.Ps.prototype={b:function(){return 134},c:function(){this.a(220)}};_Ewa.Pt=function(){_Ewa.Pt.initializeBase(this)};_Ewa.Pt.prototype={b:function(){return 122},c:function(){this.a(510)}};_Ewa.Pu=function(){_Ewa.Pu.initializeBase(this)};_Ewa.Pu.prototype={b:function(){return 153},c:function(){this.a(161)}};_Ewa.PB=function(){_Ewa.PB.initializeBase(this)};_Ewa.PB.prototype={b:function(){return 98},c:function(){this.a(132)}};_Ewa.PL=function(){_Ewa.PL.initializeBase(this)};_Ewa.PL.prototype={b:function(){return 102},c:function(){this.a(145)}};_Ewa.PM=function(){_Ewa.PM.initializeBase(this)};_Ewa.PM.prototype={b:function(){return 149},c:function(){this.a(219)}};_Ewa.PO=function(){_Ewa.PO.initializeBase(this)};_Ewa.PO.prototype={b:function(){return 104},c:function(){this.a(50)},e:function(){var n=this;this.d(function(n){return!!n.pivotTableId&&!!n.pivotTableName})}};_Ewa.blb=function(n,t){_Ewa.blb.initializeBase(this);this.n=n;this.o=t};_Ewa.blb.prototype={n:0,o:0,b:function(){return this.n},c:function(){this.a(225)},e:function(){var n=this;this.d(function(t){return t.opType===n.o})}};_Ewa.PP=function(){_Ewa.PP.initializeBase(this,[168,1])};_Ewa.PQ=function(){_Ewa.PQ.initializeBase(this,[169,2])};_Ewa.PA=function(){_Ewa.PA.initializeBase(this,[170,3])};_Ewa.Pv=function(){_Ewa.Pv.initializeBase(this,[171,4])};_Ewa.Pz=function(){_Ewa.Pz.initializeBase(this,[172,5])};_Ewa.Py=function(){_Ewa.Py.initializeBase(this,[173,6])};_Ewa.PF=function(){_Ewa.PF.initializeBase(this,[174,7])};_Ewa.PH=function(){_Ewa.PH.initializeBase(this,[176,9])};_Ewa.PI=function(){_Ewa.PI.initializeBase(this,[175,8])};_Ewa.PC=function(){_Ewa.PC.initializeBase(this,[177,10])};_Ewa.PD=function(){_Ewa.PD.initializeBase(this,[178,11])};_Ewa.PE=function(){_Ewa.PE.initializeBase(this,[179,12])};_Ewa.PK=function(){_Ewa.PK.initializeBase(this,[180,13])};_Ewa.PR=function(){_Ewa.PR.initializeBase(this,[181,14])};_Ewa.PN=function(){_Ewa.PN.initializeBase(this,[182,15])};_Ewa.Px=function(){_Ewa.Px.initializeBase(this,[183,16])};_Ewa.Pw=function(){_Ewa.Pw.initializeBase(this,[184,17])};_Ewa.PT=function(){_Ewa.PT.initializeBase(this,[185,18])};_Ewa.PJ=function(){_Ewa.PJ.initializeBase(this,[186,19])};_Ewa.PG=function(){_Ewa.PG.initializeBase(this,[187,20])};_Ewa.PS=function(){_Ewa.PS.initializeBase(this)};_Ewa.PS.prototype={b:function(){return 155},c:function(){this.a(131)},e:function(){var n=this;this.d(function(n){var t=$$as(_Ewa.rX,n);return!!t&&!(!t.fieldName||!t.fieldName.length)&&!(!t.hierarchyName||!t.hierarchyName.length)})}};_Ewa.PU=function(){_Ewa.PU.initializeBase(this)};_Ewa.PU.prototype={b:function(){return 206},c:function(){this.a(560)}};_Ewa.PV=function(){_Ewa.PV.initializeBase(this)};_Ewa.PV.prototype={b:function(){return 161},c:function(){this.a(243)}};_Ewa.PW=function(){_Ewa.PW.initializeBase(this)};_Ewa.PW.prototype={b:function(){return 159},c:function(){this.a(241)},e:function(){var n=this;this.d(function(n){var t=n;return!t.addToPrintArea})}};_Ewa.blc=function(n,t){_Ewa.blc.initializeBase(this);this.n=n;this.o=t};_Ewa.blc.prototype={n:0,o:0,b:function(){return this.n},c:function(){this.a(11)},e:function(){var t=this,n;this.d(function(n){return n.cellFormat.ValidMembers===16});n=this;this.d(function(t){return t.cellFormat.Font.ValidMembers===n.o})}};_Ewa.PX=function(){_Ewa.PX.initializeBase(this)};_Ewa.PX.prototype={b:function(){return 57},c:function(){this.a(517)}};_Ewa.PY=function(){_Ewa.PY.initializeBase(this,[3,4])};_Ewa.PZ=function(){_Ewa.PZ.initializeBase(this)};_Ewa.PZ.prototype={b:function(){return 2},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===128})}};_Ewa.Qb=function(){_Ewa.Qb.initializeBase(this)};_Ewa.Qb.prototype={b:function(){return 109},c:function(){this.a(106);this.a(105)}};_Ewa.Qc=function(){_Ewa.Qc.initializeBase(this)};_Ewa.Qc.prototype={b:function(){return 124},c:function(){this.a(221)}};_Ewa.Qa=function(){_Ewa.Qa.initializeBase(this)};_Ewa.Qa.prototype={b:function(){return 113},c:function(){this.a(208)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.gn.b})}};_Ewa.Qd=function(){_Ewa.Qd.initializeBase(this)};_Ewa.Qd.prototype={b:function(){return 29},c:function(){this.a(508)},e:function(){var n=this;this.d(function(n){var t=n;return t.command===3||t.command===1||t.command===4})}};_Ewa.Qe=function(){_Ewa.Qe.initializeBase(this)};_Ewa.Qe.prototype={b:function(){return 40},c:function(){this.a(104)}};_Ewa.Qf=function(){_Ewa.Qf.initializeBase(this)};_Ewa.Qf.prototype={b:function(){return 114},c:function(){this.a(209)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.gn.b})}};_Ewa.Qg=function(){_Ewa.Qg.initializeBase(this)};_Ewa.Qg.prototype={b:function(){return 106},c:function(){this.a(121)}};_Ewa.Qh=function(){_Ewa.Qh.initializeBase(this,[4,64])};_Ewa.Qj=function(){_Ewa.Qj.initializeBase(this)};_Ewa.Qj.prototype={b:function(){return 1},c:function(){this.a(527);this.a(12)}};_Ewa.Ql=function(){_Ewa.Ql.initializeBase(this)};_Ewa.Ql.prototype={b:function(){return 119},c:function(){_Ewa.a.a("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.a(255):this.a(232)},e:function(){var n=this;this.d(function(n){return n.actionType===3})},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")}};_Ewa.Qo=function(){_Ewa.Qo.initializeBase(this)};_Ewa.Qo.prototype={b:function(){return 77},c:function(){this.a(553)},e:function(){var n=this;this.d(function(n){return!n.actionType})},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")}};_Ewa.Qn=function(){_Ewa.Qn.initializeBase(this)};_Ewa.Qn.prototype={b:function(){return 163},c:function(){this.a(553)},e:function(){var n=this;this.d(function(n){return n.actionType===1})},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")}};_Ewa.Qk=function(){_Ewa.Qk.initializeBase(this)};_Ewa.Qk.prototype={b:function(){return 164},c:function(){_Ewa.a.a("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.a(255):this.a(232)},e:function(){var n=this;this.d(function(n){return n.actionType===4})},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")}};_Ewa.Qp=function(){_Ewa.Qp.initializeBase(this)};_Ewa.Qp.prototype={b:function(){return 165},c:function(){this.a(224)},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")}};_Ewa.Qm=function(){_Ewa.Qm.initializeBase(this)};_Ewa.Qm.prototype={b:function(){return 205},c:function(){_Ewa.a.a("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.a(256):this.a(249)},f:function(){this.g("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}};_Ewa.Qq=function(){_Ewa.Qq.initializeBase(this)};_Ewa.Qq.prototype={b:function(){return 5},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===64})}};_Ewa.Qr=function(){_Ewa.Qr.initializeBase(this)};_Ewa.Qr.prototype={b:function(){return 59},c:function(){this.a(155)}};_Ewa.Qs=function(){_Ewa.Qs.initializeBase(this)};_Ewa.Qs.prototype={b:function(){return 115},c:function(){this.a(176)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.gn.b&&!!n.autoFilterOptions.CriteriaType})}};_Ewa.Qt=function(){_Ewa.Qt.initializeBase(this)};_Ewa.Qt.prototype={b:function(){return 58},c:function(){this.a(176)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.gn.b&&!n.autoFilterOptions.CriteriaType})}};_Ewa.Qu=function(){_Ewa.Qu.initializeBase(this)};_Ewa.Qu.prototype={b:function(){return 41},c:function(){this.a(518)}};_Ewa.Qw=function(){_Ewa.Qw.initializeBase(this,[6,32])};_Ewa.Qx=function(){_Ewa.Qx.initializeBase(this,[7,8])};_Ewa.Qy=function(){_Ewa.Qy.initializeBase(this,[8,1])};_Ewa.Qz=function(){_Ewa.Qz.initializeBase(this,[9,2])};_Ewa.QA=function(){_Ewa.QA.initializeBase(this)};_Ewa.QA.prototype={b:function(){return 74},c:function(){this.a(215)}};_Ewa.QB=function(){_Ewa.QB.initializeBase(this)};_Ewa.QB.prototype={b:function(){return 97},c:function(){this.a(188)}};_Ewa.QC=function(){_Ewa.QC.initializeBase(this)};_Ewa.QC.prototype={b:function(){return 60},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===2})}};_Ewa.QF=function(){_Ewa.QF.initializeBase(this)};_Ewa.QF.prototype={b:function(){return 53},c:function(){this.a(156)},e:function(){var n=this;this.d(function(n){var t=n;return t.command===2||t.command===5||t.command===6||t.command===7})}};_Ewa.QG=function(){_Ewa.QG.initializeBase(this)};_Ewa.QG.prototype={b:function(){return 107},c:function(){this.a(216)}};_Ewa.QD=function(){_Ewa.QD.initializeBase(this)};_Ewa.QD.prototype={b:function(){return 43},c:function(){this.a(526)}};_Ewa.QE=function(){_Ewa.QE.initializeBase(this)};_Ewa.QE.prototype={b:function(){return 63},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===256})}};_Ewa.QH=function(){_Ewa.QH.initializeBase(this)};_Ewa.QH.prototype={b:function(){return 12},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===32})}};_Ewa.QI=function(){_Ewa.QI.initializeBase(this)};_Ewa.QI.prototype={b:function(){return 108},c:function(){this.a(141)},e:function(){var n=this;this.d(function(n){return _Ewa.sa.isInstanceOfType(n)})}};_Ewa.QJ=function(){_Ewa.QJ.initializeBase(this,[10,128])};_Ewa.QK=function(){_Ewa.QK.initializeBase(this,[11,16])};_Ewa.QL=function(){_Ewa.QL.initializeBase(this)};_Ewa.QL.prototype={b:function(){return 61},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===1})}};_Ewa.QM=function(){_Ewa.QM.initializeBase(this)};_Ewa.QM.prototype={b:function(){return 62},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===8})}};_Ewa.Qi=function(){_Ewa.Qi.initializeBase(this)};_Ewa.Qi.prototype={b:function(){return 69},c:function(){this.a(190)}};_Ewa.QN=function(){_Ewa.QN.initializeBase(this)};_Ewa.QN.prototype={b:function(){return 103},c:function(){this.a(51)}};_Ewa.QO=function(){_Ewa.QO.initializeBase(this)};_Ewa.QO.prototype={b:function(){return 47},c:function(){this.a(148)}};_Ewa.QP=function(){_Ewa.QP.initializeBase(this)};_Ewa.QP.prototype={b:function(){return 91},c:function(){this.a(532)},e:function(){var n=this;this.d(function(n){var t=n;return t.shapeType!==95&&t.shapeType!==96&&t.shapeType!==97&&t.shapeType!==98&&t.shapeType!==100&&t.shapeType!==102&&t.shapeType!==103})}};_Ewa.QQ=function(){_Ewa.QQ.initializeBase(this)};_Ewa.QQ.prototype={b:function(){return 92},c:function(){this.a(531)}};_Ewa.QR=function(){_Ewa.QR.initializeBase(this,[193,4])};_Ewa.QS=function(){_Ewa.QS.initializeBase(this)};_Ewa.QS.prototype={b:function(){return 191},c:function(){this.a(581)},e:function(){var n=this;this.d(function(n){return _Ewa.sb.isInstanceOfType(n)})}};_Ewa.QT=function(){_Ewa.QT.initializeBase(this,[196,32])};_Ewa.bld=function(n,t){_Ewa.bld.initializeBase(this);this.n=n;this.o=t};_Ewa.bld.prototype={n:0,o:0,b:function(){return this.n},c:function(){this.a(581)},e:function(){var t=this,n;this.d(function(n){return _Ewa.ia.isInstanceOfType(n)&&n.shapeTextFormat.ValidMembers===4});n=this;this.d(function(t){return _Ewa.ia.isInstanceOfType(t)&&t.shapeTextFormat.Font.ValidMembers===n.o})}};_Ewa.QU=function(){_Ewa.QU.initializeBase(this,[197,1])};_Ewa.QV=function(){_Ewa.QV.initializeBase(this,[198,2])};_Ewa.QW=function(){_Ewa.QW.initializeBase(this)};_Ewa.QW.prototype={b:function(){return 199},c:function(){this.a(581)},e:function(){var n=this;this.d(function(n){return _Ewa.ia.isInstanceOfType(n)&&n.shapeTextFormat.ValidMembers===2})}};_Ewa.QX=function(){_Ewa.QX.initializeBase(this,[194,8])};_Ewa.QY=function(){_Ewa.QY.initializeBase(this,[195,16])};_Ewa.QZ=function(){_Ewa.QZ.initializeBase(this)};_Ewa.QZ.prototype={b:function(){return 200},c:function(){this.a(581)},e:function(){var n=this;this.d(function(n){return _Ewa.ia.isInstanceOfType(n)&&n.shapeTextFormat.ValidMembers===1})}};_Ewa.Ra=function(){_Ewa.Ra.initializeBase(this)};_Ewa.Ra.prototype={b:function(){return 13},c:function(){this.a(138)}};_Ewa.Rb=function(){_Ewa.Rb.initializeBase(this)};_Ewa.Rb.prototype={b:function(){return 142},c:function(){this.a(237)},e:function(){var i=this,n,t;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){var i=n,t=i.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return t.DeltaColumn<0&&!t.DeltaRow&&(!!t.InsertDeleteRange.FirstRow||t.InsertDeleteRange.LastRow!==1048575)||!t.DeltaColumn&&t.DeltaRow<0&&(!!t.InsertDeleteRange.FirstColumn||t.InsertDeleteRange.LastColumn!==16383)})}};_Ewa.Rc=function(){_Ewa.Rc.initializeBase(this)};_Ewa.Rc.prototype={b:function(){return 143},c:function(){this.a(237)},e:function(){var i=this,n,t;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){var i=n,t=i.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return t.DeltaColumn>0&&!t.DeltaRow&&(!!t.InsertDeleteRange.FirstRow||t.InsertDeleteRange.LastRow!==1048575)||!t.DeltaColumn&&t.DeltaRow>0&&(!!t.InsertDeleteRange.FirstColumn||t.InsertDeleteRange.LastColumn!==16383)})}};_Ewa.Rd=function(){_Ewa.Rd.initializeBase(this)};_Ewa.Rd.prototype={b:function(){return 139},c:function(){this.a(237)},e:function(){var f=this,n,t,i,r,u;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn<0});i=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});r=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});u=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===1048575})}};_Ewa.Re=function(){_Ewa.Re.initializeBase(this)};_Ewa.Re.prototype={b:function(){return 138},c:function(){this.a(237)},e:function(){var f=this,n,t,i,r,u;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn>0});i=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});r=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});u=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===1048575})}};_Ewa.Rf=function(){_Ewa.Rf.initializeBase(this)};_Ewa.Rf.prototype={b:function(){return 14},c:function(){this.a(137)}};_Ewa.Rg=function(){_Ewa.Rg.initializeBase(this)};_Ewa.Rg.prototype={b:function(){return 137},c:function(){this.a(185)}};_Ewa.Ri=function(){_Ewa.Ri.initializeBase(this)};_Ewa.Ri.prototype={b:function(){return 15},c:function(){this.a(207)}};_Ewa.Rj=function(){_Ewa.Rj.initializeBase(this)};_Ewa.Rj.prototype={b:function(){return 90},c:function(){this.a(151)}};_Ewa.Rk=function(){_Ewa.Rk.initializeBase(this)};_Ewa.Rk.prototype={b:function(){return 120},c:function(){this.a(226)}};_Ewa.Rl=function(){_Ewa.Rl.initializeBase(this)};_Ewa.Rl.prototype={b:function(){return 64},c:function(){this.a(557)}};_Ewa.Rm=function(){_Ewa.Rm.initializeBase(this)};_Ewa.Rm.prototype={b:function(){return 141},c:function(){this.a(237)},e:function(){var f=this,n,t,i,r,u;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});i=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow<0});r=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});u=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===16383})}};_Ewa.Rn=function(){_Ewa.Rn.initializeBase(this)};_Ewa.Rn.prototype={b:function(){return 140},c:function(){this.a(237)},e:function(){var f=this,n,t,i,r,u;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});i=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow>0});r=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});u=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===16383})}};_Ewa.Ro=function(){_Ewa.Ro.initializeBase(this)};_Ewa.Ro.prototype={b:function(){return 39},c:function(){this.a(135)}};_Ewa.Rp=function(){_Ewa.Rp.initializeBase(this)};_Ewa.Rp.prototype={b:function(){return 36},c:function(){this.a(136)}};_Ewa.Rr=function(){_Ewa.Rr.initializeBase(this)};_Ewa.Rr.prototype={b:function(){return 67},c:function(){this.a(184)}};_Ewa.Rq=function(){_Ewa.Rq.initializeBase(this)};_Ewa.Rq.prototype={b:function(){return 68},c:function(){this.a(183)}};_Ewa.Rt=function(){_Ewa.Rt.initializeBase(this)};_Ewa.Rt.prototype={b:function(){return 126},c:function(){this.a(239)}};_Ewa.Ru=function(){_Ewa.Ru.initializeBase(this)};_Ewa.Ru.prototype={b:function(){return 70},c:function(){this.a(515)}};_Ewa.Rv=function(){_Ewa.Rv.initializeBase(this)};_Ewa.Rv.prototype={b:function(){return 71},c:function(){this.a(157)}};_Ewa.Rs=function(){_Ewa.Rs.initializeBase(this)};_Ewa.Rs.prototype={b:function(){return 89},c:function(){this.a(213)}};_Ewa.Rw=function(){_Ewa.Rw.initializeBase(this)};_Ewa.Rw.prototype={b:function(){return 188},c:function(){this.a(203)}};_Ewa.Rx=function(){_Ewa.Rx.initializeBase(this)};_Ewa.Rx.prototype={b:function(){return 189},c:function(){this.a(173)},e:function(){var n=this;this.d(function(n){return!n.clearFilter})}};_Ewa.Ry=function(){_Ewa.Ry.initializeBase(this)};_Ewa.Ry.prototype={b:function(){return 190},c:function(){this.a(173)},e:function(){var n=this;this.d(function(n){return n.clearFilter})}};_Ewa.Rz=function(){_Ewa.Rz.initializeBase(this)};_Ewa.Rz.prototype={b:function(){return 27},c:function(){this.a(208)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.gn.a})}};_Ewa.RA=function(){_Ewa.RA.initializeBase(this)};_Ewa.RA.prototype={b:function(){return 144},c:function(){this.a(237)},e:function(){var r=this,n,t,i;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn<0});i=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})}};_Ewa.RB=function(){_Ewa.RB.initializeBase(this)};_Ewa.RB.prototype={b:function(){return 145},c:function(){this.a(237)},e:function(){var r=this,n,t,i;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn>0});i=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})}};_Ewa.RC=function(){_Ewa.RC.initializeBase(this)};_Ewa.RC.prototype={b:function(){return 121},c:function(){this.a(141)},e:function(){var n=this;this.d(function(n){return _Ewa.se.isInstanceOfType(n)})}};_Ewa.RD=function(){_Ewa.RD.initializeBase(this)};_Ewa.RD.prototype={b:function(){return 105},c:function(){this.a(193)}};_Ewa.RE=function(){_Ewa.RE.initializeBase(this)};_Ewa.RE.prototype={b:function(){return 16},c:function(){this.a(206)}};_Ewa.RF=function(){_Ewa.RF.initializeBase(this)};_Ewa.RF.prototype={b:function(){return 30},c:function(){this.a(209)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.gn.a})}};_Ewa.RG=function(){_Ewa.RG.initializeBase(this)};_Ewa.RG.prototype={b:function(){return 25},c:function(){this.a(187)},e:function(){var n=this;this.d(function(n){return n.options.OperationType===1})}};_Ewa.RH=function(){_Ewa.RH.initializeBase(this)};_Ewa.RH.prototype={b:function(){return 28},c:function(){this.a(176)},e:function(){var t=this,n;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.gn.a});n=this;this.d(function(n){return!n.autoFilterOptions.CriteriaType})}};_Ewa.RI=function(){_Ewa.RI.initializeBase(this)};_Ewa.RI.prototype={b:function(){return 32},c:function(){this.a(176)},e:function(){var t=this,n;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.gn.a});n=this;this.d(function(n){var i=n,t,r=(t=new($$sc.v.$$(_Ewa.DU)),t.b(1),t.b(2),t.b(8),t.b(9),t.b(10),t.b(11),t.b(12),t.b(13),t.b(14),t.b(15),t.b(16),t.b(17),t.b(18),t.b(19),t.b(20),t.b(21),t.b(22),t.b(23),t.b(24),t.b(25),t.b(26),t.b(27),t.b(28),t.b(29),t.b(30),t.b(31),t.b(32),t.b(33),t.b(34),t.b(35),t.b(36),t.b(37),t.b(38),t.b(39),t);return r.c(i.autoFilterOptions.CriteriaType)})}};_Ewa.RK=function(){_Ewa.RK.initializeBase(this)};_Ewa.RK.prototype={b:function(){return 73},c:function(){this.a(211)}};_Ewa.RJ=function(){_Ewa.RJ.initializeBase(this)};_Ewa.RJ.prototype={b:function(){return 101},c:function(){this.a(217)}};_Ewa.RL=function(){_Ewa.RL.initializeBase(this)};_Ewa.RL.prototype={b:function(){return 44},c:function(){this.a(514)}};_Ewa.RM=function(){_Ewa.RM.initializeBase(this)};_Ewa.RM.prototype={b:function(){return 146},c:function(){this.a(237)},e:function(){var r=this,n,t,i;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});i=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow<0})}};_Ewa.RN=function(){_Ewa.RN.initializeBase(this)};_Ewa.RN.prototype={b:function(){return 147},c:function(){this.a(237)},e:function(){var r=this,n,t,i;this.d(function(n){return!!n.insertDeleteMultiRangeParameters});n=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.IsTableCommand});t=this;this.d(function(n){return!n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});i=this;this.d(function(n){return n.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow>0})}};_Ewa.RO=function(){_Ewa.RO.initializeBase(this)};_Ewa.RO.prototype={b:function(){return 26},c:function(){this.a(177)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.gn.a})}};_Ewa.RP=function(){_Ewa.RP.initializeBase(this)};_Ewa.RP.prototype={b:function(){return 87},c:function(){this.a(212)}};_Ewa.RQ=function(){_Ewa.RQ.initializeBase(this)};_Ewa.RQ.prototype={b:function(){return 88},c:function(){this.a(196)}};_Ewa.RR=function(){_Ewa.RR.initializeBase(this)};_Ewa.RR.prototype={b:function(){return 31},c:function(){this.a(210)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.gn.a})}};_Ewa.Rh=function(){_Ewa.Rh.initializeBase(this)};_Ewa.Rh.prototype={b:function(){return 54},c:function(){this.a(139)}};_Ewa.RT=function(){_Ewa.RT.initializeBase(this)};_Ewa.RT.prototype={b:function(){return 128},c:function(){this.a(559)}};_Ewa.RU=function(){_Ewa.RU.initializeBase(this)};_Ewa.RU.prototype={b:function(){return 55},c:function(){this.a(197)}};_Ewa.RX=function(){_Ewa.RX.initializeBase(this)};_Ewa.RX.prototype={b:function(){return 56},c:function(){this.a(128)}};_Ewa.RV=function(){_Ewa.RV.initializeBase(this)};_Ewa.RV.prototype={b:function(){return 33},c:function(){this.a(181)},e:function(){var n=this;this.d(function(n){return!n.parentCommentId})}};_Ewa.RW=function(){_Ewa.RW.initializeBase(this)};_Ewa.RW.prototype={b:function(){return 34},c:function(){this.a(181)},e:function(){var n=this;this.d(function(n){return!!n.parentCommentId})}};_Ewa.RZ=function(){_Ewa.RZ.initializeBase(this)};_Ewa.RZ.prototype={b:function(){return 45},c:function(){this.a(170)}};_Ewa.RY=function(){_Ewa.RY.initializeBase(this)};_Ewa.RY.prototype={b:function(){return 46},c:function(){this.a(171)}};_Ewa.gn=function(){};_Ewa.pu=function(){};_Ewa.pu.prototype={m:null,l:null,j:null,i:null,p:function(){return this.l||(this.l=new($$sc.v.$$(_Ewa.jD)),this.c()),this.l},k:function(){return this.m||(this.m=new($$sc.v.$$(Function)),this.e()),this.m},q:function(){return this.i||(this.i=new($$sc.v.$$(String)),this.s()),this.i},r:function(){return this.j||(this.j=new($$sc.v.$$(_Ewa.Eb)),this.f()),this.j},e:function(){},f:function(){},s:function(){},d:function(n){this.k().b(n)},a:function(n){this.p().c(n)||this.p().b(n)},h:function(n){this.r().b(n)},g:function(n){this.q().b(n)}};_Ewa.go=function(n){this.b=n};_Ewa.go.c=function(){if(!_Ewa.go.a){var n;_Ewa.go.a=(n=new($$sc.v.$$(_Ewa.pu)),n.b(new _Ewa.kn),n.b(new _Ewa.ko),n)}return _Ewa.go.a};_Ewa.go.e=function(n,t){return t.p().c(n.a())};_Ewa.go.f=function(n,t){var u=t.k(),i,r,f;if(!u.f.length)return!0;for(i=!0,r=u.$$lge();r.$$mn();)if(f=r.$$cu(),!f(n.b())){i=!1;break}return i};_Ewa.go.d=function(n){for(var t=n.a(0),r=n.$$lge(),i;r.$$mn();)i=r.$$cu(),i.k().f.length>t.k().f.length&&(t=i);return t};_Ewa.go.prototype={a:null,b:null,f:function(){if(!this.a){var n;this.a=(n=new($$sc.v.$$(_Ewa.pu)),n.b(new _Ewa.Qj),n.b(new _Ewa.PZ),n.b(new _Ewa.PY),n.b(new _Ewa.Qh),n.b(new _Ewa.Qq),n.b(new _Ewa.Qw),n.b(new _Ewa.Qx),n.b(new _Ewa.Qy),n.b(new _Ewa.Qz),n.b(new _Ewa.QJ),n.b(new _Ewa.QK),n.b(new _Ewa.QH),n.b(new _Ewa.Ra),n.b(new _Ewa.Rf),n.b(new _Ewa.Ri),n.b(new _Ewa.RE),n.b(new _Ewa.RA),n.b(new _Ewa.RB),n.b(new _Ewa.RM),n.b(new _Ewa.RN),n.b(new _Ewa.Re),n.b(new _Ewa.Rd),n.b(new _Ewa.Rn),n.b(new _Ewa.Rm),n.b(new _Ewa.RG),n.b(new _Ewa.RO),n.b(new _Ewa.Rz),n.b(new _Ewa.RH),n.b(new _Ewa.Qd),n.b(new _Ewa.RF),n.b(new _Ewa.RR),n.b(new _Ewa.RI),n.b(new _Ewa.RV),n.b(new _Ewa.RW),n.b(new _Ewa.Pp),n.b(new _Ewa.Rp),n.b(new _Ewa.Rb),n.b(new _Ewa.Rc),n.b(new _Ewa.Ro),n.b(new _Ewa.Qe),n.b(new _Ewa.Qu),n.b(new _Ewa.QD),n.b(new _Ewa.Pr),n.b(new _Ewa.RL),n.b(new _Ewa.RY),n.b(new _Ewa.RZ),n.b(new _Ewa.QO),n.b(new _Ewa.OR),n.b(new _Ewa.Pn),n.b(new _Ewa.QF),n.b(new _Ewa.Rh),n.b(new _Ewa.RU),n.b(new _Ewa.RX),n.b(new _Ewa.PX),n.b(new _Ewa.Qt),n.b(new _Ewa.Qr),n.b(new _Ewa.QC),n.b(new _Ewa.QL),n.b(new _Ewa.QM),n.b(new _Ewa.QE),n.b(new _Ewa.Rl),n.b(new _Ewa.OB),n.b(new _Ewa.OJ),n.b(new _Ewa.Rr),n.b(new _Ewa.Rq),n.b(new _Ewa.Qi),n.b(new _Ewa.Rv),n.b(new _Ewa.Ru),n.b(new _Ewa.RK),n.b(new _Ewa.QA),n.b(new _Ewa.OL),n.b(new _Ewa.OG),n.b(new _Ewa.Qo),n.b(new _Ewa.ON),n.b(new _Ewa.OM),n.b(new _Ewa.OE),n.b(new _Ewa.OK),n.b(new _Ewa.OF),n.b(new _Ewa.OH),n.b(new _Ewa.OD),n.b(new _Ewa.OI),n.b(new _Ewa.Qv),n.b(new _Ewa.RP),n.b(new _Ewa.RQ),n.b(new _Ewa.Rs),n.b(new _Ewa.Rj),n.b(new _Ewa.QP),n.b(new _Ewa.QQ),n.b(new _Ewa.OT),n.b(new _Ewa.OU),n.b(new _Ewa.OV),n.b(new _Ewa.OS),n.b(new _Ewa.QB),n.b(new _Ewa.PB),n.b(new _Ewa.Pi),n.b(new _Ewa.OW),n.b(new _Ewa.RJ),n.b(new _Ewa.PL),n.b(new _Ewa.QN),n.b(new _Ewa.PO),n.b(new _Ewa.RD),n.b(new _Ewa.Qg),n.b(new _Ewa.QG),n.b(new _Ewa.QI),n.b(new _Ewa.Qb),n.b(new _Ewa.Po),n.b(new _Ewa.Pq),n.b(new _Ewa.Pm),n.b(new _Ewa.Qa),n.b(new _Ewa.Qf),n.b(new _Ewa.Qs),n.b(new _Ewa.OC),n.b(new _Ewa.Pt),n.b(new _Ewa.Ql),n.b(new _Ewa.Rk),n.b(new _Ewa.RC),n.b(new _Ewa.Qc),n.b(new _Ewa.Rt),n.b(new _Ewa.Pc),n.b(new _Ewa.RT),n.b(new _Ewa.OQ),n.b(new _Ewa.Oz),n.b(new _Ewa.OO),n.b(new _Ewa.Pf),n.b(new _Ewa.Ps),n.b(new _Ewa.Pd),n.b(new _Ewa.OY),n.b(new _Ewa.Rg),n.b(new _Ewa.OZ),n.b(new _Ewa.PM),n.b(new _Ewa.Pu),n.b(new _Ewa.OX),n.b(new _Ewa.PS),n.b(new _Ewa.Pj),n.b(new _Ewa.Pk),n.b(new _Ewa.Pl),n.b(new _Ewa.PW),n.b(new _Ewa.OA),n.b(new _Ewa.PV),n.b(new _Ewa.Pg),n.b(new _Ewa.Qn),n.b(new _Ewa.Qk),n.b(new _Ewa.Qp),n.b(new _Ewa.Pe),n.b(new _Ewa.Ph),n.b(new _Ewa.PP),n.b(new _Ewa.PQ),n.b(new _Ewa.PA),n.b(new _Ewa.Pv),n.b(new _Ewa.Pz),n.b(new _Ewa.Py),n.b(new _Ewa.PF),n.b(new _Ewa.PI),n.b(new _Ewa.PH),n.b(new _Ewa.PC),n.b(new _Ewa.PD),n.b(new _Ewa.PE),n.b(new _Ewa.PK),n.b(new _Ewa.PR),n.b(new _Ewa.PN),n.b(new _Ewa.Px),n.b(new _Ewa.Pw),n.b(new _Ewa.PT),n.b(new _Ewa.PJ),n.b(new _Ewa.PG),n.b(new _Ewa.Rw),n.b(new _Ewa.Rx),n.b(new _Ewa.Ry),n.b(new _Ewa.QS),n.b(new _Ewa.QR),n.b(new _Ewa.QX),n.b(new _Ewa.QY),n.b(new _Ewa.QT),n.b(new _Ewa.QU),n.b(new _Ewa.QV),n.b(new _Ewa.QW),n.b(new _Ewa.QZ),n.b(new _Ewa.Qm),n.b(new _Ewa.PU),n.b(new _Ewa.RS),n);_Ewa.a.a("OfficeVSO:4825267_RemoveDisabledEvents")&&this.g()}return this.a},c:function(n,t){var i=this.d(n,this.f(),t);return i||(i=this.d(n,_Ewa.go.c(),t),!i&&this.e(n,_Ewa.go.b,t)&&(i=_Ewa.go.b)),i},d:function(n,t,i){for(var r=new($$sc.v.$$(_Ewa.pu)),f=t.$$lge(),u;f.$$mn();)u=f.$$cu(),this.e(n,u,i)&&r.b(u);return r.f.length===1?r.a(0):r.f.length>1?_Ewa.go.d(r):null},e:function(n,t,i){var r=_Ewa.go.e(n,t);return i?r&&_Ewa.go.f(n,t):r},g:function(){for(var t=new($$sc.v.$$(_Ewa.pu)),u=this.a.$$lge(),o,i,s,r,h;u.$$mn();){for(var n=u.$$cu(),f=!1,e=n.r().$$lge();e.$$mn();)if(o=e.$$cu(),!_Ewa.a.b(o)){t.b(n);f=!0;break}if(!f)for(i=n.q().$$lge();i.$$mn();)if(s=i.$$cu(),!_Ewa.a.c(s,!1)){t.b(n);break}}for(r=t.$$lge();r.$$mn();)h=r.$$cu(),this.a.e(h)}};_Ewa.Pa=function(){};_Ewa.Pa.prototype={a:null,b:function(){if(!this.a){var n;this.a=(n=new($$sc.v.$$(_Ewa.jD)),n.b(12),n.b(11),n)}return this.a},c:function(n){return this.b().c(n.a())},d:function(n){for(var u,i=[],f=n.b(),r=f.batchedOperations,e=r.length,t=0;t<e;++t)u=r[t],i.push(new _Ewa.rV(n.a(),u));return i}};_Ewa.W=function(){};_Ewa.W.b=function(){return _Ewa.W.a||(_Ewa.W.a=new($$sc.n.$$(_Ewa.jD))(new _Ewa.W.c),_Ewa.W.a.a(507),_Ewa.W.a.a(10),_Ewa.W.a.a(576),_Ewa.W.a.a(563),_Ewa.W.a.a(564),_Ewa.W.a.a(565),_Ewa.W.a.a(566),_Ewa.W.a.a(567),_Ewa.W.a.a(568),_Ewa.W.a.a(569),_Ewa.W.a.a(570),_Ewa.W.a.a(571),_Ewa.W.a.a(572),_Ewa.W.a.a(573),_Ewa.W.a.a(574),_Ewa.W.a.a(575),_Ewa.W.a.a(501),_Ewa.W.a.a(520),_Ewa.W.a.a(1),_Ewa.W.a.a(1002),_Ewa.W.a.a(129),_Ewa.W.a.a(198),_Ewa.W.a.a(500),_Ewa.W.a.a(519),_Ewa.W.a.a(538),_Ewa.W.a.a(1e3),_Ewa.W.a.a(1003),_Ewa.W.a.a(144),_Ewa.W.a.a(502),_Ewa.W.a.a(505),_Ewa.W.a.a(179),_Ewa.W.a.a(205),_Ewa.W.a.a(134),_Ewa.W.a.a(230),_Ewa.W.a.a(103),_Ewa.W.a.a(110),_Ewa.W.a.a(112),_Ewa.W.a.a(113),_Ewa.W.a.a(124),_Ewa.W.a.a(133),_Ewa.W.a.a(154),_Ewa.W.a.a(162),_Ewa.W.a.a(168),_Ewa.W.a.a(172),_Ewa.W.a.a(201),_Ewa.W.a.a(222),_Ewa.W.a.a(227),_Ewa.W.a.a(513),_Ewa.W.a.a(534),_Ewa.W.a.a(539),_Ewa.W.a.a(545),_Ewa.W.a.a(547),_Ewa.W.a.a(555),_Ewa.W.a.a(558),_Ewa.W.a.a(562),_Ewa.W.a.a(585),_Ewa.W.a.a(1001),_Ewa.W.a.a(1005),_Ewa.W.a.a(1008),_Ewa.W.a.a(1010),_Ewa.W.a.a(1011),_Ewa.W.a.a(1012),_Ewa.W.a.a(1018),_Ewa.W.a.a(252),_Ewa.W.a.a(253),_Ewa.W.a.a(258),_Ewa.W.a.a(101),_Ewa.W.a.a(102),_Ewa.W.a.a(108),_Ewa.W.a.a(118),_Ewa.W.a.a(257),_Ewa.W.a.a(119),_Ewa.W.a.a(120),_Ewa.W.a.a(123),_Ewa.W.a.a(126),_Ewa.W.a.a(127),_Ewa.W.a.a(130),_Ewa.W.a.a(140),_Ewa.W.a.a(159),_Ewa.W.a.a(160),_Ewa.W.a.a(165),_Ewa.W.a.a(166),_Ewa.W.a.a(167),_Ewa.W.a.a(169),_Ewa.W.a.a(189),_Ewa.W.a.a(223),_Ewa.W.a.a(214),_Ewa.W.a.a(228),_Ewa.W.a.a(233),_Ewa.W.a.a(247),_Ewa.W.a.a(504),_Ewa.W.a.a(511),_Ewa.W.a.a(512),_Ewa.W.a.a(525),_Ewa.W.a.a(533),_Ewa.W.a.a(535),_Ewa.W.a.a(537),_Ewa.W.a.a(542),_Ewa.W.a.a(544),_Ewa.W.a.a(548),_Ewa.W.a.a(550),_Ewa.W.a.a(551),_Ewa.W.a.a(552),_Ewa.W.a.a(554),_Ewa.W.a.a(577),_Ewa.W.a.a(584),_Ewa.W.a.a(586),_Ewa.W.a.a(587),_Ewa.W.a.a(588),_Ewa.W.a.a(592),_Ewa.W.a.a(1009),_Ewa.W.a.a(1016),_Ewa.W.a.a(1017)),_Ewa.W.a};_Ewa.W.c=function(){};_Ewa.W.c.prototype={a:function(n,t){return n===t},b:function(n){return n}};_Ewa.zr.registerClass("_Ewa.zr",_Ewa.sX.$$(_Ewa.lS));_Ewa.pu.registerClass("_Ewa.pu");_Ewa.Oz.registerClass("_Ewa.Oz",_Ewa.pu);_Ewa.OA.registerClass("_Ewa.OA",_Ewa.pu);_Ewa.OB.registerClass("_Ewa.OB",_Ewa.pu);_Ewa.OC.registerClass("_Ewa.OC",_Ewa.pu);_Ewa.OO.registerClass("_Ewa.OO",_Ewa.pu);_Ewa.OQ.registerClass("_Ewa.OQ",_Ewa.pu);_Ewa.OR.registerClass("_Ewa.OR",_Ewa.pu);_Ewa.OS.registerClass("_Ewa.OS",_Ewa.pu);_Ewa.OT.registerClass("_Ewa.OT",_Ewa.pu);_Ewa.OU.registerClass("_Ewa.OU",_Ewa.pu);_Ewa.OV.registerClass("_Ewa.OV",_Ewa.pu);_Ewa.bkY.registerClass("_Ewa.bkY",_Ewa.pu);_Ewa.OD.registerClass("_Ewa.OD",_Ewa.bkY);_Ewa.OE.registerClass("_Ewa.OE",_Ewa.bkY);_Ewa.OF.registerClass("_Ewa.OF",_Ewa.bkY);_Ewa.OG.registerClass("_Ewa.OG",_Ewa.bkY);_Ewa.OH.registerClass("_Ewa.OH",_Ewa.bkY);_Ewa.kn.registerClass("_Ewa.kn",_Ewa.pu);_Ewa.OI.registerClass("_Ewa.OI",_Ewa.bkY);_Ewa.Qv.registerClass("_Ewa.Qv",_Ewa.pu);_Ewa.OJ.registerClass("_Ewa.OJ",_Ewa.pu);_Ewa.OK.registerClass("_Ewa.OK",_Ewa.bkY);_Ewa.OL.registerClass("_Ewa.OL",_Ewa.bkY);_Ewa.OM.registerClass("_Ewa.OM",_Ewa.bkY);_Ewa.ON.registerClass("_Ewa.ON",_Ewa.bkY);_Ewa.OP.registerClass("_Ewa.OP",_Ewa.pu);_Ewa.OW.registerClass("_Ewa.OW",_Ewa.pu);_Ewa.OX.registerClass("_Ewa.OX",_Ewa.pu);_Ewa.ko.registerClass("_Ewa.ko",_Ewa.pu);_Ewa.OY.registerClass("_Ewa.OY",_Ewa.pu);_Ewa.OZ.registerClass("_Ewa.OZ",_Ewa.pu);_Ewa.Pc.registerClass("_Ewa.Pc",_Ewa.pu);_Ewa.RS.registerClass("_Ewa.RS",_Ewa.pu);_Ewa.Pd.registerClass("_Ewa.Pd",_Ewa.pu);_Ewa.Pe.registerClass("_Ewa.Pe",_Ewa.pu);_Ewa.Pf.registerClass("_Ewa.Pf",_Ewa.pu);_Ewa.Pg.registerClass("_Ewa.Pg",_Ewa.pu);_Ewa.Ph.registerClass("_Ewa.Ph",_Ewa.pu);_Ewa.Pi.registerClass("_Ewa.Pi",_Ewa.pu);_Ewa.Pj.registerClass("_Ewa.Pj",_Ewa.pu);_Ewa.Pk.registerClass("_Ewa.Pk",_Ewa.pu);_Ewa.Pl.registerClass("_Ewa.Pl",_Ewa.pu);_Ewa.Pm.registerClass("_Ewa.Pm",_Ewa.pu);_Ewa.Pn.registerClass("_Ewa.Pn",_Ewa.pu);_Ewa.Po.registerClass("_Ewa.Po",_Ewa.pu);_Ewa.Pp.registerClass("_Ewa.Pp",_Ewa.pu);_Ewa.Pq.registerClass("_Ewa.Pq",_Ewa.pu);_Ewa.Pr.registerClass("_Ewa.Pr",_Ewa.pu);_Ewa.Ps.registerClass("_Ewa.Ps",_Ewa.pu);_Ewa.Pt.registerClass("_Ewa.Pt",_Ewa.pu);_Ewa.Pu.registerClass("_Ewa.Pu",_Ewa.pu);_Ewa.PB.registerClass("_Ewa.PB",_Ewa.pu);_Ewa.PL.registerClass("_Ewa.PL",_Ewa.pu);_Ewa.PM.registerClass("_Ewa.PM",_Ewa.pu);_Ewa.PO.registerClass("_Ewa.PO",_Ewa.pu);_Ewa.blb.registerClass("_Ewa.blb",_Ewa.pu);_Ewa.PP.registerClass("_Ewa.PP",_Ewa.blb);_Ewa.PQ.registerClass("_Ewa.PQ",_Ewa.blb);_Ewa.PA.registerClass("_Ewa.PA",_Ewa.blb);_Ewa.Pv.registerClass("_Ewa.Pv",_Ewa.blb);_Ewa.Pz.registerClass("_Ewa.Pz",_Ewa.blb);_Ewa.Py.registerClass("_Ewa.Py",_Ewa.blb);_Ewa.PF.registerClass("_Ewa.PF",_Ewa.blb);_Ewa.PH.registerClass("_Ewa.PH",_Ewa.blb);_Ewa.PI.registerClass("_Ewa.PI",_Ewa.blb);_Ewa.PC.registerClass("_Ewa.PC",_Ewa.blb);_Ewa.PD.registerClass("_Ewa.PD",_Ewa.blb);_Ewa.PE.registerClass("_Ewa.PE",_Ewa.blb);_Ewa.PK.registerClass("_Ewa.PK",_Ewa.blb);_Ewa.PR.registerClass("_Ewa.PR",_Ewa.blb);_Ewa.PN.registerClass("_Ewa.PN",_Ewa.blb);_Ewa.Px.registerClass("_Ewa.Px",_Ewa.blb);_Ewa.Pw.registerClass("_Ewa.Pw",_Ewa.blb);_Ewa.PT.registerClass("_Ewa.PT",_Ewa.blb);_Ewa.PJ.registerClass("_Ewa.PJ",_Ewa.blb);_Ewa.PG.registerClass("_Ewa.PG",_Ewa.blb);_Ewa.PS.registerClass("_Ewa.PS",_Ewa.pu);_Ewa.PU.registerClass("_Ewa.PU",_Ewa.pu);_Ewa.PV.registerClass("_Ewa.PV",_Ewa.pu);_Ewa.PW.registerClass("_Ewa.PW",_Ewa.pu);_Ewa.blc.registerClass("_Ewa.blc",_Ewa.pu);_Ewa.PX.registerClass("_Ewa.PX",_Ewa.pu);_Ewa.PY.registerClass("_Ewa.PY",_Ewa.blc);_Ewa.PZ.registerClass("_Ewa.PZ",_Ewa.pu);_Ewa.Qb.registerClass("_Ewa.Qb",_Ewa.pu);_Ewa.Qc.registerClass("_Ewa.Qc",_Ewa.pu);_Ewa.Qa.registerClass("_Ewa.Qa",_Ewa.pu);_Ewa.Qd.registerClass("_Ewa.Qd",_Ewa.pu);_Ewa.Qe.registerClass("_Ewa.Qe",_Ewa.pu);_Ewa.Qf.registerClass("_Ewa.Qf",_Ewa.pu);_Ewa.Qg.registerClass("_Ewa.Qg",_Ewa.pu);_Ewa.Qh.registerClass("_Ewa.Qh",_Ewa.blc);_Ewa.Qj.registerClass("_Ewa.Qj",_Ewa.pu);_Ewa.Ql.registerClass("_Ewa.Ql",_Ewa.pu);_Ewa.Qo.registerClass("_Ewa.Qo",_Ewa.pu);_Ewa.Qn.registerClass("_Ewa.Qn",_Ewa.pu);_Ewa.Qk.registerClass("_Ewa.Qk",_Ewa.pu);_Ewa.Qp.registerClass("_Ewa.Qp",_Ewa.pu);_Ewa.Qm.registerClass("_Ewa.Qm",_Ewa.pu);_Ewa.Qq.registerClass("_Ewa.Qq",_Ewa.pu);_Ewa.Qr.registerClass("_Ewa.Qr",_Ewa.pu);_Ewa.Qs.registerClass("_Ewa.Qs",_Ewa.pu);_Ewa.Qt.registerClass("_Ewa.Qt",_Ewa.pu);_Ewa.Qu.registerClass("_Ewa.Qu",_Ewa.pu);_Ewa.Qw.registerClass("_Ewa.Qw",_Ewa.blc);_Ewa.Qx.registerClass("_Ewa.Qx",_Ewa.blc);_Ewa.Qy.registerClass("_Ewa.Qy",_Ewa.blc);_Ewa.Qz.registerClass("_Ewa.Qz",_Ewa.blc);_Ewa.QA.registerClass("_Ewa.QA",_Ewa.pu);_Ewa.QB.registerClass("_Ewa.QB",_Ewa.pu);_Ewa.QC.registerClass("_Ewa.QC",_Ewa.pu);_Ewa.QF.registerClass("_Ewa.QF",_Ewa.pu);_Ewa.QG.registerClass("_Ewa.QG",_Ewa.pu);_Ewa.QD.registerClass("_Ewa.QD",_Ewa.pu);_Ewa.QE.registerClass("_Ewa.QE",_Ewa.pu);_Ewa.QH.registerClass("_Ewa.QH",_Ewa.pu);_Ewa.QI.registerClass("_Ewa.QI",_Ewa.pu);_Ewa.QJ.registerClass("_Ewa.QJ",_Ewa.blc);_Ewa.QK.registerClass("_Ewa.QK",_Ewa.blc);_Ewa.QL.registerClass("_Ewa.QL",_Ewa.pu);_Ewa.QM.registerClass("_Ewa.QM",_Ewa.pu);_Ewa.Qi.registerClass("_Ewa.Qi",_Ewa.pu);_Ewa.QN.registerClass("_Ewa.QN",_Ewa.pu);_Ewa.QO.registerClass("_Ewa.QO",_Ewa.pu);_Ewa.QP.registerClass("_Ewa.QP",_Ewa.pu);_Ewa.QQ.registerClass("_Ewa.QQ",_Ewa.pu);_Ewa.bld.registerClass("_Ewa.bld",_Ewa.pu);_Ewa.QR.registerClass("_Ewa.QR",_Ewa.bld);_Ewa.QS.registerClass("_Ewa.QS",_Ewa.pu);_Ewa.QT.registerClass("_Ewa.QT",_Ewa.bld);_Ewa.QU.registerClass("_Ewa.QU",_Ewa.bld);_Ewa.QV.registerClass("_Ewa.QV",_Ewa.bld);_Ewa.QW.registerClass("_Ewa.QW",_Ewa.pu);_Ewa.QX.registerClass("_Ewa.QX",_Ewa.bld);_Ewa.QY.registerClass("_Ewa.QY",_Ewa.bld);_Ewa.QZ.registerClass("_Ewa.QZ",_Ewa.pu);_Ewa.Ra.registerClass("_Ewa.Ra",_Ewa.pu);_Ewa.Rb.registerClass("_Ewa.Rb",_Ewa.pu);_Ewa.Rc.registerClass("_Ewa.Rc",_Ewa.pu);_Ewa.Rd.registerClass("_Ewa.Rd",_Ewa.pu);_Ewa.Re.registerClass("_Ewa.Re",_Ewa.pu);_Ewa.Rf.registerClass("_Ewa.Rf",_Ewa.pu);_Ewa.Rg.registerClass("_Ewa.Rg",_Ewa.pu);_Ewa.Ri.registerClass("_Ewa.Ri",_Ewa.pu);_Ewa.Rj.registerClass("_Ewa.Rj",_Ewa.pu);_Ewa.Rk.registerClass("_Ewa.Rk",_Ewa.pu);_Ewa.Rl.registerClass("_Ewa.Rl",_Ewa.pu);_Ewa.Rm.registerClass("_Ewa.Rm",_Ewa.pu);_Ewa.Rn.registerClass("_Ewa.Rn",_Ewa.pu);_Ewa.Ro.registerClass("_Ewa.Ro",_Ewa.pu);_Ewa.Rp.registerClass("_Ewa.Rp",_Ewa.pu);_Ewa.Rr.registerClass("_Ewa.Rr",_Ewa.pu);_Ewa.Rq.registerClass("_Ewa.Rq",_Ewa.pu);_Ewa.Rt.registerClass("_Ewa.Rt",_Ewa.pu);_Ewa.Ru.registerClass("_Ewa.Ru",_Ewa.pu);_Ewa.Rv.registerClass("_Ewa.Rv",_Ewa.pu);_Ewa.Rs.registerClass("_Ewa.Rs",_Ewa.pu);_Ewa.Rw.registerClass("_Ewa.Rw",_Ewa.pu);_Ewa.Rx.registerClass("_Ewa.Rx",_Ewa.pu);_Ewa.Ry.registerClass("_Ewa.Ry",_Ewa.pu);_Ewa.Rz.registerClass("_Ewa.Rz",_Ewa.pu);_Ewa.RA.registerClass("_Ewa.RA",_Ewa.pu);_Ewa.RB.registerClass("_Ewa.RB",_Ewa.pu);_Ewa.RC.registerClass("_Ewa.RC",_Ewa.pu);_Ewa.RD.registerClass("_Ewa.RD",_Ewa.pu);_Ewa.RE.registerClass("_Ewa.RE",_Ewa.pu);_Ewa.RF.registerClass("_Ewa.RF",_Ewa.pu);_Ewa.RG.registerClass("_Ewa.RG",_Ewa.pu);_Ewa.RH.registerClass("_Ewa.RH",_Ewa.pu);_Ewa.RI.registerClass("_Ewa.RI",_Ewa.pu);_Ewa.RK.registerClass("_Ewa.RK",_Ewa.pu);_Ewa.RJ.registerClass("_Ewa.RJ",_Ewa.pu);_Ewa.RL.registerClass("_Ewa.RL",_Ewa.pu);_Ewa.RM.registerClass("_Ewa.RM",_Ewa.pu);_Ewa.RN.registerClass("_Ewa.RN",_Ewa.pu);_Ewa.RO.registerClass("_Ewa.RO",_Ewa.pu);_Ewa.RP.registerClass("_Ewa.RP",_Ewa.pu);_Ewa.RQ.registerClass("_Ewa.RQ",_Ewa.pu);_Ewa.RR.registerClass("_Ewa.RR",_Ewa.pu);_Ewa.Rh.registerClass("_Ewa.Rh",_Ewa.pu);_Ewa.RT.registerClass("_Ewa.RT",_Ewa.pu);_Ewa.RU.registerClass("_Ewa.RU",_Ewa.pu);_Ewa.RX.registerClass("_Ewa.RX",_Ewa.pu);_Ewa.RV.registerClass("_Ewa.RV",_Ewa.pu);_Ewa.RW.registerClass("_Ewa.RW",_Ewa.pu);_Ewa.RZ.registerClass("_Ewa.RZ",_Ewa.pu);_Ewa.RY.registerClass("_Ewa.RY",_Ewa.pu);_Ewa.kn.a=null;_Ewa.ko.a=null;_Ewa.gn.a="Table";_Ewa.gn.b="Sheet";_Ewa.go.a=null;_Ewa.go.b=new _Ewa.OP;_Ewa.W.a=null;Type.registerNamespace("_Ewa");_Ewa.bkZ=function(){};_Ewa.bkZ.a=function(){_Ewa.m.a(function(n){_Ewa.zr.a(n)})};_Ewa.bkZ.a();Type.registerNamespace("_Ewa");_Ewa.EF=function(n,t){this.b=n;this.c=t};_Ewa.EF.prototype={b:null,c:null,a:function(n){var t,i;if(isNullOrUndefined(n))return null;if(t=null,n==="gridMenuId")t="ContextMenuCell";else return null;return i=this.b.b(),this.e(i,t),i},e:function(n,t){for(var f=this.c.b(t),i=f.$$lge(),u;i.$$mn();)for(var e=i.$$cu(),o=e.a(),r=o.$$lge();r.$$mn();)u=r.$$cu(),this.d(n,u)},d:function(n,t){var r=t.a().Id,o=t.a().Alt,u=t.a().Image16by16,f="Image16by16",e=t.a().Command,i;CommandUI.a.a(u)&&(f="None");t.b().f.length>0?(e=798637440,i=this.b.d(r,r,o,e),i.k(f,u,null),this.f(i.a(),t),Array.add(n.a(),i)):Array.add(n.a(),this.b.f(r,o,e,u,f,null,!1,null,!1))},f:function(n,t){for(var r=null,u=this.b.b(),f=t.b().$$lge();f.$$mn();){var i=f.$$cu(),s=i.a().Id,h=i.a().Alt,e=i.a().Image16by16,o="Image16by16",c=i.a().Command;CommandUI.a.a(e)&&(o="None");r=this.b.f(s,h,c,e,o,null,!1,null,!1);Array.add(u.a(),r)}Array.add(n.a(),u)}};_Ewa.EG=function(n,t){var i,r;this.e=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.p);_Ewa.EG.initializeBase(this,[!1]);this.a=t;this.b=n;this.j=n.l()+"OfficeAddinLabel-Medium14";i=this;this.b.a().c(_Ewa.ch,29,function(n){i.c=n;n.c(i)},null);this.b.b().g(this.h);this.a.l(this.f);r=this;this.b.a().c(_Ewa.uA,206,function(n){r.d=n;n.b(r.e)},null)};_Ewa.EG.prototype={a:null,b:null,j:null,c:null,d:null,l:function(n){this.es("LAC",n)},k:function(n){this.eu("LAC",n)},g:function(n,t){var i,r;return n!=="QueryAddinLabel"?!1:(t[CommandUI.Controls.c.LabelText]!==this.a.b&&(i=CommandUI.AddInCommands.o.a(this.a),t[CommandUI.Controls.c.LabelText]=i.a,t[CommandUI.Controls.c.Visible]=i.b,r=this,window.setTimeout(function(){r.m()},0)),!0)},i:function(){return!0},m:function(){this.b&&CommandUI.AddInCommands.o.b(this.a,this.b.q(),this.j,_Ewa.ClientStringManager.a().a(319),_Ewa.ClientStringManager.a().a(320))},dispose:function(){this.b.b().h(this.h);this.a.n(this.f);this.d&&(this.d.c(this.e),this.d=null);this.c&&(this.c.b(this),this.c=null);this.b=null;this.a=null;_Ewa.bW.prototype.dispose.call(this)},n:function(){this.a&&this.a.j()},o:function(){this.er("LAC",null,null)},p:function(n,t){var i=n.a();i||t&&t.b||this.c&&(this.c.b(this),this.c=null)}};_Ewa.ok=function(){this.j={tabhome:"Ribbon.Home",tabinsert:"Ribbon.Insert",tabdata:"Ribbon.Data",tabreview:"Ribbon.Review",tabview:"Ribbon.View"};this.i={tabpagelayoutexcel:["Ribbon.PageLayoutExcel",_Ewa.ClientStringManager.a().a(1553),_Ewa.ClientStringManager.a().a(1557)],tabformulas:["Ribbon.Formulas",_Ewa.ClientStringManager.a().a(1554),_Ewa.ClientStringManager.a().a(1558)],tabdeveloper:["Ribbon.Developer",_Ewa.ClientStringManager.a().a(1555),_Ewa.ClientStringManager.a().a(1559)],tabaddins:["Ribbon.AddIns",_Ewa.ClientStringManager.a().a(1556),_Ewa.ClientStringManager.a().a(1560)]};this.k=["Ribbon.Home","Ribbon.Insert","Ribbon.PageLayoutExcel","Ribbon.Formulas","Ribbon.Data","Ribbon.Review","Ribbon.View","Ribbon.Developer","Ribbon.AddIns"]};_Ewa.ok.prototype={h:null,b:function(){return"SourceControlId"},a:function(){return"Workbook"},c:function(){return"DesktopFormFactor"},f:function(){return this.j},g:function(){var t,r,e;if(this.h)return this.h;this.h={};for(var u=Object.keys(this.j),o=u.length,n=0;n<o;++n)t=u[n],this.h[t]=this.j[t];for(var f=Object.keys(this.i),s=f.length,i=0;i<s;++i)r=f[i],e=this.i[r],this.h[r]=e[0];return this.h},e:function(){return this.k},d:function(){return this.i}};_Ewa.up=function(){};_Ewa.up.a=function(n,t,i,r,u,f){var e=n.a(9,null);return e.sharedInfo=t,_Ewa.k.a(n,"InsertAgaveTaskpane",e,i,r,u,f,0,null,null)};_Ewa.EH=function(n,t,i,r,u,f,e){this.p=Function.createDelegate(this,this.B);this.b=n;Diag.a.b(34936844,0,!isNullOrUndefined(t),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",_Ewa.cT.a(!0,null));this.c=t;this.l=i;this.g=r;this.e=u;this.h=f;this.d=new _Ewa.ok;this.k=new CommandUI.AddInCommands.F;this.n=e;Common.dB.a="WAC_Excel";this.i=new($$sc.v.$$(String));this.f=new($$sc.v.$$(String))};_Ewa.EH.prototype={l:null,e:null,d:null,g:null,h:null,k:null,n:null,m:!1,i:null,f:null,b:null,c:null,dispose:function(){isNullOrUndefined(this.h)||(this.h.dispose(),this.h=null);this.b=null;this.c=null;this.m=!0},a:function(n,t,i){var r=!1;switch(t){case 1402209562:r=this.F(i);break;default:r=!1}return r},z:function(){return!1},x:function(n,t,i){var r=_Ewa.g.c(),u=t.a,f,e;switch(u){case 843847158:break;case-2025863019:f=i.ak1.toString();e=this;CommandUI.AddInCommands.a.g(f,function(){_Ewa.c.a(e.b).q()});break;case-1777565636:_Ewa.fe.d(i.OsfcontrolId.toString());this.c.W(i.OsfcontrolId.toString());break;case 1592314317:_Ewa.fe.c(i.OsfcontrolId.toString());this.c.K(i.OsfcontrolId.toString());break;case 1402209562:r=this.v(i);break;case 407117407:this.o(i);break;case 1782110672:this.r(i);break;case 516359383:this.h.m();break;case 543799107:this.C();break;case 1949669462:this.e.k(!0,!0);break;case-1014260128:r=this.t(i);break;default:r=_Ewa.Y.a(u)}return r},w:function(n,t){var i=!1;switch(t.a){case 843847158:case-2025863019:case-1777565636:case 1592314317:case 1782110672:case 516359383:case 543799107:case 1949669462:case 407117407:case-1014260128:i=!0;break;case 1402209562:i=!Common.a.v}return i},y:function(){return!1},C:function(){var n,t,i,r;if(this.e.d<=0&&(this.e.j(),n=this.u(),n&&n.f.length>0))for(t=n.$$lge();t.$$mn();)i=t.$$cu(),r={ack1:i,ack0:4,ak0:(new Date).getTime()},this.r(r)},r:function(n){Diag.a.a(17408928,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",n.ack0,n.ack1);this.e.p();var t=this;window.setTimeout(function(){if(isNullOrUndefined(t.c))Diag.a.a(39613472,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",_Ewa.cT.a(!0,null)));else{var i=new CommandUI.AddInCommands.H(new CommandUI.AddInCommands.g(t.c.a()),CommandUI.AddInCommands.d.b(),CommandUI.AddInCommands.e.b());i&&(i.g(function(n,i){t.o(i.a)}),i.i(n))}},0)},o:function(n){var t,f,i,o,e,l,r,s,h,c,u;if(!this.m){Diag.a.a(17306637,220,50,"LaunchOperationType {0}.",n.ack0);try{if(_Ewa.a.b(190)&&(t=n.ack2,t&&t.f.length>0)){for(f=t.f.length,i=f-1;i>=0;i--)o=t.a(i),o.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&t.e(t.a(i));if(t.f.length<f&&(e=_Ewa.l.a(_Ewa.cR,this.b.a(),5,4,0,null),l=this,_Ewa.g.a(e,function(){e.a().a(33,null,null,null)},this.b.g(),3,null,null)),!t.f.length)return}if(isNullOrUndefined(this.c)){Diag.a.a(34936846,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",_Ewa.cT.a(!0,null)));return}r=null;Common.a.a.a("HostInstallAddInsIsEnabled")?(s=this,h=function(n,t){var i={};i.InstanceId=Common.br.a().toString();i.PrimaryMarketplace={};i.PrimaryMarketplace.MarketplaceRef=n.storeId;i.PrimaryMarketplace.MarketplaceType=n.currentStoreType;i.PrimaryMarketplace.SolutionId=n.assetId;i.PrimaryMarketplace.SolutionVersion=n.appVersion;i.WebExtensionType=1;s.c.X(i,function(){t(n)})},r=new CommandUI.AddInCommands.w(this.d,this.l,new CommandUI.AddInCommands.g(this.c.a()),new CommandUI.AddInCommands.A(this.b.l(),1402209562),this.e,CommandUI.AddInCommands.d.b(),this.k,h)):r=new CommandUI.AddInCommands.w(this.d,this.l,new CommandUI.AddInCommands.g(this.c.a()),new CommandUI.AddInCommands.A(this.b.l(),1402209562),this.e,CommandUI.AddInCommands.d.b(),this.k,null);r.a(this.p);c=this.b.a().a(_Ewa.hr,53,!1,null);c.a()&&(u=this,Common.App.AppLifecycleManager.get_instance().a(5,null,3).CW(function(){u.m||r.b(u.n,u.b.q(),n)}))}catch(a){Diag.a.a(17651478,220,10,String.format("LaunchAddinCommands error message : {0}.",a.message))}}},v:function(n){var t=_Ewa.g.c(),i=n[this.d.b()],r=this.g.a()(i),u=new _Ewa.fe(this.b,this.c,r.ownerAddinInfo,t,null);return this.q(t,i,r,u)},q:function(n,t,i,r){var o=this,u=function(){n=r.h()},f=this,e=function(){_Ewa.c.a(f.b).q()};return this.g.c(t,this.e,r,new CommandUI.AddInCommands.g(this.c.a()),i,u,e),n},s:function(n){var h=_Ewa.g.c(),r=this.c.c(n.assetId),f,e,u,o,i,a;if((!r||(f=this.c.b(r),!_Ewa.j.d(f)||!f.SharedRuntime.State))&&(e=this.g.b(),u=n.assetId in e?e[n.assetId]:null,u)){var t=this.g.a()(u),v=new _Ewa.fe(this.b,this.c,t.ownerAddinInfo,h,null),y=this,c=function(i){var r,e,o;if(i){r={};for(var s=i,c=s.length,f=0;f<c;++f)e=s[f],r[e[0]]=e[1];o="Office.AutoShowTaskpaneWithDocument"in r?r["Office.AutoShowTaskpaneWithDocument"]:null;o&&o.toLowerCase()==="true"&&(Diag.a.a(542185175,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.currentStoreType,n.storeId,Telemetry.PrivacyRules.GetAssetId(null!==t.ownerAddinInfo?t.ownerAddinInfo.storeType:n.currentStoreType,n.storeId,n.assetId,null,null)),y.q(h,u,t,v))}};if(Diag.a.a(542185174,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.currentStoreType,n.storeId,Telemetry.PrivacyRules.GetAssetId(null!==t.ownerAddinInfo?t.ownerAddinInfo.storeType:n.currentStoreType,n.storeId,n.assetId,null,null)),r)c(this.c.b(r).OsfPropertyBag);else if(o=this.b.b().j().WebExtensions,o)for(var l=o,p=l.length,s=0;s<p;++s)if(i=l[s],a=i.WebExtensionType===1?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent,a===n.targetType&&i.PrimaryMarketplace.MarketplaceType.toLowerCase()===n.currentStoreType.toLowerCase()&&i.PrimaryMarketplace.MarketplaceRef.toLowerCase()===n.storeId.toLowerCase()&&i.PrimaryMarketplace.SolutionId.toLowerCase()===n.assetId.toLowerCase()){c(i.OsfPropertyBag);break}}},j:function(n,t,i){if(n&&n.length){!i||t||this.i.c(n)||this.i.b(n);var r=this.f.c(n);r&&t&&this.f.e(n);r||t||this.f.b(n)}},D:function(n){var u=n.b(),f,e,s,i,l,a,v,y,p,w,t,nt,b,r,tt;if(u){if(u.a)for(f=u.a.$$lge();f.$$mn();)if(e=f.$$cu(),e.groups)for(var k=e.groups,it=k.length,o=0;o<it;++o)if(s=k[o],s.controls)for(var d=s.controls,rt=d.length,h=0;h<rt;++h)if(i=d[h],this.j(i.id,i.enabled,!0),i.controlType===1&&i.menuItems)for(var g=i.menuItems,ut=g.length,c=0;c<ut;++c)l=g[c],this.j(l.id,l.enabled,!0)}else if(n.a())for(a=n.a().$$lge();a.$$mn();)if(v=a.$$cu(),v.a())for(y=v.a().$$lge();y.$$mn();)if(p=y.$$cu(),p.a())for(w=p.a().$$lge();w.$$mn();)if(t=w.$$cu(),nt="Enabled"in t.a()?t.a().Enabled:!0,this.j(t.d||"",nt,!0),(t.f||"")==="FlyoutAnchor"&&t.b())for(b=t.b().$$lge();b.$$mn();)r=b.$$cu(),tt="Enabled"in r.a()?r.a().Enabled:!0,this.j(r.c||"",tt,!0)},B:function(n,t){var i=null;t&&(i=t);i&&i.b&&this.D(i.b);this.b.t();_Ewa.a.b(88)&&i&&i.a&&this.s(i.a)},u:function(){var n=new($$sc.v.$$(Common.di));return _Ewa.a.b(54)&&(this.b.b().e().a(27)&&(n.b(0),n.b(16)),this.b.b().e().a(33)&&n.b(1),n.b(8)),n},t:function(n){var t=!0;if(isNullOrUndefined(n)||isNullOrUndefined(n.DynamicAddinCommandsMethodDispatchId))return $$sc.a.a(Boolean,!1);switch(n.DynamicAddinCommandsMethodDispatchId){case 1:t=this.G(n);break;case 2:t=this.E(n);break;case 4:this.f.h();this.f.k(this.i);break;case 3:t=this.A(n);break;default:t=!1}return $$sc.a.a(Boolean,t)},F:function(n){if(!n||!(this.d.b()in n))return!1;var t=n[this.d.b()];return!t||!t.length?!1:this.f.c(t)},G:function(n){var i=null,f=null,r=null,u=!0;if(isNullOrUndefined(n.SolutionId)||isNullOrUndefined(n[this.d.b()])||isNullOrUndefined(n.MethodData)||(i=n.SolutionId,f=n.PrivacyCompliantSolutionId,r=n[this.d.b()],u=n.MethodData),!i||!i.length||!r||!r.length)return Diag.a.a(51515651,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;var o=new CommandUI.AddInCommands.b(this.b.l(),i,this.d,!0),e=o.b(r),t={};return t.DynamicAddinCommandsApiName="UpdateControlEnableState",t.AssetId=f,t.MaskedTabId=e,t.IsToEnable=u,Diag.a.a(51515652,220,15,_Ewa.E.a(t)),this.j(e,u,!1),_Ewa.dQ.a().c(!1),!0},E:function(n){var u=null,f=null,l=null,o=null,s=!0,r,h,c,a,e;if(isNullOrUndefined(n.StoreType)||isNullOrUndefined(n.SolutionId)||isNullOrUndefined(n[this.d.b()])||isNullOrUndefined(n.MethodData)||(u=n.StoreType,f=n.SolutionId,l=n.PrivacyCompliantSolutionId,o=n[this.d.b()],s=n.MethodData),!u||!u.length||!f||!f.length||!o||!o.length)return Diag.a.a(51515653,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;var v=new CommandUI.AddInCommands.b(this.b.l(),f,this.d,!0),t=v.c(o),i={};if(i.DynamicAddinCommandsApiName="SetRibbonTabVisible",i.StoreType=u,i.AssetId=l,i.MaskedTabId=t,i.IsToShow=s,Diag.a.a(51515654,220,15,_Ewa.E.a(i)),r=this.e.a(u,f,1),h=!1,r&&r.b&&r.b.b()&&r.b.b().a)for(c=r.b.b().a.$$lge();c.$$mn();)if(a=c.$$cu(),a.id===t){h=!0;break}return h?(e=new Array(0),s?appChrome.selectors.getSelectedTabId()!==t&&e.push(appChrome.actions.activateRibbonTab(t)):(appChrome.selectors.getSelectedTabId()===t&&e.push(appChrome.actions.setCurrentTab("Home")),e.push(appChrome.actions.deactivateRibbonTab(t))),appChrome.api.dispatch(e),!0):(Diag.a.a(591001285,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1)},A:function(n){var f=null,e=null,o=null,i=null,r,s,t,h,u;return(isNullOrUndefined(n.SolutionId)||isNullOrUndefined(n.MethodData)||(r=n.MethodData,f=n.SolutionId,isNullOrUndefined(r.OsfControl)||isNullOrUndefined(r.RibbonUpdaterData)||(e=r.OsfControl,o=r.RibbonUpdaterData,i=r.WebExtensionData)),!f||!f.length||!o||!e||!i)?(Diag.a.a(591971673,220,15,"InstallContextualTab failed to invalid parameters"),!1):(s=this.e.a(i.PrimaryMarketplace.MarketplaceType,i.PrimaryMarketplace.SolutionId,1),s&&s.b)?(Diag.a.a(591001284,220,15,"InstallContextualTab was called multiple times"),!1):(t={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.solutionId=i.PrimaryMarketplace.SolutionId,t.version=i.PrimaryMarketplace.SolutionVersion,t.storeType=i.PrimaryMarketplace.MarketplaceType,t.storeId=i.PrimaryMarketplace.MarketplaceRef,t.assetId=i.PrimaryMarketplace.SolutionId,t.assetStoreId=i.PrimaryMarketplace.MarketplaceRef,t.targetType=i.WebExtensionOsfControlType,t.width=i.TaskpaneWidth,t.height=0,t.isAddinCommands=!0,t.id=t.assetId,t.appVersion=i.PrimaryMarketplace.SolutionVersion,t.currentStoreType=i.PrimaryMarketplace.MarketplaceType):(t.appVersion=i.PrimaryMarketplace.SolutionVersion,t.assetId=i.PrimaryMarketplace.SolutionId,t.assetStoreId=i.PrimaryMarketplace.MarketplaceRef,t.currentStoreType=i.PrimaryMarketplace.MarketplaceType,t.id=t.assetId,t.storeId=t.assetStoreId,t.targetType=i.WebExtensionOsfControlType,t.width=i.TaskpaneWidth,t.height=0,t.isAddinCommands=!0),h=new($$sc.v.$$(Object)),h.b(t),u={},u.ack2=h,u.ack0=6,u.OsfControl=e,u.RibbonUpdaterData=o,this.o(u),!0)}};_Ewa.uq=function(n){this.s=Function.createDelegate(this,this.v);this.r=Function.createDelegate(this,this.t);_Ewa.uq.initializeBase(this,[n])};_Ewa.uq.a=function(n){_Ewa.bh.a(199,new _Ewa.uq(n))};_Ewa.uq.prototype={p:null,n:function(){Diag.a.a(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");var t,n=this;_Ewa.cs.a(this.h).a((t=new _Ewa.MB(null,null,null,0),t.g=function(){var t=n.h.b().A()&&n.h.b().a()&&!!(n.h.s()&16384)&&n.h.j();return n.h.b().a()&&Diag.a.a(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",t,n.h.b().A(),n.h.b().a(),!!(n.h.s()&16384),n.h.j()),t},t.e=this.r,t.f=this.s,t.h=2,t))},t:function(){var t,u;Diag.a.a(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",this.h.j(),!!(this.h.s()&16384));t=new($$sc.D.$$(_Ewa.hr));u=this;this.h.a().c(_Ewa.hr,53,function(n){Diag.a.a(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");t.a(n)},null);var f=t.b,i=new CommandUI.AddInCommands.h,r=CommandUI.AddInCommands.f.b(),e=new _Ewa.EG(this.h,r),o=_Ewa.l.b(Sys.IDisposable,this.h.a(),203,this.i(),this.j,null),s=this.w(i),h=_Ewa.l.a(_Ewa.hD,this.h.a(),349,350,this.j,null),n=this;return _Ewa.g.a(_Ewa.g.b([f,o,s,h],this.i(),3),function(){Diag.a.a(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");_Ewa.g.a(_Ewa.l.b(_Ewa.bQ,n.h.a(),106,n.i(),n.j,null),function(t){var u=t.a();n.p=new _Ewa.EH(n.h,u,i,new CommandUI.AddInCommands.B,r,e,Common.Utils.a.a().d(Common.ct,null));Diag.a.a(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");n.m([n.p],null);n.h.a().b(_Ewa.lI,198,n.p)},n.i(),3,null,null)},this.i(),3,null,null)},v:function(){isNullOrUndefined(this.p)?Diag.a.a(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated."):(this.h.i().h(this.p),this.h.a().e(_Ewa.lI,198,null),this.p=null);this.h.a().e(_Ewa.qV,204,null);_Ewa.N.a(_Ewa.bkq.$$(_Ewa.lI),_Ewa.zj.$$(_Ewa.lI),21,this.h.a(),198,null)},w:function(n){var t=_Ewa.l.b(_Ewa.dJ,this.h.a(),102,this.i(),this.j,null),i=this;return _Ewa.g.a(t,function(){Diag.a.a(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");var r=t.a();i.h.a().b(_Ewa.qV,204,new _Ewa.EF(r,n))},this.i(),3,null,null)}};_Ewa.fe=function(n,t,i,r,u){_Ewa.fe.initializeBase(this);this.c=n;this.b=t;this.a=i;this.d=u;this.e=r||$$sc.a.a(Boolean,!0)};_Ewa.fe.d=function(n){_Ewa.fe.a.c(n)&&_Ewa.fe.a.a(n).c()};_Ewa.fe.c=function(n){_Ewa.fe.a.c(n)&&_Ewa.fe.a.a(n).b()};_Ewa.fe.b=function(n,t){var i={};return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.SolutionId=n.solutionId,i.Version=n.version,i.StoreType=t.storeType,i.StoreId=n.storeId,i.AssetId=n.solutionId,i.AssetStoreId="omex",i.TargetType=1,i.Width=350,i.OwnerAddinSolutionId=t.solutionId,i.OwnerAddinStoreType=t.storeType,i.SharedRuntimeId=null,i.Preload=!1,i.Id=n.solutionId,i.AppVersion=n.version,i.CurrentStoreType=t.storeType,i.OwnerAddinAssetId=t.assetId):(i.AppVersion=n.appVersion,i.StoreId=n.storeId,i.AssetId=n.assetId,i.CurrentStoreType=t.storeType,i.TargetType=1,i.AssetStoreId="omex",i.Width=350,i.OwnerAddinAssetId=t.assetId,i.Id=i.AssetId,i.SharedRuntimeId=null,i.Preload=!1),i};_Ewa.fe.prototype={b:null,c:null,a:null,d:null,e:null,h:function(){var n=this.e;return this.e=$$sc.a.a(Boolean,!0),n},disposeHost:function(n){this.b.v(n)},setOwnerAddinEToken:function(n){this.a.eToken=n},showTaskpane:function(n,t,i){var r,u,e,o,s,h,f;if(Diag.a.a(17306639,220,50,"ShowTaskpane action called."),r=null,u=!1,_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(e=new CommandUI.AddInCommands.b("m_excelWebRenderer_ewaCtl_",this.a.solutionId,new _Ewa.ok,!0),o=e.a(n.solutionId.substr(this.a.solutionId.length)),r=t.getSharedRuntimeForTaskpane("Workbook",o),u=!!r&&r.LifeTime===1,this.b.j(u?this.a.solutionId:n.solutionId,null,u?r:null,null))return}else if(s=new CommandUI.AddInCommands.b("m_excelWebRenderer_ewaCtl_",this.a.assetId,new _Ewa.ok,!0),h=s.a(n.assetId.substr(this.a.assetId.length)),r=t.getSharedRuntimeForTaskpane("Workbook",h),u=!!r&&r.LifeTime===1,this.b.j(u?this.a.assetId:n.assetId,null,u?r:null,null))return;this.g(u,!0);f=this;this.e=this.f(n,r,function(n,t){if(!n){Diag.a.a(17306640,220,10,"ShowTaskpane: instance id is null.");i(null,t);return}u&&(n.PrimaryMarketplace.SolutionId=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?f.a.solutionId:f.a.assetId,n.SharedRuntime=r);n.WebExtensionOsfControlType=3;f.b.k(n);i(n.InstanceId,t);f.g(u,!1)})},showDialog:function(n,t,i){var s,h;Diag.a.a(17306641,220,50,"ShowDialog action called.");var f=this.c.c().a(),r=this,e=function(n){var u=n.Result,t=u?u.AgaveData:null,f;t?(f=function(){var i=function(){r.disposeHost(t.InstanceId)},n=new CommandUI.AddInCommands.D(i);return n.G("",null,null),n.O},r.b.t(t,f),i(t.InstanceId,0)):(Diag.a.a(17306642,220,10,"ShowDialog: instance id is null."),i(null,n.Errors?n.Errors[0].ErrorCause:5001))},o=_Ewa.fe.b(n,this.a),c=this,u=function(n,t,i){return _Ewa.up.a(f,o,_Ewa.n.a(n,e),t,i,null)};_Ewa.a.d()?(s=this,this.e=_Ewa.H.a(this.c.f(),u,function(n){return new _Ewa.v(500,0,n,64,null)},this.d)):(h=this,this.e=_Ewa.H.a(this.c.f(),u,function(n){return new _Ewa.ba(500,0,n,0,null)},this.d))},createUILessSandbox:function(n,t,i){var f;Diag.a.a(17306643,220,50,"UILess action called.");var r=t.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),u=!!r&&r.LifeTime===1,e=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.b.u(u?this.a.solutionId:n.solutionId,u?r:null):this.b.u(u?this.a.assetId:n.assetId,u?r:null);if(e){i(e,0);return}f=this;this.e=this.f(n,r,function(n,t){if(!n){Diag.a.a(17306644,220,10,"UILess: instance id is null.");i(null,t);return}if(u)n.PrimaryMarketplace.SolutionId=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?f.a.solutionId:f.a.assetId,n.SharedRuntime=r,n.TaskpaneVisible=!1,n.WebExtensionOsfControlType=3,f.b.k(n);else{var e=function(){return _Ewa.fe.a.b(n.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog),_Ewa.fe.a.a(n.InstanceId).a()};n.WebExtensionOsfControlType=4;f.b.t(n,e)}i(n.InstanceId,t)})},f:function(n,t,i){var r=null,o=this.c.c().a(),p=this,l=function(n){var t=n.Result;r=t?t.AgaveData:null;r||i(null,n.Errors?n.Errors[0].ErrorCause:5001)},u=_Ewa.fe.b(n,this.a),a,c,v,y,f;t&&(Diag.a.a(571774671,220,50,"Shared runtime agave is inserted."),u.SharedRuntimeId=t.Resid);var s=500,w=this,h=function(n,t,i){return _Ewa.up.a(o,u,_Ewa.n.a(n,l),t,i,null)},e=0;return isNullOrUndefined(u.IsToBePersisted)||u.IsToBePersisted||(s=538,a=this,h=function(n,t,i){return Diag.a.a(542185173,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",u.CurrentStoreType,u.StoreId,Telemetry.PrivacyRules.GetAssetId(u.CurrentStoreType,u.StoreId,u.AssetId,null,null)),_Ewa.uu.a(o,u,_Ewa.n.a(n,l),t,i,null,null)},e=16),_Ewa.a.d()?(e|=64,v=this,c=_Ewa.H.a(this.c.f(),h,function(n){return new _Ewa.v(s,0,n,e,null)},this.d)):(y=this,c=_Ewa.H.a(this.c.f(),h,function(n){return new _Ewa.ba(s,0,n,e,null)},this.d)),f=this,_Ewa.g.ts(c,function(){if(!r)return $$sc.a.a(Boolean,!1);var u=function(u,e){var o,s;if(u){for(t||(r.PrimaryMarketplace.MarketplaceType=n.storeType),_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(r.OwnerAddinSolutionId=f.a.solutionId,r.OwnerAddinAssetId=f.a.assetId):r.OwnerAddinAssetId=f.a.assetId,r.OwnerAddinStoreType=f.a.storeType,r.OsfPropertyBag=[],o=0;o<u.Settings.length;o++)s=[],s[0]=u.Settings[o].Name,s[1]=u.Settings[o].Value,r.OsfPropertyBag[o]=s;i(r,0)}else i(null,e.Errors?e.Errors[0].ErrorCause:5001)};return f.i(o,r.InstanceId,u)},$$sc.f.a,3,$$sc.c.a)},i:function(n,t,i){var o=this,u=function(n){var t=n.Result;i(t,n)},s=this,r=function(i,r,f){return _Ewa.ep.b(n,t,_Ewa.n.a(i,u),r,f,null)},f,e;return _Ewa.a.d()?(f=this,_Ewa.H.a(this.c.f(),r,function(n){return new _Ewa.v(501,0,n,80,null)},this.d)):(e=this,_Ewa.H.a(this.c.f(),r,function(n){return new _Ewa.ba(501,0,n,16,null)},this.d))},g:function(n,t){n&&window.performance&&window.performance.memory&&Diag.a.a(561598934,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",t,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}};_Ewa.EG.registerClass("_Ewa.EG",_Ewa.bW,_Ewa.rM,Common.IRootUser);_Ewa.EH.registerClass("_Ewa.EH",null,_Ewa.yL,_Ewa.lI,Sys.IDisposable);_Ewa.uq.registerClass("_Ewa.uq",_Ewa.bh);_Ewa.fe.registerClass("_Ewa.fe",CommandUI.AddInCommands.X);_Ewa.fe.a=new($$sc.w.$$(CommandUI.AddInCommands.u));Type.registerNamespace("_Ewa");_Ewa.bdj=function(){};_Ewa.bdj.a=function(){_Ewa.m.a(function(n){_Ewa.a.b(54)&&_Ewa.uq.a(n)})};_Ewa.bdj.a();Type.registerNamespace("_Ewa");_Ewa.iw=function(){};_Ewa.iw.registerInterface("_Ewa.iw");_Ewa.Fe=function(){};_Ewa.uC=function(){};_Ewa.uC.prototype={none:0,registerEvent:1,unregisterEvent:2,customFunction:3,showCard:4,createWorkbook:5,openWorkbook:6,enableEvents:7,closeWorkbook:8,setCalculationMode:9,workbookLinksRequestRefresh:10,workbookLinksRequestRefreshAll:11,workbookLinksEnableContent:12,workbookLinksFindNextLink:13,workbookLinksOpenWorkbook:14,rangePicker:15,enableRichApiRecording:16,recordAction:17,focus:18};_Ewa.uC.registerEnum("_Ewa.uC",!1);_Ewa.ix=function(){};_Ewa.ix.prototype={none:0,testEvent:1,test1Event:2,worksheetDataChangedEvent:10,worksheetActivatedEvent:11,worksheetDeactivatedEvent:12,worksheetAddedEvent:13,worksheetSelectionChangedEvent:14,worksheetDeletedEvent:15,worksheetCalculatedEvent:16,worksheetFilteredEvent:17,worksheetFormatChangedEvent:18,worksheetRowSortedEvent:19,worksheetColumnSortedEvent:20,worksheetSingleClickedEvent:21,worksheetRowHiddenChangedEvent:22,worksheetFormulaChangedEvent:23,worksheetProtectionChangedEvent:24,worksheetNameChangedEvent:25,worksheetVisibilityChangedEvent:26,worksheetMovedEvent:27,worksheetNavigationObjectChangedEvent:28,chartAddedEvent:50,chartActivatedEvent:51,chartDeactivatedEvent:52,chartDeletedEvent:53,tableSelectionChangedEvent:100,tableDataChangedEvent:101,tableAddedEvent:102,tableDeletedEvent:103,tableFilteredEvent:104,agaveVisualUpdateEvent:150,customFunctionExecutionBeginEvent:200,customFunctionExecutionEndEvent:201,commentAddedEvent:250,commentDeletedEvent:251,commentChangedEvent:252,invocationMessage:1e3,cancellationMessage:1001,metadataMessage:1002,visualSelectionChangedEvent:2e3,visualChangeEvent:2001,visualTrackerModelChangedEvent:2002,shapeSelectionChangedEvent:2100,shapeActivatedEvent:2101,shapeDeactivatedEvent:2102,shapeAddedEvent:2103,shapeDeletedEvent:2104,workbookAutoSaveSettingChangedEvent:2200,wacOperationEvent:2201,recordingStateChangedEvent:2202,workbookActivatedEvent:2203,workbookNavigationObjectChangedEvent:2204,ribbonCommandExecutedEvent:2300,linkedDataTypeRefreshRequestCompletedEvent:2500,linkedDataTypeRefreshModeChangedEvent:2501,linkedDataTypeLinkedDataTypeAddedEvent:2502,linkedWorkbookWorkbookLinksChangedEvent:2600,linkedWorkbookRefreshCompletedEvent:2601,rangePickerSelectionChangedEvent:2700,lineageActivityUpdateAvailableEvent:2800,lineageActivityFilterUpdatedEvent:2801,lineageActivityLoadCompletedEvent:2802,pivotTableAddedEvent:2900,pivotTableDeletedEvent:2901,namedItemAddedEvent:3e3,namedItemDeletedEvent:3001,appRuntimeVisibilityChangedEvent:65539,beforeCloseNotifiactionCancelledEvent:65540};_Ewa.ix.registerEnum("_Ewa.ix",!1);_Ewa.bdn=function(){};_Ewa.bdn.a=function(){_Ewa.m.a(_Ewa.xA.a);_Ewa.m.a(_Ewa.uy.a)};_Ewa.uy=function(n){_Ewa.uy.initializeBase(this);this.h=n;n.a().b(_Ewa.bkq.$$(_Ewa.bQ),106,this);this.l()};_Ewa.uy.a=function(n){new _Ewa.uy(n)};_Ewa.uy.prototype={m:null,n:null,q:function(){return this.m||(this.m=new _Ewa.bc(this.h,this.n))},h:null,a:function(){if(Diag.a.a(38942484,0,50,"DdaFacadeServiceFactory:Create."),Common.a.Q){Diag.a.a(38537093,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",Common.a.Q);return}if(_Ewa.a.b(431)){var n=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(t){t.a("mso_officeStore",!0).then(function(t){return _Ewa.bc.e=t,n.p(),null})})}else this.p()},p:function(){var i=this.h.a(),t=_Ewa.l.a(_Ewa.om,i,224,225,this.j,null),f=this,r=_Ewa.x.k(41,4,function(){return!isNullOrUndefined(window.OSF)},this.h.e().MaxRetriesForLoadingScript,this.h.g(),this.j,106),u=_Ewa.xq.a(this.i(),this.j),n=this;_Ewa.g.a(_Ewa.g.b([t,r,u],this.h.g(),3),function(){typeof OfficeExt=="undefined"||typeof OSF=="undefined"?Diag.a.a(40421204,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",_Ewa.cT.a(!0,null)):n.r();Diag.a.a(38537094,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");n.n=t.a();n.k(n.q());Diag.a.a(39965575,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.i(),3,null,null)},r:function(){_Ewa.a.b(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Common.App.AppsForOffice.i);this.h.y().a(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Common.App.AppsForOffice.i,new Common.App.AppsForOffice.q(Common.a.a.l.d.WebServiceBase),_Ewa.a.b(72),_Ewa.a.b(463))},dispose:function(){System.a.a(this.m);this.m=null;this.h=null;_Ewa.sX.prototype.dispose.call(this)}};_Ewa.uv=function(n,t){this.f=Function.createDelegate(this,this.h);this.b=new($$sc.v.$$(_Ewa.uv.a));_Ewa.uv.initializeBase(this,[!1]);this.d=n;this.a=t};_Ewa.uv.b=function(n,t){var f=!1,i,r,u;return n===974713501&&(i=t?t.CommandValueId:null,r=i?i.DdaMethod:null,r&&r.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(u=i.ArrayData,f=!!u&&(u[6]&64)==64)),f};_Ewa.uv.prototype={d:null,a:null,c:!1,e:!1,g:function(n,t){if(!this.e){this.c||(this.a.f().h(this.f),this.c=!0);var i;this.b.b((i=new _Ewa.uv.a,i.b=n,i.a=t,i))}},h:function(){var i,n,t;if(!this.e)for(this.a.f().f(this.f),this.c=!1,i=this.b,this.b=new($$sc.v.$$(_Ewa.uv.a)),n=i.$$lge();n.$$mn();)t=n.$$cu(),this.d.bg(t.b,t.a,!0)},dispose:function(){var r,n,t,i;if(!this.e){for(this.e=!0,this.c&&this.a.f().f(this.f),r=this.b,this.b=null,n=r.$$lge();n.$$mn();)t=n.$$cu(),i=t.a?t.a.DdaMethodCallback:null,i&&this.d.bc(5004,i,!0);this.a=null;this.d=null;_Ewa.bgG.prototype.dispose.call(this)}}};_Ewa.uv.a=function(){};_Ewa.uv.a.prototype={b:0,a:null};_Ewa.kU=function(){};_Ewa.kU.c=function(){return _Ewa.kU.a||(_Ewa.kU.a={"-2002156328":1e3,"-1954750170":1001,"317650254":1002,"-1005263101":1003,"1353664579":1004,"159671765":1005,"1446690022":1008,"1150069548":2e3,"-1409306331":2001,"338507772":2002,"-457159301":2003,"-1037701970":2004,"-1893322318":2005,"965579896":2007,"93287890":2008,"358088857":2009,"-1223650923":2002,"2007306190":2014,"1549955423":3002,"-1275974171":3004,"382101082":3005,"-898776235":3006,"335464256":3007,"1677378049":3008,"-261992848":3009,"-980820954":3002,"-931375837":3010,"929186550":8e3,"-982144310":8001,"-785741187":8010,"2125217573":8011,"299124955":8012,"1669853884":8020,"-1515932330":8021,"314621024":8022,"-300049690":8023,"14766835":4002,"-1251992761":5002,"-2087635043":5012,"2100961153":5012,"-1218744139":1014,"-1468309555":5006,"-315732528":5012,"611268539":5012,"1531005923":5006,"1593924569":5006,"299476328":5102,"49173765":5102,"-907155566":5102,"-1201603824":5102,"1541165282":5102,"-1347753427":5102,"134912532":5102,"1780971550":5104})};_Ewa.kU.b=function(n){return _Ewa.y.c(_Ewa.kU.c(),n.toString(),5001)};_Ewa.mv=function(n){this.e=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.s);this.k={};this.l={};this.f={};this.i={};this.b=n;this.j=this.m};_Ewa.mv.a=function(n,t){var i=new Array(6);return i[0]=n.Category,i[1]=n.Type,i[2]=n.Target,i[3]=n.Message,i[4]=n.Id,i[5]=t,i};_Ewa.mv.prototype={c:null,j:null,p:function(n){n&&(this.o(),Array.add(this.c,n))},v:function(n){this.c&&(Array.remove(this.c,n),this.c.length||(this.b.bQ(!1),this.b.da(this.j),this.c=null))},b:null,s:function(n,t){for(var u,f,c,i,s,h,o,l,a=this.b.o().a("Task","DdaEventDispatch.HandleServerEvent"),e=t.a,r=0;r<e.length;r++)switch(e[r].EventType){case 2:u=e[r];f={};f.Name=u.Name;f.BindingType=u.BindingType;f.ColCount=u.ColCount;f.RowCount=u.RowCount;this.d(u.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,f,null);break;case 4:c=e[r];this.d(c.InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(i=e[r],_Ewa.f.a(i.InstanceId)){for(this.f={},this.i={},s=0;s<i.Entries.length;s++)this.n(i.Entries[s],i.IsRemoteOverride);Diag.a.a(36444194,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",this.f,this.i,this.k,this.l)}else{for(h=new Array(i.Entries.length),o=0;o<i.Entries.length;o++)h[o]=_Ewa.mv.a(i.Entries[o],i.IsRemoteOverride);i.Entries.length>0&&i.Entries[0].Category===1?(l=i.InstanceId,this.t(l,h)):i.InstanceId&&this.d(i.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,h)}}a.a()},t:function(n,t){var i=$$as(_Ewa.bc,_Ewa.bJ.a(this.b)),r=this;_Ewa.g.a(i.cO(n),function(n){var f,u,e;if(_Ewa.cb.a(n)){if(f=n.a(),u=i.bb(f),f)if(u.v)r.d(f,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(u.n)for(e=0;e<t.length;e++)Array.add(u.n,t[e]);else u.n=t}else n.b===5?Diag.a.a(38134347,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):n.b===4&&Diag.a.a(38134348,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.b.g(),0,null,null)},w:function(n,t){var i=t;this.d(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,i)},u:function(n,t){var i=$$as(_Ewa.bc,_Ewa.bJ.a(this.b)),r=i.cM(n);r?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(r,t,this.e):i.cD(n,t)},n:function(n,t){var a=!1,r=parseInt(n.Type),v=n.Target,o=$$as(_Ewa.bc,_Ewa.bJ.a(this.b)),s=o.be.h(r,v),h,c,f,u,l,i,e;if(s&&Object.keys(s).length>0){a=!0;h=s;for(c in h)f={key:c,value:h[c]},o.be.e(f.key)&&(u=new Array(1),u[0]=_Ewa.mv.a(n,t),_Ewa.a.a("OfficeVSO:5379862_RichApiEventsTriggerSource")&&(l=u[0][3],isNullOrUndefined(l)||(i=$$as(Object,_Ewa.E.b(l)),!i||isNullOrUndefined(i.triggerControlId)||isNullOrUndefined(i.triggerSource)||(e=!1,t?(i.triggerSource="Unknown",e=!0):o.cF(i.triggerControlId,f.key)&&(i.triggerSource="ThisLocalAddin",e=!0),e&&(u[0][3]=_Ewa.E.a(i))))),this.d(f.key,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u))}a?(this.h(_Ewa.ix.toString(r),this.f),this.h(_Ewa.ix.toString(r),this.k)):(this.h(_Ewa.ix.toString(r),this.i),this.h(_Ewa.ix.toString(r),this.l))},o:function(){this.c||(this.c=[],this.b.cd(this.j),this.b.bQ(!0))},h:function(n,t){n in t||(t[n]=0);t[n]=t[n]+1},a:function(n,t,i){var r={};r.Target=t;r.Category=65536;r.Type=n;r.Message=i;r.Id=-1;this.n(r,!1)},r:function(n,t){var i={},r;i.Target="";i.Category=2;i.Type=1e3;i.Message=t;i.Id=0;r=new Array(1);r[0]=_Ewa.mv.a(i,!1);this.u(n,r)},g:function(n,t,i,r){var u={},f;u.Target=i;u.Category=65536;u.Type=t;u.Message=r;u.Id=-1;f=new Array(1);f[0]=_Ewa.mv.a(u,!1);this.d(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,f)},q:function(n,t){this.d(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)},d:function(n,t,i,r){var f,o,u,s,e;if(this.c&&(f=$$as(_Ewa.bc,_Ewa.bJ.a(this.b)),!f||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||f.be.e(n)))for(o=new _Ewa.qo(t,n,i,r),u=0,s=this.c.length;u<s;u++)e=this.c[u],e&&e(o)}};_Ewa.ux=function(n,t){this.a=n;this.c=t};_Ewa.ux.prototype={b:null,e:function(n){n&&(this.b||(this.b=[]),Array.add(this.b,n))},f:function(n){this.b&&Array.remove(this.b,n)},a:0,c:null,g:function(n){return this.a!==n.dispid?!1:this.a===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.c===n.ddaBinding.Name:!0},d:function(n){if(this.b){var i=this,t=function(t){var i=t;i(n)};Array.forEach(this.b,t)}},h:function(){this.b=[]}};_Ewa.bc=function(n,t){this.bY=Function.createDelegate(this,this.co);this.cb=Function.createDelegate(this,this.cX);this.bG=Function.createDelegate(this,this.cV);this.bI=Function.createDelegate(this,this.cY);this.bF=Function.createDelegate(this,this.cS);this.bH=Function.createDelegate(this,this.cW);this.bJ=Function.createDelegate(this,this.cZ);this.ca=Function.createDelegate(this,this.Y);this.bZ=Function.createDelegate(this,this.cU);this.ba=[];this.bA=[];this.bS=[];this.bo=[];this.bE=new($$sc.n.$$(String))($$sc.d.a());this.bx=new($$sc.q.$$(String,$$sc.p.$$(String)))($$sc.d.a());this.br=[];this.bV=[];_Ewa.bc.initializeBase(this,[!1]);this.Z=n;this.by=t;this.cQ();_Ewa.uz.a(this);this.bB=0;_Ewa.a.a("OfficeVSO:5545371_DisableAddinKeyboardShortcutsInMobile")&&(Common.c.f()||Common.c.q())||OfficeExt.ShortcutKeyDispatchManager.init();this.bK={};this.bX=!_Ewa.a.a("OfficeVSO:5696885_ArgumentAssistanceHelpTaskPane")};_Ewa.bc.a=function(n){var t=n.PrimaryMarketplace.SolutionId;return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?_Ewa.a.b(303)&&n.OwnerAddinSolutionId&&(t=n.OwnerAddinSolutionId):_Ewa.a.b(303)&&n.OwnerAddinAssetId&&(t=n.OwnerAddinAssetId),t};_Ewa.bc.g=function(n){var t=0;return _Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?n.RequestFlags&1&&(n.RequestFlags&256)!=256||(t=16):t=(n.RequestFlags&1)?0:16,t};_Ewa.bc.b=function(n,t){var i=_Ewa.bc.a(n,t),r=n.PrimaryMarketplace.SolutionVersion,u=n.PrimaryMarketplace.MarketplaceType,f=n.PrimaryMarketplace.MarketplaceRef;return _Ewa.bc.f("2",i,r,u,f)};_Ewa.bc.n=function(n){var t={recording:n};return JSON.stringify(t)};_Ewa.bc.m=function(n){var t={};return t["visibility"]=n?"Visible":"Hidden",JSON.stringify(t)};_Ewa.bc.j=function(n){if(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){var t=n.getSolutionId(),i=n.getVersion(),r=n.getStoreType(),u=n.getStoreId();return _Ewa.bc.f("2",t,i,r,u)}var f=n.getMarketplaceID(),e=n.getMarketplaceVersion(),o=n.getStoreType(),s=n.getStoreLocator();return _Ewa.bc.f("2",f,e,o,s)};_Ewa.bc.f=function(n,t,i,r,u){var f=_Ewa.bc.o(r).toString();return String.format("{0}|{1}|{2}|{3}|{4}|||",n,t,i,f,u)};_Ewa.bc.h=function(n,t){var r=n.split("|"),i,f,e;if(r.length<7)return Diag.a.a(542185166,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if(r[0]!=="2")return Diag.a.a(35755851,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",r[0]),null;var u=r[1],o=r[2],s=_Ewa.bc.p(r[3]),h=r[4],c=r[5];return u&&u.length||(u=c),i={},i.InstanceId=String.format("{{{0}}}",Common.u.a().a),i.WebExtensionOsfControlType=4,i.WebExtensionType=1,i.PrimaryMarketplace={},i.PrimaryMarketplace.SolutionId=u,i.PrimaryMarketplace.SolutionVersion=o,i.PrimaryMarketplace.MarketplaceRef=h,i.PrimaryMarketplace.MarketplaceType=s,i.ContainsCustomFunctions=t?!0:!1,t&&(f=["customFunctionAddinId",n],e=[f],i.OsfPropertyBag=e),i};_Ewa.bc.p=function(n){var t=parseInt(n);return t===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:t===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:t===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:t===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:t===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:t===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:t===OSF.StoreTypeEnum.OneDrive?OSF.StoreType.OneDrive:t===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:t===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:t===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:t===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:t===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null};_Ewa.bc.o=function(n){return n===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:n===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:n===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:n===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:n===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:n===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:n===OSF.StoreType.OneDrive?OSF.StoreTypeEnum.OneDrive:n===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:n===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:n===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:n===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:n===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};_Ewa.bc.i=function(n){var t={};return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.Version=n.appVersion,t.AssetId=n.assetId,t.AssetStoreId=null!==n.assetStoreId?n.assetStoreId.toString():null,t.StoreType=n.storeType,t.Height=n.height,t.SolutionId=n.solutionId,t.StoreId=n.storeId,t.TargetType=n.targetType,t.Width=t.TargetType===1?0:n.width,t.SharedRuntimeId=n.sharedRuntimeId,t.AppVersion=n.appVersion,t.CurrentStoreType=n.currentStoreType,t.Id=n.id):(t.AppVersion=n.appVersion,t.AssetId=n.assetId,t.AssetStoreId=null!==n.assetStoreId?n.assetStoreId.toString():null,t.CurrentStoreType=n.currentStoreType,t.Height=n.height,t.Id=n.id,t.StoreId=n.storeId,t.TargetType=n.targetType,t.Width=t.TargetType===1?0:n.width,t.SharedRuntimeId=n.sharedRuntimeId),t};_Ewa.bc.k=function(n){return n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent||n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};_Ewa.bc.l=function(n){var t;return t=new CommandUI.AddInCommands.m,t.e=n.infoType,t.i=n.id,t.c=n.title,t.f=n.description,t.g=n.buttonTxt,t.a=n.buttonCallback,t.h=n.highPriority,t.b=n.dismissCallback,t.d=n.errorCode,t.j=n.iframeNotificationUrl,t};_Ewa.bc.d=function(n){var t=n==="FA000000014",i;return t||(i="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1",t=n===i),t};_Ewa.bc.q=function(n){return n==="FA000000005"};_Ewa.bc.prototype={bX:!1,bh:null,bf:null,bd:null,bn:null,by:null,bR:!1,bs:!1,bD:!1,bT:!1,bm:null,bp:null,bz:350,bQ:null,cL:function(){return this.bQ||(this.bQ=new Common.Utils.d(this.Z.Z()))},bl:null,p:function(n){this.es("cd",n)},R:function(n){this.eu("cd",n)},q:function(n){this.es("csc",n)},f:function(n){this.eu("csc",n)},w:function(n){this.es("ca",n)},Q:function(n){this.eu("ca",n)},x:function(n){this.es("ci",n)},y:function(n){this.es("ekros",n)},S:function(n){this.eu("ekros",n)},bU:function(n,t){try{var i=JSON.parse(n),r=i[t];return r.toLowerCase()}catch(u){return""}},db:function(n){var t=this.bU(n,"AudienceGroup"),i=this.bU(n,"SessionOrigin"),r;try{if(r=parseInt(this.bU(n,"Ring")),t!=="automation"&&i!=="bluechicken"&&r>=-2)return!0}catch(u){if(t!=="automation"&&i!=="bluechicken")return!0}return!1},bi:function(){var i,f,e;if(!this.bf){var n={},o=!(this.Z.s()&1),t=_Ewa.x.b.b,s=this.Z.k(),r=Common.E.b+Common.E.e,u=0;_Ewa.a.b(526)&&(u|=2);n.pageBaseUrl=t.LayoutsContentUrlPrefix;n.appName=OSF.AppName.ExcelWebApp;n.appVersion="16";n.appSettings=this.cN();n.singleSignOnSettings=Common.App.AppsForOffice.a.i();n.clientMode=o?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;n.appUILocale=this.Z.e().UICultureTag;n.dataLocale=this.Z.e().DataCultureTag;n.docUrl=s.ClientUrl;n.hostControl=this;n.formFactor=OSF.FormFactor.Default;n.lcid=this.Z.R().toString();n.localizedScriptsUrl=Common.E.b+Common.E.f;n.localizedImagesUrl=r;n.localizedStylesUrl=Common.E.b+Common.E.i;n.localizedResourcesUrl=r;n.osfOmexBaseUrl=t.OsfOmexBaseUrl;n.firstPartyManifestCDNUrl=t.FirstPartyAddInManifestCDN;n.sdxAssetsToPrefetchMapping=Common.a.a.b("SdxAssetsToPrefetchMapping");n.sdxCdnUrl=t.SdxCdnUrl;n.sdxDmsUrl=t.SdxDmsUrl;n.devCatalogUrl=t.DevCatalogUrl;n.oneDriveCatalogBaseApiUrl=t.OneDriveCatalogBaseApiUrl;n.controlStatusChanged=this.bZ;n.notifyHost=this.ca;n.allowExternalMarketplace=this.Z.b().e().a(27)&&_Ewa.bc.e;n.trustAgaves=_Ewa.a.b(4);n.enableAddinCommands=_Ewa.a.b(54);n.enableBlackForestRedirect=_Ewa.a.b(89);n.enableMyOrg=this.Z.b().e().a(33);n.enableMyApps=this.Z.b().e().a(34);n.enableDevCatalog=_Ewa.a.b(46);n.enablePrivateCatalog=this.dc();n.enableTaskpaneUpgradeToAppCommand=_Ewa.a.b(94);n.showSignOutFromPrivateCatalogMessage=this.Z.b().e().a(36);n.enableUploadFileDevCatalog=_Ewa.a.b(54)&&!_Ewa.a.b(290);n.userNameHashCode=Common.d.e(Common.a.s);n.envCode=this.Z.e().OfficeAddinTelemetryDataSourceCode.toString();n.enableSingleSignOnForAddin=!_Ewa.a.b(25)&&Common.a.cr;n.enableServiceDeliveredExperience=_Ewa.a.b(86);n.enableDisplayBlockedMinorError=_Ewa.a.b(187);n.hideAppsExtensionUrl=Common.a.dq;n.enableAnonymousUseLegacyCatalogService=_Ewa.a.b(177);n.enableInsertDialogAccessibilityFix=_Ewa.a.b(184);n.disableAppsForOfficeThirdParty=_Ewa.a.b(190);n.enableFirstPartySSO=_Ewa.a.b(202);n.wacSessionId=this.Z.e().UserSessionId;n.disableLogging=!this.Z.e().AriaLoggingIsEnabled;n.enableFirstPartySDXErrorMessages=_Ewa.a.b(216);n.enableRichApiCellEditDelay=_Ewa.a.b(194);n.isHostDocumentDomain=_Ewa.a.b(232);n.loggableUserId=Common.a.a.b("LoggableUserId");n.sessionStartInfoJson=Common.a.a.b("SessionStartInfoJson");n.wopiHostOriginFromPostMessage=Common.a.cB;n.wopiHostOriginFromWacPropBag=Common.a.a.b("PostMessageOrigin");n.wacIsEmbedded=Common.a.a.a("IsEmbedded");n.accessibilityAllowFocusAddinTaskpane=Common.a.a.a("AccessibilityAllowFocusAddinTaskpane");n.enableRemoveAppCommandsAddin=Common.a.a.a("RemoveAppCommandsAddinIsEnabled");n.isHostFrameTrustCheckEnabledForAddIns=Common.a.a.a("HostFrameTrustCheckIsEnabledForAddIns");n.isHostFrameTrusted=Common.a.cL();n.agaveAddinUploadEnabled=_Ewa.a.b(48);n.hostAllowedOfficeStore=Common.a.a.a("HostAllowedOfficeStore");n.hostAllowedSdxEmbedding=Common.a.a.a("HostAllowedSdxEmbedding");n.hostInstallAddIns=Common.a.a.b("HostInstallAddIns");n.hostInstallAddInsIsEnabled=Common.a.a.a("HostInstallAddInsIsEnabled");n.approvedAddIns=Common.a.a.b("ApprovedAddIns");n.addinEnforceHttpsIsEnabled=this.db(n.sessionStartInfoJson);n.hostFeatureGateFlag=u;n.isUpnCheckEnabled=Common.a.a.a("IsUpnCheckEnabled");n.wacUpn=Common.a.a.b("UserPrincipalName");n.isReactRibbonEnabled=_Ewa.s.e();n.enableSetFocusOnTaskpaneOnUserAction=_Ewa.a.c("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);n.isSafariWithIndexedDBDisabled=_Ewa.a.a("OfficeVSO:5280064_IDBBuggedInSafari")&&Common.c.N();n.enableCustomShortcuts=_Ewa.a.a("OfficeVSO:5325526_EnableCustomShortcuts");n.changeGetModifierKeyStringOutputOrder=_Ewa.a.a("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.bf=new OSF.ContextActivationManager(n);this.bf.setIframeAttributeBag({frameborder:0,marginheight:0,marginwidth:0});this.bf.setWSA(Common.a.p);this.bf&&typeof this.bf.hostCheckReadyHandler!="undefined"&&(i=this.bf,Common.a.gL(i.$$d_hostCheckReadyHandler||(i.$$d_hostCheckReadyHandler=Function.createDelegate(i,i.hostCheckReadyHandler))));try{f=Common.Utils.a.a();e=f.a(Common.App.OAuth.d,null);this.bf.setOAuthManager(e)}catch(h){}}return this.bf},bC:!1,be:null,bj:null,bu:null,bt:null,bN:null,cc:null,bL:null,bM:null,bO:null,bP:null,bB:0,bv:null,bK:null,H:function(){return this.bK},Z:null,i:function(n){var t={};return t.Name=n.Name,t.BindingType=n.BindingType,t.HasHeaders=n.HasHeaders,n.IsValidRef&&(t.ColCount=n.Reference.LastColumn-n.Reference.FirstColumn+1,t.RowCount=n.Reference.LastRow-n.Reference.FirstRow+1),t},N:function(n,t){var i=this.cz(t);this.bf.launchInsertDialog(n,null,i)},P:function(n,t){var i={};i.callbackFunc=n;i.storeType=OSF.StoreTypeEnum.MarketPlace;i.fromInsertDialog=!1;i.refresh=t;this.bf.queryEntitlementDetails(i)},invokeDdaMethod:function(n,t){var i=this.bb(n.DdaMethod.ControlId);if(!i){this.bc(5001,t,!0);return}i.bd(n,t)},registerDdaEventAsync:function(n,t,i,r,u){var f=this.bb(t);if(!f){this.bc(5001,u,!0);return}if(!_Ewa.bc.k(n)){this.bc(5e3,u,!0);return}f.bh(n,i,r,u)},unregisterDdaEventAsync:function(n,t,i,r,u){var f=this.bb(t);if(!f){this.bc(5001,u,!0);return}if(!_Ewa.bc.k(n)){this.bc(5e3,u,!0);return}f.bn(n,i,r,u)},dispose:function(){this.bT||(this.Z.C(this.bJ),this.bh.h(this.bH),this.bh.E(this.bF),this.bh.s(this.bI),this.by.b(this),this.Z.f().e(this.bG),this.Z=null,this.by=null,this.bd=null,this.ba=null,this.bA=null,this.bn&&(this.bn.dispose(),this.bn=null),System.a.a(this.bu),System.a.a(this.bt),this.bp&&(this.bp.dispose(),this.bp=null),_Ewa.bW.prototype.dispose.call(this),this.bT=!0,Diag.a.a(39613473,0,50,"DdaFacade is disposed"))},e:function(n){var t=this.bb(n);return t?t.Y():null},V:function(n){var t,r,i;if(this.bR!==n){for(this.bR=n,t=0,r=this.ba.length;t<r;t++)i=this.ba[t],n?i.J(!1):i.W();this.bu.u(n);this.bt.u(n)}},J:function(n){var t=this.bb(n);return t?t.X():null},cY:function(){var s,f,n,t,e,i,o,r,u;for(this.bm=this.bh.m().WebExtensions,s=this,f=function(n){return _Ewa.a.b(124)?!n.i||!n.i.length:!0},n=this.ba.length-1;n>=0;--n)t=this.ba[n],e=this.cI(t.b.InstanceId),!e&&f(t)&&(t.P(),Array.removeAt(this.ba,n));if(this.bm)for(i=0,o=this.bm.length;i<o;i++)r=this.bm[i],u=this.bb(r.WebExtensionId),u&&(u.f=r)},cU:function(n){this.er("csc",n.getID(),null)},Y:function(n,t,i){var s,r,nt,tt,bt,a,v,y,p,kt,dt,gt,it,ni,h,f,ti,ii,rt,w,ri,fi,b,e,vi,ft,k,d,o,et,ei,ot,c,st,g,ht,u,yi,ct,lt,pi,at,oi,si,vt,hi,yt,l,pt;if(_Ewa.a.a("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&t===OSF.AgaveHostAction.KeyboardShortcuts){s=$$as(Object,i);r={};r.keyCode=s.keyCode;r.type="keydown";r.ctrlKey=s.ctrlKey;r.shiftKey=s.shiftKey;r.altKey=s.altKey;r.metaKey=s.metaKey;nt=this.bb(n);tt=nt.l;r.srcElement=_Ewa.cP.isInstanceOfType(tt)?tt.e():_Ewa.c.a(this.Z).H();var ci=new Sys.UI.DomEvent(r),li=_Ewa.bc.b(nt.b,this.Z),wt={};wt.focusedAddinId=li;bt=new _Ewa.L(1461300262,1,this.Z.p(),6,null);_Ewa.c.a(this.Z).cK(ci,bt,wt)}else if(t===OSF.AgaveHostAction.Select)this.bX&&_Ewa.c.a(this.Z).x(!0),this.ck(!0);else if(t===OSF.AgaveHostAction.UnSelect)this.ck(!1);else if(t===OSF.AgaveHostAction.CancelDialog)this.bg(-684355545,null,!0);else if(t===OSF.AgaveHostAction.InsertAgave)a={},v=i,v&&(a.ack5=v,a.CommandValueId=_Ewa.bc.i(v),this.bg(-741808261,a,!0));else if(t===OSF.AgaveHostAction.InsertDevManifest)y={},p=i,p&&(y.ack5=p,y.CommandValueId=_Ewa.bc.i(p),this.bg(-741808261,y,!0));else if(t===OSF.AgaveHostAction.InsertDevManifestError)kt=$$as(Object,i),dt={ak1:this.bf.getDevManifestInvalidUrlErrorString(kt.manifestUrl)},this.bg(-2025863019,dt,!0);else if(t===OSF.AgaveHostAction.NotifyHostError)gt={ak1:this.bf.getManifestInvaildErrorString()},this.bg(-2025863019,gt,!0);else if(t===OSF.AgaveHostAction.RefreshAddinCommands)_Ewa.a.b(54)&&this.bg(543799107,null,!0);else if(t===OSF.AgaveHostAction.CtrlF6Exit||t===OSF.AgaveHostAction.CtrlF6ExitShift){if(it=this.Z.a().a(_Ewa.fL,15,!1,null),!it)return;ni=this.bb(n);h=ni.l;h&&h.be();Common.c.b()&&document.activeElement.blur();f={};f.keyCode=117;f.type="keydown";f.ctrlKey=!0;f.shiftKey=t===OSF.AgaveHostAction.CtrlF6ExitShift;f.srcElement=_Ewa.cP.isInstanceOfType(h)?h.e():_Ewa.c.a(this.Z).H();ti=new Sys.UI.DomEvent(f);it.b(ti)}else if(t===OSF.AgaveHostAction.PageIsReady){if(ii=this.bb(n),rt=ii.l,rt&&rt.m()===OSF.OsfControlTarget.TaskPane){if(w=this.Z.a().a(_Ewa.dU,183,!1,null),!w)return;if(this.ba){ri=_Ewa.s.a(this.Z);for(var ui=this.ba,ai=ui.length,ut=0;ut<ai;++ut)fi=ui[ut],_Ewa.bc.d(fi.k())&&(ri?w.O(!0,!1):w.o())}}}else if(t===OSF.AgaveHostAction.TabExit)if(b=this.bb(n),e=b.l,e){if(e.m()===OSF.OsfControlTarget.InContent)e.bB();else if(e.m()===OSF.OsfControlTarget.TaskPane)if(_Ewa.s.a(this.Z))Common.c.b()&&document.activeElement.blur(),vi=this,Common.UISurfaces.a().then(function(n){var t=_Ewa.cP.isInstanceOfType(e)?e:null;return t?t.E()?n.focusResizeHandle(2):n.focusTabbedTaskPaneArea(2):n.focusTabbedTaskPaneArea(2),null});else{if(ft=this.Z.a().a(_Ewa.dU,183,!1,null),!ft)return;Common.c.b()&&document.activeElement.blur();k=document.getElementById(this.Z.l()+"novTaskPaneResizeButton");k&&_Ewa.b.d(k)?_Ewa.b.c(k,!1):ft.o()}}else b&&b.m===4&&this.bf.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.TabExitShift)d=this.bb(n),o=d.l,o?o.m()===OSF.OsfControlTarget.InContent?o.cj():o.m()===OSF.OsfControlTarget.TaskPane&&(et=_Ewa.cP.isInstanceOfType(o)?o:null,et&&(Common.c.b()&&document.activeElement.blur(),et.r())):d&&d.m===4&&this.bf.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.EscExit||t===OSF.AgaveHostAction.ExitNoFocusable||t===OSF.AgaveHostAction.ExitNoFocusableShift){if(ei=this.bb(n),ot=ei.l,ot)ot.be();else if(t===OSF.AgaveHostAction.EscExit){for(c=null,st=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge();st.$$mn();)if(g=st.$$cu(),g.a.b===n){g.a.a.F();c=g.b;break}c&&(ht=this.bb(c),ht&&ht.m!==4&&this.bi().notifyAgave(c,OSF.AgaveHostAction.TabIn))}}else if(t===OSF.AgaveHostAction.InstallCustomFunctions){if(!_Ewa.a.b(124)){Diag.a.a(36721667,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");return}u=i;yi=this;_Ewa.cs.a(this.Z).b(function(){return!1});ct=this;_Ewa.g.a(_Ewa.l.a(_Ewa.ef,this.Z.a(),278,279,1,null),function(n){var t=n.a(),i;ct.Z.a().a(_Ewa.ef,278,!1,null)||ct.Z.a().b(_Ewa.ef,278,t);i=u.osfControl.getStoreType();_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?t.a(u.osfControl.getSolutionId(),i,_Ewa.bc.j(u.osfControl),u).e():t.a(u.osfControl.getMarketplaceID(),i,_Ewa.bc.j(u.osfControl),u).e()},this.ew(),3,null,null)}else if(t===OSF.AgaveHostAction.UninstallCustomFunctions){if(!_Ewa.a.b(124)){Diag.a.a(39965697,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");return}lt=i;pi=this;_Ewa.cs.a(this.Z).b(function(){return!1});at=this;_Ewa.g.a(_Ewa.l.a(_Ewa.ef,this.Z.a(),278,279,1,null),function(n){var t=n.a();at.Z.a().a(_Ewa.ef,278,!1,null)||at.Z.a().b(_Ewa.ef,278,t);t.d(lt.solutionId,lt.storeType).e()},this.ew(),3,null,null)}else t===OSF.AgaveHostAction.SendTelemetryEvent?Common.App.AppsForOffice.h.b(i):t===OSF.AgaveHostAction.SendCustomerContent?Common.App.AppsForOffice.h.a(i):t===OSF.AgaveHostAction.LaunchExtensionComponent?(oi=i,si=Common.App.AppsForOfficeCommon.b.a(),si.c(oi)):t===OSF.AgaveHostAction.RefreshRibbonGallery?(vt=this.Z.a().a(_Ewa.eL,352,!1,null),vt&&vt.d(i)):t===OSF.AgaveHostAction.RemoveAppCommandsAddin?(hi=i,this.da(hi.assetId),_Ewa.s.a(this.Z)||(yt=this.Z.a().a(_Ewa.dU,183,!1,null),yt&&yt.b())):t===OSF.AgaveHostAction.GetOriginalControlId&&(l=i,pt=new CommandUI.AddInCommands.b(this.Z.l(),l.ownerAssetId,new _Ewa.ok,!0),l.originalControlId=pt?pt.a(l.controlId):l.controlId)},bc:function(n,t,i){var r={};r.CommandValueId=n;r.DdaMethodCallback=t;this.bg(451041795,r,i)},bk:function(n){var t={};t.DdaMethodCallback=n;this.bg(1237877382,t,!0)},bg:function(n,t,i){var e=new _Ewa.L(n,0,this.Z.p(),0,null),u=t?t.DdaMethodCallback:null,f,r;this.bp&&_Ewa.c.a(this.Z).m()&&_Ewa.uv.b(n,t)?this.bp.g(n,t):(f=this.Z.i().a(e,t,null),i&&(r=this,_Ewa.g.a(f,function(n){var t=!1,i=n;_Ewa.cb.b(i)?r.bc(5001,u,t):i.a()||(_Ewa.c.a(r.Z).m()?r.bc(5004,u,t):r.bc(5001,u,t))},this.ew(),8,null,null)))},cC:function(n){var t=this;return!!this.bq(function(i){return _Ewa.bc.a(i.b,t.Z)===_Ewa.bc.a(n,t.Z)&&i.b.PrimaryMarketplace.MarketplaceType===n.PrimaryMarketplace.MarketplaceType&&i.b.PrimaryMarketplace.MarketplaceRef===n.PrimaryMarketplace.MarketplaceRef&&i.b.PrimaryMarketplace.SolutionVersion===n.PrimaryMarketplace.SolutionVersion})},bb:function(n){var t=this;return this.bq(function(t){return t.b.InstanceId.startsWith(n)})},cH:function(n){var t=this;return this.bq(function(t){return t.i===n})},ch:function(n){var t=this;return this.bq(function(t){return t.k()===n&&!(!t.i||!t.i.length)})},ci:function(n,t,i,r){var u=this;return this.bq(function(u){return u.k()===n&&u.b.PrimaryMarketplace.MarketplaceRef.toLowerCase()===t.toLowerCase()&&u.b.PrimaryMarketplace.MarketplaceType.toLowerCase()===i.toLowerCase()&&!!u.b.SharedRuntime&&!!u.b.SharedRuntime.Resid&&!!r&&!!r.Resid&&u.b.SharedRuntime.Resid.toLowerCase()===r.Resid.toLowerCase()})},cy:function(n,t){var i=this.bb(n);i&&(i.I(t),i.z(!0))},dd:function(n,t){var i=this.bb(n);i&&i.z(t)},k:function(n){var t,i,r;(n.WebExtensionType!==1||this.Z.s()&8388608&&n.TaskpaneVisible||this.Z.s()&8388608&&!n.TaskpaneVisible&&_Ewa.j.d(n))&&(t=null,_Ewa.j.d(n)&&(t=_Ewa.bc.b(n,this.Z),_Ewa.a.a("OfficeVSO:5647070_OverwriteSharedRuntimeTaskpaneWidth")&&n.TaskpaneWidth||(n.TaskpaneWidth=this.bz)),i=new _Ewa.ha(this,this.bd,n,!1).G(),Diag.a.a(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(n.PrimaryMarketplace.MarketplaceType,n.PrimaryMarketplace.MarketplaceRef,n.PrimaryMarketplace.SolutionId,null,null),n.PrimaryMarketplace.MarketplaceType,_Ewa.j.d(n)),t&&(i.i=t),Array.add(this.ba,i),this.bl=null,this.cl(n.InstanceId)||(r=String.format("{0}|{1}|{2}|{3}|{4}",n.PrimaryMarketplace.SolutionId,n.PrimaryMarketplace.SolutionVersion,n.PrimaryMarketplace.MarketplaceRef,n.PrimaryMarketplace.MarketplaceType,n.WebExtensionType),this.er("ci",r,null)))},X:function(n,t){var i,r;n.TaskpaneWidth=this.bz;n.TaskpaneVisible=!0;i={};_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.SolutionId=n.PrimaryMarketplace.SolutionId,i.TargetType=n.WebExtensionType,i.Version=n.PrimaryMarketplace.SolutionVersion,i.StoreType=n.PrimaryMarketplace.MarketplaceType,i.StoreId=n.PrimaryMarketplace.MarketplaceRef,i.AssetId=n.PrimaryMarketplace.SolutionId,i.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,i.Width=n.TaskpaneWidth,i.Id=n.PrimaryMarketplace.SolutionId,i.AppVersion=n.PrimaryMarketplace.SolutionVersion,i.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType):(i.Id=n.PrimaryMarketplace.SolutionId,i.TargetType=n.WebExtensionType,i.AppVersion=n.PrimaryMarketplace.SolutionVersion,i.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType,i.StoreId=n.PrimaryMarketplace.MarketplaceRef,i.AssetId=n.PrimaryMarketplace.SolutionId,i.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,i.Width=n.TaskpaneWidth);r=new _Ewa.ha(this,this.bd,n,!0);r.G();Array.add(this.ba,r);var f=this,o=function(){f.v(r.b.InstanceId);f.bi().purgeOsfControl(r.b.InstanceId,!1);t()},u=null,e=this;u=_Ewa.B.a().b(function(){r.e&&(System.a.a(u),u=null,e.a().insertBlankControlWithErrorUX(e.cs(r,i),o))},100,_Ewa.o.R,!0,!1)},B:function(n){if(n&&n.length){var i=[],t=this;Array.forEach(n,function(n){var r=n,u;r.ContainsCustomFunctions&&(u=_Ewa.bc.b(r,t.Z),t.bE.b(u)||(t.bE.a(u),Array.add(t.bV,r)),t.cC(r)||Array.add(i,r))});i.length&&this.cf(i)}},t:function(n,t){if(!this.bb(n.InstanceId)){var i=t(),r=new _Ewa.ha(this,this.bd,n,!1).O(i);Array.add(this.ba,r);this.bl=null}},W:function(n){_Ewa.bc.c.c(n)&&_Ewa.bc.c.a(n).c()},K:function(n){_Ewa.bc.c.c(n)&&_Ewa.bc.c.a(n).b()},cO:function(n){var u=null,t,r,i=null,f,e,o,s,h;return(t=_Ewa.bc.h(n,!0),!t)?(Diag.a.a(50426760,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),$$sc.a.a(String,null)):(r=this.bf.getOsfControl(_Ewa.bc.a(t,this.Z)),r&&(f=r.getManifest(),f&&(i=f.getSharedRuntimeForCustomFunctions("Workbook"))),u=i&&i.LifeTime===1?this.ci(t.PrimaryMarketplace.SolutionId,t.PrimaryMarketplace.MarketplaceRef,t.PrimaryMarketplace.MarketplaceType,i):this.cH(n),u)?$$sc.a.a(String,u.b.InstanceId):(e=new($$sc.D.$$(String)),_Ewa.j.z(i)&&(t.SharedRuntime=i),o=r?r.getNotificationParams():[],!o.length)?this.cg(t):(s=this,h=this,this.cv(o,function(){_Ewa.g.a(e.b,function(){s.cg(t)},s.ew(),3,null,null)},function(){}),e.b)},cM:function(n){var r=null,t=_Ewa.bc.h(n,!1),i,u,f;return t?(i=null,u=this.bf.getOsfControl(_Ewa.bc.a(t,this.Z)),u&&(f=u.getManifest(),f&&(i=f.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"))),_Ewa.j.z(i)&&(r=this.ci(t.PrimaryMarketplace.SolutionId,t.PrimaryMarketplace.MarketplaceRef,t.PrimaryMarketplace.MarketplaceType,i),r))?r.b.InstanceId:null:(Diag.a.a(592196425,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null)},cD:function(n,t){var r=_Ewa.bc.h(n,!1),u,o,s,a,v,i,l;if(!r){Diag.a.a(592196424,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null");return}if(u=null,o=this.bf.getOsfControl(_Ewa.bc.a(r,this.Z)),o&&(s=o.getManifest(),s&&(u=s.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"))),_Ewa.j.z(u))r.SharedRuntime=u;else return;var f=r.PrimaryMarketplace.SolutionId,e=r.PrimaryMarketplace.SolutionVersion,h=OSF.OsfManifestManager.getCachedManifest(f,e);if(h){if(this.bx.c(n)){a=this.bx.a(n);v=this;_Ewa.g.a(a,function(n){var i=n.a();i&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(i,t,v.bd.e)},this.ew(),3,null,null);return}i={};_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.solutionId=f,i.version=e,i.storeType=r.PrimaryMarketplace.MarketplaceType,i.storeId=r.PrimaryMarketplace.MarketplaceRef,i.assetId=f,i.assetStoreId=null,i.targetType=OSF.OsfControlTarget.TaskPane):(i.appVersion=e,i.assetId=f,i.storeType=r.PrimaryMarketplace.MarketplaceType,i.storeId=r.PrimaryMarketplace.MarketplaceRef,i.targetType=OSF.OsfControlTarget.TaskPane);var c=new($$sc.D.$$(String)),y=_Ewa.g.c(),p=new _Ewa.fe(this.Z,this,i,y,null),w=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(f,u.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(h,w,e);l=this;p.createUILessSandbox(i,h,function(i,r){i&&!r?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(i,t,l.bd.e),c.a(i)):c.a(null);l.bx.f(n)});this.bx.b(n,c.b)}},s:function(n){var t=this.ch(n),i;t&&(i=t.b.SharedRuntime,i||this.g(t.b.InstanceId))},g:function(n){var t=this.ch(n);return t?(this.v(t.b.InstanceId),!0):!1},cF:function(n,t){var r,u,f,e,i;if(!this.ba||!n||!t)return!1;if(n.toLowerCase()===t.toLowerCase())return!0;for(r=null,u=null,f=0,e=this.ba.length;f<e;f++)if(i=this.ba[f],_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(i.b.OwnerAddinSolutionId&&(i.b.InstanceId===n&&(r=i.b.OwnerAddinSolutionId.toLowerCase()),i.b.InstanceId===t&&(u=i.b.OwnerAddinSolutionId.toLowerCase()),r&&u))break}else if(i.b.OwnerAddinAssetId&&(i.b.InstanceId===n&&(r=i.b.OwnerAddinAssetId.toLowerCase()),i.b.InstanceId===t&&(u=i.b.OwnerAddinAssetId.toLowerCase()),r&&u))break;return r&&r===u?!0:!1},cx:function(n){if(!this.bb(n.InstanceId)){var t=new _Ewa.ha(this,this.bd,n,!1);Array.add(this.ba,t);this.bl=null}},bW:function(n){if(this.ba&&n>=0&&n<this.ba.length){var t=this.ba[n],i=t.e;return Array.removeAt(this.ba,n),this.co(t),_Ewa.b.f(i),!0}return!1},v:function(n){if(!this.ba)return!1;for(var t=0,i=this.ba.length;t<i;t++)if(this.ba[t].b.InstanceId===n)return this.bW(t);return!1},da:function(n){var r,i,t,u;if(!this.ba)return!1;for(n==="WA200002680"&&(r=this.Z.a().a(_Ewa.dN,271,!1,null),r.v()),i=n.toLowerCase(),t=0,u=this.ba.length;t<u;t++)if(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(i===this.ba[t].b.OwnerAddinSolutionId.toLowerCase())return this.bW(t)}else if(i===this.ba[t].b.OwnerAddinAssetId.toLowerCase())return this.bW(t);return!1},z:function(n){n.cw()&&(this.bb(n.a().v.InstanceId)||(this.cm(n.a().v.InstanceId)||Array.add(this.bA,n.a().v.InstanceId),this.k(n.a().v)),this.bh.b()&&this.cy(n.a().v.InstanceId,n.g()))},c:function(n){if(this.ba)for(var t=0,i=this.ba.length;t<i;t++)if(this.ba[t].b.WebExtensionType===1&&_Ewa.f.b(this.ba[t].k(),n,!0))return this.ba[t].b.InstanceId;return null},cG:function(n){var i=[],t,r;if(this.ba)for(t=0,r=this.ba.length;t<r;t++)_Ewa.f.b(this.ba[t].k(),n,!0)&&i.push(this.ba[t].b.InstanceId);return i},u:function(n,t){if(!t||!n||!n.length)return null;if(this.ba)for(var i=0,r=this.ba.length;i<r;i++)if(this.ba[i].b.WebExtensionType===1&&_Ewa.f.b(this.ba[i].k(),n,!0)&&this.ba[i].b.SharedRuntime&&_Ewa.f.b(this.ba[i].b.SharedRuntime.Resid,t.Resid,!0))return this.ba[i].b.InstanceId;return null},l:function(n,t){return n?t?String.format("{0}.{1}",n,t):n:""},j:function(n,t,i,r){var f,s,u,h,o,e;if(this.bl===n)return!0;if(this.bl=n,f=t,s=!1,(!f||!f.length)&&this.ba)for(u=0,h=this.ba.length;u<h;u++)if(this.ba[u].b.WebExtensionType===1&&_Ewa.f.b(this.ba[u].k(),n,!0)&&(o=!1,e=!1,i?(o=!0,e=!!this.ba[u].b.SharedRuntime&&_Ewa.f.b(this.ba[u].b.SharedRuntime.Resid,i.Resid,!0)):r&&(o=!0,e=_Ewa.f.b(this.ba[u].b.SharedRuntimeId,r,!0)),!o||e)){e&&this.ba[u].T(!0);f=this.ba[u].b.InstanceId;s=!0;this.bl=null;break}return!f||!f.length||this.er("ca",f,null),s},U:function(n,t){var i,r;if(!n||!n.length){Diag.a.a(51176384,0,15,"SetAppRuntimeState: Invalid controlId.");throw Error.invalidOperation(_Ewa.ClientStringManager.a().a(2119));}else if(i=this.bb(n),i&&_Ewa.j.d(i.b))i.T(t),t&&(this.er("ca",n,null),i.e&&i.e.firstChild&&(r=i.e.firstChild.title,r&&r.length>0&&this.cL().a(r)));else{Diag.a.a(51176355,0,50,"SetAppRuntimeState: run on non-shared runtime app.");throw Error.invalidOperation(_Ewa.ClientStringManager.a().a(2118));}},I:function(n){var i=!1,t;if(!n||!n.length){Diag.a.a(51176386,0,15,"GetAppRuntimeState: Invalid controlId.");throw Error.invalidOperation(_Ewa.ClientStringManager.a().a(2119));}else if(t=this.bb(n),t&&_Ewa.j.d(t.b))i=t.b.TaskpaneVisible;else{Diag.a.a(51176385,0,50,"GetAppRuntimeState: run on non-shared runtime app.");throw Error.invalidOperation(_Ewa.ClientStringManager.a().a(2118));}return i},C:function(n,t){var i=this.bb(n);return i?i.F(t):null},cl:function(n){return this.ce(this.bA,n)},cm:function(n){return this.ce(this.bS,n)},r:function(n){Array.add(this.bS,n)},h:function(){return this.ba},b:function(n){var t=this.bb(n);return t?t.b:null},a:function(){return this.bi()},m:function(n){this.er("ekros",n,this)},cp:function(n){var i,t;n&&(i=this.bb(n.InstanceId),i&&(n.SharedRuntime||n.SharedRuntimeId||(this.v(i.b.InstanceId),this.bi().purgeOsfControl(i.b.InstanceId,!1)),t={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.SolutionId=n.PrimaryMarketplace.SolutionId,t.TargetType=n.WebExtensionType,t.Version=n.PrimaryMarketplace.SolutionVersion,t.StoreType=n.PrimaryMarketplace.MarketplaceType,t.StoreId=n.PrimaryMarketplace.MarketplaceRef,t.AssetId=n.PrimaryMarketplace.SolutionId,t.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,t.Width=n.TaskpaneWidth,t.SharedRuntimeId=n.SharedRuntimeId,t.Id=n.PrimaryMarketplace.SolutionId,t.AppVersion=n.PrimaryMarketplace.SolutionVersion,t.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType):(t.Id=n.PrimaryMarketplace.SolutionId,t.TargetType=n.WebExtensionType,t.AppVersion=n.PrimaryMarketplace.SolutionVersion,t.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType,t.StoreId=n.PrimaryMarketplace.MarketplaceRef,t.AssetId=n.PrimaryMarketplace.SolutionId,t.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,t.Width=n.TaskpaneWidth,t.SharedRuntimeId=n.SharedRuntimeId),this.cw(t)))},d:function(){this.bd.o()},cK:function(n,t,i){this.bd.a(n,t,i)},T:function(n,t){var i=new Array(2);i[0]=t;i[1]=null;this.bd.r(n,JSON.stringify(i))},cj:function(n,t){var i=_Ewa.bc.n(t),r=this.b(n);this.bd.g(r.InstanceId,2202,"Workbook",i)},cJ:function(n){for(var t=0,i=this.ba.length;t<i;t++)this.cj(this.ba[t].b.InstanceId,n)},E:function(n,t){var i=_Ewa.bc.m(t);this.bd.g(n,65539,"",i)},G:function(n,t,i){this.bd.g(n,1,t,i)},D:function(n,t){this.bd.q(n,t)},A:function(n,t){return[[2,1e3,"",JSON.stringify([n,t]),0,!1]]},L:function(){return!!this.bj&&this.bj.b()},cB:function(){this.bj&&this.bj.c()},F:function(){var s=!!this.bj&&this.bj.b(),i,u,f,o;if(s){i=this.bj.d();for(var r=i,h=r.length,n=0;n<h;++n){u=r[n];f=this.cG(u);for(var e=f,c=e.length,t=0;t<c;++t)o=e[t],this.bd.g(o,65540,"","{}")}}},bq:function(n){var i;if(!this.ba)return null;for(var r=this.ba,u=r.length,t=0;t<u;++t)if(i=r[t],n(i))return i;return null},cg:function(n){var t=new($$sc.D.$$(String)),u=_Ewa.bc.b(n,this.Z),i,r;return _Ewa.j.d(n)?(Diag.a.a(571774670,0,50,"Shared runtime custom function agave is started."),i=this,this.cq(n,function(r){if(!r){Diag.a.a(542185168,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(n.PrimaryMarketplace.MarketplaceType,n.PrimaryMarketplace.MarketplaceRef,n.PrimaryMarketplace.SolutionId,null,null));t.SX(Error.create("Null insert data"));return}n.InstanceId=r.InstanceId;n.WebExtensionOsfControlType=3;n.TaskpaneVisible=!1;i.k(n);t.a(n.InstanceId)})):(_Ewa.bc.c.b(n.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog),r=_Ewa.bc.c.a(n.InstanceId).a(),this.cE(n,r,u),this.cq(n,null),t.a(n.InstanceId)),t.b},cE:function(n,t,i){if(!this.bb(n.InstanceId)){var r=new _Ewa.ha(this,this.bd,n,!1);r.i=i;r.O(t);Array.add(this.ba,r);this.bl=null}},cq:function(n,t){var u=_Ewa.bc.b(n,this.Z),r,e;if(this.bE.b(u)){if(t)for(var f=this.bV,o=f.length,i=0;i<o;++i)if(r=f[i],e=_Ewa.bc.b(r,this.Z),e===u){t(r,0);break}}else this.br.push(n),this.br.length>=1&&this.cr(n,t)},cr:function(n,t){var f=null,i={},a,v,y;_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.SolutionId=_Ewa.bc.a(n,this.Z),i.TargetType=n.WebExtensionType,i.Version=n.PrimaryMarketplace.SolutionVersion,i.StoreType=n.PrimaryMarketplace.MarketplaceType,i.StoreId=n.PrimaryMarketplace.MarketplaceRef,i.AssetId=n.PrimaryMarketplace.SolutionId,i.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,i.Width=n.TaskpaneWidth,i.ContainsCustomFunctions=!0,i.Id=_Ewa.bc.a(n,this.Z),i.AppVersion=n.PrimaryMarketplace.SolutionVersion,i.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType):(i.Id=_Ewa.bc.a(n,this.Z),i.TargetType=n.WebExtensionType,i.AppVersion=n.PrimaryMarketplace.SolutionVersion,i.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType,i.StoreId=n.PrimaryMarketplace.MarketplaceRef,i.AssetId=n.PrimaryMarketplace.SolutionId,i.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,i.Width=n.TaskpaneWidth,i.ContainsCustomFunctions=!0);_Ewa.j.d(n)&&(i.SharedRuntimeId=n.SharedRuntime.Resid);var e=this.Z.c().a(),c=this.Z.c().a().b(!1),o=e.a(9,c);o.sharedInfo=i;var p=this,s=function(n){var t=_Ewa.X.a(n.b);Diag.a.a(38372576,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",_Ewa.i.a(t,","))},r=this,h=function(n){if((!n||_Ewa.O.a(n))&&(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Diag.a.a(39965700,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(i.StoreType,i.StoreId,i.SolutionId,null,null),_Ewa.i.a(n.Errors,",")):Diag.a.a(539305358,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(i.CurrentStoreType,i.StoreId,i.Id,null,null),_Ewa.i.a(n.Errors,","))),r.br.shift(),r.br.length>0){var u=r.br[0];r.cr(u,t)}},u;if(t){var w=this,l=function(n){var i=n.Result;f=i?i.AgaveData:null;f||t(null,n.Errors?n.Errors[0].ErrorCause:5001);t(f,0)},b=this;u=function(n,t,i){return _Ewa.k.a(e,"InsertAgaveTaskpane",o,_Ewa.n.a(n,h,l),_Ewa.n.b(t,s),i,null,0,null,null)}}else a=this,u=function(n,t,i){return _Ewa.k.a(e,"InsertAgaveTaskpane",o,_Ewa.n.a(n,h),_Ewa.n.b(t,s),i,null,0,null,null)};_Ewa.a.d()?(v=this,_Ewa.H.a(this.Z.f(),u,function(n){return new _Ewa.v(519,0,n,64,null)},null)):(y=this,_Ewa.H.a(this.Z.f(),u,function(n){return new _Ewa.ba(519,0,n,0,null)},null))},dc:function(){return this.Z.y().a(35)},n:function(n){var t=this.bb(n);t&&t.h&&t.S()},O:function(n){var r=this,i=this.bq(function(n){return _Ewa.bc.d(n.k())}),t;i&&(t=this.bi().getOsfControl(i.b.InstanceId),t&&t.notifyAgave(OSF.AgaveHostAction.SendMessage,n))},M:function(){var t=this,n=this.bq(function(n){return n.b.WebExtensionType===1&&_Ewa.bc.d(n.k())});return!!n},cQ:function(){var n=isNullOrUndefined(this.Z)||_Ewa.a.b(265);isNullOrUndefined(this.Z)&&Diag.a.a(39965576,0,50,"VSO#2693929: Initialize is called. EwaControl is null");n&&Diag.a.a(39965577,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.bD);this.bD||(_Ewa.uD.a(this.Z),this.bh=this.Z.b(),this.bd=new _Ewa.mv(this.Z),this.Z.B(this.bJ),this.bh.g(this.bH),this.bh.z(this.bF),this.bh.q(this.bI),this.Z.f().d(this.bG),this.cn(),this.cT(),this.cR(),this.Z.a().b(_Ewa.bQ,35,this),this.by.a(this),n&&Diag.a.a(39965578,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.be=new _Ewa.on,n&&Diag.a.a(39965579,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.bN=new _Ewa.EX(this.Z,this.be,this.bd),this.cc=new _Ewa.EY(this.Z,this.be,this.bd),this.bu=new _Ewa.EV(this.Z,this.be,this.bd),this.bt=new _Ewa.EU(this.Z,this.be,this.bd),this.bL=new _Ewa.ET(this.Z,this.be,this.bd),this.bM=new _Ewa.EW(this.Z,this.be,this.bd),this.bO=new _Ewa.EZ(this.Z,this.be,this.bd),this.bP=new _Ewa.Fa(this.Z,this.be,this.bd),this.Z.bj()&&(this.bv=new _Ewa.Fb(this.Z,this.be,this.bd)),_Ewa.a.b(194)&&(this.bp=new _Ewa.uv(this,_Ewa.c.a(this.Z))),_Ewa.a.a("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.bj=new _Ewa.ES),this.bD=!0,Diag.a.a(39613474,0,50,"DdaFacade is initialized"))},cI:function(n){if(!this.bm)return null;for(var t=0,i=this.bm.length;t<i;t++)if(n.startsWith(this.bm[t].WebExtensionId))return this.bm[t];return null},cn:function(){var i=this.bh,n,r,t,f,u,e;if(i.a()&&!this.bs){if(i.j()){if(this.bC=this.Z.b().e().a(22),i.j().WebExtensions&&i.j().WebExtensions.length){for(n=i.j().WebExtensions,r=!1,t=n.length-1;t>=0;t--){if(!this.bh.b()){if(Array.add(this.bA,n[t].InstanceId),n[t].WebExtensionType!==1){Array.removeAt(n,t);continue}if(_Ewa.j.d(n[t])&&n[t].SharedRuntime.State)n[t].SharedRuntime.State===1?n[t].TaskpaneVisible=!1:n[t].SharedRuntime.State===2?n[t].TaskpaneVisible=!0:Diag.a.a(51176387,0,10,"The sharedRuntime state is invalid");else if(!n[t].ContainsCustomFunctions&&!n[t].TaskpaneVisible&&!_Ewa.jA.a(n[t])){Array.removeAt(n,t);continue}}f=OSF.OsfControl.isFirstPartyStoreString(n[t].PrimaryMarketplace.MarketplaceType);_Ewa.a.b(190)&&!f&&(Array.removeAt(n,t),r||(r=!0,u=_Ewa.l.a(_Ewa.cR,this.Z.a(),5,4,3,null),e=this,_Ewa.g.a(u,function(){u.a().a(33,null,null,null)},this.ew(),3,null,null)));_Ewa.a.a("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&n[t].PrimaryMarketplace&&_Ewa.bc.d(n[t].PrimaryMarketplace.SolutionId)&&(Diag.a.a(593248416,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(n,t))}this.cf(n)}}else this.bC=!1;this.bs=!0}},ck:function(n){var u=_Ewa.c.a(this.Z),f=u.a().b().a(),t,r;if(f&&n){if(t=!1,this.ba)for(var e=this.ba,o=e.length,i=0;i<o;++i)if(r=e[i],_Ewa.bc.d(r.k())||_Ewa.bc.q(r.k())){t=!0;break}t||u.a().b().c(f,!0)}},cT:function(){var n=this.bi();n&&this.bh.b()&&this.Z.h()&&_Ewa.D.j(this.Z.h())&&(_Ewa.ms.a(this.Z).br()?_Ewa.ms.a(this.Z).a():_Ewa.ms.a(this.Z).C(this.cb))},cX:function(){this.Z.h()&&_Ewa.D.j(this.Z.h())&&_Ewa.ms.a(this.Z).a()},cf:function(n){for(var u=null,e=100,i=this,r,f,u=function(n){var t=n.WebExtensionData,f=n.IsTaskPane,c=n.RecordHandler,h=function(){if(i.bo.shift(),i.bo.length>0){var n=i.bo[0];u(n)}},o,l,r,s;if(i.c(t.PrimaryMarketplace.SolutionId)){h();return}if(f&&(t.WebExtensionOsfControlType=1),o=_Ewa.jA.a(t),f&&!t.TaskpaneVisible&&!o&&(l=!t.SharedRuntime||!t.SharedRuntime.State,l&&!t.ContainsCustomFunctions)){h();return}r=new _Ewa.ha(i,i.bd,t,!f);Diag.a.a(542185165,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(t.PrimaryMarketplace.MarketplaceType,t.PrimaryMarketplace.MarketplaceRef,t.PrimaryMarketplace.SolutionId,null,null),t.PrimaryMarketplace.MarketplaceType,_Ewa.j.d(t));r.G();_Ewa.j.d(t)&&(r.i=_Ewa.bc.b(t,i.Z),t.TaskpaneWidth=i.bz);o&&(t.WebExtensionToolTip="");f&&t.TaskpaneVisible&&!o&&(t.TaskpaneWidth=i.bz);Array.add(i.ba,r);i.bl=null;s=null;s=_Ewa.B.a().b(function(){r.e&&(System.a.a(s),s=null,c&&c(n,r),h())},e,_Ewa.o.Q,!0,!1)},t=0;t<n.length;t++)this.bb(n[t].InstanceId)||(n[t].WebExtensionType!==1?this.k(n[t]):_Ewa.a.b(54)?(this.Z.s()&8388608||n[t].TaskpaneVisible)&&(r={},r.marketplaceId=n[t].PrimaryMarketplace.SolutionId,r.marketplaceVersion=n[t].PrimaryMarketplace.SolutionVersion,r.storeType=n[t].PrimaryMarketplace.MarketplaceType,r.storeId=n[t].PrimaryMarketplace.MarketplaceRef,r.targetData=n[t],f=this,this.bi().isAddinCommandsAsync(r,function(n,t,i){var o,e,h,c,s,l;if(!n){o=i.targetData;Diag.a.a(542185164,220,10,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(o.PrimaryMarketplace.MarketplaceType,o.PrimaryMarketplace.MarketplaceRef,o.PrimaryMarketplace.SolutionId,null,null),o.PrimaryMarketplace.MarketplaceType);return}if(e=i.targetData,t){if(!_Ewa.a.b(88))return;if(r.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase()){h=r.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase();c=_Ewa.a.a("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&r.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase();(h||c)&&_Ewa.j.d(e)&&f.bw(e,u);return}_Ewa.a.a("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog")?f.cP(i,u):(s=!1,l=function(n){var o=n,l,a,t,r;if(!o.errorCode){if(o.value)for(var c=o.value,v=c.length,h=0;h<v;++h){if(l=c[h],s)break;a=l[1];s=a.toUpperCase()===e.PrimaryMarketplace.SolutionId.toUpperCase()}s?_Ewa.j.d(e)&&f.bw(e,u):(t={},r=i,_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.SolutionId=r.marketplaceId,t.TargetType=e.WebExtensionType,t.Version=r.marketplaceVersion,t.StoreType=e.PrimaryMarketplace.MarketplaceType,t.StoreId=r.storeId,t.AssetId=r.marketplaceId,t.AssetStoreId=r.storeId,t.Width=e.TaskpaneWidth,e.TaskpaneVisible=!0,t.Id=r.marketplaceId,t.AppVersion=r.marketplaceVersion,t.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType):(t.Id=r.marketplaceId,t.TargetType=e.WebExtensionType,t.AppVersion=r.marketplaceVersion,t.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType,t.StoreId=r.storeId,t.AssetId=r.marketplaceId,t.AssetStoreId=r.storeId,t.Width=e.TaskpaneWidth,e.TaskpaneVisible=!0),f.cd(t,e,u))}},f.P(l,!0))}else f.bw(e,u)})):this.bw(n[t],u))},cP:function(n,t){var i=!1,r=this,u=function(u){var o=u,e=n.targetData,c,l,f;if(!o.errorCode){if(o.value)for(var h=o.value,a=h.length,s=0;s<a;++s){if(c=h[s],i)break;l=c[1];i=l.toUpperCase()===e.PrimaryMarketplace.SolutionId.toUpperCase()}i?_Ewa.j.d(e)&&r.bw(e,t):(f={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(f.SolutionId=n.marketplaceId,f.TargetType=e.WebExtensionType,f.Version=n.marketplaceVersion,f.StoreType=e.PrimaryMarketplace.MarketplaceType,f.StoreId=n.storeId,f.AssetId=n.marketplaceId,f.AssetStoreId=n.storeId,f.Width=e.TaskpaneWidth,f.Id=n.marketplaceId,f.AppVersion=n.marketplaceVersion,f.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType):(f.Id=n.marketplaceId,f.TargetType=e.WebExtensionType,f.AppVersion=n.marketplaceVersion,f.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType,f.StoreId=n.storeId,f.AssetId=n.marketplaceId,f.AssetStoreId=n.storeId,f.Width=e.TaskpaneWidth),e.TaskpaneVisible=!0,r.cd(f,e,t))}};this.P(u,!0)},bw:function(n,t){var i={};i.WebExtensionData=n;i.IsTaskPane=!0;this.bo.push(i);this.bo.length===1&&t(i)},cd:function(n,t,i){var r={},u;r.ActivationInfo=n;r.WebExtensionData=t;r.IsTaskPane=!1;u=this;r.RecordHandler=function(n,t){var i=n.ActivationInfo,f=n.WebExtensionData,r=function(){u.v(t.b.InstanceId);u.bi().purgeOsfControl(t.b.InstanceId,!1);u.cw(i)};u.a().insertBlankControlWithErrorUX(u.cs(t,i),r)};this.bo.push(r);this.bo.length===1&&i(r)},cw:function(n){var t={},r,i,u;_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.solutionId=n.SolutionId,t.version=n.Version,t.storeType=n.StoreType,t.storeId=n.StoreId,t.assetId=n.AssetId,t.assetStoreId=n.AssetStoreId,t.targetType=n.TargetType,t.sharedRuntimeId=n.SharedRuntimeId,t.id=n.Id,t.currentStoreType=n.CurrentStoreType,t.appVersion=n.AppVersion):(t.id=n.Id,t.targetType=n.TargetType,t.currentStoreType=n.CurrentStoreType,t.assetId=n.AssetId,t.appVersion=n.AppVersion,t.storeId=n.StoreId,t.assetStoreId=n.AssetStoreId,t.sharedRuntimeId=n.SharedRuntimeId);r=new($$sc.v.$$(Object));r.b(t);i={};i.ack2=r;i.ack0=3;u=new _Ewa.L(407117407,0,this.Z.p(),0,null);this.Z.i().a(u,i,null)},cs:function(n,t){var i={};return Common.a.a.d("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.div=n.e,i.id=n.b.InstanceId,i.solutionId=t.SolutionId,i.version=t.Version,i.storeId=t.StoreId,i.storeType=t.StoreType,i.osfControlType=OSF.OsfControlTarget.TaskPane,i.marketplaceID=t.Id,i.marketplaceVersion=t.AppVersion,i.store=t.StoreId):(i.div=n.e,i.id=n.b.InstanceId,i.marketplaceID=t.Id,i.marketplaceVersion=t.AppVersion,i.store=t.StoreId,i.storeType=t.CurrentStoreType,i.osfControlType=OSF.OsfControlTarget.TaskPane),i},cZ:function(){this.cn()},cV:function(n,t){var i,r,u;t.b===1&&(i=t.a,i&&(r=new _Ewa.Fg(_Ewa.bi.c(i.b),_Ewa.bi.c(i.d),_Ewa.bi.c(i.c),_Ewa.bi.a(i.b,i.d),_Ewa.bi.a(i.d,i.c),i.f,i.a&&i.a.c()&&i.a.c().ServerCorrelationId?i.a.c().ServerCorrelationId:null,i.a?Enum.toString(_Ewa.jD,i.a.a()):null,_Ewa.dj.b(_Ewa.bi.a(i.b,_Ewa.q.a().a()))),u=Sys.Serialization.JavaScriptSerializer.serialize(r),Diag.a.a(50872916,0,50,u)))},cW:function(n,t){!this.bh.a()&&_Ewa.nJ.a(t)?(Array.forEach(this.ba,this.bY),Array.clear(this.ba),this.bs=!1):(t.a&&(Diag.a.a(578888858,0,50,"Silent Reload require reset osf controls."),this.ct()),this.cu(),_Ewa.a.a("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.bs=!1))},cS:function(){_Ewa.a.a("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Diag.a.a(578888857,0,50,"Load on demand occurred require reset osf controls."),this.ct());this.cu();_Ewa.a.a("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.bs=!1)},ct:function(){var i,r,n,u,f,t,o,e;if(_Ewa.a.a("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(i=[],r=0;r<this.ba.length;r++)n=this.ba[r],n.m&&n.m!==3&&n.m!==4||Array.add(i,n);for(u=!1,f=0;f<i.length;f++)t=i[f],this.v(t.b.InstanceId),!u&&t&&t.b&&(u=_Ewa.j.d(t.b));u&&(o={DynamicAddinCommandsMethodDispatchId:4},this.bg(-1014260128,o,!0))}_Ewa.a.b(426)&&(e=this,_Ewa.g.a(_Ewa.l.a(_Ewa.ef,this.Z.a(),278,279,3,null),function(n){if(n){var t=n.a();t&&(e.Z.a().a(_Ewa.ef,278,!1,null)||e.Z.a().b(_Ewa.ef,278,t),t.c().e())}},this.ew(),3,null,null))},cu:function(){var t=new _Ewa.Fd(this.Z,this.be,this.bB);if(isNullOrUndefined(this.Z)?Diag.a.a(39965580,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):_Ewa.a.b(265)&&Diag.a.a(39965581,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+isNullOrUndefined(this.be)),t.e()){var o=this,f=function(){},s=this,e=function(n){var t=_Ewa.X.a(n.b);Diag.a.a(38372578,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",_Ewa.i.a(t,","))},i=t.d(),r=this,u=function(n,t,u){return _Ewa.k.a(r.Z.c().a(),"ExecuteRichApiRequest",r.cA(i),_Ewa.n.a(n,f),_Ewa.n.b(t,e),u,null,0,null,null)},n=_Ewa.bc.g(i,this.Z);_Ewa.a.d()?(n|=64,this.Z.f().b(new _Ewa.v(507,0,u,n,null))):this.Z.f().b(new _Ewa.ba(507,0,u,n,null))}},cA:function(n){var t=this.Z.c().a().a(1,null);return t.request=n,t},co:function(n){var t=n;t.P();this.er("cd",t.b.InstanceId,null)},ce:function(n,t){if(n)for(var i=0;i<n.length;i++)if(_Ewa.f.b(n[i],t,!0))return!0;return!1},cz:function(n){var t={},i;return(t.navigationMode=OSF.OsfNavigationMode.DefaultMode,t.assetId=null,t.category=null,!n||n.length<3)?t:(_Ewa.f.a(n[0])||(i=parseInt(n[0]),isNaN(parseInt(i))||(t.navigationMode=i)),_Ewa.f.a(n[1])||(t.assetId=n[1]),_Ewa.f.a(n[2])||(t.category=n[2]),t)},cR:function(){var n,t;if(_Ewa.a.b(62)&&(n=this.Z.k().FullDocumentInfo.EmbeddingPageOrigin,n&&n.length&&n.trim()!=="*")){this.bn=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new _Ewa.EQ(this),n,this.Z.k().FullDocumentInfo.EmbeddingPageSessionInfo,this.Z.y().a(2));try{this.bn.init()}catch(i){try{this.bn.dispose()}catch(r){}this.bn=null;Diag.a.a(41181569,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+i.message)}t={};t.a=this.Z.e().UserSessionId;_Ewa.F.a().a(39,t,!1)}},cv:function(n,t,i){var r=_Ewa.bc.l(n[0]),u=r.a,f=r.b,e=this,o;r.a=function(){u&&u();var f=r.e!==OSF.InfoType.Error?t:null;n.shift();n.length?e.cv(n,f,i):f&&f()};o=this;r.b=function(){f&&f();i&&r.e!==OSF.InfoType.Error&&i()};CommandUI.AddInCommands.a.h(r)},cN:function(){var n={};return n.AddinRibbonControlsOverriddenByApi=_Ewa.a.a("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString(),n.AddinActionDefinitionHybridMode=_Ewa.a.b(696).toString(),n.UseActionIdForUILessCommand=_Ewa.a.b(702).toString(),n.AllowStorageAccessByUserActivationOnIFrame=_Ewa.a.c("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString(),n.RequirementSetRibbonApiOnePointTwo=_Ewa.a.c("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString(),n.flightingTreatmentVariables=Common.a.a.o,n.ShortcutInfoArrayInUserPreferenceData=_Ewa.a.a("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString(),n}};_Ewa.uz=function(n){this.k=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.p);this.g=new($$sc.w.$$(Function));this.h=new($$sc.w.$$(Function));this.f=n;this.a().b(this.l);this.a().a(this.k)};_Ewa.uz.a=function(n){if(!n.Z.a().a(_Ewa.iw,232,!1,null)){var t=new _Ewa.uz(n);n.Z.a().b(_Ewa.iw,232,t)}};_Ewa.uz.prototype={g:null,h:null,i:null,j:null,f:null,a:function(){return this.i||(this.i=Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance(this.n())),this.i},n:function(){if(!this.j&&this.f){var n=this.f.bi();this.j=n}return this.j},b:function(n,t,i,r){if(_Ewa.a.b(25))this.f.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,i,!0);else{Diag.a.a(19931726,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var u=this,f=function(r){r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(u.g.b(n,t),u.f.bk(i)):(Diag.a.a(19931727,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),u.f.bc(r,i,!0))};this.g.c(n)?f(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.q(n,r,f)}},c:function(n,t,i){_Ewa.a.b(25)?this.f.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,i,!0):(Diag.a.a(595121569,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.h.b(n,t),this.f.bk(i))},d:function(n,t){if(_Ewa.a.b(25))this.f.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0);else if(this.g.c(n)){Diag.a.a(19931728,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");var i=this,r=function(r){i.g.e(n);r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?i.f.bk(t):(Diag.a.a(19931729,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),i.f.bc(r,t,!0))};this.a().c(n,r)}else this.f.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t,!0)},e:function(n,t){_Ewa.a.b(25)?this.f.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0):(Diag.a.a(595121568,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.h.e(n),this.f.bk(t))},q:function(n,t,i){try{var r=this,u=function(n){r.f.cx(r.m(n))};this.a().f(t,n,i,u)}catch(f){Diag.a.a(19690967,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",f.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},m:function(n){var t={};return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.InstanceId=n.id,t.WebExtensionType=n.osfControlType===OSF.OsfControlTarget.InContent?0:1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=n.solutionId,t.PrimaryMarketplace.SolutionVersion=n.version,t.PrimaryMarketplace.MarketplaceRef=n.storeId,t.PrimaryMarketplace.MarketplaceType=n.storeType):(t.InstanceId=n.id,t.WebExtensionType=n.osfControlType===OSF.OsfControlTarget.InContent?0:1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=n.marketplaceID,t.PrimaryMarketplace.SolutionVersion=n.marketplaceVersion,t.PrimaryMarketplace.MarketplaceRef=n.store,t.PrimaryMarketplace.MarketplaceType=n.storeType),t},p:function(n,t){if(this.g.c(t.a)){var i=new _Ewa.baR(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,t.a,null,t.b,t.c,t.d,t.e);this.g.a(t.a)(i);t.b===OSF.DialogMessageType.DialogClosed&&this.g.e(t.a)}},o:function(n,t){if(this.h.c(t.a)){var i=new _Ewa.baS(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,t.a,null,t.d,t.b,t.c,t.e);this.h.a(t.a)(i)}}};_Ewa.EQ=function(n){this.d=Function.createDelegate(this,this.g);this.a=n};_Ewa.EQ.prototype={a:null,b:null,c:!1,invokeDdaMethod:function(n,t){var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.a.bg(974713501,i,!0)},registerDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.bc(-1,u,!0);return}n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&this.f();this.b||(this.b=[]);var f=this.e(n,i);f||(f=new _Ewa.ux(n,i),Array.add(this.b,f));f.e(r);this.a.bk(u)},unregisterDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.bc(-1,u,!0);return}var f=this.e(n,i);f&&f.f(r);this.a.bk(u)},f:function(){if(!this.c){var n=_Ewa.c.a(this.a.Z).a();n.h(this.d);this.c=!0}},g:function(){var t=this,n=function(n){var t=n;t.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&t.d(new _Ewa.qo(t.a,"",null,null))};Array.forEach(this.b,n)},e:function(n,t){var i,r;if(!this.b)return null;for(i=0;i<this.b.length;i++)if(r=this.b[i],r.a===n&&r.c===t)return r;return null}};_Ewa.ER=function(){};_Ewa.ER.a=function(n,t,i){return console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof t+", objectId="+t+", value="+i),null};_Ewa.ha=function(n,t,i,r){this.E=Function.createDelegate(this,this.Q);this.B=Function.createDelegate(this,this.Z);this.D=Function.createDelegate(this,this.bg);this.C=Function.createDelegate(this,this.bf);_Ewa.ha.initializeBase(this);this.d=n.Z;this.c=n;this.b=i;this.b.InstanceId=i.SrcLocationOverrideResourceId?n.l(i.InstanceId,i.SrcLocationOverrideResourceId):i.InstanceId;this.u=t;this.f={};this.f.WebExtensionId=i.InstanceId;this.w="osfControl_"+i.InstanceId;this.r="disabled_"+i.InstanceId;this.f.BindingData=i.BindingData;this.s=this.c.cl(i.InstanceId);this.H=this.c.cm(i.InstanceId);this.m=i.WebExtensionOsfControlType;this.x=r};_Ewa.ha.b=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};_Ewa.ha.a=function(n){return n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent};_Ewa.ha.c=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};_Ewa.ha.prototype={b:null,o:0,u:null,j:null,w:null,f:null,p:!1,t:null,g:0,r:null,c:null,s:!0,H:!1,l:null,m:0,i:null,n:null,q:null,v:!1,x:!1,A:null,a:function(){return this.b.InstanceId},h:null,bc:function(n){this.h||(this.h=n)},S:function(){this.h&&(this.h.dispose(),this.h=null)},d:null,e:null,k:function(){return this.b.SrcLocationOverrideResourceId?this.c.l(this.b.PrimaryMarketplace.SolutionId,this.b.SrcLocationOverrideResourceId):this.b.PrimaryMarketplace.SolutionId},G:function(){var r,e,u,t,i,n,f;return!OSF.OsfControl.isFirstPartyStoreString(this.b.PrimaryMarketplace.MarketplaceType)&&_Ewa.a.b(190)?(r=_Ewa.l.a(_Ewa.cR,this.d.a(),5,4,0,null),e=this,_Ewa.g.a(r,function(){r.a().a(33,null,null,null)},this.ew(),3,null,null),this):(this.b.WebExtensionType===1?(u=this,_Ewa.g.a(_Ewa.ct.a(this.d),function(n){n.a().l(_Ewa.cP,u.d.a(),77,6,u.C,1)},this.ew(),3,null,null)):(t=this.K(),i=_Ewa.R.a(this.d),t||(n={},n.Type=3,n.Id=this.f.WebExtensionId,n.WebExtensionData=this.b,n.ContentHtml="<div/>",n.Version=0,n.AbsoluteLeft=0,n.AbsoluteTop=0,n.AbsoluteRight=0,n.AbsoluteBottom=0,n.Width=0,n.Height=0,n.ZOrder=0,n.OriginDeltaX=0,n.OriginDeltaY=0,f=new _Ewa.fH(n),i.n(f,null),t=i.a(f.h(),null)),t?(this.y(t.g().firstChild),this.l=$$as(_Ewa.kV,t)):i.t(this.D)),this)},O:function(n){return this.y(n),this},P:function(){this.x||this.c.bi().purgeOsfControl(this.b.InstanceId,!1);this.U(!0);var n=this.K();n&&_Ewa.R.a(this.d).d(n,14,!1);this.c.be.m(this.b.InstanceId);this.c.be.f(this.b.InstanceId,!0);this.e=null},bd:function(n,t){if(!_Ewa.a.a("OfficeVSO:3614837_disableDragCheck")&&!!this.g){this.c.bc(5004,t,!0);return}var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.c.bg(974713501,i,!0)},bh:function(n,t,i,r){var f,e,u;if(!_Ewa.a.a("OfficeVSO:3614837_disableDragCheck")&&!!this.g){this.c.bc(-1,r,!0);return}if(_Ewa.ha.b(n)&&(isNullOrUndefined(t)||isNullOrUndefined(this.F(t)))){this.c.bc(3002,r,!0);return}if(Diag.a.a(36444195,0,50,"eventId: {0}, targetId: {1}",n,t),_Ewa.ha.a(n)&&this.ba(),_Ewa.ha.c(n)&&this.bb(),n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(_Ewa.a.b(25)){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}f=this.c.Z.a().a(_Ewa.iw,232,!1,null);f.b(this.b.InstanceId,i,r,t);return}if(n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent){if(_Ewa.a.b(25)){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}e=this.c.Z.a().a(_Ewa.iw,232,!1,null);e.c(this.b.InstanceId,i,r,t);return}n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.N(-1777565636,r);this.j||(this.j=[]);u=this.L(n,t);u||(u=new _Ewa.ux(n,t),Array.add(this.j,u));u.h();u.e(i);this.c.bk(r);n===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.n&&(this.q=i)},bn:function(n,t,i,r){var f,e,u;if(n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(_Ewa.a.b(25)){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}f=this.c.Z.a().a(_Ewa.iw,232,!1,null);f.d(this.b.InstanceId,r);return}if(n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent){if(_Ewa.a.b(25)){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}e=this.c.Z.a().a(_Ewa.iw,232,!1,null);e.e(this.b.InstanceId,r);return}if(n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.N(1592314317,r),u=this.L(n,t),!!this.g){this.c.bc(-1,r,!0);return}if(!u){this.c.bk(r);return}u.f(i);u.b.length>0||Array.remove(this.j,u);this.j.length?_Ewa.ha.a(n)&&this.V(!1):this.U(!1);this.c.bk(r)},I:function(n){var t=_Ewa.b.a(n,this.w);t||n.appendChild(_Ewa.b.f(this.e))},z:function(n){_Ewa.b.b(this.e,n,!0)},bi:function(n,t){_Ewa.b.l(this.e,n,!1);_Ewa.b.r(this.e,t,!1)},J:function(n){if(!this.g&&!_Ewa.b.a(this.e,this.r)&&this.e){var t=document.createElement("div");t.id=this.r;t.className="ewa-wx-disabled-div";t.style.backgroundImage="url("+_Ewa.x.b.a(83)+")";t.style.opacity=n?"1":"0";t.style.backgroundRepeat="no-repeat";t.style.backgroundPosition="center";this.e.insertBefore(t,this.e.firstChild)}this.g++},W:function(){this.g>0&&this.g--;this.g||(_Ewa.b.f(_Ewa.b.a(this.e,this.r)),this.p&&!_Ewa.h.k(this.t,_Ewa.c.a(this.d).a().a().b())&&this.Q(null,null))},F:function(n){if(!this.f||!this.f.BindingData)return null;for(var t=0;t<this.f.BindingData.length;t++)if(this.f.BindingData[t].Name===n)return this.f.BindingData[t];return null},Y:function(){var n=this.M();return n?n.getDefaultIconUrl():null},X:function(){if(this.b.TaskpaneTitle)return this.b.TaskpaneTitle;var n=this.M();return n?n.getDefaultDisplayName():null},R:function(){if(this.n&&this.q){var n=new _Ewa.qo(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.b.InstanceId,null,this.n);this.q(n);this.n=null;this.q=null}},T:function(n){this.A&&this.A.c(n)},bl:function(){var i,n,t,r;this.d.b().b()&&this.be()&&(i=_Ewa.ms.a(this.d),i.c(this.e),this.z(!1));this.c.bC?(this.x||(n={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(n.div=this.e,n.id=this.b.InstanceId,n.solutionId=this.b.PrimaryMarketplace.SolutionId,n.version=this.b.PrimaryMarketplace.SolutionVersion,n.storeId=this.b.PrimaryMarketplace.MarketplaceRef,n.storeType=this.b.PrimaryMarketplace.MarketplaceType,n.ownerAddinSolutionId=this.b.OwnerAddinSolutionId,n.ownerAddinStoreType=this.b.OwnerAddinStoreType,this.b.AssetMarketplace&&(n.assetId=this.b.AssetMarketplace.SolutionId,n.assetStoreId=this.b.AssetMarketplace.MarketplaceRef,n.alternateReference={},n.alternateReference.marketplaceID=this.b.AssetMarketplace.SolutionId,n.alternateReference.marketplaceVersion=this.b.AssetMarketplace.SolutionVersion,n.alternateReference.store=this.b.AssetMarketplace.MarketplaceRef,n.alternateReference.storeType=this.b.AssetMarketplace.MarketplaceType),n.marketplaceID=this.b.PrimaryMarketplace.SolutionId,n.marketplaceVersion=this.b.PrimaryMarketplace.SolutionVersion,n.store=this.b.PrimaryMarketplace.MarketplaceRef,n.ownerAddinAssetId=this.b.OwnerAddinAssetId):(n.div=this.e,n.id=this.b.InstanceId,n.marketplaceID=this.b.PrimaryMarketplace.SolutionId,n.marketplaceVersion=this.b.PrimaryMarketplace.SolutionVersion,n.store=this.b.PrimaryMarketplace.MarketplaceRef,n.storeType=this.b.PrimaryMarketplace.MarketplaceType,n.ownerAddinAssetId=this.b.OwnerAddinAssetId,n.ownerAddinStoreType=this.b.OwnerAddinStoreType,this.b.AssetMarketplace&&(n.alternateReference={},n.alternateReference.marketplaceID=this.b.AssetMarketplace.SolutionId,n.alternateReference.marketplaceVersion=this.b.AssetMarketplace.SolutionVersion,n.alternateReference.store=this.b.AssetMarketplace.MarketplaceRef,n.alternateReference.storeType=this.b.AssetMarketplace.MarketplaceType)),n.settings=this.b.OsfPropertyBag,n.reason=_Ewa.a.a("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?this.s?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.H?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:this.s?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted,n.osfControlType=this.b.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent,n.isForUILessAction=this.b.WebExtensionOsfControlType===4,n.sourceLocationOverrideResourceId=this.b.SrcLocationOverrideResourceId,n.focusOnIframeWhenLoaded=this.b.FocusOnIframeWhenLoaded,_Ewa.jA.a(this.b)&&(n.featureGates=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Common.a.a.H(n.solutionId):Common.a.a.H(n.marketplaceID)),n.hostInfoFlags=0,_Ewa.f.a(this.i)||(n.hostInfoFlags|=2),_Ewa.j.d(this.b)&&(n.hostInfoFlags|=1),this.d.bt()||(Diag.a.a(571774818,0,50,"Content web add-in disabled by doc IRM"),n.hostInfoFlags|=4),_Ewa.a.b(691)&&(n.hostInfoFlags|=8),_Ewa.a.b(54)&&_Ewa.a.b(94)&&_Ewa.f.a(this.i)&&(t=this,n.virtualOsfControlActivationCallback=function(){t.c.cp(t.b)}),n.sharedRuntimeId=this.b.SharedRuntime?this.b.SharedRuntime.Resid:this.b.SharedRuntimeId,!_Ewa.j.d(this.b)||this.b.Preload||_Ewa.jA.a(this.b)||(r=this.c.bi().getOsfControl(_Ewa.bc.a(this.b,this.d)),r||this.c.cp(this.b)),n.initialDisplayMode=this.b.TaskpaneVisible?2:1,this.c.bi().insertOsfControl(n)),this.g=0):this.J(!0)},U:function(n){this.V(n);this.bm()},ba:function(){this.o||this.u.p(this.B);this.o++},V:function(n){this.o>0&&(n?this.o=0:this.o--,this.o||this.u.v(this.B))},bb:function(){if(!this.p){var n=_Ewa.c.a(this.d).a();this.t=_Ewa.h.p(_Ewa.c.a(this.d).a().a().b());n.h(this.E);this.p=!0}},bm:function(){this.p&&(_Ewa.c.a(this.d).a().k(this.E),this.p=!1)},bj:function(n){var t=new _Ewa.p(n.Reference.FirstRow+1,n.Reference.FirstColumn+1,n.Reference.LastRow+1,n.Reference.LastColumn+1,!1,!1);n.BindingType===1&&(n.HasHeaders&&(t.a=t.a-1),n.HasTotals&&(t.c=t.c+1));var f=_Ewa.c.a(this.d).a().a().b(),i=t.bn(this.t),r=t.bn(f),u=t.l(_Ewa.c.a(this.d).a().a().e());return u&&(_Ewa.bs.a(i)&&!_Ewa.bs.a(r)||!_Ewa.bs.a(i)&&!_Ewa.bs.a(r)&&!_Ewa.h.k(i,r))?u:null},bk:function(){var n=this,t=function(t){var i=t,r,u;(i.a!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&i.a!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n.c.be.e(n.b.InstanceId))&&(i.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent?i.d(new _Ewa.qo(i.a,n.b.InstanceId,null,null)):i.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent&&(r=n.F(i.c),r&&r.IsValidRef&&(n.d.b().b()?n.d.m().a().b():n.d.d().a().a())===r.Reference.SheetName&&(u=n.bj(r),u&&i.d(new _Ewa.baP(i.a,n.b.InstanceId,n.c.i(r),r,u.a-1,u.b-1,u.j(),u.m())))))};Array.forEach(this.j,t)},Q:function(){this.g||(this.bk(),this.t=_Ewa.h.p(_Ewa.c.a(this.d).a().a().b()))},L:function(n,t){var i,r;if(!this.j)return null;for(i=0;i<this.j.length;i++)if(r=this.j[i],r.a===n&&r.c===t)return r;return null},Z:function(n){if(n.controlId===this.b.InstanceId){var i=this,t=function(t){var i=t;i.g(n)&&i.d(n)};Array.forEach(this.j,t)}},K:function(){for(var n,i=_Ewa.R.a(this.d).b(),t=i.length-1;t>=0;--t)if(n=i[t],n.a().a===3&&n.a().v.InstanceId===this.f.WebExtensionId)return n;return null},be:function(){for(var t,n=0;n<this.d.m().e();n++)if(t=this.d.m().g(n),t.U===this.f.WebExtensionId)return!0;return!1},bf:function(n){var t=$$as(_Ewa.cP,n),i,r;t&&!t.h()&&(i=!!this.b&&!OSF.OsfControl.isFirstPartyStoreString(this.b.PrimaryMarketplace.MarketplaceType)&&!this.d.bt(),i?Diag.a.a(571774816,0,50,"Taskpane web add-in disabled by doc IRM"):(t.p(this.b),t.q(this.c),this.A=t,this.y(t.e()),_Ewa.a.a("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(t.j(),(this.b.SharedRuntime&&this.b.SharedRuntime.LifeTime===1||this.b.SharedRuntimeId)&&!this.b.TaskpaneVisible&&t.c(!1)):((this.b.SharedRuntime&&this.b.SharedRuntime.LifeTime===1||this.b.SharedRuntimeId)&&!this.b.TaskpaneVisible&&t.c(!1),t.j()),this.s||(_Ewa.s.a(this.d)?t.l():_Ewa.ct.a(this.d).a().d(t,!0)),r=this.d.a().a(_Ewa.bkq.$$(_Ewa.cP),77,!1,null),r.g(this.C),this.l=$$as(_Ewa.kV,t)))},y:function(n){this.e=n;this.e.id=this.w;this.e.className="ewa-wx-container-div";this.e.dir=this.d.v()?"rtl":"ltr";this.bl()},bg:function(n,t){t.a.a().a===3&&t.a.a().v.InstanceId===this.f.WebExtensionId&&(this.l=$$as(_Ewa.kV,t.a),this.y(t.a.g().firstChild),_Ewa.R.a(this.d).A(this.D))},M:function(){if(!!this.g)return null;var n=_Ewa.jA.a(this.b)?"":this.b.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.b.PrimaryMarketplace.SolutionId,n)},N:function(n,t){var i,r;if(_Ewa.a.b(25)){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0);return}try{if(Diag.a.a(19931730,0,50,"HandleDialogNotificationShownInAddinEvent called!"),this.m!==4){this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,t,!0);return}i={};i.OsfcontrolId=this.b.InstanceId;r=new _Ewa.L(n,0,this.d.j()?2:1,0,null);this.d.i().a(r,i,null);this.c.bk(t)}catch(u){Diag.a.a(19931731,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",u.message);this.c.bc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t,!0)}}};_Ewa.ES=function(){this.a={}};_Ewa.ES.prototype={e:function(n){delete this.a[n]},c:function(){for(var i,t=Object.keys(this.a),r=t.length,n=0;n<r;++n)i=t[n],delete this.a[i]},b:function(){return Object.keys(this.a).length>0},d:function(){return Object.keys(this.a)}};_Ewa.ET=function(n,t,i){this.m=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.p);this.a=n;this.k=t;this.f=i};_Ewa.ET.prototype={k:null,f:null,a:null,i:0,j:0,b:null,c:null,o:function(n){var t,i;n.messageType===51?(this.n(n.actionType,t={val:this.i},this.l),this.i=t.val):n.messageType===52&&(this.n(n.actionType,i={val:this.j},this.m),this.j=i.val)},n:function(n,t,i){if(n===1)t.val||_Ewa.c.a(this.a).a().b().n(i),t.val++,this.r();else if(n===2){if(t.val<1)return;t.val===1&&_Ewa.c.a(this.a).a().b().p(i);t.val--}},p:function(){var r=_Ewa.c.a(this.a).a().b().e(),n,t,i;this.h(r)&&(n=this.g(r),n)&&(t={},t.chartId=n,t.worksheetId=this.e(),i=_Ewa.E.a(t),this.d(51,n,i),this.d(51,this.e(),i))},q:function(){var n,t,i;if(this.b&&(n={},n.chartId=this.b,n.worksheetId=this.c,t=_Ewa.E.a(n),this.d(52,this.b,t),this.d(52,this.c,t)),i=_Ewa.c.a(this.a).a().b().e(),!this.h(i)){this.b=null;this.c=null;return}this.b=this.g(i);this.c=this.e()},d:function(n,t,i){t&&this.k.b(n,t)&&this.f.a(n,t,i)},g:function(n){if(!n||!n.a())return null;var i=n.a().c,t=i.match(new RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));return t&&t.length===1?t[0]:null},e:function(){var n=this.a.d().a();return!n||n.U?null:n.Q},r:function(){var n=_Ewa.c.a(this.a).a().b().e();this.h(n)&&(this.b=this.g(n),this.c=this.e())},h:function(n){return!!n&&!!n.a()&&!n.a().a}};_Ewa.Fb=function(n,t,i){this.e=Function.createDelegate(this,this.h);this.a=n;this.d=t;this.c=i;this.i()};_Ewa.Fb.prototype={d:null,c:null,a:null,b:null,f:function(n){if(n.actionType===1){this.a.bZ(!0);var t=$$as(_Ewa.bc,_Ewa.bJ.a(this.a));t.cJ(!0)}else n.actionType===2&&this.a.bZ(!1);this.b=n.controlId;Diag.a.a(594105035,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",_Ewa.uC.toString(n.actionType),this.b,this.a.bv())},g:function(n){var t=$$as(_Ewa.bc,_Ewa.bJ.a(this.a));t.cj(n,this.a.bv())},i:function(){if(this.a.bj()){var n=this;_Ewa.g.a(_Ewa.l.a(_Ewa.lS,this.a.a(),297,298,1,null),function(t){var i=t.a();i&&i.a(n.e)},this.a.g(),3,null,null)}},h:function(n,t){var r=2201,u="Workbook",i={};i.eventId=n;i.payload=t;this.d.b(r,u)&&this.c.a(r,u,_Ewa.E.a(i))}};_Ewa.EU=function(n,t,i){_Ewa.EU.initializeBase(this,[n,t,i])};_Ewa.EU.prototype={l:null,k:null,r:function(){return _Ewa.bP.b(this.a.a().q().a())},m:function(n,t){return _Ewa.a.a("OfficeVSO:5670378_EnablePickedRangesSelectionChangedEventForFirstTimeOnOpenSheet")?this.l!==n||!_Ewa.h.k(this.k,t):_Ewa.EV.prototype.m.call(this,n,t)},n:function(n,t,i){_Ewa.a.a("OfficeVSO:5670378_EnablePickedRangesSelectionChangedEventForFirstTimeOnOpenSheet")?(this.l=n,this.k=_Ewa.h.p(t)):_Ewa.EV.prototype.n.call(this,n,t,i)},s:function(){return!this.a.m()&&!this.a.u()},q:function(n,t){this.d.b(2700,"Workbook")&&this.e.a(2700,"Workbook",t)}};_Ewa.on=function(){this.a={};this.c={}};_Ewa.on.a=function(n,t){return String.format("{0}#{1}",n,t)};_Ewa.on.prototype={d:0,h:function(n,t){return this.a[_Ewa.on.a(n,t)]},f:function(n,t){if(!t&&isNullOrUndefined(this.c[n])){this.c[n]=1;return}t&&!isNullOrUndefined(this.c[n])&&delete this.c[n]},e:function(n){return isNullOrUndefined(this.c[n])},i:function(n){var t=_Ewa.on.a(n.messageType,n.targetId);n.actionType===1?this.j(n.controlId,n.messageType,t):n.actionType===2&&this.k(n.controlId,n.messageType,t)},m:function(n){var t,u,i;if(n&&(t=Object.keys(this.a),!isNullOrUndefined(t)&&!(t.length<=0)))for(var f=t,e=f.length,r=0;r<e;++r)u=f[r],i=this.a[u],i[n]&&(delete i[n],Object.keys(i).length||delete this.a[u])},b:function(n,t){var r=_Ewa.on.a(n,t),i=this.a[r];return!!i&&Object.keys(i).length>0},l:function(){return!Common.D.a(this.a)},g:function(){var f=[],e=this.a,i,t,r,u,o,n;for(i in e){t={key:i,value:e[i]};r=t.value;for(u in r)o={key:u,value:r[u]},n={},n.eventType=parseInt(t.key.split("#")[0]),n.targetId=t.key.split("#")[1],n.addinId=o.key,f.push(n)}return f},j:function(n,t,i){var u,r,f;this.a[i]?(r=this.a[i],r[n]?(f=r[n],r[n]=f+1):r[n]=1):(u={},u[n]=1,this.a[i]=u);t===100&&this.d++},k:function(n,t,i){var r,u;this.a[i]?(r=this.a[i],n?(u=r[n],u===1?(delete r[n],Object.keys(r).length||delete this.a[i]):r[n]=u-1,t===100&&this.d--):Diag.a.a(23941468,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",n,i)):Diag.a.a(23941467,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",i)}};_Ewa.EV=function(n,t,i){this.i=Function.createDelegate(this,this.t);_Ewa.EV.initializeBase(this,[!1]);this.g=n;this.d=t;this.e=i;this.a=_Ewa.c.a(n);this.b={};this.h={}};_Ewa.EV.prototype={g:null,d:null,e:null,a:null,c:0,f:0,b:null,h:null,v:function(){return!this.f&&this.c>0},p:function(n){var t=$$as(_Ewa.ce,this.g.d());if(n.actionType===1)this.c||this.a.a().h(this.i),this.c++;else if(n.actionType===2){if(this.c<1)return;this.c===1&&this.a.a().k(this.i);this.c--}},u:function(n){n?this.f++:(this.f>0&&this.f--,this.f||this.t(null,new _Ewa.BP(!1)))},t:function(n,t){var r,e;if(this.v()&&!this.s()&&(!t||!t.a)&&(r=$$as(_Ewa.J,this.g.d().a()),r)&&!r.U){var i=r.Q,u=this.r(),f=null,o=null;this.d.d>0&&(f=this.a.e().a(this.a.a().a().a(),!1),o=i in this.h?this.h[i]:null);this.m(i,u)&&(e=this,_Ewa.g.a($$sc.a.a(Boolean,!0),function(){e.x(i,u);e.w(i,u,f,o)},this.ew(),3,null,null));this.n(i,u,f)}},r:function(){return this.a.a().a().b()},m:function(n,t){if(_Ewa.a.a("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")){var i=!!n&&_Ewa.eh.e(this.b);return(i||n in this.b)&&!_Ewa.h.k(this.b[n],t)}return n in this.b&&!_Ewa.h.k(this.b[n],t)},n:function(n,t,i){this.b[n]=_Ewa.h.p(t);this.h[n]=i},s:function(){return this.a.m()||this.a.u()},q:function(n,t){this.d.b(14,n)&&this.e.a(14,n,t);this.d.b(14,"Workbook")&&this.e.a(14,"Workbook",t)},x:function(n,t){var i={},r;i.worksheetId=n;i.address=this.o(t);r=_Ewa.E.a(i);this.q(n,r)},w:function(n,t,i,r){var u,f,e,o;this.d.d>0&&(u="",f="",r&&(u=r.Q),i&&(f=i.Q),r?i?(e=i.O.bn(t),u!==f&&this.j(u,"",n),this.j(f,this.o(e),n)):this.j(u,"",n):i&&(o=i.O.bn(t),this.j(f,this.o(o),n)))},j:function(n,t,i){if(this.d.b(100,n)){var r={};r.address=t;r.worksheetId=i;this.e.a(100,n,_Ewa.E.a(r))}},o:function(n){return _Ewa.h.n(n,",",this.g,!1,!1,!1)},dispose:function(){this.c>0&&this.a.a().k(this.i);this.b=null;this.h=null;this.c=0;this.a=null;this.g=null;this.d=null;this.e=null}};_Ewa.EW=function(n,t,i){this.f=Function.createDelegate(this,this.m);this.e=n;this.h=t;this.g=i};_Ewa.EW.prototype={h:null,g:null,e:null,c:0,d:0,a:null,b:null,j:function(n){var t=_Ewa.c.a(this.e).a();n.actionType===1?(this.c||this.d||t.b().n(this.f),n.messageType===2101?this.c++:n.messageType===2102&&this.d++):n.actionType===2&&(n.messageType===2101?this.c=this.c>0?this.c-1:0:n.messageType===2102&&(this.d=this.d>0?this.d-1:0),this.c||this.d||t.b().p(this.f))},m:function(){var i=_Ewa.c.a(this.e).a().b().e(),n,r,t,u;if(this.d>0&&this.a&&this.b&&(n={},n.shapeId=this.a,n.worksheetId=this.b,r=_Ewa.E.a(n),this.i(2102,this.a,r)),this.l(i)){if(this.a=this.n(i),this.b=this.k(),!this.a||!this.b){Diag.a.a(38372579,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",this.a,this.b);return}this.c>0&&(t={},t.shapeId=this.a,t.worksheetId=this.b,u=_Ewa.E.a(t),this.i(2101,this.a,u))}else this.a=null,this.b=null},l:function(n){return!!n&&!!n.a()&&(!n.a().a||n.a().a===7||n.a().a===1||n.a().a===3||n.a().a===5)},n:function(n){if(!n||!n.a())return null;var i=n.a().c,t=i.match(new RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")),r=t&&t.length===1?t[0]:null;return r?r:(Diag.a.a(38372608,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",i),null)},k:function(){var n=this.e.d().a();return!n||n.U?null:n.Q},i:function(n,t,i){t&&this.h.b(n,t)&&this.g.a(n,t,i)}};_Ewa.EX=function(n,t,i){this.m=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.y);this.k=Function.createDelegate(this,this.v);this.b=n;this.j=t;this.e=i};_Ewa.EX.prototype={j:null,e:null,b:null,f:0,i:0,g:0,h:0,p:function(n){n.messageType===11?n.targetId==="Workbook"?this.r(n.actionType):this.q(n.actionType):n.messageType===12&&(n.targetId==="Workbook"?this.s(n.actionType):this.t(n.actionType))},q:function(n){var t;this.a(n,t={val:this.f},this.k);this.f=t.val},t:function(n){var t;this.a(n,t={val:this.i},this.n);this.i=t.val},r:function(n){var t;this.a(n,t={val:this.g},this.l);this.g=t.val},s:function(n){var t;this.a(n,t={val:this.h},this.m);this.h=t.val},a:function(n,t,i){n===1?this.o(t,i):n===2&&this.u(t,i)},o:function(n,t){n.val||this.b.d().c(t);n.val++},u:function(n,t){n.val<1||(n.val===1&&this.b.d().d(t),n.val--)},v:function(n,t){var i=$$as(_Ewa.J,t.a),r,u;this.d(i)&&(r={},r.worksheetId=i.Q,u=_Ewa.E.a(r),this.c(11,i.Q,u,!1))},y:function(n,t){var i=$$as(_Ewa.J,t.b),r,u;this.d(i)&&(r={},r.worksheetId=i.Q,u=_Ewa.E.a(r),this.c(12,i.Q,u,!1))},w:function(n,t){var r=$$as(_Ewa.J,t.a),i,u;this.d(r)&&(i={},i.worksheetId=r.Q,u=_Ewa.E.a(i),this.c(11,null,u,!0))},x:function(n,t){var r=$$as(_Ewa.J,t.b),i,u;this.d(r)&&(i={},i.worksheetId=r.Q,u=_Ewa.E.a(i),this.c(12,null,u,!0))},d:function(n){return!!n&&!n.U},c:function(n,t,i,r){var u=r?"Workbook":t;this.j.b(n,u)&&this.e.a(n,u,i)}};_Ewa.EY=function(n,t,i){this.g=Function.createDelegate(this,this.j);this.h=Function.createDelegate(this,this.k);this.e=n;this.a=_Ewa.c.a(n);this.d=t;this.c=i;this.m()};_Ewa.EY.prototype={d:null,c:null,e:null,a:null,b:null,f:!1,m:function(){for(var r,t,i=this.a.J(),u=i.length,n=0;n<u;++n)r=i[n],t=r.l(),Common.f.a().a("msospPointerDown",t,this.h),Common.j.a().a("click",t,this.g)},k:function(n){var t,i,r,u=(r=this.a.ch(n.get_clientPoint(),i={val:t}),t=i.val,r);return this.f=n.b===3&&!!t&&this.a.a().a().r(t),this.b=n.get_clientPoint(),!1},j:function(n){var t,u,f,i,r,e;if(this.a.F()||this.a.u()||this.f||n.k()||n.i()||n.a.button||!this.b||!n.get_clientPoint()||n.get_clientPoint().x!==this.b.x||n.get_clientPoint().y!==this.b.y)return!1;if(i=(f=this.a.ch(n.get_clientPoint(),u={val:t}),t=u.val,f),r=$$as(_Ewa.J,this.e.d().a()),i&&r&&!r.U){if(!this.a.a().a().h().i(t))return!1;e=new _Ewa.Hq(r,t,_Ewa.j.J(i.x),_Ewa.j.J(i.y));this.l(null,e)}return!1},l:function(n,t){var u=t.d,i,r,f,e;this.i(u)&&(i={},i.worksheetId=u.Q,i.address=t.a.toString(),i.offsetX=t.b,i.offsetY=t.c,r=u.Q,this.d.b(21,r)&&(f=_Ewa.E.a(i),this.c.a(21,r,f)),r="Workbook",this.d.b(21,r)&&(e=_Ewa.E.a(i),this.c.a(21,r,e)))},i:function(n){return!!n&&!n.U}};_Ewa.Fa=function(n,t,i){this.e=Function.createDelegate(this,this.m);this.i=Function.createDelegate(this,this.j);this.c=n;this.g=t;this.f=i;window.requestIdleCallback||(this.d=!1)};_Ewa.Fa.prototype={g:null,f:null,c:null,a:0,h:!0,b:0,d:!0,k:function(n){if(n.actionType===1)this.a||this.l(),this.a++;else if(n.actionType===2){if(this.a<1)return;this.a===1&&this.n();this.a--}},j:function(){var n=document.hasFocus(),t,i;this.h!==n&&(n&&(t={},i=_Ewa.E.a(t),this.f.a(2203,"Workbook",i)),this.h=n)},l:function(){if(this.g.b(2203,"Workbook"))if(this.d){var n={};n.timeout=this.c.e().CheckFocusTimeout;this.b=window.requestIdleCallback(this.e,n)}else this.b=window.setInterval(this.i,this.c.e().CheckFocusTimeInterval)},n:function(){this.d?window.cancelIdleCallback(this.b):window.clearInterval(this.b)},m:function(n){(n.timeRemaining()>0||n.didTimeout)&&this.j();window.requestIdleCallback(this.e)}};_Ewa.EZ=function(n,t,i){this.e=Function.createDelegate(this,this.l);this.a=n;this.h=t;this.f=i};_Ewa.EZ.prototype={h:null,f:null,a:null,d:0,c:null,b:null,k:function(n){if(n.messageType===2e3)if(n.actionType===1)this.d||_Ewa.c.a(this.a).a().b().n(this.e),this.d++,this.m();else if(n.actionType===2){if(!this.d)return;this.d===1&&_Ewa.c.a(this.a).a().b().p(this.e);this.d--}},l:function(){var n=_Ewa.c.a(this.a).a().b().e(),t;n?this.j(n)?(t=this.i(),this.g(t),this.c=n.a().c,this.b=t):this.c&&(this.g(this.b),this.c=null,this.b=null):this.c&&(this.g(this.b),this.c=null,this.b=null)},g:function(n){var i={},t,r;i.worksheetId=n;i.revisionLoad=!1;_Ewa.a.a("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(_Ewa.a.b(787)||_Ewa.a.c("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))&&(t=_Ewa.c.a(this.a).a().b().e(),i.selectedVisualId=t&&t.a()&&t.a().e?t.a().e.VisualID:null);r=_Ewa.E.a(i);n&&this.h.b(2e3,n)&&this.f.a(2e3,n,r)},i:function(){var n=this.a.d().a();return!n||n.U?null:n.Q},m:function(){var n=_Ewa.c.a(this.a).a().b().e();this.j(n)&&(this.c=n.a().c,this.b=this.i())},j:function(n){return!!n&&n.ct()}};_Ewa.Fc=function(n){this.a=n};_Ewa.Fc.prototype={a:null};_Ewa.Fd=function(n,t,i){this.c=n;this.a=t;this.b=i};_Ewa.Fd.prototype={c:null,a:null,b:0,e:function(){return _Ewa.a.b(265)?this.a.l()||!!this.b:!1},d:function(){var t={},i,r,n;return t.eventRegistrationInfos=this.a.g(),t.runtimeCalculationMode=this.b,r=(i=new _Ewa.Fe,i.runtimeState=t,i),n={},n.HttpMethod="POST",n.PathAndQuery="RestoreRuntimeState",n.RequestHeaders=null,n.RequestBody=JSON.stringify(r),n.RequestFlags=1,n}};_Ewa.Fg=function(n,t,i,r,u,f,e,o,s){this.enqueueUtcTime=n;this.processUtcTime=t;this.dequeueUtcTime=i;this.inQueueDurationInMS=r;this.executionDurationInMS=u;this.operationCount=f;this.ServerCorrelationId=e;this.UserOperationName=o;this.IsDocumentHidden=s};_Ewa.Fg.prototype={enqueueUtcTime:null,processUtcTime:null,dequeueUtcTime:null,inQueueDurationInMS:0,executionDurationInMS:0,operationCount:0,ServerCorrelationId:null,UserOperationName:null,IsDocumentHidden:!1};_Ewa.uD=function(n,t,i){this.j=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.v);this.k=Function.createDelegate(this,this.u);this.g=Function.createDelegate(this,this.r);this.h=Function.createDelegate(this,this.s);this.n=Function.createDelegate(this,this.w);_Ewa.uD.resolveInheritance();this.l=this.K;this.q=this.fB;_Ewa.uD.initializeBase(this,[i,n,!0]);this.d=t;Sys.UI.DomElement.addCssClass(this.eq,"ewr-chrtcontarea");Sys.UI.DomElement.addCssClass(this.eq,"ewa-scrollbars");i.tabIndex=0;this.p(this.et.h(),!1);this.ey().a("mousedown",this.n,!1);var r=this;this.ey().a("contextmenu",function(n){_Ewa.M.a(n,!0)},!1);this.et.d().j(this.h);this.et.m().j(this.h);this.et.m().c(this.g);this.et.d().c(this.g);this.d.d(this.k);this.d.g(this.m);this.d.c(this.j);_Ewa.a.d()&&this.C(this.fU)};_Ewa.uD.a=function(n){if(!_Ewa.ms.a(n)){var t=n.G();n.a().b(_Ewa.uB,34,new _Ewa.uD(n,new _Ewa.ng(n,n.b(),n.c().b(),3,0),t.appendChild(t.ownerDocument.createElement("div"))))}};_Ewa.uD.prototype={d:null,f:null,e:null,i:!1,b:function(){return this.d},dispose:function(){this.et&&(this.et.d().h(this.h),this.et.m().h(this.h),this.et.m().d(this.g),this.et.d().d(this.g));this.d&&(this.d.b(this.k),this.d.i(this.m),this.d.f(this.j));_Ewa.a.d()&&this.I(this.fU);this.o();System.a.a(this.d);this.d=null;_Ewa.b.f(this.eq);_Ewa.bal.prototype.dispose.call(this)},c:function(n){_Ewa.b.f(_Ewa.b.a(this.eq,n.id));this.eq.appendChild(n)},a:function(){if(this.e&&!this.i){var t=$$as(_Ewa.bc,_Ewa.bJ.a(this.et)),n=t.bb(this.e.InstanceId);n&&(n.bi(this.e.Width,this.e.Height),n.I(this.eq),n.z(!0),this.i=!0)}},eo:function(){return!0},v:function(n,t){if(t.a.b===this.f&&this.e){var i=$$as(_Ewa.bc,this.et.a().a(_Ewa.bQ,35,!1,null));i.dd(this.e.InstanceId,!1)}},u:function(n,t){var i=t.a.a;switch(i.t){case 1:case 3:case 5:this.x(t)}},t:function(){this.hB(!0)},x:function(n){this.e=n.a.a.r;this.i=!1;this.a()},y:function(n){this.et.b().G()&&n&&(n.g()||n.o(new _Ewa.kN),n.g().b=new _Ewa.T(this.eq.scrollLeft,this.eq.scrollTop),n.g().d=20)},o:function(){this.d.w(this.f);this.f=null;this.e=null;this.i=!1},s:function(n,t){this.eE()&&this.y(t.b);this.o()},r:function(n,t){this.p(t.a,!!t.b)},p:function(n,t){var r=this.eJ(!!n&&_Ewa.D.j(n)),i;r&&(this.d.D(n,_Ewa.Q.e,i={val:this.f}),this.f=i.val,this.iE(t,!1))},w:function(){this.et.b().K()}};_Ewa.Fh=function(){};_Ewa.Fh.a=function(n){n.add("InternalTest","PreviewExecutionMethod",_Ewa.ER.a)};_Ewa.KU=function(n,t){this.f=Function.createDelegate(this,this.k);this.g=n;this.h=t;this.e=!1;this.h.a().b(_Ewa.om,224,this)};_Ewa.KU.prototype={h:null,g:null,d:null,c:null,e:!1,a:function(n){if(this.e){Diag.a.a(19718340,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times.");return}if(this.e=!0,this.c={},this.d={},!n){Diag.a.a(19273180,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object.");return}n.y(this.f)},b:function(n){var t,i,r;if(!n){Diag.a.a(19273181,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.");return}n.S(this.f);t=this.c;for(i in t)r={key:i,value:t[i]},System.a.a(r.value);this.c=null;this.d=null;this.e=!1},k:function(n,t){var u=null,f=null,i=null,e,o,r;if(t)_Ewa.cP.isInstanceOfType(t)?(e=t,u=e.e(),i=e.v()):_Ewa.ev.isInstanceOfType(t)&&(o=t,u=o.A(),i=o.v());else{Diag.a.a(19718341,0,10,"Invalid parameter for ReadoutSelection");return}if(!u){Diag.a.a(19273183,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter.");return}if(f=$$as(_Ewa.bQ,n),!f){Diag.a.a(19273182,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object.");return}this.i(i,u,f)||i in this.c||(this.d[i]=0,r=this,this.c[i]=_Ewa.B.a().b(function(){r.d[i]>=10||r.i(i,u,f)?(delete r.d[i],r.c[i].dispose(),delete r.c[i]):r.d[i]=r.d[i]+1},500,_Ewa.o.p,!0,!1))},i:function(n,t,i){var f=this.j(i,n),u,r;return f?!1:(u=t.querySelector("iframe"),!u)?(Diag.a.a(20022086,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(r=u.title,!r||!r.length)?(Diag.a.a(19273185,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(this.g.a(r),!0)},j:function(n,t){var i=n.a().getOsfControl(t);return i?i.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};_Ewa.xA=function(n){_Ewa.xA.initializeBase(this);this.h=n;this.l()};_Ewa.xA.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.om),225,new _Ewa.xA(n))};_Ewa.xA.prototype={h:null,a:function(){var n=this.h.a(),t=this;_Ewa.g.a(_Ewa.l.a(_Ewa.cC,n,211,212,this.j,null),function(i){var r=n.a(_Ewa.om,224,!1,null)||new _Ewa.KU(i.a(),t.h);t.k(r)},this.i(),3,null,null)}};_Ewa.Fe.registerClass("_Ewa.Fe");_Ewa.uy.registerClass("_Ewa.uy",_Ewa.sX.$$(_Ewa.bQ));_Ewa.uv.registerClass("_Ewa.uv",_Ewa.bgG);_Ewa.uv.a.registerClass("_Ewa.uv.a");_Ewa.ux.registerClass("_Ewa.ux");_Ewa.bc.registerClass("_Ewa.bc",_Ewa.bW,_Ewa.jg,_Ewa.bQ,_Ewa.bdp,Sys.IDisposable);_Ewa.ha.registerClass("_Ewa.ha",_Ewa.bhQ,_Ewa.bkb);_Ewa.ES.registerClass("_Ewa.ES");_Ewa.Fb.registerClass("_Ewa.Fb");_Ewa.EV.registerClass("_Ewa.EV",_Ewa.bgG);_Ewa.EU.registerClass("_Ewa.EU",_Ewa.EV);_Ewa.on.registerClass("_Ewa.on");_Ewa.Fc.registerClass("_Ewa.Fc");_Ewa.Fg.registerClass("_Ewa.Fg");_Ewa.uD.registerClass("_Ewa.uD",_Ewa.bal,_Ewa.uB,_Ewa.hZ,Sys.IDisposable);_Ewa.xA.registerClass("_Ewa.xA",_Ewa.sX.$$(_Ewa.om));_Ewa.kU.a=null;_Ewa.bc.c=new($$sc.w.$$(CommandUI.AddInCommands.u));_Ewa.bc.e=!0;_Ewa.bdn.a();Type.registerNamespace("_Ewa");_Ewa.uu=function(){};_Ewa.uu.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sharedInfo=t,_Ewa.k.a(n,"ShowAgaveTaskpane",o,i,r,u,f,0,null,null)};_Ewa.hL=function(){this.c=Function.createDelegate(this,this.g);this.b=Function.createDelegate(this,this.e)};_Ewa.hL.c=function(){return _Ewa.hL.a||(_Ewa.hL.a=new _Ewa.hL),_Ewa.hL.a};_Ewa.hL.prototype={a:null,d:function(n){_Ewa.hL.b||(this.a=n,this.f(),_Ewa.hL.b=!0)},f:function(){Common.a.c().b(860152194,2147483648,this.b,96);Common.a.c().a(741381681,2147483648,this.c)},e:function(n,t,i,r,u){if(i===2){var f=u?u:{},e=f.callback,o=f.refresh?f.refresh:!1;if(!e)return 16;this.a.P(e,o)}return 32},g:function(n,t,i,r,u){if(i===2){var f=u?u.callback:null;f&&this.a.x(f)}return 32}};_Ewa.EJ=function(n,t,i,r,u,f){this.b=n;this.a=f};_Ewa.EJ.prototype={b:null,a:null,y:function(){return!1},z:function(){return!1},w:function(n,t,i,r){var u=!1,f;switch(t.a){case-684355545:u=!0;break;case-741808261:u=!!i;break;case-859308420:u=!!r&&r.a===1;break;case 418618014:u=n===1&&!!r&&r.a===1;break;case-515602470:f=_Ewa.a.b(240)&&n===2;u=(n===1||f)&&!!r&&r.a===1;break;case 2086613372:u=_Ewa.a.b(240)&&n===2&&!!r&&r.a===1;break;case-1336341324:u=_Ewa.a.b(517)&&n===1&&!!r&&r.a===1;break;case-1444574190:case-336193495:u=n===1&&!!r&&r.a===1;break;case 1296389134:u=n===1&&!!r&&r.a===1;break;case 1221897806:u=_Ewa.a.b(170)&&n===2;break;case-1753056834:u=_Ewa.a.c("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:u=_Ewa.a.c("Microsoft.Office.Excel.InsertPivotTableFromPowerBI",!1)&&_Ewa.a.c("Microsoft.Office.Excel.ExternalConnectionCreate",!1);break;case 301511274:u=_Ewa.a.b(650);break;case 515196233:u=_Ewa.a.c("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.b.j();break;case 1723441034:u=this.b.b().S()}return u},x:function(n,t,i){var r=_Ewa.g.c(),e=t.a,u,f;switch(t.a){case 1296389134:u=i.SourceControlId;f=i.LabelText;this.a.h(u,f);break;case-684355545:this.a.d();break;case-741808261:r=this.a.e(i,t);break;case-1336341324:_Ewa.a.b(517)&&(r=this.a.a(i,n,t));break;case-859308420:case-515602470:case 2086613372:case-336193495:case-1444574190:case 418618014:case 1221897806:case-1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:r=this.a.a(i,n,t);break;default:r=_Ewa.Y.a(e)}return r}};_Ewa.ur=function(n){_Ewa.ur.initializeBase(this,[n])};_Ewa.ur.a=function(n){_Ewa.bh.a(76,new _Ewa.ur(n))};_Ewa.ur.prototype={n:function(){var n=this;_Ewa.gi.a(_Ewa.hM,this.h,374,375,this.j,function(t){n.m([new _Ewa.EJ(n.h,null,null,null,null,t),new _Ewa.Ff(n.h)],null)},null)}};_Ewa.AgaveCommandManager=function(n,t,i,r,u){this.A=Function.createDelegate(this,this.Z);this.u=Function.createDelegate(this,this.Y);this.t=Function.createDelegate(this,this.W);this.v=Function.createDelegate(this,this.H);this.z=Function.createDelegate(this,this.X);this.w=Function.createDelegate(this,this.N);this.x=Function.createDelegate(this,this.P);this.y=Function.createDelegate(this,this.Q);this.o={};this.m={};_Ewa.AgaveCommandManager.initializeBase(this,[!1]);this.i=n;this.s=i;this.j=t;this.q=r;this.p=u;this.p.a(2451283737,2147483648,this.y);this.p.a(1323818969,2147483648,this.x);this.p.a(1257657435,2147483648,this.w)};_Ewa.AgaveCommandManager.prototype={s:null,j:null,i:null,l:null,q:null,p:null,n:null,b:function(n){this.es("IDS",n)},c:function(n){this.eu("IDS",n)},dispose:function(){System.a.a(this.l);this.l=null;_Ewa.bW.prototype.dispose.call(this)},d:function(){this.l.F()},h:function(n,t){if(n){this.er("IDS",null,null);var i=n.split("|");this.U(n,t,i);this.l=new Common.App.AppsForOffice.p;this.l.G("",null,null);this.j.N(this.l.O,i)}},a:function(n,t,i){var r=_Ewa.g.c(),h,y,p,u,o,c,s,l,e,a,v,f;return((i.a===-515602470||i.a===-336193495||i.a===2086613372||i.a===-1444574190||i.a===-1336341324)&&(r=this.O(n,t,i)),i.a===418618014&&(h=new Common.App.AppsForOfficeCommon.a,h.a=_Ewa.ClientStringManager.a().a(1724),r=this.k(i,"HelloWorld",h,!0,null,!1,null)),y=i.d===this.i.l()+"Ribbon.Help"||i.d==="Help",p=y&&i.b===2,p||Array.indexOf(["A0","A1","Help","ContactSupport","WhatsNew"],n.MenuItemId)!==-1||n.MenuItemId==="HelpArticle")?this.D(n,i):i.b===7&&n.SourceControlId===this.i.l()+"giveFeedbackPane"?(n.MenuItemId="GiveFeedback",this.D(n,i)):(i.a===1221897806&&(r=this.ba(i)),i.a===-1753056834&&(r=this.bb(i)),i.a===932597253&&_Ewa.a.c("Microsoft.Office.Excel.InsertPivotTableFromPowerBI",!1)&&_Ewa.a.c("Microsoft.Office.Excel.ExternalConnectionCreate",!1)&&(Diag.a.a(573835101,0,50,"InsertPowerBIPivotTable - addin launch requested"),Common.A.b(932597253,!0,"",0,0,0,null),u=new Common.App.AppsForOfficeCommon.a,u.a=_Ewa.ClientStringManager.a().a(2043),u.b=_Ewa.a.c("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?"PowerBi.DevUrl":"PowerBi.Url",u.g=!0,u.d=320,o={},o.LaunchSource=$$as(String,n.SourceControlId),o.LaunchMode="Default",u.c=o,r=this.k(i,"FA000000054",u,!0,null,!1,null)),i.a===301511274&&(r=this.bc(i)),i.a===515196233&&(c=this.i.a().a(_Ewa.lY,465,!1,null),c&&c.a(),s=new Common.App.AppsForOfficeCommon.a,s.a=_Ewa.ClientStringManager.a().a(2105),l=new _Ewa.gb,l.a="ewa-ptp-header",r=this.k(i,"FA000000075",s,!0,l,!1,s.a)),i.a===1723441034&&(e=new Common.App.AppsForOfficeCommon.a,e.a=_Ewa.ClientStringManager.a().a(2117),e.g=!0,e.d=320,a=new _Ewa.gb,a.a="ewa-ptp-header",r=this.k(i,"FA000000080",e,!0,a,!1,null)),_Ewa.a.c("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&n.LoadDataFromPictureTaskpane&&(v={},f=new Common.App.AppsForOfficeCommon.a,f.a="Data From Picture",f.b=n.DataFromPictureURL?n.DataFromPictureURL:"",v.SessionID=n.SessionID,f.c=v,f.g=!0,r=this.k(i,n.DataFromPictureAssetId,f,!1,null,!1,null)),r)},e:function(n,t){var e=_Ewa.g.c(),f=this.i,i,u=n.ack5,k,r,h,d,c,l,o,w,b,ot,st;if("SourceControlId"in n){if((i={},k=n.SourceControlId,r=k.split("|"),r.length!==8)||_Ewa.f.a(r[0])||_Ewa.f.a(r[1])||_Ewa.f.a(r[2])||isNaN(parseInt(r[2]))||_Ewa.f.a(r[3])||isNaN(parseInt(r[3]))||_Ewa.f.a(r[4])||_Ewa.f.a(r[5])||isNaN(parseInt(r[5]))||_Ewa.f.a(r[6])||_Ewa.f.a(r[7]))return _Ewa.g.d();_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(u={},u.version=i.Version=r[0],u.assetId=i.AssetId=r[1],u.solutionId=i.SolutionId=r[1],u.height=i.Height=parseInt(r[2]),u.width=i.Width=parseInt(r[3]),u.storeId=i.StoreId=r[4],u.targetType=i.TargetType=parseInt(r[5]),u.assetStoreId=i.AssetStoreId=r[6],u.storeType=i.StoreType=r[7],u.appVersion=r[0],u.currentStoreType=r[7],u.id=r[1]):(u={},u.appVersion=i.AppVersion=r[0],u.assetId=i.AssetId=r[1],u.id=i.Id=r[1],u.height=i.Height=parseInt(r[2]),u.width=i.Width=parseInt(r[3]),u.storeId=i.StoreId=r[4],u.targetType=i.TargetType=parseInt(r[5]),u.assetStoreId=i.AssetStoreId=r[6],u.currentStoreType=i.CurrentStoreType=r[7])}else i=n.CommandValueId;if(h=null,"InsertAgaveClientSideParametersKey"in n&&(h=n.InsertAgaveClientSideParametersKey),this.l&&this.l.F(),!i||!u)return Diag.a.a(593605401,220,10,"Inserting addin needs inserted agave parameters"),e;if(this.i.br()&&"EnabledInViewMode"in n&&(i.EnabledInViewMode=n.EnabledInViewMode),_Ewa.a.a("OfficeVSO:5480488_GetCommandSelectionModeAllowedToInsertAgave")){if(d=this.J(t.a),!i.EnabledInViewMode&&!f.P(null,!1,d,0))return e}else{var g=t.a===1221897806,rt=_Ewa.a.b(240)&&(t.a===-515602470||t.a===2086613372),nt=!1;if(nt=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?t.a===-859308420&&i.SolutionId==="FA000000043":t.a===-859308420&&i.AssetId==="FA000000043",!i.EnabledInViewMode&&(!(g||rt||nt)&&!f.P(null,!1,1,0)||g&&!f.P(null,!1,2,0)))return e}if(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i.AssetId==="WA200002680"||i.SolutionId==="a048b5e5-dc67-4812-b114-0969772a09ec")&&(c=this.i.a().a(_Ewa.dN,271,!1,null),c&&c.c()):(i.AssetId==="WA200002680"||i.AssetId==="a048b5e5-dc67-4812-b114-0969772a09ec")&&(l=this.i.a().a(_Ewa.dN,271,!1,null),l&&l.c()),o=isNullOrUndefined(i.IsToBePersisted)||i.IsToBePersisted?0:16,i.TargetType===1)e=this.S(i,u,t,h,o);else{var tt=_Ewa.c.a(f),s=this.s.e(tt),ut=f.b().b()?f.h().P:f.h().a(),a,v,y,p;s?(w=s.b,a=w.a().a,v=w.a().b,y=s.a.x,p=s.a.y):(a=v=1,b=this.s.c(tt),y=b.a,p=b.b);var ft=this.i.c().a().b(!1),et=this,it=function(n,t,r){return _Ewa.ut.b(f.c().a(),i,ut,a,v,y,p,_Ewa.n.a(n,et.z),t,r,null,ft)};_Ewa.a.d()?(o|=64,ot=this,e=_Ewa.H.a(this.i.f(),it,function(n){return new _Ewa.v(534,0,n,o,null)},t)):(st=this,e=_Ewa.H.a(this.i.f(),it,function(n){return new _Ewa.ba(534,0,n,o,null)},t))}return e},G:function(){var u=Common.Utils.a.a().b(Common.App.d,null),f=Common.Utils.a.a().b(Common.App.CustomerFeedback.g,null),i,n,t,r;return this.q?this.q.a()?this.C():f.b().a(this.v):Diag.a.a(593605400,1302,15,"feedbackFormManager is undefined"),i={},Common.a.a.G(i),n=u.b().c(i),t={},"telemetryGroup"in n&&(t=n.telemetryGroup),t.processSessionId=n.sessionId,t.officeBuild=n.build,n.telemetryGroup=t,n.feedbackType=-1,n.userVoiceEnabled=!1,_Ewa.a.b(357)&&"userVoice"in n&&(r=n.userVoice,"url"in r&&(n.userVoiceLink=r.url,n.userVoiceEnabled=!0,Diag.a.a(593605399,1302,15,"feedback pane user voice is enable"))),_Ewa.a.b(354)&&("disableIncludeScreenshot"in n||(n.disableIncludeScreenshot=!1),"screenshot"in n||(n.screenshot=!1)),_Ewa.a.b(355)&&(n.disableScreenshotPreview=!1),_Ewa.a.b(356)&&(n.includeScreenshotSelectedDefault=!0),n},f:function(n){var t,r,i;!this.n&&_Ewa.a.b(774)&&_Ewa.a.c("Microsoft.Office.Excel.IdeasXLOPreload",!1)&&(t=null,t=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle",r=this.B(t),i=new _Ewa.gb,i.b="ewanov_analyzedata",this.n=this.g(r,null,!1,null,i,!0),_Ewa.a.a("OfficeVSO:5347991_AddComponentNamesToReport")?_Ewa.Z.a(this.i).a(_Ewa.t.D,{Location:Common.n.toString(n.b),InputMethod:Common.m.a.toString(n.c)},null,!0):_Ewa.Z.a(this.i).a(_Ewa.t.D,{},null,!0))},F:function(n){var t=this.i.b().e().a(17),i=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(i){i.a("mso_sendASmile",t).then(function(i){return n.FeedbackEnabled=t&&i,null})})},ba:function(n){var f=_Ewa.c.a(this.i),r=new Common.App.AppsForOfficeCommon.a,t={},i,u;return t.ActiveTab="Format",t.DatapaneFlighting=_Ewa.a.c("Microsoft.Office.Excel.ChartTaskPaneData",!1),t.AceFlighting=!0,t.ChartNewSDXRecording=_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1),t.ThemeColorsFlighting=_Ewa.a.c("Microsoft.Office.Excel.ThemeColors",!1)&&_Ewa.a.a("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled"),this.F(t),t.startTimeMs=Date.now(),t.UserSessionId=this.i.e().UserSessionId,i=f.a().b().b(),i&&(t.SubSelection=i),Diag.a.a(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",t.UserSessionId,isNullOrUndefined(n.b)?"Null":Common.n.toString(n.b),i?i:"ChartRoot"),r.c=t,r.a=_Ewa.ClientStringManager.a().a(929),u=new _Ewa.gb,u.a="ewa-ptp-header",this.k(n,"FA000000014",r,!0,u,!1,null)},bb:function(n){var t=new Common.App.AppsForOfficeCommon.a,i;return t.c={},t.a=_Ewa.ClientStringManager.a().a(1712),t.f="FA000000066",i=new _Ewa.gb,i.a="ewa-ptp-header",this.k(n,"FA000000066",t,!0,i,!1,t.a)},bc:function(n){var t=new Common.App.AppsForOfficeCommon.a,i;return t.c={},t.a=_Ewa.ClientStringManager.a().a(2067),i=new _Ewa.gb,i.a="ewa-ptp-header",this.k(n,"FA000000064",t,!0,i,!1,null)},D:function(n,t){var u=n.MenuItemId.toString(),i={},r=new Common.App.AppsForOfficeCommon.a,e,f,o;r.a=_Ewa.ClientStringManager.a().a(9);switch(u){case"A0":e=n.CommandValueId||"";i.query=e.split("|").slice(2,2147483647).join("|");break;case"A1":i.query=n.CommandValueId;break;case"Help":i.gwdropdownflightinfo=_Ewa.a.b(245);i.query="";break;case"GiveFeedback":_Ewa.a.b(353)?(r.a=_Ewa.ClientStringManager.a().a(1678),r.b="Help.GiveFeedback.Url",i.feedback=this.G()):i.query=u;break;case"HelpArticle":i.query=n.CommandValueId;break;case"ContactSupport":case"ShowTraining":case"WhatsNew":i.query=u;break;default:return $$sc.a.a(Boolean,!0)}return r.c=i,f=new _Ewa.gb,f.a="ewa-ptp-header",o=n.EnabledInViewMode||!1,this.k(t,"FA000000012",r,!1,f,o,null)},B:function(n){var t={};return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.Version="0.0.0.0",t.AssetId="FA000000005",t.SolutionId="FA000000005",t.AssetStoreId="",t.StoreType=OSF.StoreType.Sdx,t.Height=0,t.Width=0,t.StoreId=OSF.StoreType.Sdx,t.TargetType=OSF.OsfControlTarget.TaskPane,t.IsToBePersisted=!1,t.SourceLocationOverrideResourceId=n,t.SharedRuntimeId=n,t.Id="FA000000005",t.CurrentStoreType=OSF.StoreType.Sdx,t.AppVersion="0.0.0.0"):(t.AppVersion="0.0.0.0",t.AssetId="FA000000005",t.Id="FA000000005",t.AssetStoreId="",t.CurrentStoreType=OSF.StoreType.Sdx,t.Height=0,t.Width=0,t.StoreId=OSF.StoreType.Sdx,t.TargetType=OSF.OsfControlTarget.TaskPane,t.IsToBePersisted=!1,t.SourceLocationOverrideResourceId=n,t.SharedRuntimeId=n),t},O:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.a,s=new _Ewa.gb,u={},c,v,e,y,l,p,w,b,k,d,o,h,a,f,g;this.F(u);u.LaunchSource="";u.StartTimeMs=Date.now();u.CorrelationId=Common.u.a().a;r.c=u;r.g=!0;r.d=320;s.a="ewa-ptp-header-ideas";s.c="ewa-ptp-title-ideas";switch(i.a){case-1444574190:u.LaunchMode="RecommendedPivotTables";u.SelectionContext="";u.LaunchSource="PivotTableHandRaise"===$$as(String,n.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";this.i&&_Ewa.a.a("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&!_Ewa.f.a(n.SourceSelection)&&(y=n.SourceSelection.split(",")[0],l=_Ewa.a.a("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0,(k=_Ewa.h.h(y,this.i.d(),p={val:c},w={val:v},b={val:e}),c=p.val,v=w.val,e=b.val,k)&&!_Ewa.c.a(this.i).e().c(e)?(d=this.i.d().b(c),u.SelectionContext=JSON.stringify((o=new _Ewa.AgaveCommandManager.b,o.address=v,o.addressWithSheet=c+"!"+e.w(!1,!1),o.sheetId=_Ewa.D.a(d),o.sheetName=c,o.isSheetEmpty=!1,o.columnCount=e.m(),o.rowCount=e.j(),o.columnIndex=e.b+l,o.rowIndex=e.a+l,o.selectionType="Continuous",o))):(h=this.i.m().b($$as(String,n.SourceSelection)),h&&_Ewa.D.o(h)&&(e=_Ewa.bw.a(h,!0),a=this.i.d().b(h.P),u.SelectionContext=JSON.stringify((f=new _Ewa.AgaveCommandManager.c,f.tableName=h.N,f.hasTableHeaders=_Ewa.bw.b(h),f.isPivotTable=!1,f.isTable=!0,f.userSelectedPivotTable=!1,f.address=e.w(!1,!1),f.addressWithSheet=a.a()+"!"+e.w(!1,!1),f.sheetId=_Ewa.D.a(a),f.sheetName=a.a(),f.isSheetEmpty=!1,f.columnCount=e.m(),f.rowCount=e.j(),f.columnIndex=e.b+l,f.rowIndex=e.a+l,f.selectionType="Continuous",f)))));r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"RecommendPivotTables.PPE.Bundle":"RecommendPivotTables.Bundle";r.a=_Ewa.ClientStringManager.a().a(1722);r.e="ewanov_pivottable";s.b="ewanov_pivottable";break;case-336193495:u.LaunchMode="RecommendedCharts";r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"RecommendCharts.PPE.Bundle":"RecommendCharts.Bundle";r.a=_Ewa.ClientStringManager.a().a(1721);r.e="ewanov_recommendedCharts";s.b="ewanov_recommendedCharts";break;case-1336341324:if(!_Ewa.a.b(517))return $$sc.a.a(Boolean,!1);u.LaunchMode="NL";r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"IdeasNL.PPE.Bundle":"IdeasNL.Bundle";switch(_Ewa.a.g("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:r.a=_Ewa.ClientStringManager.a().a(1726);u.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:r.a=_Ewa.ClientStringManager.a().a(1727);u.NLLaunchModeBrandingCandidatesIndex=2;break;case 0:default:r.a=_Ewa.ClientStringManager.a().a(1725);u.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!_Ewa.a.b(240))return $$sc.a.a(Boolean,!1);u.LaunchMode="ChartDesigner";u.LaunchSelectionMode=t.toString();r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";r.a=_Ewa.ClientStringManager.a().a(1728);break;case-515602470:default:u.LaunchMode="Default";_Ewa.a.b(240)&&(u.LaunchSelectionMode=t.toString());r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";r.a=_Ewa.ClientStringManager.a().a(1723);r.e="ewanov_analyzedata";s.b="ewanov_analyzedata"}return _Ewa.a.b(774)?(r.b=_Ewa.a.c("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle",this.n?(g=this,this.n.CWR($$sc.a,function(){return g.E(u,r)})):this.R(i,r,s,u)):this.k(i,"FA000000005",r,!0,s,!1,null)},R:function(n,t,i,r){var f=this.B(t.b),u;return this.n=this.g(f,t,!1,n,i,!1),u=this,this.n.CWR($$sc.a,function(){return u.E(r,t)})},E:function(n,t){var i=this.j.c(this.j.l("FA000000005",t.b)),r;return i&&(this.o.FA000000005=n,r=this.r(this.j.b(i).OsfPropertyBag,"FA000000005"),this.j.b(i).OsfPropertyBag=r),this.T("FA000000005","LaunchIdeasAction",n,t),$$sc.a.a(Boolean,!0)},Q:function(n,t,i,r,u){var c,y;if(i!==2)return 32;var o=u,l=o.extId,p=o.ComponentType,h=o.ComponentId,w=o.HostProps,f=o.OptionalProps,e=new Common.App.AppsForOfficeCommon.a;e.k=f.a.InstanceToken;e.a=f.a.TaskPaneTitle;e.f=f.a.TaskPaneIconId;"TaskPaneWidth"in f.a&&(e.d=f.a.TaskPaneWidth);e.b=f.a.SourceLocationOverrideResourceId;e.c=f.b;e.i=f.a.OnTaskPaneClose;e.j=h;var a=new _Ewa.L(-859308420,0,2,0,""),v=l.b()===OSF.StoreType.Sdx,s=new _Ewa.gb;return _Ewa.a.a("OfficeVSO:5665476_OfficeScriptsHeaderCSSName")?(c=f.a.HeaderCssClass,s.a=c?c:"ewa-ptp-header",s.c=f.a.TitleCssClass):(s.a=this.K(h),s.c=this.M(h)),y=this.k(a,l.a(),e,v,s,!1,null),32},P:function(n,t,i,r,u){if(i!==2)return 32;var f=u,o=f.extId,e=o.a(),s=f.OptionalProps,h=s.a.SourceLocationOverrideResourceId;return e?(this.j.a().refreshOsfControl(e,h),32):8},M:function(n){switch(n){case"MakerCodeEditor":case"MakerScriptRecorder":case"MakerScriptGallery":case"MakerScriptDetail":case"FA000000043":var t=_Ewa.s.a(this.i)&&_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptsReactTaskpaneInfra",!1);return t?"ewa-ptp-title-maker-react":"ewa-ptp-title-maker";default:return null}},K:function(n){switch(n){case"MakerCodeEditor":case"MakerScriptRecorder":case"MakerScriptGallery":case"MakerScriptDetail":case"FA000000043":var t=_Ewa.s.a(this.i)&&_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptsReactTaskpaneInfra",!1);return t?this.i.v()?"ewa-ptp-header-maker-rtl":"ewa-ptp-header-maker":"ewa-ptp-header";default:return"ewa-ptp-header"}},k:function(n,t,i,r,u,f,e){var l=_Ewa.g.c(),o,c,h,s;return i||(i=new Common.App.AppsForOfficeCommon.a),o={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(o.Version="0.0.0.0",o.AssetId=t,o.SolutionId=t,o.AssetStoreId="",o.StoreType=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,o.Height=0,o.Width=0,o.StoreId=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,o.TargetType=OSF.OsfControlTarget.TaskPane,o.IsToBePersisted=!1,o.SourceLocationOverrideResourceId=i.b,o.AppVersion="0.0.0.0",o.Id=t,o.CurrentStoreType=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty):(o.AppVersion="0.0.0.0",o.AssetId=t,o.Id=t,o.AssetStoreId="",o.CurrentStoreType=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,o.Height=0,o.Width=0,o.StoreId=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,o.TargetType=OSF.OsfControlTarget.TaskPane,o.IsToBePersisted=!1,o.SourceLocationOverrideResourceId=i.b),(i.a||e)&&(this.m[t]=(c=new _Ewa.AgaveCommandManager.a,c.a=i.a,c.b=e,c.c=i.f,c)),_Ewa.a.c("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(i.c||(i.c={}),i.c.ShowFeedback=this.i.be(),this.o[t]=i.c):i.c&&(this.o[t]=i.c),h={},h.CommandValueId=o,s={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(s.id=o.Id,s.solutionId=o.SolutionId,s.version=o.Version,s.storeType=o.StoreType,s.storeId=o.StoreId,s.assetId=o.AssetId,s.assetStoreId=o.AssetStoreId,s.height=o.Height,s.targetType=o.TargetType,s.width=o.Width,s.isAddinCommands=!r,s.appVersion=o.AppVersion,s.currentStoreType=o.CurrentStoreType):(s.appVersion=o.AppVersion,s.assetId=o.AssetId,s.assetStoreId=o.AssetStoreId,s.currentStoreType=o.CurrentStoreType,s.height=o.Height,s.id=o.Id,s.storeId=o.StoreId,s.targetType=o.TargetType,s.width=o.Width,s.isAddinCommands=!r),h.ack5=s,u||(u=new _Ewa.gb),u.e=i.g,u.d=i.d,h.InsertAgaveClientSideParametersKey=u,h.EnabledInViewMode=f,this.e(h,n)},S:function(n,t,i,r,u){var f=this,s=function(n,t){var i,o,s,e,h,c;if(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(i=n.SolutionId,o=n.StoreType,(n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&n.SourceLocationOverrideResourceId&&(i=f.j.l(i,n.SourceLocationOverrideResourceId))):(i=n.Id,o=n.CurrentStoreType,(n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&n.SourceLocationOverrideResourceId&&(i=f.j.l(i,n.SourceLocationOverrideResourceId))),s=f.j.j(i,null,null,n.SharedRuntimeId),(o===OSF.StoreType.FirstParty||o===OSF.StoreType.Sdx)&&(_Ewa.a.b(305)&&s&&(e=f.j.c(i),e&&(h=null,h=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?f.r(f.j.b(e).OsfPropertyBag,n.SolutionId):f.r(f.j.b(e).OsfPropertyBag,n.AssetId),c=f.j.a().getOsfControl(e),c&&c.setSettings(h))),n.SharedRuntimeId&&s||f.j.a().refreshOsfControl(n.Id,n.SourceLocationOverrideResourceId)),!s){var v=f.i.c().a().b(!1),l=519,a=function(t,i,u){return _Ewa.ut.a(f.i.c().a(),n,_Ewa.n.a(t,f.t),i,u,r,v)};return isNullOrUndefined(n.IsToBePersisted)||n.IsToBePersisted||(l=538,a=function(t,i,u){return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Diag.a.a(542185172,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.StoreType,n.StoreId,Telemetry.PrivacyRules.GetAssetId(n.StoreType,n.StoreId,n.SolutionId,null,null)):Diag.a.a(539305360,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.CurrentStoreType,n.StoreId,Telemetry.PrivacyRules.GetAssetId(n.CurrentStoreType,n.StoreId,n.AssetId,null,null)),_Ewa.uu.a(f.i.c().a(),n,_Ewa.n.a(t,f.t),i,u,r,v)}),_Ewa.a.d()?(u|=64,_Ewa.H.a(f.i.f(),a,function(n){return new _Ewa.v(l,0,n,u,null)},t)):_Ewa.H.a(f.i.f(),a,function(n){return new _Ewa.ba(l,0,n,u,null)},t)}return _Ewa.g.d()},h=this,c=function(n){var t,i,r;return Diag.a.a(542185171,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(n.currentStoreType,n.storeId,n.assetId,null,null),n.currentStoreType),t={},i=new($$sc.v.$$(Object)),i.b(n),t.ack2=i,t.ack0=3,r=new _Ewa.L(407117407,0,h.i.p(),0,null),h.i.i().a(r,t,null)},o,e,l,a;return!_Ewa.a.b(54)||n.StoreId===OSF.StoreType.FirstParty?s(n,i,r):t.isAddinCommands?c(t):(o=new($$sc.D.$$(Boolean)),e={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(e.marketplaceId=n.SolutionId,e.marketplaceVersion=n.Version,e.storeType=n.StoreType,e.storeId=n.StoreId,e.targetData=n):(e.marketplaceId=n.Id,e.marketplaceVersion=n.AppVersion,e.storeType=n.CurrentStoreType,e.storeId=n.StoreId,e.targetData=n),_Ewa.a.b(94)&&(e.clearCache=!0),l=this,this.j.a().isAddinCommandsAsync(e,function(n,t,i){if(o.a(t),!n){var r=i.targetData;_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?Diag.a.a(542185170,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(r.StoreType,r.StoreId,r.SolutionId,null,null),r.StoreType):Diag.a.a(539305359,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(r.CurrentStoreType,r.StoreId,r.Id,null,null),r.CurrentStoreType)}}),a=this,_Ewa.g.ts(o.b,function(u){var f=u.a();return f?c(t):s(n,i,r)},this.i.g(),3,null))},X:function(n){var i=n.Result,t=null===i?null:i.SolutionId;!t||!t.length||(this.j.r(t),_Ewa.R.a(this.i).c(3,t,!1))},r:function(n,t){var i,e,u,r,h;if(!this.o[t])return n;if(i={},n)for(var c=n,p=c.length,f=0;f<p;++f)e=c[f],i[e[0]]=e[1];u=this.o[t];for(var l=Object.keys(u),w=l.length,o=0;o<w;++o)r=l[o],i[r]=r==="feedback"&&_Ewa.a.b(353)?Sys.Serialization.JavaScriptSerializer.serialize(u[r]):Sys.Serialization.JavaScriptSerializer.serialize(u[r].toString());for(var b=Object.keys(i).length,a=new Array(b),v=0,y=Object.keys(i),k=y.length,s=0;s<k;++s)h=y[s],a[v]=[h,i[h].toString()],v++;return a},W:function(n,t){var f=n.Result,i=f?f.AgaveData:null,u,r;if(!i){Diag.a.a(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.");return}u=t;Diag.a.b(593605393,0,i.TaskpaneWidth===350,"Taskpane width is {0}, assetId is {1}.",i.TaskpaneWidth,i.PrimaryMarketplace.SolutionId);r=this.m[i.PrimaryMarketplace.SolutionId];r&&(r.a&&(i.TaskpaneTitle=r.a),r.c&&(i.TaskpaneIconId=r.c),r.b&&(i.TaskpaneButtonTooltip=r.b),_Ewa.a.a("OfficeVSO:5647070_OverwriteSharedRuntimeTaskpaneWidth")&&r.d>0&&(i.TaskpaneWidth=r.d));u&&(i.FocusOnIframeWhenLoaded=u.e,u.d&&(i.TaskpaneWidth=u.d),i.TaskpaneIconCssClass=u.b,i.TaskpaneHeaderCssClass=u.a,i.TaskpaneTitleCssClass=u.c);this.o[i.PrimaryMarketplace.SolutionId]&&(i.OsfPropertyBag=this.r(i.OsfPropertyBag,i.PrimaryMarketplace.SolutionId));_Ewa.jA.a(i)||(i.WebExtensionOsfControlType=1);i&&(this.j.r(f.SolutionId),this.j.k(i))},U:function(n,t,i){var f=this.i.e().UserSessionId,e=this.i.e().UICultureTag,o=this.i.e().UICultureTagLcid,s=this.i.e().WacHostId,r="",u="";i.length>=5&&(r=i[3],u=i[4]);this.V(r,u,n,t,e,o,f,s)},V:function(n,t,i,r,u,f,e,o){var s={};s.a=e;s.b=i;s.c=r;s.d=n;s.e=t;s.f=u;s.g=f;s.h=o;_Ewa.F.a().a(36,s,!1)},C:function(){var t,r;if(Fdbk.a.r()){Diag.a.a(593605392,1302,15,"OBF is undefined");return}try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.u);return}catch(n){t=n?n.toString():null;Diag.a.a(593605391,1302,15,"Failed to use createScreenshot "+t)}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.u);return}catch(i){r=i?i.toString():null;Diag.a.a(593605390,1302,15,"Failed to use html2canvas"+r)}},H:function(n){n&&(this.q.b(n),this.C())},Y:function(n){var i=n.toDataURL("image/jpeg",null),r=this.j.c("FA000000012.Help.GiveFeedback.Url"),t={};t.screenshot=i;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r,"onScreenshot",t,null)},g:function(n,t,i,r,u,f){var v=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?n.SolutionId:n.AssetId,y=$$sc.a.a(Boolean,!1),e,c,o,h,l,a,s;return!n||!v||!v.length||_Ewa.f.a(n.SharedRuntimeId)||(r=r?r:new _Ewa.L(-859308420,0,2,0,""),e={},_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(e.id=n.Id,e.solutionId=n.SolutionId,e.version=n.Version,e.storeType=n.StoreType,e.storeId=n.StoreId,e.assetId=n.AssetId,e.assetStoreId=n.AssetStoreId,e.height=n.Height,e.targetType=n.TargetType,e.width=0,e.isAddinCommands=!1,e.sharedRuntimeId=n.SharedRuntimeId,n.Preload=f,e.appVersion=n.AppVersion,e.currentStoreType=n.CurrentStoreType):(e.appVersion=n.AppVersion,e.assetId=n.AssetId,e.assetStoreId=n.AssetStoreId,e.currentStoreType=n.CurrentStoreType,e.height=n.Height,e.id=n.Id,e.storeId=n.StoreId,e.targetType=n.TargetType,e.width=0,e.isAddinCommands=!1,e.sharedRuntimeId=n.SharedRuntimeId,n.Preload=f),c=u?u:new _Ewa.gb,c.d=0,t&&(o=t,c.e=o.g,_Ewa.a.a("OfficeVSO:5647070_OverwriteSharedRuntimeTaskpaneWidth")?(h=new _Ewa.AgaveCommandManager.a,o.a&&(h.a=o.a),o.d>0&&(h.d=o.d),_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.m[n.SolutionId]=h:this.m[n.AssetId]=h):o.a&&(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?this.m[n.SolutionId]=(l=new _Ewa.AgaveCommandManager.a,l.a=o.a,l):this.m[n.AssetId]=(a=new _Ewa.AgaveCommandManager.a,a.a=o.a,a))),s={},s.CommandValueId=n,s.ack5=e,s.InsertAgaveClientSideParametersKey=c,s.EnabledInViewMode=i,y=this.e(s,r)),y},T:function(n,t,i,r){var u,o;if(!(!n||!n.length)&&!(!t||!t.length)){var e=null,s=new Common.App.AppsForOfficeCommon.c(n,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),h=new Common.App.AppsForOfficeCommon.e("ExcelOnline","Web",this.i.e().UICultureTag),f=new Common.App.AppsForOfficeCommon.d;f.a.ActionArgs=i;r&&(u=r,!u.b||!u.b.length||(f.a.SourceLocationOverrideResourceId=u.b),!u.a||!u.a.length||(f.a.TaskPaneTitle=u.a),!u.e||!u.e.length||(f.a.IconCssClass=u.e),!u.h||!u.h.length||(f.a.TaskPaneIconUrl=u.h),!u.f||!u.f.length||(f.a.TaskPaneIconId=u.f));Common.App.AppsForOfficeCommon.b.a().a(s,"Action",t,h,f,o={val:e});e=o.val}},N:function(n,t,i,r,u){var s,c,f,h,e,o,l;if(i!==2)return 32;if((s=u,Common.D.d(s))||(c=s.ComponentType,c!=="Action")||(f=s.OptionalProps,!f))return 8;if(h=this.L(u),e=h?this.j.c(h):null,!(!e||!e.length)){var a=s.ComponentId,v=f.a.ActionArgs,y=this.j.A(a,v);return _Ewa.a.a("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(o=this.j.b(e),o.TaskpaneTitle!==f.a.TaskPaneTitle&&(o.TaskpaneTitle=f.a.TaskPaneTitle,o.TaskpaneIconCssClass=f.a.IconCssClass,o.TaskpaneIconUrl=f.a.TaskPaneIconUrl,o.TaskpaneIconId=f.a.TaskPaneIconId,l=this.j.a().getOsfControl(e),this.j.a().raiseOsfControlStatusChange(l))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(e,y,this.A),32}return 8},Z:function(n,t){this.j.D(n,t)},L:function(n){var i=n,r,t,u;return!Common.D.d(i)&&(r=i.extId,r&&(t=r.a(),u=i.OptionalProps,!(!t||!t.length)&&u))?this.I(t,u.a.SourceLocationOverrideResourceId):null},I:function(n,t){return!(!n||!n.length)&&!(!t||!t.length)?String.format("{0}.{1}",n,t):n},J:function(n){switch(n){case 1221897806:return 2;case-515602470:case 2086613372:return _Ewa.a.b(240)?1023:1;case 1723441034:return 1023;case-859308420:return 1023;case 515196233:return 1023;default:return 1}}};_Ewa.AgaveCommandManager.a=function(){};_Ewa.AgaveCommandManager.a.prototype={a:null,b:null,d:0,c:null};_Ewa.AgaveCommandManager.b=function(){};_Ewa.AgaveCommandManager.b.prototype={sheetId:null,sheetName:null,address:null,addressWithSheet:null,rowCount:0,rowIndex:0,columnCount:0,columnIndex:0,isSheetEmpty:!1,selectionType:null};_Ewa.AgaveCommandManager.c=function(){_Ewa.AgaveCommandManager.c.initializeBase(this)};_Ewa.AgaveCommandManager.c.prototype={isTable:!1,isPivotTable:!1,hasTableHeaders:!1,tableName:null,userSelectedPivotTable:!1};_Ewa.us=function(n){_Ewa.us.initializeBase(this);this.h=n;this.l()};_Ewa.us.a=function(n){n.a().b(_Ewa.bkq.$$(_Ewa.hM),375,new _Ewa.us(n))};_Ewa.us.prototype={h:null,a:function(){var n=this.h.a(),t=_Ewa.l.b(_Ewa.bQ,n,106,this.i(),this.j,null),i=_Ewa.l.b(_Ewa.gm,n,104,this.i(),this.j,null),f=_Ewa.x.c(36,0,this.j,!1,!1,375),r=this,u;_Ewa.g.a(_Ewa.g.b([i,t,f],this.i(),3),function(){var e=new Common.App.AppsForOfficeCommon.g(Common.Utils.c.a()),o=new Common.App.AppsForOfficeCommon.o(Common.a.a,Common.a.e,"WAC_Excel"),s=new Common.App.AppsForOfficeCommon.n(e,o,"PreinstalledAppsData_Excel",null),f=null,u;_Ewa.a.b(353)&&(f=Common.Utils.a.a().b(Common.App.CustomerFeedback.d,null).b());Common.App.AppsForOfficeCommon.h.a.a=s;_Ewa.hL.c().d(t.a());u=new _Ewa.AgaveCommandManager(r.h,t.a(),i.a(),f,Common.a.c());n.b(_Ewa.uA,206,u);r.k(n.a(_Ewa.hM,374,!1,null)||n.b(_Ewa.hM,374,u))},this.i(),3,null,null);u=this;Common.Utils.a.a().c(Common.Utils.d,null).c(Common.Utils.h,null).a().b(function(){return new Common.Utils.d(u.h.Z())})}};_Ewa.bdm=function(){};_Ewa.bdm.a=function(){_Ewa.m.a(function(n){_Ewa.ur.a(n);_Ewa.us.a(n)})};_Ewa.ut=function(){};_Ewa.ut.a=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.sharedInfo=t,_Ewa.k.a(n,"InsertAgaveTaskpane",o,i,r,u,f,0,null,null)};_Ewa.ut.b=function(n,t,i,r,u,f,e,o,s,h,c,l){var a=n.a(9,l);return a.sharedInfo=t,a.sheetName=i,a.positionRow=r,a.positionCol=u,a.positionOffsetX=f,a.positionOffsetY=e,_Ewa.k.a(n,"InsertWebExtension",a,o,s,h,c,0,null,null)};_Ewa.Ff=function(n){_Ewa.Ff.initializeBase(this,[!1]);this.b=n;this.a=!1};_Ewa.Ff.prototype={b:null,a:!1,y:function(){return!1},z:function(){return!1},w:function(n,t){var i=_Ewa.a.b(138);return t.a===-983891024&&i},x:function(n,t){var i=_Ewa.g.c();return t.a===-983891024&&this.c(),i},c:function(){var s=new Common.App.SmartLookup.h(null),r={},h=_Ewa.c.a(this.b),c=h.h(null),u=c.d(),n,l=(n=new Common.App.SmartLookup.e,n.neighborhood=u,n.mentionStart=0,n.mentionLength=u?u.length:0,n),i,a=(i=new Common.App.SmartLookup.f,i.selection=l,i.entryPoint=0,i),f=this,o;s.a(!1).then(function(n){n.applicationName="Excel";n.isFirstLaunch=f.a;n.themeId=5;r.SmartLookupApplicationInterface=JSON.stringify(a);r.AppProperties=JSON.stringify(n);f.a=!1});var e=null,v=new Common.App.AppsForOfficeCommon.e("ExcelOnline","Web","en-Us"),y=new Common.App.AppsForOfficeCommon.c("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0"),t=new Common.App.AppsForOfficeCommon.d;t.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(1713);t.a.TaskPaneWidth=350;t.a.SourceLocationOverrideResourceId="WAC.PROD.URL";t.b=r;Common.App.AppsForOfficeCommon.b.a().a(y,"Taskpane","SmartLookupSDXTaskpane",v,t,o={val:e});e=o.val}};_Ewa.EJ.registerClass("_Ewa.EJ",null,_Ewa.lI);_Ewa.ur.registerClass("_Ewa.ur",_Ewa.bh);_Ewa.AgaveCommandManager.registerClass("_Ewa.AgaveCommandManager",_Ewa.bW,_Ewa.hM,_Ewa.uA);_Ewa.AgaveCommandManager.a.registerClass("_Ewa.AgaveCommandManager.a");_Ewa.AgaveCommandManager.b.registerClass("_Ewa.AgaveCommandManager.b");_Ewa.AgaveCommandManager.c.registerClass("_Ewa.AgaveCommandManager.c",_Ewa.AgaveCommandManager.b);_Ewa.us.registerClass("_Ewa.us",_Ewa.sX.$$(_Ewa.hM));_Ewa.Ff.registerClass("_Ewa.Ff",_Ewa.bW,_Ewa.lI);_Ewa.hL.a=null;_Ewa.hL.b=!1;_Ewa.bdm.a();Type.registerNamespace("_Ewa");_Ewa.bdK=function(){};_Ewa.bdL=function(){};_Ewa.FB=function(n,t,i){this.i=n;this.e=t;this.g=i;this.d=new _Ewa.FA;this.f=!!this.e&&this.e.a()==null?!1:this.e.a()};_Ewa.FB.prototype={g:null,e:null,i:null,d:null,f:!1,c:function(){return this.f},b:function(){return this.d},a:function(){var i=_Ewa.q.a().a(),n=[],r,u,f,e;if(this.e)n.push((r=new Otel.a,r.name="IsAuthSupported",r.bool=this.f,r));else return this.h(n,i,"need_OAuthManager","No OAuthManager");if(!this.g.a||!this.g.a.a)return this.h(n,i,"need_license","No License");if(Common.a.a.a("IsAnonymousUser"))return this.h(n,i,"need_user","Anonymous User");if(Date.now()-this.d.timeStamp<33e5)return n.push((u=new Otel.a,u.name="UsedCachedToken",u.bool=!0,u)),Common.A.a(_Ewa.t.k,!0,0,n),Promise.resolve((f=new _Ewa.hE,f.IsSuccess=!0,f.Token=this.d.token,f));n.push((e=new Otel.a,e.name="UsedCachedToken",e.bool=!1,e));var t=1,h=this,o=function(i,r){return new Promise(function(n){window.setTimeout(function(){n(i)},r)}).then(function(i){var r,u;return n.push((r=new Otel.a,r.name="Error"+t,r.string=i.ErrorMessage,r)),n.push((u=new Otel.a,u.name="ErrorCode"+t,u.string=i.ErrorCode,u)),t++,h.j()})},l=this,a=this,s=this,c=this;return this.j().catch(function(n){return o(n,200)}).catch(function(n){return o(n,400)}).then(function(r){var c="",u,f,e,o,h;return r.IsSuccess?(s.d.token=r.Token,s.d.timeStamp=Date.now(),c=r.Token):(n.push((u=new Otel.a,u.name="Error"+t,u.string=r.ErrorMessage,u)),n.push((f=new Otel.a,f.name="ErrorCode"+t,f.string=r.ErrorCode,f))),n.push((e=new Otel.a,e.name="Attempts",e.int64=t,e)),n.push((o=new Otel.a,o.name="Error",o.string=r.ErrorMessage,o)),n.push((h=new Otel.a,h.name="ErrorCode",h.string=r.ErrorCode,h)),Common.A.a(_Ewa.t.k,r.IsSuccess,_Ewa.bi.a(i,_Ewa.q.a().a()),n),Promise.resolve(r)}).catch(function(r){var u=r,f,e,o;return n.push((f=new Otel.a,f.name="Error"+t,f.string=u.ErrorMessage,f)),n.push((e=new Otel.a,e.name="ErrorCode"+t,e.string=u.ErrorCode,e)),n.push((o=new Otel.a,o.name="Attempts",o.int64=t,o)),c.h(n,i,u.ErrorCode,u.ErrorMessage)})},h:function(n,t,i,r){var f,e,u;return n.push((f=new Otel.a,f.name="Error",f.string=r,f)),n.push((e=new Otel.a,e.name="ErrorCode",e.string=i,e)),Common.A.a(_Ewa.t.k,!1,_Ewa.bi.a(t,_Ewa.q.a().a()),n),Promise.resolve((u=new _Ewa.hE,u.IsSuccess=!1,u.ErrorMessage=r,u.ErrorCode=i,u))},j:function(){var t=_Ewa.bn.l(this.i),n=0,i=2e4,r=this,f=this,u=this.e.b("Maker",t).then(function(n){if(n)return!n.IsSuccess&&r.k(n)?Promise.reject(n):Promise.resolve(n);var t,i=(t=new _Ewa.hE,t.IsSuccess=!1,t.ErrorMessage="Missing result object",t.ErrorCode="need_result",t);return Promise.reject(i)}).catch(function(n){var t=new _Ewa.hE;return Object.getType(n)===Object.getType(t)?t=n:(t.ErrorMessage=n.toString(),t.ErrorCode="exception"),Promise.reject(t)}),e=this,o=this;return Promise.race([u,new Promise(function(t,r){n=window.setTimeout(function(){var n;r((n=new _Ewa.hE,n.IsSuccess=!1,n.ErrorCode="Timeout",n.ErrorMessage="Timed out waiting auth token promise",n))},i)})]).then(function(t){return window.clearTimeout(n),t})},k:function(n){return n.ErrorCode==="interaction_required"||n.ErrorCode==="InitFailed"||n.ErrorCode==="invalid_resource"||n.ErrorCode==="login_required"&&n.ErrorMessage.startsWith("AADSTS500341")?!1:!0}};_Ewa.FJ=function(n,t){this.currentUserToken=n;this.currentUserMlapiToken=t};_Ewa.FJ.prototype={currentUserToken:null,currentUserMlapiToken:null};_Ewa.bdN=function(){};_Ewa.bdN.prototype={UserId:null,OfficeScriptingEnabled:!1};_Ewa.FA=function(){};_Ewa.FA.prototype={token:null,timeStamp:0};_Ewa.gz=function(n,t,i,r,u){this.a=n;this.b=t;this.e=i;this.c=r;this.d=u};_Ewa.gz.prototype={a:!1,b:!1,e:null,c:null,d:null};_Ewa.ed=function(n){this.a=_Ewa.eh.c(n)||{};this.e(this.d()||null)};_Ewa.ed.prototype={a:null,d:function(){return this.a.shareId},e:function(n){return this.a.shareId=n||null,n},c:function(){return this.a.name},g:function(){return this.a.dateLastPublished},h:function(){return this.a.isCreator},f:function(){return!!this.d()&&this.d().length>0},b:function(){return new _Ewa.ed(this.a)}};_Ewa.bdM=function(){this.operationName=operation;this.scriptMetadata=script};_Ewa.bdM.prototype={operationName:null,scriptMetadata:null};_Ewa.gc=function(n,t){this.a=n;this.l=t};_Ewa.gc.prototype={a:null,h:function(n){for(var t=0;t<this.a.length;t++)if(this.a[t].a.id===n||this.a[t].d()===n)return t;return-1},l:null,d:function(){this.l(this.a)},b:function(n){return this.h(n.a.id)===-1?(this.a.push(n),!0):!1},i:function(n){if(this.h(n.a.id)===-1){var t=[n];return this.a=t.concat.apply(t,this.a),!0}return!1},o:function(n){var t=this.h(n.a.id),i;if(t===-1)return!1;for(i=this.a[t].b();t>0;)this.a[t]=this.a[t-1],t--;return this.a[0]=i,!0},f:function(n){var t=this.h(n.a.id),i;return t!==-1?(i=this.a[t].d(),this.a[t]=n,this.a[t].e(i),!0):!1},k:function(n){var t=this.h(n.a.id);return t!==-1?n.c()===this.a[t].c():!1},g:function(n){var t=this.h(n);return t!==-1?(this.a.splice(t,1),!0):!1},m:function(){this.a=new Array(0)},c:function(n){var t=this.h(n);return t!==-1?this.a[t]:null},e:function(n){return n>=0&&this.a.length>n?this.a[n]:null},n:function(n){for(var i,r=new _Ewa.gc([],this.l),t=0;t<this.a.length;t++)i=this.a[t],n.c(i.a.id)||r.b(i);return r},j:function(){for(var r,t=new Array(0),i=this.a,u=i.length,n=0;n<u;++n)r=i[n],t.push(r.a);return t}};_Ewa.FI=function(n,t,i,r){this.c=n;this.b=t;this.d=i;this.a=r};_Ewa.FI.prototype={c:null,b:null,d:null,a:null};_Ewa.FD=function(n,t){_Ewa.FD.initializeBase(this);this.d=n;this.a=t};_Ewa.FD.prototype={d:null,a:null,f:function(n){switch(n){case"1":case"2":case"3":return this.c.e(parseInt(n)-1);default:return this.a.k.a.c(n)||this.a.l().c(n)||this.a.r().c(n)}},e:function(n,t,i){var r=null,u;if(this.a.b())switch(n){case"1":case"2":case"3":r=this.c.e(parseInt(n)-1);break;default:r=this.c.c(n)}_Ewa.s.e()?(u=_Ewa.a.a("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?i===2:!_Ewa.Q.a().f(),t[CommandUI.Controls.a.GalleryButtonProps]=_Ewa.dM.b(n,r,u)):t[CommandUI.Controls.a.InnerHTML]=_Ewa.dM.e(r);t.Alt=r?r.c():""},b:function(n){var t,i,r,u,f,e,o,s,h,c;this.c=this.m();this.d.t();t=[];t.push((i=new Otel.a,i.name="Operation",i.string=n,i));t.push((r=new Otel.a,r.name="HasReadRecentCachedScripts",r.bool=this.a.k.k,r));t.push((u=new Otel.a,u.name="ReadScriptsDone",u.bool=this.a.I(),u));t.push((f=new Otel.a,f.name="ReadSamplesScriptsDone",f.bool=this.a.K(),f));t.push((e=new Otel.a,e.name="SamplesScriptCount",e.int64=this.a.r().a.length,e));t.push((o=new Otel.a,o.name="ReadRecentScriptsDone",o.bool=this.a.k.g,o));t.push((s=new Otel.a,s.name="RecentScriptCount",s.int64=this.a.k.a.a.length,s));t.push((h=new Otel.a,h.name="ReadWorkbookScriptsDone",h.bool=this.a.C(),h));t.push((c=new Otel.a,c.name="WorkbookScriptCount",c.int64=this.a.l().a.length,c));Common.A.a(_Ewa.t.j,!0,0,t)},g:function(n){var i=!1,t="",f=n,r=new _Ewa.ed(f.scriptMetadata),u={},e,o,s,h,c,l,a,v,y,p;u.Operation="HandleRefreshRibbonGallery";u.RefreshOperation=f.operationName;switch(f.operationName){case"Publish":i=(o=this.l(r,e={val:t}),t=e.val,o);break;case"Delete":i=(h=this.i(r,s={val:t}),t=s.val,h);break;case"Attach":i=(l=this.h(r,c={val:t}),t=c.val,l);break;case"Detach":i=(v=this.j(r,a={val:t}),t=a.val,v);break;case"Open":i=(p=this.k(r,y={val:t}),t=y.val,p)}u.GalleryUpdated=i;i?(Diag.a.a(545064346,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",t),this.b("RefreshGallery")):Diag.a.a(545064345,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",t);u.Message=t;Diag.a.a(545064344,0,50,JSON.stringify(u))},m:function(){for(var f,o=this,r=new _Ewa.gc([],function(){}),t=this.a.l()?this.a.l().a.length:0,u=this.a.k.a?this.a.k.a.a.length:0,e=this.a.r()?this.a.r().a.length:0,i=0,n=0;n<3;n++)n<t?r.b(this.a.l().e(n)):n-t+i<u?(f=this.a.k.a.e(n-t+i),this.a.l().c(f.a.id)?(i++,n--):r.b(f)):n-t-u+i<e&&r.b(this.a.r().e(n-t+i-u));return r},l:function(n,t){if(this.a.k.a.i(n))return t.val="",!0;t.val="";var i=n.b();return this.a.l().f(i),this.a.l().d(),this.a.k.a.f(n),!0},i:function(n,t){return this.a.l().g(n.a.id),this.a.k.a.g(n.a.id)?(t.val="",!0):(t.val="Deleting a script but script could not be found in recent script collection.",!1)},h:function(n,t){var i=n.b();return i.e(null),this.a.k.a.i(i),this.a.l().b(n)?(this.a.l().d(),t.val="",!0):(t.val="Could not attach a script that is already attached.",!1)},j:function(n,t){return this.a.l().g(n.a.id)?(t.val="",!0):(t.val="Detaching a script but the script could not be found in the collection.",!1)},k:function(n,t){t.val="";var r=n.b(),i=!1;return this.a.l().k(r)&&(this.a.l().f(r),this.a.l().d(),i=!0),this.a.k.a.i(n)?i=!0:this.a.k.a.k(n)&&(this.a.k.a.f(n),this.a.k.a.o(n),i=!0),i}};_Ewa.FC=function(n,t){_Ewa.FC.initializeBase(this);this.d=n;this.a=t};_Ewa.FC.prototype={d:null,a:null,f:function(n){switch(n){case"1":case"2":case"3":return this.c.e(parseInt(n)-1);default:return this.a.a.c(n)||this.a.b.c(n)||this.a.d.c(n)}},e:function(n,t,i){var r=null,u;if(this.a.F())switch(n){case"1":case"2":case"3":r=this.c.e(parseInt(n)-1);break;default:r=this.c.c(n)}_Ewa.s.e()?(u=_Ewa.a.a("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?i===2:!_Ewa.Q.a().f(),t[CommandUI.Controls.a.GalleryButtonProps]=_Ewa.dM.b(n,r,u)):t[CommandUI.Controls.a.InnerHTML]=_Ewa.dM.e(r);t.Alt=r?r.c():""},b:function(n){var t,i,r,u,f,e,o,s,h,c;this.c=this.m();this.d.t();t=[];t.push((i=new Otel.a,i.name="Operation",i.string=n,i));t.push((r=new Otel.a,r.name="HasReadRecentCachedScripts",r.bool=this.a.k,r));t.push((u=new Otel.a,u.name="ReadScriptsDone",u.bool=this.a.v(),u));t.push((f=new Otel.a,f.name="ReadSamplesScriptsDone",f.bool=this.a.m,f));t.push((e=new Otel.a,e.name="SamplesScriptCount",e.int64=this.a.d.a.length,e));t.push((o=new Otel.a,o.name="ReadRecentScriptsDone",o.bool=this.a.g,o));t.push((s=new Otel.a,s.name="RecentScriptCount",s.int64=this.a.a.a.length,s));t.push((h=new Otel.a,h.name="ReadWorkbookScriptsDone",h.bool=this.a.c,h));t.push((c=new Otel.a,c.name="WorkbookScriptCount",c.int64=this.a.b.a.length,c));Common.A.a(_Ewa.t.j,!0,0,t)},g:function(n){var i=!1,t="",f=n,r=new _Ewa.ed(f.scriptMetadata),u={},e,o,s,h,c,l,a,v,y,p;u.Operation="HandleRefreshRibbonGallery";u.RefreshOperation=f.operationName;switch(f.operationName){case"Publish":i=(o=this.l(r,e={val:t}),t=e.val,o);break;case"Delete":i=(h=this.i(r,s={val:t}),t=s.val,h);break;case"Attach":i=(l=this.h(r,c={val:t}),t=c.val,l);break;case"Detach":i=(v=this.j(r,a={val:t}),t=a.val,v);break;case"Open":i=(p=this.k(r,y={val:t}),t=y.val,p)}u.GalleryUpdated=i;i?(Diag.a.a(539309782,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",t),this.b("RefreshGallery")):Diag.a.a(539309781,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",t);u.Message=t;Diag.a.a(539309780,0,50,JSON.stringify(u))},m:function(){for(var f,o=this,r=new _Ewa.gc([],function(){}),t=this.a.b?this.a.b.a.length:0,u=this.a.a?this.a.a.a.length:0,e=this.a.d?this.a.d.a.length:0,i=0,n=0;n<3;n++)n<t?r.b(this.a.b.e(n)):n-t+i<u?(f=this.a.a.e(n-t+i),this.a.b.c(f.a.id)?(i++,n--):r.b(f)):n-t-u+i<e&&r.b(this.a.d.e(n-t+i-u));return r},l:function(n,t){if(this.a.a.i(n))return t.val="",!0;t.val="";var i=n.b();return this.a.b.f(i),this.a.b.d(),this.a.a.f(n),!0},i:function(n,t){return this.a.b.g(n.a.id),this.a.a.g(n.a.id)?(t.val="",!0):(t.val="Deleting a script but script could not be found in recent script collection.",!1)},h:function(n,t){var i=n.b();return i.e(null),this.a.a.i(i),this.a.b.b(n)?(this.a.b.d(),t.val="",!0):(t.val="Could not attach a script that is already attached.",!1)},j:function(n,t){return this.a.b.g(n.a.id)?(t.val="",!0):(t.val="Detaching a script but the script could not be found in the collection.",!1)},k:function(n,t){t.val="";var r=n.b(),i=!1;return this.a.b.k(r)&&(this.a.b.f(r),this.a.b.d(),i=!0),this.a.a.i(n)?i=!0:this.a.a.k(n)&&(this.a.a.f(n),this.a.a.o(n),i=!0),i}};_Ewa.bdI=function(){};_Ewa.bdI.prototype={c:null};_Ewa.FE=function(n,t){this.b=n;this.a=t};_Ewa.FE.prototype={a:null,b:null,z:function(){return!1},x:function(n,t,i){var f=_Ewa.g.c(),r=t.a,u;switch(r){case 1845457202:case-45542983:case 1904816141:case 1606046412:case 971811139:this.a.u(2045014907,-1,0,null);u=r===1904816141?i.MenuItemId.toString():null;this.b.g(r,u)}return f},w:function(n,t){var i=!1,r=t.a;switch(r){case 1845457202:case-45542983:case 971811139:case 1904816141:case 1606046412:i=this.a.bj()}return i},y:function(n,t,i){return t==="PopulateAutomateGalleryMenu"&&this.a.bj()?(this.b.i(t,i),!0):!1}};_Ewa.uM=function(n){_Ewa.uM.initializeBase(this,[n])};_Ewa.uM.a=function(n){n.a().b(_Ewa.bkq.$$(Array),308,new _Ewa.uM(n))};_Ewa.uM.prototype={n:function(){var n=this;_Ewa.gi.a(_Ewa.hM,this.h,374,375,this.j,function(){var t=n.h.a().a(_Ewa.eL,352,!1,null);t?n.m([new _Ewa.FE(t,n.h)],null):Diag.a.a(593605389,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")},null)}};_Ewa.FF=function(){_Ewa.FF.initializeBase(this)};_Ewa.FF.prototype={b:function(){var t=_Ewa.q.a().a(),n=[],i=this;return new Promise(function(r){Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null).a(function(u){u.a("ExcelOfficeScripting",!1).then(function(u){var f;n.push((f=new Otel.a,f.name="IsLicensed",f.bool=u,f));Common.A.a(_Ewa.t.z,!0,_Ewa.bi.a(t,_Ewa.q.a().a()),n);i.a=new _Ewa.gz(u,!0,null,"","");r(u)}).catch(function(u){var f,e,o;n.push((f=new Otel.a,f.name="IsLicensed",f.bool=!1,f));n.push((e=new Otel.a,e.name="Error",e.string=u.toString(),e));n.push((o=new Otel.a,o.name="ErrorCode",o.string="exception",o));Common.A.a(_Ewa.t.z,!1,_Ewa.bi.a(t,_Ewa.q.a().a()),n);i.a=new _Ewa.gz(!1,!1,null,"exception",u.toString());r(!1)})})})}};_Ewa.bdJ=function(){};_Ewa.bdJ.prototype={a:null};_Ewa.FH=function(n,t){var i,r,u,f;_Ewa.FH.initializeBase(this);this.e=n;this.q=new DOMParser;this.i=new _Ewa.dS;this.f=t;t.b()&&this.f.d("Scripts","OfficeScriptingCache");this.l=!1;i=this;this.h=new _Ewa.gc([],function(n){_Ewa.iz.c(n)});r=this;this.b=new _Ewa.gc([],function(n){_Ewa.iz.a(n)});u=this;this.d=new _Ewa.gc([],function(n){_Ewa.iz.a(n)});f=this;this.a=new _Ewa.gc([],function(){})};_Ewa.FH.prototype={f:null,e:null,q:null,i:null,u:function(n,t){if(this.i.a()){var i={};i.TimeStamp=_Ewa.q.a().a();i.IsEnabled=t;this.i.h(n,_Ewa.E.a(i))}},w:function(n){var i=!1,r=!1,u=null,t;return this.i.a()&&(t=JSON.parse(this.i.f(n)),t&&(r=t.IsEnabled,u=new Date(t.TimeStamp),i=!0)),new _Ewa.gz(r,i,u,"","")},t:function(n){var r=_Ewa.q.a().a(),i=[],t=this;return _Ewa.g.e(String,Boolean,this.f.a("recentScripts"),function(u){var f=!t.g||!t.a.a.length,c=u.a(),e,o,s,a;if(i.push((e=new Otel.a,e.name="ExistingScriptCount",e.int64=t.a.a.length,e)),c!==""){if(o=JSON.parse(c),i.push((s=new Otel.a,s.name="CachedScriptCount",s.int64=o.length,s)),f){for(var l=o,v=l.length,h=0;h<v;++h)a=l[h],t.a.b(new _Ewa.ed(a));return t.k=!0,t.p=o.length>0,Common.A.a(_Ewa.t.h,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i),t.r(n),!0}Common.A.a(_Ewa.t.h,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i)}else Common.A.a(_Ewa.t.h,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i);return!1},this.e.g(),3,null)},B:function(n){this.E(n);_Ewa.bn.b()?this.t(n):this.D(n)},x:function(n,t,i){var h=_Ewa.q.a().a(),r=[],l,a,f,e,o,c,s;if(!n||!n.IsSuccess){l=n?n.ErrorCode:"need_token";a=n?n.ErrorMessage:"No Access Token";r.push((f=new Otel.a,f.name="ServiceChecked",f.bool=!1,f));r.push((e=new Otel.a,e.name="Error",e.string=a,e));r.push((o=new Otel.a,o.name="ErrorCode",o.string=l,o));Common.A.a(_Ewa.t.b,!1,_Ewa.bi.a(h,_Ewa.q.a().a()),r);this.g=!0;t.b("recentScripts");return}_Ewa.cy.a(this.e,n.Token);c=Common.br.a().toString();r.push((s=new Otel.a,s.name="CorrelationId",s.string=c,s));var y=makerstorage.getRecentScripts(c),u=this,v=this;y.then(function(n){var i,s,c,f;r.push((i=new Otel.a,i.name="HasReadCachedScripts",i.bool=u.k,i));u.a.m();for(var o=n,l=o.length,e=0;e<l;++e)s=o[e],u.a.b(new _Ewa.ed(s));u.p=!0;u.g=!0;u.f.b()&&(c=_Ewa.E.a(u.a.j()),u.f.c(new _Ewa.lK("recentScripts",c)));r.push((f=new Otel.a,f.name="ScriptCount",f.int64=u.a.a.length,f));Common.A.a(_Ewa.t.b,!0,_Ewa.bi.a(h,_Ewa.q.a().a()),r);t.b("recentScripts")}).catch(function(n){var u,f,e,o,s;Object.getType(n)===makerstorage.StorageServiceError?(u=n,r.push((f=new Otel.a,f.name="Error",f.string=u.message,f)),r.push((e=new Otel.a,e.name="ErrorCode",e.string=String.format("makerstorage_{0}_{1}",u.errorCode.toString(),u.status.toString()),e)),u.errorCode===17&&i.i(_Ewa.bn.f(v.e))):(r.push((o=new Otel.a,o.name="Error",o.string=n.toString(),o)),r.push((s=new Otel.a,s.name="ErrorCode",s.string="exception",s)));Common.A.a(_Ewa.t.bj,!1,_Ewa.bi.a(h,_Ewa.q.a().a()),r);v.g=!0;t.b("recentScripts")})},A:function(n,t){var i=new($$sc.D.$$(Boolean)),r=this,f=function(u){var f=u.Result,h,c,l,e,o,s;f&&f.ResponseStatusCode===200?(h=f.ResponseBody.join(""),c=JSON.parse(h),n(r.C(c.value)),i.a(!0)):(l=f?"RichApi_"+f.ResponseStatusCode:"RichApiError",e=[],e.push((o=new Otel.a,o.name="Error",o.string="Failed to read shared script ids from document",o)),e.push((s=new Otel.a,s.name="ErrorCode",s.string=l,s)),r.c=!0,r.j(t,_Ewa.q.a().a(),0,e),i.a(!1))},u=this,e=function(n){var o=_Ewa.X.a(n.b),r,f,e;Diag.a.a(539309779,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");r=[];r.push((f=new Otel.a,f.name="Error",f.string="Failure using rich api: "+o,f));r.push((e=new Otel.a,e.name="ErrorCode",e.string="RichApiFailure",e));u.c=!0;u.j(t,_Ewa.q.a().a(),0,r);i.a(!1)},o=_Ewa.cy.g(this.e);return _Ewa.cy.h(this.e,f,e,o,i)},z:function(n,t,i){var f=_Ewa.q.a().a(),e=0,o=0,r,s,v,y,h,c,l;if(this.c=e===n.d,r=[],r.push((s=new Otel.a,s.name="ScriptIds",s.int64=n.d,s)),n.d){if(!t||!t.IsSuccess){v=t?t.ErrorCode:"need_token";y=t?t.ErrorMessage:"No Access Token";r.push((h=new Otel.a,h.name="Error",h.string=y,h));r.push((c=new Otel.a,c.name="ErrorCode",c.string=v,c));this.c=!0;this.j(i,f,o,r);return}}else{this.o=!0;this.c=!0;this.j(i,f,o,r);return}for(_Ewa.cy.a(this.e,t.Token),l=n.$$ge();l.$$mn();){var w=l.$$cu(),a=Common.br.a().toString(),u=this,p=this;makerstorage.getSharedScript(w.a,a).then(function(t){var l=[],s,h,c,v;l.push((s=new Otel.a,s.name="BodySize",s.int64=t.body.length,s));l.push((h=new Otel.a,h.name="CorrelationId",h.string=a,h));Common.A.a(_Ewa.t.d,!0,_Ewa.bi.a(f,_Ewa.q.a().a()),l);e++;c=new _Ewa.ed(t);c.e(n.a(c.a.id));u.b.b(c);u.c=e===n.d;u.o=!0;u.j(i,f,o,r);u.f.b()&&(v=_Ewa.E.a(u.b.j()),u.f.c(new _Ewa.lK("workbookScripts",v)))}).catch(function(t){var u=[],s,h,c,l,v,y;Object.getType(t)===makerstorage.StorageServiceError?(s=t,r.push((h=new Otel.a,h.name="Error",h.string=s.message,h)),r.push((c=new Otel.a,c.name="ErrorCode",c.string=String.format("makerstorage_{0}_{1}",s.errorCode.toString(),s.status.toString()),c))):(u.push((l=new Otel.a,l.name="Error",l.string=t.toString(),l)),u.push((v=new Otel.a,v.name="ErrorCode",v.string="exception",v)));u.push((y=new Otel.a,y.name="CorrelationId",y.string=a,y));Common.A.a(_Ewa.t.d,!1,_Ewa.bi.a(f,_Ewa.q.a().a()),u);e++;o++;p.c=e===n.d;p.j(i,f,o,r)})}},y:function(n){var t={};t.id="samples-2";t.name=_Ewa.ClientStringManager.a().a(2028);this.d.b(new _Ewa.ed(t));t.id="samples-4";t.name=_Ewa.ClientStringManager.a().a(2029);this.d.b(new _Ewa.ed(t));t.id="samples-5";t.name=_Ewa.ClientStringManager.a().a(2030);this.d.b(new _Ewa.ed(t));this.m=!0;n.b("SampleScripts")},C:function(n){var e=new($$sc.w.$$(String)),o=this.q.parseFromString(n,"text/xml").querySelector('[id="script-ids-node-id"]'),r,t,i,u,f,s,h,c;if(o)for(r=o.getElementsByTagName("scriptId"),t=0;t<r.length;t++)i=r[t].getAttribute("id"),!i||!i.length||(c=_Ewa.iz.b(i,s={val:u},h={val:f}),u=s.val,f=h.val,c)&&e.b(u,f);return e},E:function(n){var r=_Ewa.q.a().a(),i=[],t=this;return _Ewa.g.e(String,Boolean,this.f.a("workbookScripts"),function(u){var f=!t.c||!t.b.a.length,c=u.a(),e,s,o,a;if(i.push((e=new Otel.a,e.name="ExistingScriptCount",e.int64=t.b.a.length,e)),c!==""){if(s=JSON.parse(c),i.push((o=new Otel.a,o.name="CachedScriptCount",o.int64=s.length,o)),f){for(var l=s,v=l.length,h=0;h<v;++h)a=l[h],t.b.b(new _Ewa.ed(a));return t.b.d(),Common.A.a(_Ewa.t.i,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i),t.r(n),!0}Common.A.a(_Ewa.t.i,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i)}else Common.A.a(_Ewa.t.i,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i);return!1},this.e.g(),3,null)},D:function(n){var r=_Ewa.q.a().a(),i=[],t=this;return _Ewa.g.e(String,Boolean,this.f.a("publishedScripts"),function(u){var f=!t.n||!t.h.a.length,c=u.a(),e,s,o,a;if(i.push((e=new Otel.a,e.name="ExistingScriptCount",e.int64=t.h.a.length,e)),c!==""){if(s=JSON.parse(c),i.push((o=new Otel.a,o.name="CachedScriptCount",o.int64=s.length,o)),f){for(var l=s,v=l.length,h=0;h<v;++h)a=l[h],t.h.b(new _Ewa.ed(a));return t.h.d(),Common.A.a(_Ewa.t.a,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i),t.r(n),!0}Common.A.a(_Ewa.t.a,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i)}else Common.A.a(_Ewa.t.a,f,_Ewa.bi.a(r,_Ewa.q.a().a()),i);return!1},this.e.g(),3,null)},j:function(n,t,i,r){var u,f;this.c&&(r.push((u=new Otel.a,u.name="ScriptCount",u.int64=this.b.a.length,u)),r.push((f=new Otel.a,f.name="ScriptErrorCount",f.int64=i,f)),Common.A.a(_Ewa.t.A,!i,_Ewa.bi.a(t,_Ewa.q.a().a()),r),this.b.d(),n.b("workbookScripts"))},r:function(n){this.l=!0;n.b("CachedScripts")}};_Ewa.iz=function(){};_Ewa.iz.c=function(n){n.sort(function(n,t){return t.g()-n.g()})};_Ewa.iz.a=function(n){n.sort(function(n,t){return _Ewa.f.f(n.c(),t.c(),!0)})};_Ewa.iz.b=function(n,t,i){if(t.val=null,i.val=null,n){var r=n.indexOf(":");if(r!==-1)return t.val=n.substr(0,r),i.val=n.substr(r+1),!0}return!1};_Ewa.iz.prototype={a:null,k:!1,g:!1,p:!1,s:!1,o:!1,n:!1,c:!1,m:!1,l:!1,F:function(){return this.l||this.v()},v:function(){return(_Ewa.bn.b()?this.g:this.n)&&this.c&&this.m},h:null,b:null,d:null};_Ewa.AutomateCommandManager=function(n,t,i,r,u,f,e,o,s){var v,y,p,w,c,h,l,a;if(this.u=new _Ewa.dS,this.t={},this.m=n,this.x=i,this.A=r,this.B=u,this.p=f,this.y=e,this.k=o,this.q=_Ewa.bn.a()?s:new _Ewa.FD(n,this),this.G=new _Ewa.dM(this,n),this.F=_Ewa.q.a().a(),this.E="",this.Y(!1),v=this,this.bu(new _Ewa.gc([],function(n){_Ewa.iz.c(n)})),y=this,this.bt(new _Ewa.gc([],function(n){_Ewa.iz.a(n)})),p=this,this.bw(new _Ewa.gc([],function(n){_Ewa.iz.a(n)})),w=this,this.k.a=new _Ewa.gc([],function(){}),r.b()&&(this.D=!0,this.A.d("Scripts","OfficeScriptingCache")),c=!0,!Common.c.bg()){Diag.a.a(592815191,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser.");return}if(this.u.a()&&(h=this.bf(_Ewa.bn.f(this.m)),h.b&&(l=_Ewa.bi.b(h.e,_Ewa.q.a().a()),this.p.a=new _Ewa.gz(!0,!0,null,"",""),this.o=new _Ewa.gz(h.a,!0,null,"",""),c=this.o.a?l>604800:l>86400,this.j(!0))),this.M=_Ewa.a.a("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery"),this.be(),typeof makerstorage!="undefined"&&this.W())if(this.E=_Ewa.cy.f(this.m),_Ewa.cy.b(this.m))_Ewa.cy.a(this.m,"localstorageToken"),this.p.a=new _Ewa.gz(!0,!0,null,"",""),this.o=new _Ewa.gz(!0,!0,null,"",""),this.j(!0);else if(a=_Ewa.bn.i(this.m),a&&makerstorage.setStorageEnvironmentOverride(a),c)try{var b=this,k=this,d=this,g=this;this.p.b().then(function(){return b.y.a()}).then(function(n){return k.bp(n)}).then(function(){d.j(!1)}).catch(function(){g.j(!1)})}catch(nt){Diag.a.a(576026048,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",nt.message)}};_Ewa.AutomateCommandManager.prototype={B:null,k:null,q:null,G:null,y:null,p:null,m:null,o:null,A:null,D:!1,s:null,P:!1,S:!1,Q:!1,T:!1,R:!1,L:!1,O:null,N:null,U:null,M:!1,E:null,n:function(){return _Ewa.bn.a()?this.k.h:this.O},bu:function(n){return _Ewa.bn.a()?this.k.h=n:this.O=n,n},l:function(){return _Ewa.bn.a()?this.k.b:this.N},bt:function(n){return _Ewa.bn.a()?this.k.b=n:this.N=n,n},r:function(){return _Ewa.bn.a()?this.k.d:this.U},bw:function(n){return _Ewa.bn.a()?this.k.d=n:this.U=n,n},x:null,K:function(){return _Ewa.bn.a()?this.k.m:this.R},bv:function(n){return _Ewa.bn.a()?this.k.m=n:this.R=n,n},C:function(){return _Ewa.bn.a()?this.k.c:this.T},w:function(n){return _Ewa.bn.a()?this.k.c=n:this.T=n,n},I:function(){return(_Ewa.bn.b()?this.k.g:this.J())&&this.C()&&this.K()},b:function(){return(_Ewa.bn.b()?this.k.k:this.H())||this.I()},F:null,a:function(){var n=!!this.p.a&&this.p.a.b&&this.p.a.a,t=!!this.o&&!this.o.b,i=!!this.o&&this.p.a.b&&this.o.a;return this.W()&&n&&(i||t&&!Common.c.B(11))},bc:function(){return _Ewa.bn.a()?this.k.s:this.P},Z:function(n){return _Ewa.bn.a()?this.k.s=n:this.P=n,n},bd:function(){return _Ewa.bn.a()?this.k.o:this.S},ba:function(n){return _Ewa.bn.a()?this.k.o=n:this.S=n,n},H:function(){return _Ewa.bn.a()?this.k.l:this.L},Y:function(n){return _Ewa.bn.a()?this.k.l=n:this.L=n,n},J:function(){return _Ewa.bn.a()?this.k.n:this.Q},V:function(n){return _Ewa.bn.a()?this.k.n=n:this.Q=n,n},W:function(){var t=this.m.e().DocumentHostInfo.HostTier==="TestHost",n=Common.a.a.b("UserPrincipalName"),i=!Common.a.a.a("IsAnonymousUser")&&!(!n||!n.length)&&!_Ewa.f.c(n,"ext#",!1)&&!_Ewa.f.c(n,"guest#",!1);return!Common.c.q()&&(t||this.y.c()&&i)},j:function(n){var w=Common.a.a.a("IsO365CommercialHost"),r="",u="",y,t,f,e,o,s,h,c,i,l,p,a,v;y=!(this.p.a&&this.p.a.b&&this.p.a.a&&(!this.o||!this.o.b));this.p.a&&!this.p.a.b?(u=this.p.a.c,r=this.p.a.d):this.o&&!this.o.b&&(u=this.o.c,r=this.o.d);t=[];t.push((f=new Otel.a,f.name="IsScriptingEnabled",f.bool=this.a(),f));t.push((e=new Otel.a,e.name="IsValidHost",e.bool=w,e));t.push((o=new Otel.a,o.name="IsUserLicensed",o.bool=this.p.a?this.p.a.a:!1,o));t.push((s=new Otel.a,s.name="IsAdminSwitchOn",s.bool=this.o?this.o.a:!1,s));t.push((h=new Otel.a,h.name="ShowTab",h.bool=this.a(),h));t.push((c=new Otel.a,c.name="ServiceChecked",c.bool=!n,c));this.a()&&_Ewa.s.f(this.m)&&(i=_Ewa.bF.a(this.m),i&&i.a()?(t.push((l=new Otel.a,l.name="RibbonType",l.string="React",l)),i.a().s("Automate"),p=["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],i.a().d(p,!1)):(u="ribbon_manager_error",r="The RibbonManager or RibbonUser is null"));t.push((a=new Otel.a,a.name="Error",a.string=r,a));t.push((v=new Otel.a,v.name="ErrorCode",v.string=u,v));Common.A.a(_Ewa.t.bn,y,_Ewa.bi.a(this.F,_Ewa.q.a().a()),t)},i:function(n,t){return t?(t.MenuItems=this.G.d(t.MenuId),!0):!1},h:function(){var u,i,f;if(this.D)if(_Ewa.bn.b())u=this,this.k.t(this.q).CW(function(n){var t=n.a();t&&u.q.b("recentScripts")});else if(_Ewa.bn.a())this.k.B(this.q);else{var r=_Ewa.q.a().a(),t=[],n=this;_Ewa.g.a(this.A.a("publishedScripts"),function(i){var u=!n.J()||!n.n().a.length,h=i.a(),f,e,o,l;if(t.push((f=new Otel.a,f.name="ExistingScriptCount",f.int64=n.n().a.length,f)),h!=="")if(e=JSON.parse(h),t.push((o=new Otel.a,o.name="CachedScriptCount",o.int64=e.length,o)),u){for(var c=e,a=c.length,s=0;s<a;++s)l=c[s],n.n().b(new _Ewa.ed(l));n.n().d();n.Y(!0);n.Z(e.length>0);Common.A.a(_Ewa.t.a,u,_Ewa.bi.a(r,_Ewa.q.a().a()),t);n.v("CachedScripts")}else Common.A.a(_Ewa.t.a,u,_Ewa.bi.a(r,_Ewa.q.a().a()),t);else Common.A.a(_Ewa.t.a,u,_Ewa.bi.a(r,_Ewa.q.a().a()),t)},this.m.g(),3,null,null)}_Ewa.cy.b(this.m)?this.X((i=new _Ewa.hE,i.IsSuccess=!0,i.Token="FakeToken",i)):(f=this,this.y.a().then(function(n){f.X(n)}))},c:function(n,t,i){var r,u;if(_Ewa.bn.b()||_Ewa.bn.a())this.q.e(n,t,i);else{if(r=null,this.b())switch(n){case"1":case"2":case"3":r=this.s.e(parseInt(n)-1);break;default:r=this.s.c(n)}u=this.M?i===2:!_Ewa.Q.a().f();t[CommandUI.Controls.a.GalleryButtonProps]=_Ewa.dM.b(n,r,u);t.Alt=r?r.c():""}},d:function(n){var e,o,s,h,c,l,a,v;if(_Ewa.bn.b()||_Ewa.bn.a())this.q.g(n);else{var i=!1,t="",f=n,u=new _Ewa.ed(f.scriptMetadata),r={};r.Operation="HandleRefreshRibbonGallery";r.RefreshOperation=f.operationName;switch(f.operationName){case"Publish":i=(o=this.bo(u,e={val:t}),t=e.val,o);break;case"Delete":i=(h=this.bm(u,s={val:t}),t=s.val,h);break;case"Attach":i=(l=this.bl(u,c={val:t}),t=c.val,l);break;case"Detach":i=(v=this.bn(u,a={val:t}),t=a.val,v)}r.GalleryUpdated=i;i?(Diag.a.a(594137311,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",t),this.v("RefreshGallery")):Diag.a.a(594137310,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",t);r.Message=t;Diag.a.a(592496471,0,50,JSON.stringify(r))}},e:function(n,t,i){if(this.m.P(null,!1,1023,0)){var r=new _Ewa.qA("RunFromButtonAction",n,t,i,this.a());this.B.a(r)}},f:function(n,t,i){var r=new _Ewa.qA("ViewScriptAction",n,t,i,this.a());this.B.a(r)},g:function(n,t){var i={},r,u,f,e;i.a=this.m.e().UserSessionId;i.d=t;i.j=this.l().a.length;i.h=this.n().a.length;i.i=this.k.a.a.length;i.b=_Ewa.F.a().b(n);r=t?this.bj(t):null;u=this.bg(n,i.b,r);u&&(f=null,Common.App.AppsForOfficeCommon.b.a().a(u.b,"Taskpane",u.a,u.c,u.d,e={val:f}),f=e.val,n===1904816141&&(i.e=r.a.id,i.f=r.d(),i.c=_Ewa.bn.b()||_Ewa.bn.a()?!!this.q.c.c(r.a.id):!!this.s.c(r.a.id),i.g=r.h()||!!this.n().c(r.a.id),this.m.t()));_Ewa.F.a().a(60,i,!0)},bg:function(n,t,i){var f=null,e=_Ewa.bn.e(),c=new Common.App.AppsForOfficeCommon.e("ExcelOnline","Web","en-Us"),l=new Common.App.AppsForOfficeCommon.c("FA000000043",OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),r=new Common.App.AppsForOfficeCommon.d,o,s,u,h;r.b.AdminPolicyForFeedback=JSON.stringify(this.t);r.b.DocumentHostInfo=_Ewa.E.a(this.m.e().DocumentHostInfo);r.b.CodeEditorUrl=_Ewa.bn.d(this.m);r.b.MakerTestService=_Ewa.a.c("Microsoft.Office.Excel.MakerTestService",!1);r.b.StorageModePreference=this.E||"";r.b.Source="Ribbon";r.b.IsTeams=Common.c.r();r.b.taskpaneWidth=_Ewa.E.a(e);r.b.blockExternalCalls=this.m.bT()?"true":"false";_Ewa.a.a("OfficeVSO:5665476_OfficeScriptsHeaderCSSName")&&(o=_Ewa.cy.c(this.m),s=_Ewa.cy.d(this.m),r.a.HeaderCssClass=o,r.a.TitleCssClass=s,r.b.headerCssClass=o,r.b.titleCssClass=s);u={};u.ribbonCommand=t;u.storageAuth=this.y.b();u.publishedScripts=this.bc()?this.n().j():null;u.workbookScripts=this.bd()?this.l().j():null;_Ewa.bn.b()&&(u.recentScripts=this.k.p?this.k.a.j():null);r.b.invocationContext=_Ewa.E.a(u);h={};_Ewa.cy.e(this.m,h);r.b.wacFlights=_Ewa.E.a(h);switch(n){case-45542983:r.b.Script="";r.b.Destination="Editor";r.b.IsOwner=!0;r.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(2015);r.a.TaskPaneWidth=e;r.a.SourceLocationOverrideResourceId=_Ewa.bn.d(this.m);f="MakerCodeEditor";break;case 971811139:case 1606046412:r.b.Script="";r.b.Destination="BackStage";r.b.IsOwner=!0;r.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(2015);r.a.TaskPaneWidth=e;r.a.SourceLocationOverrideResourceId=_Ewa.bn.d(this.m);f="MakerCodeEditor";break;case 1845457202:r.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(2016);r.a.TaskPaneWidth=e;r.a.SourceLocationOverrideResourceId=_Ewa.bn.j(this.m);f="MakerScriptRecorder";break;case 1904816141:if(i)r.b.Script=_Ewa.E.a(i.a),r.b.Destination="Details",r.b.IsOwner=i.h()||!!this.n().c(i.a.id),r.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(2015),r.a.TaskPaneWidth=e,r.a.SourceLocationOverrideResourceId=_Ewa.bn.d(this.m),f="MakerCodeEditor";else return null;break;default:return null}return new _Ewa.FI(c,l,r,f)},be:function(){var n=this;Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.c,null).a(function(t){n.t.FeedbackEnabled=!0;n.t.ScreenshotEnabled=!0;n.t.EmailEnabled=!0;t.a("Enabled",!0).then(function(t){n.t.FeedbackEnabled=t},function(){});t.a("IncludeScreenshot",!0).then(function(t){n.t.ScreenshotEnabled=t},function(){});t.a("IncludeEmail",!0).then(function(t){n.t.EmailEnabled=t},function(){})})},bp:function(n){var o=_Ewa.q.a().a(),t=[],s,h,r,u,f,e,i,c;return!n||!n.IsSuccess?(s=n?n.ErrorCode:"need_token",h=n?n.ErrorMessage:"No Access Token",t.push((r=new Otel.a,r.name="ServiceChecked",r.bool=!1,r)),t.push((u=new Otel.a,u.name="Error",u.string=h,u)),t.push((f=new Otel.a,f.name="ErrorCode",f.string=s,f)),Common.A.a(_Ewa.t.g,!1,_Ewa.bi.a(o,_Ewa.q.a().a()),t),this.o=new _Ewa.gz(!1,!1,null,s,h),Promise.resolve(!1)):(t.push((e=new Otel.a,e.name="ServiceChecked",e.bool=!0,e)),_Ewa.cy.a(this.m,n.Token),i=this,c=this,makerstorage.getUserPermissions(this.m.e().UserSessionId).then(function(n){var u=n,r;return i.o=new _Ewa.gz(u.OfficeScriptingEnabled,!0,null,"",""),i.bb(_Ewa.bn.f(i.m),u.OfficeScriptingEnabled),t.push((r=new Otel.a,r.name="IsEnabled",r.bool=i.o.a,r)),Common.A.a(_Ewa.t.g,!0,_Ewa.bi.a(o,_Ewa.q.a().a()),t),Promise.resolve(i.o.a)}).catch(function(n){var i,r,u,f,e;return Object.getType(n)===makerstorage.StorageServiceError?(i=n,t.push((r=new Otel.a,r.name="Error",r.string=i.message,r)),t.push((u=new Otel.a,u.name="ErrorCode",u.string=String.format("makerstorage_{0}_{1}",i.errorCode.toString(),i.status.toString()),u))):(t.push((f=new Otel.a,f.name="Error",f.string=n.toString(),f)),t.push((e=new Otel.a,e.name="ErrorCode",e.string="exception",e))),Common.A.a(_Ewa.t.g,!1,_Ewa.bi.a(o,_Ewa.q.a().a()),t),c.o=new _Ewa.gz(!1,!1,null,"exception",n.toString()),Promise.resolve(!1)}))},br:function(n){if(_Ewa.bn.a())return this.k.A(n,this.q);var t=new($$sc.D.$$(Boolean)),i=this,u=function(r){var u=r.Result,s,h,c,f,e,o;u&&u.ResponseStatusCode===200?(s=u.ResponseBody.join(""),h=JSON.parse(s),n(i.bq(h.value)),t.a(!0)):(c=u?"RichApi_"+u.ResponseStatusCode:"RichApiError",f=[],f.push((e=new Otel.a,e.name="Error",e.string="Failed to read shared script ids from document",e)),f.push((o=new Otel.a,o.name="ErrorCode",o.string=c,o)),i.w(!0),i.z(_Ewa.q.a().a(),0,f),t.a(!1))},r=this,f=function(n){var e=_Ewa.X.a(n.b),i,u,f;Diag.a.a(51684375,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",_Ewa.i.a(e,","));i=[];i.push((u=new Otel.a,u.name="Error",u.string="Failure using rich api: "+e,u));i.push((f=new Otel.a,f.name="ErrorCode",f.string="RichApiFailure",f));r.w(!0);r.z(_Ewa.q.a().a(),0,i);t.a(!1)},e=_Ewa.cy.g(this.m);return _Ewa.cy.h(this.m,u,f,e,t)},X:function(n){_Ewa.bn.b()?this.k.x(n,this.q,this.u):this.bh(n);this.bi();var t=this;this.br(function(i){t.bk(i,n)})},bi:function(){if(_Ewa.bn.a()){this.k.y(this.q);return}var n={};n.id="samples-2";n.name=_Ewa.ClientStringManager.a().a(2028);this.r().b(new _Ewa.ed(n));n.id="samples-4";n.name=_Ewa.ClientStringManager.a().a(2029);this.r().b(new _Ewa.ed(n));n.id="samples-5";n.name=_Ewa.ClientStringManager.a().a(2030);this.r().b(new _Ewa.ed(n));this.bv(!0);this.v("SampleScripts")},bh:function(n){var s=_Ewa.q.a().a(),t=[],c,l,u,f,e,h,o,i,r;if(!n||!n.IsSuccess){c=n?n.ErrorCode:"need_token";l=n?n.ErrorMessage:"No Access Token";t.push((u=new Otel.a,u.name="ServiceChecked",u.bool=!1,u));t.push((f=new Otel.a,f.name="Error",f.string=l,f));t.push((e=new Otel.a,e.name="ErrorCode",e.string=c,e));Common.A.a(_Ewa.t.b,!1,_Ewa.bi.a(s,_Ewa.q.a().a()),t);this.V(!0);this.v("publishedScripts");return}_Ewa.cy.a(this.m,n.Token);h=Common.br.a().toString();t.push((o=new Otel.a,o.name="CorrelationId",o.string=h,o));i=this;r=this;makerstorage.getScripts(h).then(function(n){var r,o,h,u;t.push((r=new Otel.a,r.name="HasReadCachedScripts",r.bool=i.H(),r));i.n().m();for(var e=n,c=e.length,f=0;f<c;++f)o=e[f],i.n().b(new _Ewa.ed(o));i.n().d();i.Z(!0);i.V(!0);i.D&&(h=_Ewa.E.a(i.n().j()),i.A.c(new _Ewa.lK("publishedScripts",h)));t.push((u=new Otel.a,u.name="ScriptCount",u.int64=i.n().a.length,u));Common.A.a(_Ewa.t.b,!0,_Ewa.bi.a(s,_Ewa.q.a().a()),t);i.v("publishedScripts")}).catch(function(n){var i,u,f,e,o;Object.getType(n)===makerstorage.StorageServiceError?(i=n,t.push((u=new Otel.a,u.name="Error",u.string=i.message,u)),t.push((f=new Otel.a,f.name="ErrorCode",f.string=String.format("makerstorage_{0}_{1}",i.errorCode.toString(),i.status.toString()),f)),i.errorCode===17&&r.u.i(_Ewa.bn.f(r.m))):(t.push((e=new Otel.a,e.name="Error",e.string=n.toString(),e)),t.push((o=new Otel.a,o.name="ErrorCode",o.string="exception",o)));Common.A.a(_Ewa.t.b,!1,_Ewa.bi.a(s,_Ewa.q.a().a()),t);r.V(!0);r.v("publishedScripts")})},bk:function(n,t){var i,e,a,v,o,s,c;if(_Ewa.bn.a()){this.k.z(n,t,this.q);return}var r=_Ewa.q.a().a(),u=0,f=0;if(this.w(u===n.d),i=[],i.push((e=new Otel.a,e.name="ScriptIds",e.int64=n.d,e)),n.d){if(!t||!t.IsSuccess){a=t?t.ErrorCode:"need_token";v=t?t.ErrorMessage:"No Access Token";i.push((o=new Otel.a,o.name="Error",o.string=v,o));i.push((s=new Otel.a,s.name="ErrorCode",s.string=a,s));this.w(!0);this.z(r,f,i);return}}else{this.ba(!0);this.w(!0);this.z(r,f,i);return}for(_Ewa.cy.a(this.m,t.Token),c=n.$$ge();c.$$mn();){var p=c.$$cu(),l=Common.br.a().toString(),h=this,y=this;makerstorage.getSharedScript(p.a,l).then(function(t){var c=[],e,o,s;c.push((e=new Otel.a,e.name="BodySize",e.int64=t.body.length,e));c.push((o=new Otel.a,o.name="CorrelationId",o.string=l,o));Common.A.a(_Ewa.t.d,!0,_Ewa.bi.a(r,_Ewa.q.a().a()),c);u++;s=new _Ewa.ed(t);s.e(n.a(s.a.id));h.l().b(s);h.w(u===n.d);h.ba(!0);h.z(r,f,i)}).catch(function(t){var e=[],o,s,h,c,a,v;Object.getType(t)===makerstorage.StorageServiceError?(o=t,i.push((s=new Otel.a,s.name="Error",s.string=o.message,s)),i.push((h=new Otel.a,h.name="ErrorCode",h.string=String.format("makerstorage_{0}_{1}",o.errorCode.toString(),o.status.toString()),h))):(e.push((c=new Otel.a,c.name="Error",c.string=t.toString(),c)),e.push((a=new Otel.a,a.name="ErrorCode",a.string="exception",a)));e.push((v=new Otel.a,v.name="CorrelationId",v.string=l,v));Common.A.a(_Ewa.t.d,!1,_Ewa.bi.a(r,_Ewa.q.a().a()),e);u++;f++;y.w(u===n.d);y.z(r,f,i)})}},z:function(n,t,i){var r,u;this.C()&&(i.push((r=new Otel.a,r.name="ScriptCount",r.int64=this.l().a.length,r)),i.push((u=new Otel.a,u.name="ScriptErrorCount",u.int64=t,u)),Common.A.a(_Ewa.t.A,!t,_Ewa.bi.a(n,_Ewa.q.a().a()),i),this.l().d(),this.v("workbookScripts"))},bq:function(n){var e=new($$sc.w.$$(String)),o=_Ewa.AutomateCommandManager.a.parseFromString(n,"text/xml").querySelector('[id="script-ids-node-id"]'),r,t,i,u,f,s,h,c;if(o)for(r=o.getElementsByTagName("scriptId"),t=0;t<r.length;t++)i=r[t].getAttribute("id"),!i||!i.length||(c=_Ewa.iz.b(i,s={val:u},h={val:f}),u=s.val,f=h.val,c)&&e.b(u,f);return e},bj:function(n){if(_Ewa.bn.b()||_Ewa.bn.a())return this.q.f(n);switch(n){case"1":case"2":case"3":return this.s.e(parseInt(n)-1);default:return this.n().c(n)||this.l().c(n)||this.r().c(n)}},bo:function(n,t){if(this.n().b(n))return this.n().d(),t.val="",!0;t.val="";var i=n.b();return this.l().f(i),this.l().d(),this.n().f(n),this.n().d(),!0},bm:function(n,t){return this.l().g(n.a.id),this.n().g(n.a.id)?(t.val="",!0):(t.val="Deleting a script but script could not be found in published collection.",!1)},bl:function(n,t){var i=n.b();return i.e(null),this.n().b(i)&&this.n().d(),this.l().b(n)?(this.l().d(),t.val="",!0):(t.val="Could not attach a script that is already attached.",!1)},bn:function(n,t){return this.l().g(n.a.id)?(t.val="",!0):(t.val="Detaching a script but the script could not be found in the collection.",!1)},v:function(n){var t,i,r,u,f,e,o,s,h,c;_Ewa.bn.b()||_Ewa.bn.a()?this.q.b(n):(this.bs(),this.m.t(),t=[],t.push((i=new Otel.a,i.name="Operation",i.string=n,i)),t.push((r=new Otel.a,r.name="HasReadCachedScripts",r.bool=this.H(),r)),t.push((u=new Otel.a,u.name="ReadScriptsDone",u.bool=this.I(),u)),t.push((f=new Otel.a,f.name="ReadSamplesScriptsDone",f.bool=this.K(),f)),t.push((e=new Otel.a,e.name="SamplesScriptCount",e.int64=this.r().a.length,e)),t.push((o=new Otel.a,o.name="ReadPublishedScriptsDone",o.bool=this.J(),o)),t.push((s=new Otel.a,s.name="PublishedScriptCount",s.int64=this.n().a.length,s)),t.push((h=new Otel.a,h.name="ReadWorkbookScriptsDone",h.bool=this.C(),h)),t.push((c=new Otel.a,c.name="WorkbookScriptCount",c.int64=this.l().a.length,c)),Common.A.a(_Ewa.t.j,!0,0,t))},bs:function(){var e=this,n,u;this.s=new _Ewa.gc([],function(){});var t=this.l()?this.l().a.length:0,r=this.n()?this.n().a.length:0,f=this.r()?this.r().a.length:0,i=0;for(n=0;n<3;n++)n<t?this.s.b(this.l().e(n)):n-t+i<r?(u=this.n().e(n-t+i),this.l().c(u.a.id)?(i++,n--):this.s.b(u)):n-t-r+i<f&&this.s.b(this.r().e(n-t+i-r))},bb:function(n,t){if(_Ewa.bn.a()){this.k.u(n,t);return}if(this.u.a()){var i={};i.TimeStamp=_Ewa.q.a().a();i.IsEnabled=t;this.u.h(n,_Ewa.E.a(i))}},bf:function(n){var t;if(_Ewa.bn.a())return this.k.w(n);var i=!1,r=!1,u=null;return this.u.a()&&(t=JSON.parse(this.u.f(n)),t&&(r=t.IsEnabled,u=new Date(t.TimeStamp),i=!0)),new _Ewa.gz(r,i,u,"","")}};_Ewa.uN=function(n){_Ewa.uN.initializeBase(this);this.h=n;this.l()};_Ewa.uN.a=function(n){n&&n.a().b(_Ewa.bkq.$$(_Ewa.eL),351,new _Ewa.uN(n))};_Ewa.uN.prototype={h:null,a:function(){var t=_Ewa.l.a(_Ewa.hD,this.h.a(),349,350,this.j,null),u=_Ewa.x.c(113,4,this.j,!1,!1,351),i=_Ewa.l.b(_Ewa.dJ,this.h.a(),102,this.h.g(),this.j,null),r=_Ewa.l.b(_Ewa.ki,this.h.a(),396,this.h.g(),this.j,null),f=[t,u,i,r],n=this;_Ewa.g.a(_Ewa.g.b(f,this.i(),3),function(){var f=t.a(),e=r.a(),u=new _Ewa.FF,o=new _Ewa.FB(n.h,f,u),s=new _Ewa.FH(n.h,e),h=new _Ewa.FC(n.h,s),c=new _Ewa.FG(n.h,o,u);n.k(n.h.a().a(_Ewa.eL,352,!1,null)||new _Ewa.AutomateCommandManager(n.h,f,i.a(),e,c,u,o,s,h))},this.i(),3,null,null)}};_Ewa.dM=function(n,t){this.a=n;this.c=t};_Ewa.dM.e=function(n){if(n){var t=n.f()?"ewaautomate_officescriptsshared_32":"ewaautomate_officescripts_32",i=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" align="middle"><\/span>',t,_Ewa.x.a(16)),r=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',Common.d.b(n.c()));return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',i,r)}return""};_Ewa.dM.c=function(n,t){var i;return i=new Common.bS,i.Id=n,i.Title=t,i.MenuSectionTitleFocusable=!0,i.ShowMenuSectionTitleBackground=!0,i.ShowMenuSectionTitleIcon=!0,i.ControlList=[],i};_Ewa.dM.b=function(n,t,i){var u=i?"OfficeScriptsShared_32":"OfficeScriptsShared_20",f=i?"OfficeScripts_32":"OfficeScripts_20",e=i?"ewaautomate_officescriptsshared_32":"ewaautomate_officescriptsshared_20",o=i?"ewaautomate_officescripts_32":"ewaautomate_officescripts_20",r;return t?(r=t.d()||t.a.id,_Ewa.dM.d(r,"1904816141",t.c(),i,t.f()?u:f,n,n,t.f()?e:o,null)):_Ewa.dM.d("","1904816141","",i,"",n,n,null,null)};_Ewa.dM.d=function(n,t,i,r,u,f,e,o,s){var c={},l={},h;return r?(c.root=_Ewa.dM.a(32,32),l.root=_Ewa.dM.a(32,32)):(c.root=_Ewa.dM.a(20,20),l.root=_Ewa.dM.a(20,20)),h=new Common.dt,h.Id=n,h.ExternalId=f||n,h.MenuItemId=e||n,h.Command=t,h.Icon=u,h.Image=_Ewa.x.a(16),h.ImageClass=o,h.LabelText=i,h.FullIconStyle=c,h.PreviewIconStyle=l,h.Alt=s||i,h};_Ewa.dM.f=function(n){var t={};return t.display="flex",n?t.flexDirection="column":(t.height="100%",t.flexWrap="nowrap",t.justifyContent="left",t.alignItems="left",t.lineHeight="normal"),t};_Ewa.dM.g=function(n){var t={};return t.margin="0px 3px",n&&(t["max-width"]="68px"),t};_Ewa.dM.a=function(n,t){var i={};return i.width=n,i["min-width"]=n,i.height=t,i};_Ewa.dM.prototype={a:null,c:null,d:function(n){var i=this.a.x.c(null).b(),e=_Ewa.dM.c(n,_Ewa.ClientStringManager.a().a(2025)),u,f,t,o,r;return this.b(e,"OnThisWorkbookSeeMore",this.a.l(),50,_Ewa.ClientStringManager.a().a(2021),this.a.x),Array.add(i.MenuSectionList,e),u=_Ewa.dM.c(n,_Ewa.ClientStringManager.a().a(2026)),this.b(u,"MyRecentScriptsSeeMore",_Ewa.bn.b()?this.a.k.a.n(this.a.l()):this.a.n().n(this.a.l()),6,_Ewa.ClientStringManager.a().a(2022),this.a.x),Array.add(i.MenuSectionList,u),f=_Ewa.dM.c(n,_Ewa.ClientStringManager.a().a(2027)),this.b(f,"SampleScriptsSeeMore",this.a.r(),6,"",this.a.x),Array.add(i.MenuSectionList,f),o=(t=new Common.bP,t.Id="AllMyScriptsButton",t.ExternalId="AllMyScriptsButton",t.Command="1606046412",t.LabelText=_Ewa.ClientStringManager.a().a(2018),t.Alt=_Ewa.ClientStringManager.a().a(2019),t.Image16by16=_Ewa.x.a(16),t.Image16by16Class="ewaautomate_bullets_20",t.Visible=!0,t),r=_Ewa.dM.c(n,null),r.ControlsId="myScriptsSection.Controls",Array.add(r.ControlList,o),Array.add(i.MenuSectionList,r),i},b:function(n,t,i,r,u,f){var e,c,o,l;if(i&&i.a.length>0){var h=f.e(t,1,"Size150by20",null).b(!1),a={},s={};for(s.root=_Ewa.dM.a(320,30),s.flexContainer=_Ewa.dM.f(!1),s.label=_Ewa.dM.g(!1),a.galleryButtonInExpanded=s,h.GalleryStyle=a,e=0;e<i.a.length&&e<r;e++)c=i.e(e),Array.add(h.GalleryItems,_Ewa.dM.b(c.a.id,c,!1));Array.add(n.ControlList,h)}else l=(o=new Common.ep,o.Id=t,o.ExternalId=t,o.LabelText=u,o),n.ControlsId=l.Id+".Controls",Array.add(n.ControlList,l)}};_Ewa.FG=function(n,t,i){this.i=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.o);this.b=n;this.d=t;this.e=i;this.g=_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptsRunFromButtonPreAuth",!1);this.t()};_Ewa.FG.prototype={d:null,e:null,b:null,c:!1,g:!1,a:function(n){var t,i,r,u;_Ewa.a.c("Microsoft.Office.ExcelOnline.OfficeScriptsRunFromButton",!1)&&n.c&&(t=[],t.push((i=new Otel.a,i.name="isSharedRuntimeInstanceInitialized",i.bool=this.c,i)),t.push((r=new Otel.a,r.name="actionName",r.string=n.b,r)),t.push((u=new Otel.a,u.name="clickId",u.string=n.a.a,u)),this.c?this.k(n):this.m(n),Common.A.a(_Ewa.t.bk,!0,0,t))},t:function(){this.l()?this.j():_Ewa.c.a(this.b).b().M(this.f)},o:function(){this.l()?(this.j(),_Ewa.c.a(this.b).b().H(this.f)):this.c&&_Ewa.c.a(this.b).b().H(this.f)},l:function(){if(!this.g||this.c||_Ewa.cy.b(this.b))return!1;var n=_Ewa.R.a(this.b);return _Ewa.c.a(this.b).b().P()&&n.M()},j:function(){if(this.e.a)this.e.a.a&&this.d.a();else{var n=this;this.e.b().then(function(t){t&&n.d.a()})}Common.A.a(_Ewa.t.bi,!0,0,null)},p:function(n,t){Object.getType(t)===String&&t.toString().endsWith(_Ewa.bn.c(this.b))&&(this.c=!1)},r:function(){var i={},t,n;_Ewa.cy.e(this.b,i);t={};t.storageAuth=this.d.b();n={};n.wacFlights=_Ewa.E.a(i);n.invocationContext=_Ewa.E.a(t);n.documentHostInfo=_Ewa.E.a(this.b.e().DocumentHostInfo);n.storageModePreference=_Ewa.cy.f(this.b);n.taskpaneWidth=_Ewa.E.a(_Ewa.bn.e());n.blockExternalCalls=this.b.bT()?"true":"false";n.headerCssClass=_Ewa.cy.c(this.b);n.titleCssClass=_Ewa.cy.d(this.b);this.h("InitializeAction",n)},m:function(n){_Ewa.cy.b(this.b)&&_Ewa.cy.a(this.b,"localstorage");var t=this;_Ewa.g.a(_Ewa.l.a(_Ewa.hM,this.b.a(),374,375,1,null),function(i){var r=i.a();t.n(r).CW(function(){t.q(n)});t.c=!0},this.b.g(),3,null,null)},n:function(n){var t={},i,r;return _Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?(t.SolutionId="FA000000043",t.Version="1.0.0.0",t.StoreType=OSF.StoreType.Sdx,t.StoreId=OSF.StoreType.Sdx,t.AssetId="FA000000043",t.AssetStoreId=OSF.StoreType.Sdx,t.TargetType=1,t.SharedRuntimeId=_Ewa.bn.c(this.b),t.SourceLocationOverrideResourceId=_Ewa.bn.c(this.b),t.IsToBePersisted=!1,t.Id="FA000000043",t.AppVersion="1.0.0.0",t.CurrentStoreType=OSF.StoreType.Sdx):(t.AppVersion="1.0.0.0",t.AssetId="FA000000043",t.AssetStoreId=OSF.StoreType.Sdx,t.CurrentStoreType=OSF.StoreType.Sdx,t.Id="FA000000043",t.StoreId=OSF.StoreType.Sdx,t.TargetType=1,t.SharedRuntimeId=_Ewa.bn.c(this.b),t.SourceLocationOverrideResourceId=_Ewa.bn.c(this.b),t.IsToBePersisted=!1),i=new Common.App.AppsForOfficeCommon.a,i.a=_Ewa.ClientStringManager.a().a(2032),i.d=_Ewa.bn.e(),r=new _Ewa.gb,r.c=_Ewa.cy.d(this.b),r.a=_Ewa.cy.c(this.b),n.g(t,i,!1,null,r,!0)},q:function(n){this.g?(this.r(),_Ewa.bJ.a(this.b)&&_Ewa.bJ.a(this.b).p(this.i)):this.s(n);this.k(n)},s:function(n){var r={},i,t,u;_Ewa.cy.e(this.b,r);i={};i.storageAuth=this.d.b();t={};t.clickId=n.a.a;t.wacFlights=_Ewa.E.a(r);t.invocationContext=_Ewa.E.a(i);t.documentHostInfo=_Ewa.E.a(this.b.e().DocumentHostInfo);t.storageModePreference=_Ewa.cy.f(this.b);t.taskpaneWidth=_Ewa.E.a(_Ewa.bn.e());t.blockExternalCalls=this.b.bT()?"true":"false";t.headerCssClass=_Ewa.cy.c(this.b);t.titleCssClass=_Ewa.cy.d(this.b);u=new _Ewa.qA("SetSettingsAction",n.e,n.d,n.a,n.c);this.h(u.b,t)},k:function(n){var t={};t.shapeId=n.e;t.scriptLink=n.d;t.clickId=n.a.a;this.h(n.b,t)},h:function(n,t){var f=new Common.App.AppsForOfficeCommon.c("FA000000043",OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),e=new Common.App.AppsForOfficeCommon.e("ExcelOnline","Web",this.b.e().UICultureTag),i=new Common.App.AppsForOfficeCommon.d,r,u;i.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(2032);i.a.SourceLocationOverrideResourceId=_Ewa.bn.c(this.b);i.a.ActionArgs=t;i.a.TaskPaneWidth=_Ewa.bn.e();r=null;Common.App.AppsForOfficeCommon.b.a().a(f,"Action",n,e,i,u={val:r});r=u.val}};_Ewa.qA=function(n,t,i,r,u){this.b=n;this.e=t;this.d=i;this.a=r;this.c=u};_Ewa.qA.prototype={b:null,e:null,d:null,a:null,c:!1};_Ewa.cy=function(){};_Ewa.cy.b=function(n){return n.e().DocumentHostInfo.HostTier==="TestHost"};_Ewa.cy.e=function(n,t){t.OfficeScriptsRunFromButton=_Ewa.a.c("Microsoft.Office.ExcelOnline.OfficeScriptsRunFromButton",!1);t.OfficeScriptsRunFromButtonPreAuth=_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptsRunFromButtonPreAuth",!1);t.WacTaskPaneInfra=_Ewa.s.a(n);t.OfficeScriptsReactTaskpaneInfra=_Ewa.a.c("Microsoft.Office.Excel.OfficeScriptsReactTaskpaneInfra",!1);t.PipeEnableExtractPermission=_Ewa.a.c("Microsoft.Office.Excel.PipeEnableExtractPermission",!1)};_Ewa.cy.a=function(n,t){_Ewa.cy.b(n)&&(_Ewa.a.c("Microsoft.Office.Excel.MakerTestService",!1)||makerstorage.useLocalStorage(!0,0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(n.e().UserSessionId);makerstorage.setUserAccessInfo(new _Ewa.FJ(t,null))};_Ewa.cy.f=function(n){if(_Ewa.cy.b(n))return _Ewa.a.c("Microsoft.Office.Excel.MakerTestService",!1)?"makerservicelocal":"localstorage";var t=_Ewa.bn.i(n);return _Ewa.bn.k(t)};_Ewa.cy.h=function(n,t,i,r,u){var e=n.f(),f=n.c(),o=null,s=null,h=null,c=function(){var u=e.h()||f.a().e()>0||f.b().e()>0,c,n;return u?!1:(o&&e.e(o),s&&f.e(s),h&&f.h(h),c=r.request,n=function(n,u,e){return _Ewa.k.a(f.a(),"ExecuteRichApiRequest",r,_Ewa.n.a(n,t),_Ewa.n.b(u,i),e,null,0,null,null)},_Ewa.a.d()?e.b(new _Ewa.v(507,0,n,80,null)):e.b(new _Ewa.ba(507,0,n,16,null)),!0)};return c()||(o=function(){c()},s=function(){c()},h=function(){c()},e.d(o),f.d(s),f.g(h)),u.b};_Ewa.cy.g=function(n){var t={},i;return t.HttpMethod="Get",t.PathAndQuery="customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",t.RequestHeaders=null,t.RequestBody="",t.RequestFlags=256,i=n.c().a().a(1,null),i.request=t,i};_Ewa.cy.c=function(n){var t=_Ewa.s.a(n)&&_Ewa.bn.h();return t?n.v()?"ewa-ptp-header-maker-rtl":"ewa-ptp-header-maker":"ewa-ptp-header"};_Ewa.cy.d=function(n){var t=_Ewa.s.a(n)&&_Ewa.bn.h();return t?"ewa-ptp-title-maker-react":"ewa-ptp-title-maker"};_Ewa.FJ.registerClass("_Ewa.FJ");_Ewa.FA.registerClass("_Ewa.FA");_Ewa.gz.registerClass("_Ewa.gz");_Ewa.ed.registerClass("_Ewa.ed");_Ewa.gc.registerClass("_Ewa.gc");_Ewa.FI.registerClass("_Ewa.FI");_Ewa.bdI.registerClass("_Ewa.bdI");_Ewa.FD.registerClass("_Ewa.FD",_Ewa.bdI);_Ewa.FC.registerClass("_Ewa.FC",_Ewa.bdI);_Ewa.FE.registerClass("_Ewa.FE",null,_Ewa.lI);_Ewa.uM.registerClass("_Ewa.uM",_Ewa.bh);_Ewa.bdJ.registerClass("_Ewa.bdJ");_Ewa.FF.registerClass("_Ewa.FF",_Ewa.bdJ);_Ewa.iz.registerClass("_Ewa.iz");_Ewa.FH.registerClass("_Ewa.FH",_Ewa.iz);_Ewa.AutomateCommandManager.registerClass("_Ewa.AutomateCommandManager",null,_Ewa.eL);_Ewa.uN.registerClass("_Ewa.uN",_Ewa.sX.$$(_Ewa.eL));_Ewa.AutomateCommandManager.a=new DOMParser;Type.registerNamespace("_Ewa");_Ewa.bdG=function(){};_Ewa.bdG.a=function(){_Ewa.m.a(function(n){_Ewa.uM.a(n);_Ewa.uN.a(n)})};_Ewa.bdG.a();Type.registerNamespace("_Ewa");_Ewa.uw=function(n){_Ewa.uw.initializeBase(this,[n])};_Ewa.uw.a=function(n){_Ewa.bh.a(82,new _Ewa.uw(n))};_Ewa.uw.prototype={n:function(){var n=_Ewa.l.b(_Ewa.bQ,this.h.a(),106,this.i(),this.j,null),r=_Ewa.l.b(Sys.IDisposable,this.h.a(),165,this.i(),this.j,null),u=_Ewa.xq.a(this.i(),this.j),t=this,i,f;_Ewa.g.a(_Ewa.g.b([n,r,u],this.i(),3),function(){var i=n.a(),r=Common.Utils.a.a().a(Common.App.NewAndOpen.UX.c,null);t.m([new _Ewa.bv(t.h,i,r)],null)},this.i(),3,null,null);i=Common.Utils.a.a();f=this;_Ewa.g.a(_Ewa.l.b(Common.T,this.h.a(),137,this.h.g(),this.j,null),function(){i.c(_Ewa.tz,null).a().b(function(){return new _Ewa.tz})},this.h.g(),3,null,null)}};_Ewa.bdo=function(){};_Ewa.bdo.a=function(){_Ewa.m.a(_Ewa.uw.a)};_Ewa.ep=function(){};_Ewa.ep.j=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(1,null);return l.controlId=t,l.coerceType=i,l.valueFormat=r,l.filterType=u,l.currentSheetName=f,l.formula=e,_Ewa.k.a(n,"DdaGetSelectedData",l,o,s,h,c,0,null,null)};_Ewa.ep.o=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,null);return h.controlId=t,h.currentSheetName=i,h.formula=r,h.bindingData=u,_Ewa.k.a(n,"DdaSetSelectedData",h,f,e,o,s,0,null,null)};_Ewa.ep.c=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(9,null);return l.controlId=t,l.bindingId=i,l.bindingType=r,l.currentSheetName=u,l.formula=f,l.options=e,_Ewa.k.a(n,"DdaAddBinding",l,o,s,h,c,0,null,null)};_Ewa.ep.h=function(n,t,i,r,u,f,e){var o=n.a(1,null);return o.controlId=t,o.bindingId=i,_Ewa.k.a(n,"DdaGetBinding",o,r,u,f,e,0,null,null)};_Ewa.ep.k=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.bindingId=i,_Ewa.k.a(n,"DdaReleaseBinding",o,r,u,f,e,0,null,null)};_Ewa.ep.i=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var p=n.a(1,null);return p.controlId=t,p.bindingId=i,p.coerceType=r,p.valueFormat=u,p.filterType=f,p.startRow=e,p.startCol=o,p.rowCount=s,p.colCount=h,p.currentSheetName=c,_Ewa.k.a(n,"DdaGetBindingData",p,l,a,v,y,0,null,null)};_Ewa.ep.m=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(9,null);return l.controlId=t,l.bindingId=i,l.startRow=r,l.startCol=u,l.currentSheetName=f,l.bindingData=e,_Ewa.k.a(n,"DdaSetBindingData",l,o,s,h,c,0,null,null)};_Ewa.ep.g=function(n,t,i,r,u,f){var e=n.a(1,null);return e.controlId=t,_Ewa.k.a(n,"DdaGetAllBindings",e,i,r,u,f,0,null,null)};_Ewa.ep.b=function(n,t,i,r,u,f){var e=n.a(1,null);return e.controlId=t,_Ewa.k.a(n,"DdaLoadSettings",e,i,r,u,f,0,null,null)};_Ewa.ep.l=function(n,t,i,r,u,f,e,o){var s=n.a(9,null);return s.controlId=t,s.settings=i,s.overwriteIfStale=r,_Ewa.k.a(n,"DdaSaveSettings",s,u,f,e,o,0,null,null)};_Ewa.ep.d=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.isRow=r,c.currentSheetName=u,c.bindingData=f,_Ewa.k.a(n,"DdaAddRowsColumns",c,e,o,s,h,0,null,null)};_Ewa.ep.f=function(n,t,i,r,u,f,e,o){var s=n.a(9,null);return s.controlId=t,s.bindingId=i,s.currentSheetName=r,_Ewa.k.a(n,"DdaDeleteAllDataValues",s,u,f,e,o,0,null,null)};_Ewa.ep.e=function(n,t,i,r,u,f,e,o){var s=n.a(9,null);return s.controlId=t,s.bindingId=i,s.currentSheetName=r,_Ewa.k.a(n,"DdaClearBindingFormats",s,u,f,e,o,0,null,null)};_Ewa.ep.n=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.currentSheetName=r,c.bindingData=u,c.isSetFormats=f,_Ewa.k.a(n,"DdaSetBindingFormats",c,e,o,s,h,0,null,null)};_Ewa.ep.a=function(n,t,i,r,u,f){var e=n.a(1,null);return e.request=t,_Ewa.k.a(n,"ExecuteRichApiRequest",e,i,r,u,f,0,null,null)};_Ewa.EK=function(n,t,i,r){_Ewa.EK.initializeBase(this,[n,"Select Data",3,null,"",!1,!1]);this.C=t;this.A=i;this.B=r};_Ewa.EK.prototype={C:null,A:null,b:null,B:null,f:function(){return"DdaBindingPrompt"},Q:function(n,t){var r="<div class='ewa-dlg-ddaprompt-body-sectionlabel ewa-scrollbars'><label for='{1}'>{0}<\/label><\/div>\r\n<div><input type='text' id='{1}' maxlength='388' class='ewa-dlg-body-fullLine' /><\/div>",i,f,u;r=String.format(r,Common.d.b(this.A.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.E.innerHTML=r;this.b=_Ewa.b.a(this.E,"bindingText");i=(!t||!t.length)?null:n.C(t,this.A.DdaBindingsMethod.BindingId);i&&i.IsValidRef?(f=new _Ewa.p(i.Reference.FirstRow+1,i.Reference.FirstColumn+1,i.Reference.LastRow+1,i.Reference.LastColumn+1,!1,!1),this.b.value=i.Reference.SheetName+"!"+f):(u=_Ewa.c.a(this.D).a(),this.b.value=_Ewa.D.b(this.D.h())||!u.a().d()?"":u.u());this.F();this.z(!1)},J:function(){this.db();this.M(0,0,!1,!1);this.M(1,0,!1,!1);_Ewa.cL.prototype.J.call(this)},H:function(){_Ewa.b.c(this.b,!1)},bn:function(){return!0},R:function(){var n=this.b.value.trim(),t=n.indexOf("!");return t!==-1&&(n=this.L(n.substring(0,t))+n.substr(t)),this.C.k(this.A,n,0,this.B),!0},bA:function(){this.C.b.a(5001,this.B);_Ewa.cL.prototype.bA.call(this)},L:function(n){var t=_Ewa.f.J(n.trim(),"=");return t.length?t.startsWith("'")&&t.endsWith("'")?t:_Ewa.j.v(t,!1):""}};_Ewa.EL=function(n){this.e=n};_Ewa.EL.prototype={e:null,a:function(n,t){if(t){var i={};i.Error=n;i.Version=this.e.d();t(i)}},b:function(n,t,i){var r;r=_Ewa.kU.b(n.Errors[0].MessageId);this.a(r,i)},d:function(n){n&&n(this.c())},c:function(){var n={};return n.Error=0,n.Version=this.e.d(),n}};_Ewa.qy=function(n,t){this.c=Function.createDelegate(this,this.d);_Ewa.qy.initializeBase(this);this.a=n;this.b=t};_Ewa.qy.b=function(n,t){var r=document.createEvent("KeyboardEvent"),i,u;if(Common.c.k()){var f=!!(n&32),e=!!(n&4),o=!!(n&256),s=!!(n&8);r.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,s,f,e,o)}else i=[],n&4&&i.push("Shift"),n&8&&i.push("Control"),n&32&&i.push("Alt"),r.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,i,!1,"en-US");return u=new Sys.UI.DomEvent(r),u.keyCode=t,u};_Ewa.qy.a=function(n,t){var i=t;if(Common.c.b())switch(i){case 189:i=173;break;case 187:i=61;break;case 186:i=59}return _Ewa.qy.b(n,i)};_Ewa.qy.prototype={a:null,b:null,replaceShortcuts:function(n){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.a,n,this.c)},getShortcuts:function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.a)},checkShortcutsInUse:function(n){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(n,this.c)},d:function(n,t){var r=_Ewa.qy.a(n,t),i;return _Ewa.uo.a(this.b,r)?(i=this.b.J().c(r),!!i&&i.length>0):!0}};_Ewa.bv=function(n,t,i){this.a=n;this.d=t;this.b=new _Ewa.EL(n.b());this.c=new _Ewa.EO(n,this.b);this.i=i;this.g=new($$sc.q.$$(String,String))($$sc.d.b())};_Ewa.bv.o=function(){return _Ewa.bv.a||(_Ewa.bv.a={},_Ewa.bv.a[Microsoft.Office.WebExtension.CoercionType.Table]=1,_Ewa.bv.a[Microsoft.Office.WebExtension.CoercionType.Text]=2,_Ewa.bv.a[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,_Ewa.bv.a[Microsoft.Office.WebExtension.CoercionType.Html]=4,_Ewa.bv.a[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5),_Ewa.bv.a};_Ewa.bv.p=function(){return _Ewa.bv.b||(_Ewa.bv.b={},_Ewa.bv.b[Microsoft.Office.WebExtension.FilterType.All]=1,_Ewa.bv.b[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2),_Ewa.bv.b};_Ewa.bv.q=function(){return _Ewa.bv.c||(_Ewa.bv.c={},_Ewa.bv.c[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,_Ewa.bv.c[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1),_Ewa.bv.c};_Ewa.bv.l=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length/2),t=0;t<n.length/2;t++)i[t]={},i[t].Name=n[t*2],i[t].Value=n[t*2+1];return i};_Ewa.bv.r=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length*2),t=0;t<n.length;t++)i[t*2]=n[t].Name,i[t*2+1]=n[t].Value;return i};_Ewa.bv.i=function(n){var r,t,f,u,i;if(!n||!n.length)return null;for(r=new Array(n.length),t=0,f=n.length;t<f;t++)if(u=n[t].length,u)for(r[t]=new Array(u),i=0;i<u;i++)r[t][i]=n[t][i]==null?null:n[t][i].toString();else return null;return r};_Ewa.bv.e=function(n){return String.isInstanceOfType(n)?_Ewa.y.c(_Ewa.bv.o(),n,0):n};_Ewa.bv.k=function(n){return String.isInstanceOfType(n)?_Ewa.y.c(_Ewa.bv.p(),n,0):n};_Ewa.bv.n=function(n){return String.isInstanceOfType(n)?_Ewa.y.c(_Ewa.bv.q(),n,0):n};_Ewa.bv.s=function(n){switch(n.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};_Ewa.bv.h=function(n,t){var i={};return i.CoerceType=n,i.CoerceType===1?(i.Data=_Ewa.bv.i(t.Rows),i.Headers=_Ewa.bv.i(t.Headers)):i.Data=_Ewa.bv.i(t),i};_Ewa.bv.j=function(n){return n.CoerceType===1?{Headers:n.Headers,Rows:n.Data}:n.Data};_Ewa.bv.f=function(n){return n.CoerceType===1?!n.Data&&!n.Headers:!n.Data};_Ewa.bv.m=function(n){var i="Unknown",t;if(!n)return i;for(t=0;t<n.length;t++)if(n[t].Name.toLowerCase()==="sdkversion"){i=n[t].Value;break}return i};_Ewa.bv.t=function(n){var i,t;if(!n)return!1;for(i="X-OfficeScriptFireRecordingEvent".toLowerCase(),t=0;t<n.length;t++)if(n[t].Name.toLowerCase()===i)return!0;return!1};_Ewa.bv.d=function(n,t,i,r){var u={};return u.Code=n,u.Message=t,u.Location=i,u.ActionIndex=r,u};_Ewa.bv.prototype={g:null,d:null,b:null,c:null,i:null,a:null,n:null,dispose:function(){this.g=null;this.a=null},z:function(){return!1},y:function(){return!1},x:function(n,t,i){var r=t.a;switch(r){case 451041795:this.b.a(i.CommandValueId,i.DdaMethodCallback);break;case 974713501:this.N(i.CommandValueId,i.DdaMethodCallback);break;case 1237877382:this.b.d(i.DdaMethodCallback);break;default:return _Ewa.Y.a(r)}return $$sc.a.a(Boolean,!0)},w:function(n,t,i){var r=!!i;if(r)switch(t.a){case 974713501:case 1237877382:case 451041795:break;default:r=!1}return r},N:function(n,t){var i=n.DdaMethod,e,o,r,s,f,u;if(typeof i.DispatchId=="undefined"){this.b.a(5001,t);return}if(!_Ewa.bv.s(n)&&!(this.a.s()&1)){this.b.a(5002,t);return}i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(e=new _Ewa.EK(this.a,this,n,t),e.Q(this.d,n.DdaMethod.ControlId)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.L(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.bd(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.k(n,this.l(n.DdaMethod.ControlId,!1),0,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.H(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.bb(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.G(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.X(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.E(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.Q(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.Z(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(n.DdaAddRowsColumns.IsRow=!0,this.o(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(n.DdaAddRowsColumns.IsRow=!1,this.o(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.v(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.s(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(n.DdaSetBindingFormats.IsSetFormats=!0,this.q(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(n.DdaSetBindingFormats.IsSetFormats=!1,this.q(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?(o=n.DdaBindingsMethod.FailOnCollision?2:1,this.k(n,n.DdaBindingsMethod.ItemName,o,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.K(t):i.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.T(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.B(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.I(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.J(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Y(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(n.DdaMethod.ControlId,n),this.b.d(t)):i.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?_Ewa.a.b(25)?this.b.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t):this.S(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?_Ewa.a.b(25)?this.b.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t):this.R(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.D(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.F(n,t):this.b.a(5e3,t);_Ewa.a.a("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&i.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(r=this.d.b(n.DdaMethod.ControlId),f="",r&&(s=_Ewa.bc.a(r,this.a),u=r.PrimaryMarketplace.MarketplaceType,u===OSF.StoreType.InMemory?r.OwnerAddinAssetId&&r.AssetMarketplace&&(u=r.AssetMarketplace.MarketplaceType):u===OSF.StoreType.WopiCatalog&&(u=OSF.StoreType.OMEX),f=Telemetry.PrivacyRules.GetAssetId(u,r.PrimaryMarketplace.MarketplaceRef,s,null,null)),Diag.a.a(539353235,344,50,"DDA method Id: {0}, AppID: {1}",i.DispatchId,f))},H:function(n,t){var i,r,u;(n.DdaGetBindingData.CoerceType=_Ewa.bv.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.FilterType=_Ewa.bv.k(n.DdaGetBindingData.FilterType),n.DdaGetBindingData.ValueFormat=_Ewa.bv.n(n.DdaGetBindingData.ValueFormat),this.h(n.DdaGetBindingData.CoerceType,t))&&(n.DdaGetBindingData&&(i=n.DdaGetBindingData,i.FilterType||(i.FilterType=2),i.StartCol=i.StartCol|0,i.StartRow=i.StartRow|0,i.ColCount=isUndefined(i.ColCount)?-1:i.ColCount,i.RowCount=isUndefined(i.RowCount)?-1:i.RowCount),r=this,u=function(n,i,u){if(_Ewa.O.a(n)||!n.Result)r.b.b(n,u,t);else{var f=r.b.c();f.Data=_Ewa.bv.j(n.Result);t(f)}},this.c.g(n.DdaMethod.ControlId,n.DdaGetBindingData.BindingId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,n.DdaGetBindingData.StartRow,n.DdaGetBindingData.StartCol,n.DdaGetBindingData.RowCount,n.DdaGetBindingData.ColCount,u,t))},bb:function(n,t){var i,r,u;if(n.DdaSetBindingData.CoerceType=_Ewa.bv.e(n.DdaSetBindingData.CoerceType),this.h(n.DdaSetBindingData.CoerceType,t)){if(i=_Ewa.bv.h(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),_Ewa.bv.f(i)){this.b.a(2e3,t);return}i.CoerceType===1&&(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions));n.DdaSetBindingData&&(n.DdaSetBindingData.StartCol=n.DdaSetBindingData.StartCol|0,n.DdaSetBindingData.StartRow=n.DdaSetBindingData.StartRow|0);r=this;u=function(n,i,u){_Ewa.O.a(n)?r.b.b(n,u,t):r.b.d(t)};this.c.q(n.DdaMethod.ControlId,n.DdaSetBindingData.BindingId,n.DdaSetBindingData.StartRow,n.DdaSetBindingData.StartCol,i,u,t)}},L:function(n,t){var i,r,u;if(n.DdaGetBindingData.CoerceType=_Ewa.bv.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.ValueFormat=_Ewa.bv.n(n.DdaGetBindingData.ValueFormat),n.DdaGetBindingData.FilterType=_Ewa.bv.k(n.DdaGetBindingData.FilterType),this.h(n.DdaGetBindingData.CoerceType,t)){if(i=this.l(n.DdaMethod.ControlId,!1),!i||!i.length){this.b.a(1001,t);return}r=this;u=function(n,i,u){if(_Ewa.O.a(n))r.b.b(n,u,t);else{var f=r.b.c();f.Data=_Ewa.bv.j(n.Result);t(f)}};this.c.m(n.DdaMethod.ControlId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,i,u,t)}},I:function(n,t){var i,o,e;if(Common.c.X()){this.b.a(5009,t);return}var h=n,c=h[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],u=h[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],l=n.DdaMethod.ControlId,a=_Ewa.gZ.a(this.a);if(u<=0){Diag.a.a(8946265,344,15,"Invalid slice size. It should be greater than 0.");this.b.a(11002,t);return}if(u>4194304){Diag.a.a(8946266,344,15,"Invalid slice size. It should be not greater than 4MB.");this.b.a(1008,t);return}i=null;switch(c){case 1:i="Compressed";break;case 0:i="Text";break;case 2:i="Pdf";break;default:Diag.a.a(8946267,344,15,"Requested file type {0} is not supported.",c);this.b.a(1009,t);return}if(i==="Text"){Diag.a.a(8946268,344,15,"Requested file type {0} is not supported.",i);this.b.a(1009,t);return}_Ewa.a.a("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(e=new Sys.StringBuilder,e.append(_Ewa.pd.a(this.a,i,!1)),i==="Pdf"&&_Ewa.bj.a(e,"wtp","WholeWorkbook"),o=e.toString()):o=_Ewa.pd.a(this.a,i,!1);var s=null,r=new XMLHttpRequest,f=this;r.onreadystatechange=function(){var h,n,c,d,v,o,g,y,nt,tt;if(r.readyState===4)if(r.status===200){if(h=r.response,!h){Diag.a.a(8946269,344,15,"Request is successful, but respone have no data for file type {0}.",i);f.b.a(5001,t);return}s=new Uint8Array(h);var p=f.b.c(),w=p,e=s.length,b=++_Ewa.gZ.b,k={},it=0;for(n=0;n<e;n=n+u){for(c=[],d=n+u<e?n+u:e,v=0,o=n;o<d;v++,o++)c[v]=s[o];k[(it++).toString()]=c}if(g=new _Ewa.EP(b,e,u,k),y=a.d(l,g),y){f.b.a(y,t);return}w[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=b;w[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=e;Diag.a.a(8946270,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",i,e);t(p)}else r.status===500?(nt=parseInt(r.statusText),tt=_Ewa.kU.b(nt),f.b.a(tt,t)):(Diag.a.a(8946271,344,15,"Request failed to obtain the file for type {0}.",i),f.b.a(11001,t))};r.open("GET",o,!0);r.responseType="arraybuffer";r.setRequestHeader("If-Modified-Since","0");r.send(null)},J:function(n,t){var u=n,h=u[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],i=u[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()],c=n.DdaMethod.ControlId,l=_Ewa.gZ.a(this.a),f=l.e(c,h),r;if(!f){this.b.a(5001,t);return}if(r=f.b,i<0||i>=Object.keys(r).length){this.b.a(5008,t);return}var e=r[i.toString()],o=this.b.c(),s=o;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=e;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=e.length;t(o)},Y:function(n,t){var r=n,u=r[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],f=n.DdaMethod.ControlId,e=_Ewa.gZ.a(this.a),i=e.g(f,u);i?this.b.a(i,t):this.b.d(t)},bd:function(n,t){var u,i,r;if(n.DdaSetBindingData.CoerceType=_Ewa.bv.e(n.DdaSetBindingData.CoerceType),this.h(n.DdaSetBindingData.CoerceType,t)){if(u=this.l(n.DdaMethod.ControlId,!1),!u||!u.length){this.b.a(2001,t);return}if(i=_Ewa.bv.h(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),r=_Ewa.c.a(this.a).a(),i.CoerceType===1&&(!i.Data&&r.a().i()&&(i.Headers||(i.Headers=[]),i.Headers.length||Array.add(i.Headers,[]),i.Headers[0].length||Array.add(i.Headers[0],"")),_Ewa.bv.f(i)||(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions))),_Ewa.bv.f(i)){this.b.a(2e3,t);return}var o=r.a().c().f(),f=r.a().a().f(),e=this,s=function(n,u,s){var h,c,l;_Ewa.O.a(n)?e.b.b(n,s,t):(h=o.f(),c=i.Headers?i.Headers[0].length:i.Data[0].length,i.CoerceType!==1||i.Data?i.CoerceType===1&&i.TableOptions&&i.TableOptions.length&&i.TableOptions[0]==!1?(h.a=h.a+1,h.c=h.a+i.Data.length-1,h.d=h.b+c-1):(h.c=h.a+i.Data.length-(i.CoerceType===1?0:1),h.d=h.b+c-1):(h.c=h.a+1,h.d=h.b+c-1),l=h.i(f)?f:h.e(),r.d(h,l,0,0,!0,"",!1,!0,!0),e.b.d(t))};this.c.s(n.DdaMethod.ControlId,u,i,s,t)}},k:function(n,t,i,r){if(!t){this.b.a(3e3,r);return}var u=this,f=function(n,t,i){if(_Ewa.O.a(n))u.b.b(n,i,r);else{var f=u.b.c();f.Bindings=new Array(1);f.Bindings[0]=u.d.i(n.Result);r(f)}};this.c.h(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,n.DdaBindingsMethod.BindingType,t,i,f,r)},G:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.O.a(n)||!n.Result)i.b.b(n,u,t);else{var f=i.b.c();f.Bindings=new Array(1);f.Bindings[0]=i.d.i(n.Result);t(f)}};this.c.f(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},K:function(n){var t=this.b.c(),r=t,i={};i[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.a.k().ClientUrl;r[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=i;n(t)},X:function(n,t){var i=this,r=function(n,r,u){_Ewa.O.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.o(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},E:function(n,t){var i=this,r=function(n,r,u){var f,o,e;if(_Ewa.O.a(n))i.b.b(n,u,t);else{if(f=i.b.c(),n.Result)for(o=n.Result,f.Bindings=new Array(o.length),e=0;e<o.length;e++)f.Bindings[e]=i.d.i(o[e]);else f.Bindings=null;t(f)}};this.c.l(n.DdaMethod.ControlId,r,t)},Q:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.O.a(n))i.b.b(n,u,t);else{var f=i.b.c();f.Properties=n.Result;t(f)}};this.c.n(n.DdaMethod.ControlId,r,t)},Z:function(n,t){var f=this,e=function(n,i,r){_Ewa.O.a(n)?f.b.b(n,r,t):f.b.d(t)},u={},i,r;for(u.Settings=[],i=0;i<n.DdaSettingsMethod.Properties.length;i++)r={},r.Name=n.DdaSettingsMethod.Properties[i][0],r.Value=n.DdaSettingsMethod.Properties[i][1],u.Settings[i]=r;this.c.p(n.DdaMethod.ControlId,u,n.DdaSettingsMethod.OverwriteIfStale,e,t)},o:function(n,t){var r=_Ewa.bv.h(1,n.DdaAddRowsColumns.Data),i,u;if(_Ewa.bv.f(r)){this.b.a(2e3,t);return}i=this;u=function(n,r,u){_Ewa.O.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.i(n.DdaMethod.ControlId,n.DdaAddRowsColumns.BindingId,n.DdaAddRowsColumns.IsRow,r,u,t)},v:function(n,t){var i=this,r=function(n,r,u){_Ewa.O.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.k(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},s:function(n,t){var i=this,r=function(n,r,u){_Ewa.O.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.j(n.DdaMethod.ControlId,n.DdaClearBindingFormats.BindingId,r,t)},q:function(n,t){var i={},u=n.DdaSetBindingFormats.IsSetFormats,r,f;u?i.CellFormat=n.DdaSetBindingFormats.CellFormat:i.TableOptions=n.DdaSetBindingFormats.TableOptions;r=this;f=function(n,i,u){_Ewa.O.a(n)?r.b.b(n,u,t):r.b.d(t)};this.c.r(n.DdaMethod.ControlId,n.DdaSetBindingFormats.BindingId,i,u,f,t)},B:function(n,t){var f=n.ArrayData,r={},o=_Ewa.c.a(this.a).a(),c,l,v,h,y,u,a,s,b,p,k,e,w;if(f){if(f[0]==="WacPartition"){this.A(n,t);return}if(c=$$as(_Ewa.bc,_Ewa.bJ.a(this.a)),f[0]==="SetOsfControlContainerReadyForCustomFunctions"&&(l=c.bb(n.DdaMethod.ControlId),l&&(l.v=!0,l.R())),r.HttpMethod=f[1],r.PathAndQuery=f[2],r.RequestHeaders=_Ewa.bv.l(f[3]),r.RequestBody=f[4],r.AppPermission=f[5],v=f[6],r.RequestFlags=v,h=0,_Ewa.D.c(this.a.h()))switch(o.c()){case 1:h=2;break;case 2:h=3;break;case 128:h=4;break;default:h=1}if(y=null,o.b().e()&&(y=o.b().e().I()),r.SheetMultiRange=_Ewa.h.d(o.a().b(),this.a),r.ActiveCell=_Ewa.h.a(o.a().a(),this.a),r.ActiveChartId=y,r.SelectionState=h,u=this.d.b(n.DdaMethod.ControlId),r.InstanceId=u?u.InstanceId:"",u&&u.PrimaryMarketplace){if(a=_Ewa.bc.a(u,this.a),s=u.PrimaryMarketplace.MarketplaceType,s===OSF.StoreType.InMemory){if(_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)){if(!u.OwnerAddinSolutionId){this.b.a(5004,t);return}}else if(!u.OwnerAddinAssetId){this.b.a(5004,t);return}if(u.AssetMarketplace)s=u.AssetMarketplace.MarketplaceType;else{this.b.a(5004,t);return}}else s===OSF.StoreType.WopiCatalog&&(s=OSF.StoreType.OMEX);_Ewa.a.c("Microsoft.Office.Excel.RichapiEnableCompliantSolutionIdWithOneField",!1)?(b=Telemetry.PrivacyRules.GetAssetId(s,u.PrimaryMarketplace.MarketplaceRef,a,null,null),r.CompliantSolutionId=b):r.CompliantSolutionId=a;r.SolutionId=a;r.MarketplaceType=s;r.SolutionVersion=u.PrimaryMarketplace.SolutionVersion;r.StoreLocation=u.PrimaryMarketplace.MarketplaceRef}else r.SolutionId=r.MarketplaceType="",_Ewa.a.c("Microsoft.Office.Excel.RichapiEnableCompliantSolutionIdWithOneField",!1)&&(r.CompliantSolutionId="");if(r.IsEventsEnabled=isNullOrUndefined(c)||c.be.e(r.InstanceId),r.RequestGuid=Common.u.a().a,p=r.RequestBody.length,_Ewa.a.a("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&p>this.a.e().ExcelRichApiMaxAllowedRequestPayloadSize){this.b.a(5103,t);Diag.a.a(578048010,0,50,"Request payload size:{0} exceeded the limit",p);return}_Ewa.a.a("OfficeVSO:5079365_RichApiPreviewExecution")&&v&4096&&(k=new _Ewa.Fc(this.a),OfficeExtension.WacRuntime.RichApi.previewExecute(k,_Ewa.Fh.a,f),r.RequestBody=f[4])}e=_Ewa.bv.m(r.RequestHeaders);_Ewa.bv.g++;w=_Ewa.q.a().a();_Ewa.a.a("OfficeVSO:4316383_RichApiLogRequestBodySize")&&r&&r.RequestBody&&Diag.a.a(589608415,0,50,String.format("Richapi json request body size is {0}",r.RequestBody.length));var i=this,g=function(u,f,s){var h,v,b,y,d,nt,tt,it,rt,ft;i.p(w,!0,u.ServerCorrelationId);var k=null,ut=null,a=u.ServerCorrelationId;if(u&&u.Errors&&u.Errors[0]&&(k=u.Errors[0].MessageIdName,ut=u.Errors[0].Description,_Ewa.a.a("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&_Ewa.S.a(i.a).a().e(u.Errors[0].MessageId)),_Ewa.O.a(u)||!u.Result)i.e(a,e,"Server error",k,ut),i.b.b(u,s,t);else{if(h=null,_Ewa.a.b(264))if(v=u.Result,v&&v.length){for(b=0;b<v.length;b++)if(v[b].RequestGuid===r.RequestGuid){h=v[b];break}h||i.b.b(u,s,t)}else h=u.Result;else h=u.Result;if(!k&&h&&h.ResponseBody&&!_Ewa.f.a(h.ResponseBody[0]))if(y=h.ResponseBody[0],y.startsWith('{"Error":')){h.ResponseBody.length>1&&(y=y.substring(0,y.indexOf("}")+1)+"}");try{d=_Ewa.E.b(y);d.Error&&i.e(a,e,"Pipeline error",d.Error.Code,d.Error.Message)}catch(ot){i.e(a,e,"Json deserialize error",null,"Error info cannot be deserialized.")}}else i.e(a,e,null,null,null);else i.e(a,e,"Server error",k,ut);var p=h.SheetMultiRange,l=p?p.SheetName:null,g=h.ActiveChartId,c=h.SelectionState,et=c===5&&!!p||c===6||c===7||c===8;if(_Ewa.a.a("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&i.a.n().d()&&et?(i.b.a(5016,t),Diag.a.a(590488150,0,50,String.format("{0} is not allowed",c.toString()))):c===5&&p?i.a.d()&&l&&(i.a.d().f(l)?i.j(l):(nt=null,nt=function(){i.a.d().f(l)&&(Diag.a.a(593900563,0,50,"Sheets item add event handler called"),i.j(l),i.a.d().w(nt))},i.a.d().r(nt),_Ewa.a.a("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")&&(tt=null,tt=function(){i.a.d().f(l)&&(i.j(l),i.a.d().o(tt))},i.a.d().m(tt)))):(c===6||c===7||c===8||c===9)&&(p&&(it=_Ewa.h.t(p.Ranges),l&&_Ewa.h.x(it,!0)&&(_Ewa.a.a("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!i.a.d().f(l)?(rt=null,rt=function(){i.r(o,it,l,c);i.a.d().o(rt)},i.a.d().m(rt)):i.r(o,it,l,c))),c===7?(g="38.{"+g.toUpperCase()+"}",_Ewa.R.a(i.a).c(0,g,!0)):c===8&&_Ewa.R.a(i.a).c(2,g,!0),c===9&&(i.a.e().ApiCallToSetPageLayout=!0)),_Ewa.f.a(h.PostProcessActions))i.f(h,t,null);else{if(!i.a.ch()){i.e(a,e,"Promise not supported",null,"Promise is not supported on this browser.");i.b.a(5001,t);return}ft=_Ewa.E.b(h.PostProcessActions);i.W(ft).then(function(){return i.f(h,t,null),i.C(n.DdaMethod.ControlId,r),Promise.resolve(null)},function(n){return i.f(h,t,n),Promise.reject(n)})}}},d=this;this.c.t(r,g,function(n){d.p(w,!1,null);d.e(null,e,"Web service error",null,null);t(n)})},C:function(n,t){var i=$$as(_Ewa.bc,_Ewa.bJ.a(this.a));i&&i.bv&&i.bb(n)&&_Ewa.bv.t(t.RequestHeaders)&&(Diag.a.a(592196423,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",n,t.SolutionId),i.bv.g(n))},A:function(n,t){var f=this.d.b(n.DdaMethod.ControlId),e=_Ewa.bc.a(f,this.a),o=null,c=_Ewa.bc.b(f,this.a),l=new _Ewa.qy(c,this.a),s,i;o=new _Ewa.bao(e,n.DdaMethod.ControlId,this.d,this.a,l);s=_Ewa.TypeRegister.registerTypes;i={};i.ResponseHeaders=new Array(0);i.ResponseBody=new Array(1);var a=_Ewa.bv.l(n.ArrayData[3]),u=_Ewa.bv.m(a),v=new _Ewa.WacWorkbook(this.a,this.i),r=this,h=this;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(o,s,v,n.ArrayData).then(function(n){if(!n)return r.m(!1,"The rich api executor call failed",null,u),Diag.a.a(36542158,0,10,"The rich api executor call failed"),i.ResponseStatusCode=500,r.f(i,t,null),null;var f=n;return r.m(!0,"The rich api executor call succeeded",null,u),i.ResponseStatusCode=f[0],i.ResponseBody[0]=f[2],r.f(i,t,null),null},function(n){return i.ResponseStatusCode=400,i.ResponseBody[0]=n.toString(),h.m(!1,"The rich api executor call failed",null,u),Diag.a.a(36542159,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",e),h.f(i,t,null),null})},p:function(n,t,i){_Ewa.bv.g--;var r=_Ewa.bX.a(_Ewa.q.a(),n);Diag.a.a(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",r,_Ewa.bv.g,t?"success":"false",i)},f:function(n,t,i){var u=new Array(3),e,o,f,r,s;u[0]=n.ResponseStatusCode;u[1]=_Ewa.bv.r(n.ResponseHeaders);e=new Array(0);o=!1;i&&n.ResponseBody&&(f=_Ewa.E.b(n.ResponseBody.join("")),f.Error||(r={},r.Error=i,r.TraceIds=f.TraceIds,r.ProcessedResults={},r.ProcessedResults.Results=f.Results,e[0]=_Ewa.E.a(r),o=!0));u[2]=o?e:n.ResponseBody;s=this.b.c();s.Data=u;t(s)},T:function(n,t){var i=new _Ewa.ol(this.a,this.b,this.c);i.d(n,t)},S:function(n,t){Diag.a.a(19931724,0,50,"MessageParent API called!");var i=n,u=i[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],f=i.SecurityOrigin,e=i[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],o=this.a.a().a(_Ewa.iw,232,!1,null),r=o.a().d(n.DdaMethod.ControlId,u,f,e);r?(Diag.a.a(19931725,0,10,"MessageParent API Failed!"),this.b.a(r,t)):this.b.d(t)},R:function(n,t){Diag.a.a(595121570,0,50,"MessageChild API called!");var i=n,r=i[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],u=i.SecurityOrigin,f=i[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],e=this.a.a().a(_Ewa.iw,232,!1,null);e.a().e(n.DdaMethod.ControlId,r,u,f);this.b.d(t)},D:function(n,t){Diag.a.a(22071488,0,50,"GetAccessToken API called!");var i=this,r=function(r,u){var e,o,h,f,s;r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(e="",e=u.a(),o=i.b.c(),h=o,h[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=e,t(o)):(f=i.d.b(n.DdaMethod.ControlId),s=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?null!==f.OwnerAddinSolutionId?f.OwnerAddinSolutionId:f.PrimaryMarketplace.MarketplaceType:null!==f.OwnerAddinAssetId?f.OwnerAddinAssetId:f.PrimaryMarketplace.MarketplaceType,Diag.a.a(542185163,0,10,"{0}.",{errorCode:r.toString(),appId:Telemetry.PrivacyRules.GetAssetId(s,f.PrimaryMarketplace.MarketplaceRef,_Ewa.bc.a(f,i.a),null,null),storeType:s}),i.b.a(r,t))},u=!_Ewa.a.b(25),f=this;_Ewa.g.a(_Ewa.l.b(Common.T,this.a.a(),137,this.a.g(),1,null),function(t){var i=n,e=f.d.a(),o=Common.App.AppsForOfficeOauth.a.c(),s=Common.App.AppsForOffice.a.g(e,t.a(),o);s.a(n.DdaMethod.ControlId,u,i,r)},this.a.g(),3,null,null)},F:function(n,t){var i=this;_Ewa.g.a(_Ewa.l.b(Common.T,this.a.a(),137,this.a.g(),1,null),function(){var o=i.d.a(),s=o,e=s.getOsfControl(n.DdaMethod.ControlId);if(!_Ewa.a.c("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||e.isFirstParty()){var f=e.getManifest(),h=f.getMarketplaceID(),r=f.getWebApplicationId(),u=f.getWebApplicationMsaId(),c=Common.Utils.a.a().a(Common.App.WopiIdentity.c,null),l=c.getAuthContext(h);l.then(function(n){var e=i.b.c(),o=e,f={};f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=u?u:r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=n.get_upn();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=n.get_userId();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=n.get_authority();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Common.App.WopiIdentity.e.a(n.get_authorityType());f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=n.get_isAnonymous();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=n.get_tenantId();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=n.get_supportsAuthToken();o[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=f;t(e)},function(n){var o=i.b.c(),s=o,f={},e=new Common.App.WopiIdentity.e;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=u?u:r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=e.f;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=e.g;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=e.b;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=e.a;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=e.c;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=e.e;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=n;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=e.d;s[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=f;o.Error=1;t(o)})}},this.a.g(),3,null,null)},P:function(n){var t=_Ewa.c.a(this.a).a();return t.c()===16&&!!t.b().a()&&!!t.b().a().a()&&_Ewa.f.b(t.b().a().a().c,n,!0)},l:function(n,t){var i=_Ewa.c.a(this.a).a();return!t&&!i.a().d()?null:i.c()===1||this.P(n)?i.u():null},h:function(n,t){return(n===1||n===2||n===3)?!0:(this.b.a(1e3,t),!1)},m:function(n,t,i,r){var u={};u.a=this.a.e().UserSessionId;u.b=n;u.c=t;u.d=i;u.e=r;_Ewa.F.a().a(37,u,!1)},e:function(n,t,i,r,u){var f={};!n||!n.length||(f.ServerCorrelationId=n);isNullOrUndefined(t)||(f.Source=t);!i||!i.length||(f.ErrorType=i);!r||!r.length||(f.MessageId=r);!u||!u.length||(f.StatusDescription=u);Diag.a.a(50688452,0,50,_Ewa.E.a(f))},W:function(n){for(var r=this,t=new Promise(function(n){n(null)}),i=0;i<n.length;i++)t=this.V(t,n[i]);return t},V:function(n,t){var ut,i,f,h,c,r,u,e,l,a,v,o,y,p,w,b,k,d,g,nt,tt,it,ft,rt,s,et,ot;if(!t)return Diag.a.a(34625095,0,10,"Null PostProcessAction."),ut=this,n.then(function(){return Promise.reject(_Ewa.bv.d("GeneralException",_Ewa.ClientStringManager.a().a(1668),null,0))});switch(t.actionType){case 1:case 2:i=t;f=this;n=n.then(function(){var n=$$as(_Ewa.bc,_Ewa.bJ.a(f.a));if(n.bb(i.controlId)){n.be.i(i);switch(i.messageType){case 14:case 100:n.bu.p(i);break;case 11:case 12:n.bN.p(i);break;case 51:case 52:n.bL.o(i);break;case 2101:case 2102:n.bM.j(i);break;case 2e3:n.bO.k(i);break;case 2201:f.a.bn()&&n.bv.f(i);break;case 2203:n.bP.k(i);break;case 2700:_Ewa.a.a("OfficeVSO:4251858_RangePicker")&&n.bt.p(i)}}else Diag.a.a(23941466,0,10,"OsfControl with instanceId[{0}] doesn't exist.",i.controlId);return Promise.resolve(null)});break;case 3:h=this;n=n.then(function(){return h.M(t),Promise.resolve(null)});break;case 15:_Ewa.a.a("OfficeVSO:4251858_RangePicker")&&(c=this,n=n.then(function(){return c.O(t),Promise.resolve(null)}));break;case 4:r=t;u=this;n=n.then(function(){var n,t;return _Ewa.a.b(106)&&(n=_Ewa.c.a(u.a).a().a().a(),n.a!==r.row+1&&n.b!==r.column+1&&(t=_Ewa.h.a(_Ewa.p.a(r.row+1,r.column+1,!1),u.a),_Ewa.c.a(u.a).p(t,null,null,null,3,_Ewa.I.s,0,!0,!0,null,!1,!0)),_Ewa.gi.a(_Ewa.he,u.a,243,242,0,function(n){n.a(r.row+1,r.column+1,1,!1,!1)},null)),Promise.resolve(null)});break;case 7:e=t;l=this;n=n.then(function(){var n=$$as(_Ewa.bc,_Ewa.bJ.a(l.a));return n.be.f(e.controlId,e.isEnableEvents),Promise.resolve(null)});break;case 5:a=this;n=n.then(function(){return a.u(t)});break;case 6:v=this;n=n.then(function(){return v.U(t)});break;case 8:o=this;n=n.then(function(){var n,t;return _Ewa.a.a("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(n=$$as(_Ewa.bc,_Ewa.bJ.a(o.a)),n.cB()),t=new _Ewa.cZ("cw32",5,null),_Ewa.A.a(o.a).c(t),Promise.resolve(null)});break;case 9:y=this;n=n.then(function(){return y.bc(t)});break;case 10:p=t;w=this;n=n.then(function(){return w.bi(p)});break;case 11:b=this;n=n.then(function(){return b.bh()});break;case 12:k=this;n=n.then(function(){return k.be()});break;case 13:d=t;g=this;n=n.then(function(){return g.bf(d)});break;case 14:nt=t;tt=this;n=n.then(function(){return tt.bg(nt)});break;case 16:it=t;ft=this;n=n.then(function(){return Promise.resolve(it)});break;case 17:rt=t;s=this;n=n.then(function(){return s.ba(rt,$$as(_Ewa.bc,_Ewa.bJ.a(s.a)))});break;case 18:et=t;_Ewa.c.a(this.a).q();break;default:ot=this;n=n.then(function(){return Promise.reject(_Ewa.bv.d("ApiNotFound",_Ewa.ClientStringManager.a().a(1669),null,0))})}return n},O:function(n){var s=$$as(_Ewa.bc,_Ewa.bJ.a(this.a)),r=s.bb(n.controlId),e,o;if(r&&!(!n.operationType^!r.h)){_Ewa.c.a(this.a).cn(!0);switch(n.operationType){case 0:e=new _Ewa.fZ(document.createElement("input"),!1,!1,!1,null);e.i(n.range);r.bc(_Ewa.c.a(this.a).r().i(e,new _Ewa.oG(this.a)));r.h.p(!0);break;case 1:r.S();this.n=null;break;case 2:r.h.n(n.range);break;case 3:r.h.n(n.startingRange);var u,t=n.expandSelection,i=n.getNextDataRegionCell,h=n.keyboardDirectionValue,f=0;switch(h){case 2:f=38;u=t&&i?105288353:t?-31900117:i?542791952:137938150;break;case 3:f=40;u=t&&i?-1297307319:t?-1603798598:i?1713663844:-798660877;break;case 0:f=37;u=t&&i?-403586027:t?2039316657:i?-2012742350:-1470715894;break;case 1:f=39;u=t&&i?784916030:t?589730764:i?1324884057:-1231471547;break;default:u=1461300262}o=this.t("keydown",f,t,i);_Ewa.c.a(this.a).cK(o,new _Ewa.L(u,1,0,8,null),null)}_Ewa.c.a(this.a).cn(!1)}},t:function(n,t,i,r){var f=document.createEvent("KeyboardEvent"),u,e;return Common.c.k()?f.initKeyboardEvent(n,!1,!1,window.self,"A",0,r,!1,i,!1):(u="",i&&(u+="Shift"),r&&(u+=u.length>0?" Control":"Control"),f.initKeyboardEvent(n,!1,!1,window.self,"A",0,u,!1,"en-US")),e=new Sys.UI.DomEvent(f),e.keyCode=t,e},M:function(n){var r,i,t;switch(n.operationType){case 1:r=this;_Ewa.g.a(_Ewa.l.b(_Ewa.eY,this.a.a(),153,this.a.g(),1,null),function(n){n.a().e(!1)},this.a.g(),3,null,null);break;case 2:i=$$as(_Ewa.bc,_Ewa.bJ.a(this.a));t=i.bb(n.controlId);t&&(t.v=!0,t.R())}},u:function(n){var t=n.fileBase64;if(t&&t.length>this.a.e().CreateWorkbookMaxAllowedBase64Size)return Promise.reject(_Ewa.bv.d("InvalidArgument",_Ewa.ClientStringManager.a().a(1672),"Application.CreateWorkbook",0));var i=this,r=new Promise(function(n,r){var u=new CommonUI.d;u.D(4);u.G($a.G,$a.bM,1,function(u){u!==2&&u||r(_Ewa.bv.d("OperationCancelled",_Ewa.ClientStringManager.a().a(1671),"Application.CreateWorkbook",0));var f=t?"streamBase64":"streamEmpty",e=new Common.App.NewAndOpen.UX.e("blank","agave",f,t),o=i.i.a(n,r,e);o.q()})}),u=this,f=this;return r.then(function(t){return u.g.d(n.fakeFileId,t),Promise.resolve(null)},function(n){return n?Promise.reject(n):Promise.reject(_Ewa.bv.d("GeneralException",_Ewa.ClientStringManager.a().a(1668),"Application.CreateWorkbook",0))})},U:function(n){var t=this;return new Promise(function(i,r){var u=null,e,o,f;(o=t.g.k(n.fakeFileId,e={val:u},null),u=e.val,o)?(f=new CommonUI.d,f.D(4),f.G($a.G,$a.kQ,1,function(n){n===1&&_Ewa.j.c(u,null,null,"DdaMethodHandler.fileUrl");i(null)})):r(_Ewa.bv.d("GeneralException",_Ewa.ClientStringManager.a().a(1668),"Document.Open",0))})},bc:function(n){var t=this;return new Promise(function(i){var u=$$as(_Ewa.bc,_Ewa.bJ.a(t.a)),r;u.bB=n.runtimeCalculationMode;r=t.a.a().a(_Ewa.dp,268,!1,null);r&&r.v(n.runtimeCalculationMode===3);i(null)})},bi:function(n){if(_Ewa.s.k(this.a)){var t=this.a.a().a(_Ewa.fG,331,!1,null);t.c(0,n.urlStr,!0,!0,null,null)}return Promise.resolve(null)},bh:function(){if(_Ewa.s.k(this.a)){var n=this.a.a().a(_Ewa.fG,331,!1,null);n.c(1,null,!0,!0,null,null)}return Promise.resolve(null)},be:function(){if(_Ewa.s.k(this.a)){var n=this.a.a().a(_Ewa.fG,331,!1,null);n.g()}return Promise.resolve(null)},bf:function(n){if(_Ewa.s.k(this.a)){var t=this.a.a().a(_Ewa.fG,331,!1,null);t.c(5,n.urlStr,!0,!0,null,null)}return Promise.resolve(null)},bg:function(n){var r,t;if(_Ewa.s.k(this.a)){r=this.a.a().a(_Ewa.fG,331,!1,null);for(var u=r.a(),f=u.length,i=0;i<f;++i)t=u[i],t.IsActive&&t.HostEditUrl&&t.UrlStr===n.hostEditUrlStr&&_Ewa.j.c(t.HostEditUrl,"_blank",null,"")}return Promise.resolve(null)},ba:function(n,t){var i=_Ewa.E.b(n.payload),r={};return"eventId"in i&&"payload"in i&&(r.eventId=i.eventId,r.payload=i.payload),t.cK(2201,"Workbook",_Ewa.E.a(r)),Promise.resolve(null)},j:function(n){var t=$$as(_Ewa.J,this.a.d().b(n));t&&!t.S&&t.d(!0)},r:function(n,t,i,r){var u=n.a().j(),f=u<t.length&&t[u].i(n.a().a()),e=f?n.a().a():t[0].e(),o=f?u:0;_Ewa.c.a(this.a).bh(t,o,i,null,e,null,null,3,_Ewa.I.t,!0,!0,null,r===6,!0)}};_Ewa.ol=function(n,t,i){this.a=n;this.b=t;this.c=i};_Ewa.ol.a=function(n,t){n.LastRow=t===2?n.FirstRow:n.LastRow;n.LastColumn=t===2?n.FirstColumn:n.LastColumn};_Ewa.ol.prototype={b:null,c:null,a:null,d:function(n,t){var r=n.DdaGoToByIdMethod.GoToType,u=n.DdaGoToByIdMethod.SelectionMode,f=n.DdaGoToByIdMethod.Id.toString().trim(),i=this,e=function(n){var r=i.a.d().b(n.SheetName);r&&!r.S?(_Ewa.c.a(i.a).p(n,null,null,null,3,_Ewa.I.u,0,!0,!0,null,!0,!0),i.b.d(t)):i.b.a(7001,t)};r?r===1?this.f(f,u,e,t):this.b.a(5007,t):this.e(f,u,n.DdaMethod.ControlId,e,t)},e:function(n,t,i,r,u){var f=this,e=function(e){var s,o,h;if(_Ewa.O.a(e)||!e.Result||!e.Result.Reference){f.b.a(7002,u);return}if(s=e.Result,o={},o.SheetName=s.Reference.SheetName,o.FirstRow=s.Reference.FirstRow,o.FirstColumn=s.Reference.FirstColumn,o.LastRow=s.Reference.LastRow,o.LastColumn=s.Reference.LastColumn,_Ewa.ol.a(o,t),s.BindingType!==1){r(o);return}h=function(n,i,e){if(_Ewa.O.a(n)||!n.Result)f.b.b(n,e,u);else{var s=n.Result;t!==2&&(o.FirstRow-=s.Headers.length,o.FirstRow<0&&(o.FirstRow=0));r(o)}};f.c.g(i,n,1,0,2,0,0,-1,-1,h,u)};this.c.f(i,n,e,u)},f:function(n,t,i,r){var o=_Ewa.h.r(n),u,f,e;if(o){u=_Ewa.h.a(o,this.a);_Ewa.ol.a(u,t);i(u);return}if(this.a.b().b()&&this.a.m().f(n)){this.a.m().v(this.a.m().b(n));return}f=this;e=function(u){var e,o;_Ewa.O.a(u)||!u.Result?f.a.d().z(n)?(e={},e.SheetName=n,e.FirstRow=0,e.FirstColumn=0,e.LastRow=0,e.LastColumn=0,i(e)):f.b.a(7002,r):(o=u.Result,_Ewa.ol.a(o,t),i(o))};this.a.d().a()?this.c.x(n,this.a.d().a().a(),e,r):this.c.w(n,e,r)}};_Ewa.EM=function(n,t,i,r,u,f,e,o){_Ewa.EM.initializeBase(this,[10,0,t,o]);this.Q=i;this.O=r;this.W=u;this.Y=f;this.P=e;this.X=new _Ewa.fz("10",n,e)};_Ewa.EM.prototype={X:null,P:null,Q:null,O:null,W:null,Y:null,f:function(){return _Ewa.a.d()?_Ewa.bps.prototype.f.call(this):2},M:function(){return this.Y},V:function(){return this.Q},U:function(){return this.O},v:function(n){return _Ewa.iA.prototype.v.call(this,n)||this.Z(n)},w:function(){return this.X.d(this.R)},J:function(){var n={};return n.OperationType=3,n.RichApiRequest=this.P,n},Z:function(n){var t=this;return function(i,r,u){return _Ewa.ep.a(n,t.P,_Ewa.n.a(i,t.Q),_Ewa.n.b(r,t.O),u,t.W)}}};_Ewa.EN=function(n,t,i,r){_Ewa.EN.initializeBase(this,[576,0,i,r,null]);this.D=new _Ewa.fz("576",n,t)};_Ewa.EN.prototype={D:null,f:function(){return _Ewa.a.d()?_Ewa.bps.prototype.f.call(this):0},w:function(){return this.D.d(this.R)}};_Ewa.fz=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.fz.b=function(){return _Ewa.fz.a||(_Ewa.fz.a=new($$sc.n.$$(String))($$sc.d.a()),_Ewa.fz.a.a("f438b4e6-2b49-466f-9a91-b75f473eba96"),_Ewa.fz.a.a("fa000000005"),_Ewa.fz.a.a("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),_Ewa.fz.a.a("fa000000014"),_Ewa.fz.a.a("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f")),_Ewa.fz.a};_Ewa.fz.c=function(n){var r=null,u='"Name":"EnableOfficeScriptRecording"',f,e,t,o,i,s;if(u+='.*?Arguments":',u+='\\[.*?"',u+='(.*?)"',f=new RegExp(u,"mi"),e=!f.test(n.RequestBody),e){if(t=n.RequestHeaders,!t)return r;for(o="X-OfficeScriptEventId".toLowerCase(),i=0;i<t.length;i++)if(t[i].Name.toLowerCase()===o){r=t[i].Value;break}}else s=f.exec(n.RequestBody),r=s[1];return r};_Ewa.fz.prototype={c:null,b:null,a:null,f:function(n){var t,r,i;return isNullOrUndefined(n)?null:isNullOrUndefined(n.RequestBody)?null:(t=JSON.parse(n.RequestBody),isNullOrUndefined(n.ActiveChartId)||(t.ActiveChartId=n.ActiveChartId,r=_Ewa.c.a(this.a),i=r.a().b().a(),i&&i.a()&&i.a().e&&(t.ActiveChartType=_Ewa.ua.toString(i.a().e.ChartCategory))),isNullOrUndefined(n.SheetMultiRange)||(t.SheetName=n.SheetMultiRange.SheetName),t)},g:function(n){if(isNullOrUndefined(n)||isNullOrUndefined(n.Result))return null;var t=n.Result;return isNullOrUndefined(t.ResponseBody)?null:t.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(t.ResponseBody.join(""))},h:function(n){return!!n&&!isNullOrUndefined(n.a)&&n.a.length>0},d:function(n){var t=this;return function(){var u,i,r,f;if(t.a.bv()&&(u=t.e(t.c),t.h(u))){if(i=t.f(t.c),r=t.g(n),i&&!Common.D.a(i)&&r&&!Common.D.a(r))return Diag.a.a(579216154,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new _Ewa.ft(u,i,r);f=String.format("requestInfo: {0}; responseInfo: {1}",i?"(not null)":"(null)",r?"(not null)":"(null)");Diag.a.a(579216153,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",f)}return new _Ewa.ft(null,null,null)}},e:function(n){var i=this.i(n.SolutionId),t=_Ewa.fz.c(n);return t&&i?(Diag.a.a(579216152,0,50,"[RichApiRecorder][{0}]: {1}",this.b,{recorderEventId:t,"request.SolutionId":n.SolutionId}),new _Ewa.Oy(n.SolutionId,t)):(Diag.a.a(579216151,0,50,"[RichApiRecorder][{0}]: {1}",this.b,{recorderEventId:t,isRecorderAwareAddin:i,"request.SolutionId":n.SolutionId}),null)},i:function(n){if(!n)return!1;var t=n.toLowerCase();return _Ewa.fz.b().b(t)}};_Ewa.EO=function(n,t){this.b=Function.createDelegate(this,this.v);this.a=n;this.e=t};_Ewa.EO.prototype={e:null,a:null,h:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h,c){return _Ewa.ep.c(o.a.c().a(),n,t,i,o.d(),r,u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),c,e)},e,563,0)},o:function(n,t,i,r){var u=this;this.c(function(f,e,o){return _Ewa.ep.k(u.a.c().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),o,r)},r,564,0)},f:function(n,t,i,r){var u=this;this.c(function(f,e,o){return _Ewa.ep.h(u.a.c().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),o,r)},r,565,16)},l:function(n,t,i){var r=this;this.c(function(u,f,e){return _Ewa.ep.g(r.a.c().a(),n,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),e,i)},i,566,16)},g:function(n,t,i,r,u,f,e,o,s,h,c){var l=this;this.c(function(a,v,y){return _Ewa.ep.i(l.a.c().a(),n,t,i,r,u,f,e,o,s,l.d(),_Ewa.n.a(a,h),_Ewa.n.b(v,l.b),y,c)},c,567,16)},q:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h,c){return _Ewa.ep.m(o.a.c().a(),n,t,i,r,o.d(),u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),c,e)},e,568,0)},m:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h,c){return _Ewa.ep.j(o.a.c().a(),n,t,i,r,o.d(),u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),c,e)},e,569,16)},s:function(n,t,i,r,u){var f=this;this.c(function(e,o,s){return _Ewa.ep.o(f.a.c().a(),n,f.d(),t,i,_Ewa.n.a(e,r),_Ewa.n.b(o,f.b),s,u)},u,570,0)},n:function(n,t,i){var r=this;this.c(function(u,f,e){return _Ewa.ep.b(r.a.c().a(),n,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),e,i)},i,501,16)},p:function(n,t,i,r,u){var f=this;this.c(function(e,o,s){return _Ewa.ep.l(f.a.c().a(),n,t,i,_Ewa.n.a(e,r),_Ewa.n.b(o,f.b),s,u)},u,571,0)},i:function(n,t,i,r,u,f){var e=this;this.c(function(o,s,h){return _Ewa.ep.d(e.a.c().a(),n,t,i,e.d(),r,_Ewa.n.a(o,u),_Ewa.n.b(s,e.b),h,f)},f,572,0)},k:function(n,t,i,r){var u=this;this.c(function(f,e,o){return _Ewa.ep.f(u.a.c().a(),n,t,u.d(),_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),o,r)},r,573,0)},j:function(n,t,i,r){var u=this;this.c(function(f,e,o){return _Ewa.ep.e(u.a.c().a(),n,t,u.d(),_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),o,r)},r,574,0)},r:function(n,t,i,r,u,f){var e=this;this.c(function(o,s,h){return _Ewa.ep.n(e.a.c().a(),n,t,e.d(),i,r,_Ewa.n.a(o,u),_Ewa.n.b(s,e.b),h,f)},f,575,0)},w:function(n,t,i){var r=this;this.c(function(u,f,e){var o=r.a.c().a().b(!1);return _Ewa.k.c(r.a.c().a(),n,-1,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),e,i,o)},i,162,16)},x:function(n,t,i,r){var u=this;this.c(function(f,e,o){var s=u.a.c().a().b(!1);return _Ewa.k.r(u.a.c().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),o,r,s)},r,562,16)},t:function(n,t,i){var f,r,u;if(_Ewa.a.a("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(n.RequestFlags=n.RequestFlags&8191),_Ewa.a.b(264))f=this,this.u(this.a.c().a().b(!1),t,function(){f.e.a(5001,i)},i,n);else{if(r=_Ewa.bc.g(n,this.a),_Ewa.a.a("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.a.n().d()&&!(r&16)){this.e.a(5016,i);Diag.a.a(579216150,0,50,"Write operation is not allowed");return}_Ewa.a.d()&&(r|=64);u=this;this.a.f().b(new _Ewa.EN(this.a,n,function(r,f,e){return _Ewa.ep.a(u.a.c().a(),n,_Ewa.n.a(r,t),_Ewa.n.b(f,u.b),e,i)},r))}},d:function(){return this.a.b().b()?this.a.h().P:this.a.F()},v:function(n,t){this.e.a(5001,t)},c:function(n,t,i,r){if(_Ewa.a.a("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.a.n().d()&&!(r&16)){this.e.a(5016,t);Diag.a.a(590488149,0,50,"Write operation is not allowed");return}_Ewa.a.d()?(r|=64,this.a.f().b(new _Ewa.v(i,0,n,r,null))):this.a.f().b(new _Ewa.ba(i,0,n,r,null))},u:function(n,t,i,r,u){var f=_Ewa.bc.g(u,this.a),e;if(_Ewa.a.a("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.a.n().d()&&!(f&16)){this.e.a(5016,r);Diag.a.a(590488148,0,50,"Write operation is not allowed");return}e=this.a.o().a("UserAction","Rich Api request");_Ewa.a.d()&&(f|=64);this.a.f().a(new _Ewa.EM(this.a,n,t,i,r,e,u,f),null)}};_Ewa.EP=function(n,t,i,r){this.a=n;this.c=t;this.d=i;this.b=r};_Ewa.EP.prototype={a:0,c:0,d:0,b:null};_Ewa.gZ=function(n){this.a={};this.c=n};_Ewa.gZ.a=function(n){return n.a().a(_Ewa.gZ,200,!1,null)||n.a().b(_Ewa.gZ,200,new _Ewa.gZ(_Ewa.gZ.c))};_Ewa.gZ.prototype={c:0,a:null,d:function(n,t){return(this.b(n)||(this.a[n]={}),this.f(n))?(Diag.a.a(8946273,344,50,"App {0} has reach the limit of number of cached files.",n),11e3):(this.a[n][t.a.toString()]=t,0)},e:function(n,t){var i=null;return this.b(n)&&(i=this.a[n][t.toString()]),i||Diag.a.a(8946274,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",n,t),i},b:function(n){return n in this.a},g:function(n,t){if(this.b(n)){var i=this.a[n];return delete i[t.toString()],Object.keys(i).length<1&&delete this.a[n],t.toString()in i?5001:0}return 5001},f:function(n){if(!this.b(n))return!1;var t=this.a[n];return Object.keys(t).length>=this.c}};_Ewa.AppRuntimeService=function(n,t){this.a=t;this.b=n};_Ewa.AppRuntimeService.prototype={b:null,a:null,getAppRuntimeState:function(){var n=this.a.I(this.b);return n?2:1},setAppRuntimeState:function(n){var t=!0;switch(n){case 2:t=!0;break;case 1:t=!1;break;case 0:default:throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1672));}this.a.U(this.b,t)},getTypeName:function(){return"Microsoft.AppRuntime.AppRuntimeService"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 2:return this.getAppRuntimeState();case 1:return this.c(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},c:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return this.setAppRuntimeState(t),null}};_Ewa.AddinInternalService=function(n){this.a=n};_Ewa.AddinInternalService.prototype={a:null,notifyActionHandlerReady:function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.a)},getTypeName:function(){return"Microsoft.InternalService.AddinInternalService"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 1:return this.b(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},b:function(){return this.notifyActionHandlerReady(),null}};_Ewa.IdentityType=function(){};_Ewa.IdentityType.prototype={organizationAccount:0,microsoftAccount:1};_Ewa.IdentityType.registerEnum("_Ewa.IdentityType",!1);_Ewa.LicenseEventType=function(){};_Ewa.LicenseEventType.prototype={featureStateChanged:1};_Ewa.LicenseEventType.registerEnum("_Ewa.LicenseEventType",!1);_Ewa.LicenseFeatureTier=function(){};_Ewa.LicenseFeatureTier.prototype={unknown:0,basic:1,premium:2};_Ewa.LicenseFeatureTier.registerEnum("_Ewa.LicenseFeatureTier",!1);_Ewa.AuthenticationService=function(n,t){var i=t;this.a=i;this.b=n};_Ewa.AuthenticationService.prototype={a:null,b:null,get_roamingSettings:function(){return null},getAccessToken:function(n){var i=this.a.getOsfControl(this.b),r=i.getManifest(),t=r.getMarketplaceID();this.g(n,t);var u=this,f=function(f,e){if(!i.isFirstParty()||!u.a._enableFirstPartySSO){e("ApiNotAvailable");return}if(!u.e(r,n)){e("AccessDenied");return}var o=Common.Utils.a.a().a(Common.App.WopiIdentity.c,null),s=n,h=o.getAccessToken(s,t,null);h.then(function(n){f(n)},function(n){e(n)})},e=OfficeExtension.WacRuntime.Utility.createPromise(f),s=this,o=this;return e.then(function(n){var i=n,t;switch(i.get_authority()){case"OneDriveWOPI":t=1;break;case"SharepointOnline":case"ExchangeOnline":default:t=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new _Ewa.SingleSignOnToken(i.get_accessToken(),t))},function(i){var r,u;return(o.f(n,t,i),i)?(r=i,u=OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException(r,_Ewa.kP.a(r)))}),u):OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.kP.a("GeneralException")))})})},getAuthContext:function(){return null},getPrimaryIdentityInfo:function(){var n=this.a.getOsfControl(this.b),u=n.getManifest(),t=n.getManifest().getMarketplaceID(),f=this,i=function(n,i){var r=Common.Utils.a.a().a(Common.App.WopiIdentity.c,null),u=r.getPrimaryIdentityInfo(t);u.then(function(t){n(t)},function(n){i(n.toString())})},r=OfficeExtension.WacRuntime.Utility.createPromise(i),e=this,o=this;return r.then(function(n){var t=_Ewa.OfficeIdentityInfo.a(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},function(n){var t,i;return n?(t=n,i=OfficeExtension.WacRuntime.Utility.createPromise(function(n,i){i(OfficeExtension.WacRuntime.Utility.createRichApiException(t,_Ewa.kP.a(t)))}),i):OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.kP.a("GeneralException")))})})},getTypeName:function(){return"Microsoft.Authentication.AuthenticationService"},invokePropertyGet:function(n){switch(n){case 99:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.d(t);case 3:return null;case 2:return this.getPrimaryIdentityInfo()}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},d:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,_Ewa.TokenParameters);return this.getAccessToken(t)},e:function(n,t){for(var u,l,i,e,y,s=!1,p=n.getWebApplicationAuthorizations(),h=null,c=p,w=c.length,r=0;r<w;++r)if(u=c[r],u.getResource().toLowerCase()===t.a.toLowerCase()){h=u;s=!0;break}if(!s)return!1;l=t.b.split(" ,+");for(var a=l,b=a.length,f=0;f<b;++f)if(i=a[f],i&&i.length){e=!1;for(var v=h.getScopes(),k=v.length,o=0;o<k;++o)y=v[o],i.toLowerCase()===y.toLowerCase()&&(e=!0);if(!e)return!1}return!0},g:function(n,t){var i=this.c(n.a);Diag.a.a(39105299,369,50,"{0}",{manifestId:t,resource:i})},f:function(n,t,i){var r=this.c(n.a);Diag.a.a(39105300,369,10,"{0}",{manifestId:t,resource:r,error:i})},c:function(n){return n.replace("://","__").replace(new RegExp("\\.","g"),"_dot_").replace("/","\\")}};_Ewa.BeforeDocumentCloseNotification=function(n,t,i,r){this.c=n;this.b=_Ewa.bJ.a(i);var u=r.a();this.a=u.getOsfControl(t)};_Ewa.BeforeDocumentCloseNotification.prototype={c:null,a:null,b:null,disable:function(){try{if(!_Ewa.a.a("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.e();if(_Ewa.f.a(this.a.getSharedRuntimeId()))return this.f();this.b.bj.e(this.c)}catch(n){return Diag.a.a(554836963,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",n.message||"Unknown"),this.d()}return null},enable:function(){try{if(!_Ewa.a.a("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.e();if(_Ewa.f.a(this.a.getSharedRuntimeId()))return this.f();this.b.bj.a[this.c]=!0}catch(n){return Diag.a.a(554836962,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",n.message||"Unknown"),this.d()}return null},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){switch(n){case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 3:return this.disable();case 2:return this.enable()}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},e:function(){return _Ewa.mr.a("NotImplemented",_Ewa.ClientStringManager.a().a(1673))},f:function(){return _Ewa.mr.a("SharedRuntimeNotAvailable",_Ewa.ClientStringManager.a().a(1677))},d:function(){return _Ewa.mr.a("GeneralException",_Ewa.ClientStringManager.a().a(1668))}};_Ewa.CustomFunctionEngineStatus=function(){};_Ewa.CustomFunctionEngineStatus.prototype={a:!1,b:!1,c:!1,get_enabled:function(){return this.a},set_enabled:function(n){return this.a=n,n},get_nativeRuntime:function(){return this.b},set_nativeRuntime:function(n){return this.b=n,n},get_streamingEnabled:function(){return this.c},set_streamingEnabled:function(n){return this.c=n,n},getTypeName:function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"},invokePropertyGet:function(n){switch(n){case 1:return this.a;case 3:return this.b;case 2:return this.c}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 1:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 3:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 2:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.CustomFunctionManager=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.CustomFunctionManager.prototype={b:null,a:null,c:null,get_status:function(){var n=new _Ewa.CustomFunctionEngineStatus;return n.a=this.a.L(124),n.c=this.a.L(125),n.b=!1,n},register:function(n){var t=this,i=function(i,r){_Ewa.g.a(_Ewa.l.b(_Ewa.ef,t.a.a(),279,t.a.g(),1,null),function(u){var c=u.a(),o=!1,l=t.c.a(),a=l,f=a.getOsfControl(t.b),s=null,e,h;f&&(s=f.getStoreType(),e=f.getManifest(),e&&(h=e.getSharedRuntimeForCustomFunctions("Workbook"),h&&(o=!0)));_Ewa.g.a(c.b(t.b,s,n,o),function(n){if(_Ewa.cb.a(n)){var t=n.a();t?i(null):r(OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1672)))}else r(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1668)))},t.a.g(),3,null,null)},t.a.g(),3,null,null)};return OfficeExtension.WacRuntime.Utility.createPromise(i)},getTypeName:function(){return"Microsoft.ExcelServices.CustomFunctionManager"},invokePropertyGet:function(n){switch(n){case 2:return this.get_status()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.d(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},d:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string"),i=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,1,"string");return this.register(t,i)}};_Ewa.DynamicRibbon=function(n,t,i,r){this.a=n;this.d=t;this.f=i;this.h=r;this.e=_Ewa.bJ.a(this.f);var u=this.h.a();this.g=u;this.c=this.g.getOsfControl(this.d);this.i=this.c.getManifest();this.b=this.e.bb(this.d)};_Ewa.DynamicRibbon.a=function(n,t,i){var r={};return r.methodName="DynamicRibbon."+n,r.result=t?"Succeeded":"Failed",r.message=i,_Ewa.E.a(r)};_Ewa.DynamicRibbon.prototype={a:null,d:null,f:null,h:null,g:null,c:null,i:null,e:null,b:null,get_buttons:function(){return null},executeRequestCreate:function(n){var t,f,r,e,o;try{t=this.b.b;f=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t.OwnerAddinStoreType,t.PrimaryMarketplace.MarketplaceRef,this.a,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t.OwnerAddinStoreType,t.PrimaryMarketplace.MarketplaceRef,t.OwnerAddinSolutionId,null,null),ownerAddinStoreType:t.OwnerAddinStoreType,ribbonControlType:"Ribbon"}:{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t.OwnerAddinStoreType,t.PrimaryMarketplace.MarketplaceRef,this.a,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t.OwnerAddinStoreType,t.PrimaryMarketplace.MarketplaceRef,t.OwnerAddinAssetId,null,null),ownerAddinStoreType:t.OwnerAddinStoreType,ribbonControlType:"Ribbon"};Otel.Telemetry.a((r=new Otel.b,r.name="Office.Online.Extensibility.Ribbon.ExecuteRequestCreate",r.dataFields=Common.J.a(f,null,null),r));var s=_Ewa.E.b(n),i={},u={};u.OsfControl=this.c;u.RibbonUpdaterData=s;u.WebExtensionData=t;i.DynamicAddinCommandsMethodDispatchId=3;i.SolutionId=this.a;i.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(t.OwnerAddinStoreType,t.PrimaryMarketplace.MarketplaceRef,this.a,null,null);i.MethodData=u;this.e.bg(-1014260128,i,!0);e=_Ewa.DynamicRibbon.a("ExecuteRequestCreate",!0,"");Diag.a.a(591971672,0,50,e)}catch(h){o=_Ewa.DynamicRibbon.a("ExecuteRequestCreate",!1,h.toString());Diag.a.a(591971671,0,50,o)}return null},executeRequestUpdate:function(n){var t,i,e,u,o,s;try{t=null;i=null;t=this.b.b.OwnerAddinStoreType;i=this.b.b.PrimaryMarketplace.MarketplaceRef;e=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b.b.OwnerAddinSolutionId,null,null),ownerAddinStoreType:this.b.b.OwnerAddinStoreType,ribbonControlType:"Ribbon"}:{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b.b.OwnerAddinAssetId,null,null),ownerAddinStoreType:this.b.b.OwnerAddinStoreType,ribbonControlType:"Ribbon"};Otel.Telemetry.a((u=new Otel.b,u.name="Office.Online.Extensibility.Ribbon.ExecuteRequestUpdate",u.dataFields=Common.J.a(e,null,null),u));var h=_Ewa.E.b(n),c=this.b.b,r={},f={};f.OsfControl=this.c;f.RibbonUpdaterData=h;f.WebExtensionData=c;r.DynamicAddinCommandsMethodDispatchId=3;r.SolutionId=this.a;r.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(t,i,this.a,null,null);r.MethodData=f;this.e.bg(-1014260128,r,!0);o=_Ewa.DynamicRibbon.a("ExecuteRequestUpdate",!0,"");Diag.a.a(591971670,0,50,o)}catch(l){s=_Ewa.DynamicRibbon.a("ExecuteRequestUpdate",!1,l.toString());Diag.a.a(591971669,0,50,s)}return null},getButton:function(n){var t=null;if(!this.m())return this.k();if(!(!n||!n.length)){if(!this.j(n))return this.l(n);t=new _Ewa.RibbonButton(n,this.a,this.d,this.f)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},getTab:function(n){var t=null;if(this.m()){if(this.c.getOwnerAddinControlRecreated())return this.o()}else return this.k();if(!(!n||!n.length)){if(!this.j(n))return this.l(n);t=new _Ewa.RibbonTab(n,this.a,this.d,this.f)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.DynamicRibbon"},invokePropertyGet:function(n){switch(n){case 4:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){switch(n){case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 7:return this.p(t);case 6:return this.q(t);case 3:return this.s(t);case 5:return this.t(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},p:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.executeRequestCreate(t)},q:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.executeRequestUpdate(t)},s:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getButton(t)},t:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getTab(t)},l:function(n){return _Ewa.mr.a("ControlIdNotFound",_Ewa.ClientStringManager.a().a(1674)+n)},k:function(){return _Ewa.mr.a("RibbonApiNotAvailable",_Ewa.ClientStringManager.a().a(1670))},o:function(){return _Ewa.mr.a("HostRestartNeeded",_Ewa.ClientStringManager.a().a(1675))},m:function(){var n=!_Ewa.f.a(this.c.getSharedRuntimeId());return Diag.a.a(592295296,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",n)),n},j:function(n){var t=this.i.getRibbonExtensionControlMap();return n in t||this.n(n)},n:function(n){var o=this.r(),s,r,l,t,v,y,w;if(o){s=o.e;for(var h=s.tabs,b=h.length,i=0;i<b;++i){if(r=h[i],r.id===n)return!0;for(var c=r.groups,k=c.length,u=0;u<k;++u){l=c[u];for(var a=l.controls,d=a.length,f=0;f<d;++f){if(t=a[f],t.id===n)return!0;if(t.type==="Menu"){v=t;y=v;for(var p=y.items,g=p.length,e=0;e<g;++e)if(w=p[e],w.id===n)return!0}}}}}return!1},r:function(){var t=CommandUI.AddInCommands.f.b(),n=this.b.b;return t.a(n.PrimaryMarketplace.MarketplaceType,n.PrimaryMarketplace.SolutionId,1)}};_Ewa.TypeRegister=function(){};_Ewa.TypeRegister.registerTypes=function(n){Common.App.AppsForOffice.TypeRegister.registerTypes(n);var t,i,r;t=n.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);i=t.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);i.addParameter("base64File","String",1,null,0);t=n.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);i=t.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);i=t.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);i.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);t=n.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);r=t.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);i=t.addMethod("Register",1,"Void",0,0,"Register",0);i.addParameter("metadata","String",1,null,0);i.addParameter("javascript","String",1,null,0);t=n.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);r=t.addProperty("Enabled",1,"Boolean",1,!1,null,0);r=t.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);r=t.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);t=n.addEnumType("Microsoft.Authentication.IdentityType");t.addEnumField("OrganizationAccount",0);t.addEnumField("MicrosoftAccount",1);t=n.addEnumType("Microsoft.Authentication.AuthorityType");t.addEnumField("External",0);t.addEnumField("Msa",1);t.addEnumField("Aad",2);t=n.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);r=t.addProperty("DisplayName",4,"String",1,!1,null,0);r=t.addProperty("Email",3,"String",1,!1,null,0);r=t.addProperty("FederationProvider",2,"String",1,!1,null,0);r=t.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);t=n.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);r=t.addProperty("AppId",4,"String",1,!1,null,0);r=t.addProperty("Authority",2,"String",1,!1,null,0);r=t.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);r=t.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);r=t.addProperty("TenantId",6,"String",1,!1,null,0);r=t.addProperty("Upn",1,"String",1,!1,null,0);t=n.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);r=t.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);i=t.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);i.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);i=t.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);i=t.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);t=n.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);r=t.addProperty("AuthChallenge",3,"String",1,!1,null,0);r=t.addProperty("CorrelationId",7,"String",1,!1,null,0);r=t.addProperty("Policy",4,"String",1,!1,null,0);r=t.addProperty("Resource",2,"String",1,!1,null,0);r=t.addProperty("Scope",5,"String",1,!1,null,0);r=t.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);t=n.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);r=t.addProperty("AccessToken",2,"String",1,!1,null,0);r=t.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);t=n.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);r=t.addProperty("Id",1,"String",1,!0,null,0);r=t.addProperty("Value",2,"Object",1,!1,null,0);t=n.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);i=t.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);i.addParameter("id","String",1,null,0);i=t.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);i.addParameter("id","String",1,null,0);t=n.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);i=t.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);i=t.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);i.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);t=n.addEnumType("Microsoft.AppRuntime.AppRuntimeState");t.addEnumField("Inactive",0);t.addEnumField("Background",1);t.addEnumField("Visible",2);t=n.addEnumType("Microsoft.AppRuntime.Visibility");t.addEnumField("Hidden",1);t.addEnumField("Visible",2);t=n.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);r=t.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);i=t.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);i.addParameter("jsonCreate","String",1,null,0);i=t.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);i.addParameter("jsonUpdate","String",1,null,0);i=t.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);i.addParameter("id","String",1,null,0);i=t.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);i.addParameter("id","String",1,null,0);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);t=n.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);r=t.addProperty("Id",2,"String",1,!0,null,0);i=t.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);i.addParameter("visibility","Boolean",1,null,0);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);t=n.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);r=t.addProperty("Enabled",3,"Boolean",1,!1,null,0);r=t.addProperty("Id",2,"String",1,!0,null,0);r=t.addProperty("Label",4,"String",1,!0,null,0);i=t.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);i.addParameter("enabled","Boolean",1,null,0);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);t=n.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);i=t.addMethod("GetCount",3,"Int32",1,1,"Count",0);i=t.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);i.addParameter("key","String",1,null,0);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);t.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);t=n.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");t.addEnumField("Unknown",0);t.addEnumField("Basic",1);t.addEnumField("Premium",2);t=n.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);i=t.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);i.addParameter("feature","String",1,null,0);i.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);i=t.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);i.addParameter("feature","String",1,null,0);i=t.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);i.addParameter("feature","String",1,null,0);i.addParameter("fallbackValue","Boolean",1,null,0);i=t.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);i=t.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);i.addParameter("experienceId","String",1,null,0);i=t.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);i.addParameter("feature","String",1,null,0);t=n.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);r=t.addProperty("Id",5,"String",1,!0,null,0);i=t.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);i=t.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);t=n.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);i=t.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);t=n.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);i=t.addMethod("Disable",3,"Void",0,1,"Disable",0);i=t.addMethod("Enable",2,"Void",0,1,"Enable",0);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};_Ewa.License=function(n,t){this.a=Common.Utils.a.a().b(Common.App.ApplicationFeatureHelper.a,null);this.c=n;this.b=t;this.d=this.b.a().getOsfControl(this.c)};_Ewa.License.prototype={a:null,d:null,c:null,b:null,getFeatureTier:function(n,t){var i=this,r=function(r){var u=t===1?1:t===2?2:0;i.a.a(function(f){f.f(n,u).then(function(n){r(i.h(n))},function(){r(t)})})};return OfficeExtension.WacRuntime.Utility.createPromise(r)},getLicenseFeature:function(n){var t=new _Ewa.LicenseFeature(this.a,n,this.c,this.b);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},isFeatureEnabled:function(n,t){var i=this,r=function(r){i.a.a(function(i){i.a(n,t).then(function(n){r(n)},function(){r(t)})})};return OfficeExtension.WacRuntime.Utility.createPromise(r)},isFreemiumUpsellEnabled:function(){var n=this,t=function(t){n.a.a(function(n){var i=n.b();t(i)})};return OfficeExtension.WacRuntime.Utility.createPromise(t)},launchUpsellExperience:function(n){var r=this.d.isFirstParty(),t,i;if(r)return t=this,i=function(){t.a.a(function(t){t.d(n,null)})},OfficeExtension.WacRuntime.Utility.createPromise(i);throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied","");},_TestFireStateChangedEvent:function(){},getTypeName:function(){return"Microsoft.Office.Licensing.License"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 6:return this.e(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 2:return this.f(t);case 5:return this.g(t);case 1:return this.i(t);case 3:return this.isFreemiumUpsellEnabled();case 4:return this.j(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},f:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string"),i=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,1,"int");return this.getFeatureTier(t,i)},g:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getLicenseFeature(t)},i:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string"),i=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,1,"boolean");return this.isFeatureEnabled(t,i)},j:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.launchUpsellExperience(t)},e:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null},h:function(n){switch(n){case 1:return 1;case 2:return 2;case 0:default:return 0}}};_Ewa.LicenseFeature=function(n,t,i,r){this.c=n;this.a=t;this.f=i;this.e=r};_Ewa.LicenseFeature.prototype={c:null,a:null,e:null,f:null,d:"",b:0,get_id:function(){return this.a},_RegisterStateChange:function(){if(!this.b){var n=this;this.c.a(function(t){n.d=t.c(n.a,function(t){n.e.G(n.f,n.a,JSON.stringify(t))})})}return this.b++,OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},_UnregisterStateChange:function(){if(this.b--,!this.b){var n=this;this.c.a(function(t){t.e(n.a,n.d)})}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},getTypeName:function(){return"Microsoft.Office.Licensing.LicenseFeature"},invokePropertyGet:function(n){switch(n){case 5:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 6:return this._RegisterStateChange();case 7:return this._UnregisterStateChange()}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.OfficeIdentityInfo=function(){};_Ewa.OfficeIdentityInfo.a=function(n){var t=new _Ewa.OfficeIdentityInfo;t.b=n.get_displayName();t.c=n.get_email();switch(n.get_authority()){case"OneDriveWOPI":t.a=1;break;case"SharepointOnline":case"ExchangeOnline":default:t.a=0}return t.d="",t};_Ewa.OfficeIdentityInfo.prototype={b:null,c:null,d:null,a:0,get_displayName:function(){return this.b},set_displayName:function(n){return this.b=n,n},get_email:function(){return this.c},set_email:function(n){return this.c=n,n},get_federationProvider:function(){return this.d},set_federationProvider:function(n){return this.d=n,n},get_identityType:function(){return this.a},set_identityType:function(n){return this.a=n,n},getTypeName:function(){return"Microsoft.Authentication.OfficeIdentityInfo"},invokePropertyGet:function(n){switch(n){case 4:return this.b;case 3:return this.c;case 2:return this.d;case 1:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 4:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 1:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.RibbonButton=function(n,t,i,r){this.d=n;this.b=t;this.f=i;this.e=r;this.g=_Ewa.bJ.a(this.e);this.a=this.g.bb(this.f)};_Ewa.RibbonButton.prototype={d:null,b:null,f:null,e:null,g:null,a:null,c:!1,get_enabled:function(){return this.c},set_enabled:function(n){var t=this.a.b.OwnerAddinStoreType,i=this.a.b.PrimaryMarketplace.MarketplaceRef,u,r,f;return u=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a.b.OwnerAddinSolutionId,null,null),ownerAddinStoreType:t,ribbonControlType:"Button",toggle:n}:{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a.b.OwnerAddinAssetId,null,null),ownerAddinStoreType:t,ribbonControlType:"Button",toggle:n},Otel.Telemetry.a((r=new Otel.b,r.name="Office.Online.Extensibility.Ribbon.ControlUpdate",r.dataFields=Common.J.a(u,null,null),r)),this.c=n,f={DynamicAddinCommandsMethodDispatchId:1,SolutionId:this.b,PrivacyCompliantSolutionId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),SourceControlId:this.d,MethodData:this.c},_Ewa.bJ.a(this.e).bg(-1014260128,f,!0),n},get_id:function(){return this.d},get_label:function(){return null},setEnabled:function(){return},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonButton"},invokePropertyGet:function(n){switch(n){case 3:return this.c;case 2:return this.d;case 4:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 3:this.set_enabled(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 5:return this.h(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},h:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return null}};_Ewa.RibbonButtonCollection=function(){};_Ewa.RibbonButtonCollection.prototype={getCount:function(){return 0},getItem:function(){return null},_OnAccess:function(){return},getAsyncEnumerator:function(){return null},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonButtonCollection"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 3:return 0;case 2:return this.a(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},a:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null}};_Ewa.RibbonTab=function(n,t,i,r){this.c=n;this.b=t;this.e=i;this.d=r;this.f=_Ewa.bJ.a(this.d);this.a=this.f.bb(this.e)};_Ewa.RibbonTab.prototype={c:null,b:null,e:null,d:null,f:null,a:null,get_id:function(){return this.c},setVisibility:function(n){var t=this.a.b.OwnerAddinStoreType,i=this.a.b.PrimaryMarketplace.MarketplaceRef,u,r,f;u=_Ewa.a.c("Microsoft.Office.SharedOnline.OSFSolutionRefactorEntitlement",!1)?{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a.b.OwnerAddinSolutionId,null,null),ownerAddinStoreType:t,ribbonControlType:"Tab",toggle:n}:{addinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),ownerAddinAssetId:Telemetry.PrivacyRules.GetAssetId(t,i,this.a.b.OwnerAddinAssetId,null,null),ownerAddinStoreType:t,ribbonControlType:"Tab",toggle:n};Otel.Telemetry.a((r=new Otel.b,r.name="Office.Online.Extensibility.Ribbon.ControlUpdate",r.dataFields=Common.J.a(u,null,null),r));f={DynamicAddinCommandsMethodDispatchId:2,SolutionId:this.b,PrivacyCompliantSolutionId:Telemetry.PrivacyRules.GetAssetId(t,i,this.b,null,null),StoreType:t,SourceControlId:this.c,MethodData:n};_Ewa.bJ.a(this.d).bg(-1014260128,f,!0)},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonTab"},invokePropertyGet:function(n){switch(n){case 2:return this.c}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 3:return this.g(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},g:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return this.setVisibility(t),null}};_Ewa.RibbonTabCollection=function(){};_Ewa.RibbonTabCollection.prototype={getCount:function(){return 0},getItem:function(){return null},_OnAccess:function(){return},getAsyncEnumerator:function(){return null},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonTabCollection"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 5:return 0;case 4:return this.a(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},a:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null}};_Ewa.RoamingSetting=function(){};_Ewa.RoamingSetting.prototype={get_id:function(){return null},get_value:function(){return null},set_value:function(n){return n},getTypeName:function(){return"Microsoft.Authentication.RoamingSetting"},invokePropertyGet:function(n){switch(n){case 1:return null;case 2:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 2:OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"any");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.RoamingSettingCollection=function(){};_Ewa.RoamingSettingCollection.prototype={getItem:function(){return null},getItemOrNullObject:function(){return null},getTypeName:function(){return"Microsoft.Authentication.RoamingSettingCollection"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.a(t);case 2:return this.b(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},a:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null},b:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null}};_Ewa.SingleSignOnToken=function(n,t){this.a=n;this.b=t};_Ewa.SingleSignOnToken.prototype={a:null,b:0,get_accessToken:function(){return this.a},set_accessToken:function(n){return this.a=n,n},get_tokenIdenityType:function(){return this.b},set_tokenIdenityType:function(n){return this.b=n,n},getTypeName:function(){return"Microsoft.Authentication.SingleSignOnToken"},invokePropertyGet:function(n){switch(n){case 2:return this.a;case 3:return this.b}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 2:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.TokenParameters=function(){};_Ewa.TokenParameters.prototype={c:null,d:"",a:"",b:"",e:!0,f:null,get_options:function(){return this.f},set_options:function(n){return this.f=n,n},get_authChallenge:function(){return this.c},set_authChallenge:function(n){return this.c=n,n},get_correlationId:function(){return this.d},set_correlationId:function(n){return this.d=n,n},get_policy:function(){return null},set_policy:function(n){return n},get_resource:function(){return this.a},set_resource:function(n){return this.a=n,n},get_scope:function(){return this.b},set_scope:function(n){return this.b=n,n},get_silentLogin:function(){return this.e},set_silentLogin:function(n){return this.e=n,n},getTypeName:function(){return"Microsoft.Authentication.TokenParameters"},invokePropertyGet:function(n){switch(n){case 3:return this.c;case 7:return this.d;case 4:return null;case 2:return this.a;case 5:return this.b;case 6:return this.e}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 3:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 7:this.d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 5:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 6:this.e=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.WacWorkbook=function(n,t){this.a=n;this.b=t};_Ewa.WacWorkbook.prototype={a:null,b:null,createAndOpenWorkbook:function(n){if(n&&n.length>this.a.e().CreateWorkbookMaxAllowedBase64Size){Diag.a.a(38372609,0,15,"Too large base64 stream size:{0}",n.length);throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1672));}var i=n?"streamBase64":"streamEmpty",r=new Common.App.NewAndOpen.UX.e("blank","agave",i,n),t=null,u=this,f=function(n,i){var f=new CommonUI.d;f.D(4);f.G($a.G,$a.bM,1,function(f){if(f===2||!f){i("Cancelled");return}t=window.open("");var e=u.b.a(n,i,r);e.q()})},e=OfficeExtension.WacRuntime.Utility.createPromise(f),s=this,o=this;return e.then(function(n){if(!n)throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1668));try{t.top.location.href=n}catch(i){Diag.a.a(38630593,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}, stack:{2}",Common.c.e(),i,_Ewa.cT.a(!0,null));Diag.a.a(38630594,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace");t.location.replace(n)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(n){if(n==="Cancelled")throw OfficeExtension.WacRuntime.Utility.createRichApiException("OperationCancelled",_Ewa.ClientStringManager.a().a(1671));return t.close(),o.d(),null})},getTypeName:function(){return"Microsoft.ExcelServices.WacWorkbook"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.c(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},c:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.createAndOpenWorkbook(t)},d:function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1668));}};_Ewa.tz=function(){};_Ewa.tz.prototype={a:function(n,t){return new _Ewa.AuthenticationService(n,t)}};_Ewa.kP=function(){};_Ewa.kP.a=function(n){return n in _Ewa.kP.b?_Ewa.kP.b[n].toString():n};_Ewa.mr=function(){};_Ewa.mr.a=function(n,t){return OfficeExtension.WacRuntime.Utility.createPromise(function(i,r){r(OfficeExtension.WacRuntime.Utility.createRichApiException(n,t))})};_Ewa.bao=function(n,t,i,r,u){this.c=n;this.b=t;this.a=i;this.d=r;this.f=u};_Ewa.bao.prototype={c:null,b:null,a:null,d:null,e:null,f:null,hostName:function(){return"ExcelOnline"},appId:function(){return this.c},createInstance:function(n){var t;switch(n){case"Microsoft.Authentication.AuthenticationService":var i=Common.Utils.a.a().a(_Ewa.tz,null),r=this.a.a(),u=r;return i.a(this.b,u);case"Microsoft.Authentication.TokenParameters":return new _Ewa.TokenParameters;case"Microsoft.ExcelServices.CustomFunctionManager":return new _Ewa.CustomFunctionManager(this.c,this.d,this.a);case"Microsoft.AppRuntime.AppRuntimeService":return new _Ewa.AppRuntimeService(this.b,this.a);case"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return new _Ewa.BeforeDocumentCloseNotification(this.c,this.b,this.d,this.a);case"Microsoft.DynamicRibbon.DynamicRibbon":return new _Ewa.DynamicRibbon(this.c,this.b,this.d,this.a);case"Microsoft.Office.Licensing.License":return new _Ewa.License(this.b,this.a);case"Microsoft.InternalService.AddinInternalService":return new _Ewa.AddinInternalService(this.b);default:if(this.e||(this.e=new Common.App.AppsForOffice.WacApiHost),t=this.e.createInstance(n,this.f),t)return t}Diag.a.a(36542161,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",n);throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","GeneralException");}};_Ewa.uw.registerClass("_Ewa.uw",_Ewa.bh);_Ewa.EK.registerClass("_Ewa.EK",_Ewa.cL);_Ewa.qy.registerClass("_Ewa.qy",Common.App.AppsForOffice.WacApiDelegates);_Ewa.bv.registerClass("_Ewa.bv",null,_Ewa.lI,Sys.IDisposable);_Ewa.EM.registerClass("_Ewa.EM",_Ewa.iA);_Ewa.EN.registerClass("_Ewa.EN",_Ewa.v);_Ewa.EP.registerClass("_Ewa.EP");_Ewa.gZ.registerClass("_Ewa.gZ");_Ewa.AppRuntimeService.registerClass("_Ewa.AppRuntimeService");_Ewa.AddinInternalService.registerClass("_Ewa.AddinInternalService");_Ewa.AuthenticationService.registerClass("_Ewa.AuthenticationService");_Ewa.BeforeDocumentCloseNotification.registerClass("_Ewa.BeforeDocumentCloseNotification");_Ewa.CustomFunctionEngineStatus.registerClass("_Ewa.CustomFunctionEngineStatus");_Ewa.CustomFunctionManager.registerClass("_Ewa.CustomFunctionManager");_Ewa.DynamicRibbon.registerClass("_Ewa.DynamicRibbon");_Ewa.TypeRegister.registerClass("_Ewa.TypeRegister");_Ewa.License.registerClass("_Ewa.License");_Ewa.LicenseFeature.registerClass("_Ewa.LicenseFeature");_Ewa.OfficeIdentityInfo.registerClass("_Ewa.OfficeIdentityInfo");_Ewa.RibbonButton.registerClass("_Ewa.RibbonButton");_Ewa.RibbonButtonCollection.registerClass("_Ewa.RibbonButtonCollection");_Ewa.RibbonTab.registerClass("_Ewa.RibbonTab");_Ewa.RibbonTabCollection.registerClass("_Ewa.RibbonTabCollection");_Ewa.RoamingSetting.registerClass("_Ewa.RoamingSetting");_Ewa.RoamingSettingCollection.registerClass("_Ewa.RoamingSettingCollection");_Ewa.SingleSignOnToken.registerClass("_Ewa.SingleSignOnToken");_Ewa.TokenParameters.registerClass("_Ewa.TokenParameters",null,Common.App.WopiIdentity.k);_Ewa.WacWorkbook.registerClass("_Ewa.WacWorkbook");_Ewa.tz.registerClass("_Ewa.tz");_Ewa.bv.a=null;_Ewa.bv.b=null;_Ewa.bv.c=null;_Ewa.bv.g=0;_Ewa.fz.a=null;_Ewa.gZ.c=1;_Ewa.gZ.b=0;_Ewa.kP.b={GeneralException:"GeneralException",AccessDenied:"AccessDenied",ApiNotAvailable:"ApiNotAvailable",UserNotSignedIn:"UserNotSignedIn",UserAborted:"UserAborted",UnsupportedUserIdentity:"UnsupportedUserIdentity",InvalidResourceUrl:"InvalidResourceUrl",InvalidGrant:"InvalidGrant",AddinIsAlreadyRequestingToken:"AddinIsAlreadyRequestingToken",ResourceNotAllowed:"ResourceNotAllowed",ClientError:"ClientError",ServerError:"ServerError"};_Ewa.bdo.a()}catch(e){typeof _Ewa!="undefined"&&typeof _Ewa.ULSError!="undefined"&&typeof _Ewa.ULSError.sendErrorTraceTag!="undefined"&&_Ewa.ULSError.sendErrorTraceTag(e.message,e.stack,null,0,0);throw e;}