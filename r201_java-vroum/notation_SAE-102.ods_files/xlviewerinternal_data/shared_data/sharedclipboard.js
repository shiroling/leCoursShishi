var sharedClipboard=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(5);t.utils=n;var o=r(2);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return o.ConsoleLogger}});var i=r(6);t.browserSupport=i;var a=r(7);t.perfWatch=a;var s=r(8);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var l=r(12);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return l.initStopwatchFactory}});var c=r(13);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return c.TelemetryCollector}});var d=r(14);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return d.getNewGuid}});var u=r(15);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return u.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return u.TextAreaInputMode}})},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return l})),r.d(t,"__metadata",(function(){return c})),r.d(t,"__awaiter",(function(){return d})),r.d(t,"__generator",(function(){return u})),r.d(t,"__createBinding",(function(){return g})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return f})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return m})),r.d(t,"__spreadArrays",(function(){return S})),r.d(t,"__spreadArray",(function(){return w})),r.d(t,"__await",(function(){return y})),r.d(t,"__asyncGenerator",(function(){return v})),r.d(t,"__asyncDelegator",(function(){return C})),r.d(t,"__asyncValues",(function(){return b})),r.d(t,"__makeTemplateObject",(function(){return E})),r.d(t,"__importStar",(function(){return L})),r.d(t,"__importDefault",(function(){return _})),r.d(t,"__classPrivateFieldGet",(function(){return I})),r.d(t,"__classPrivateFieldSet",(function(){return P}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function l(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var g=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function S(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function w(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof y?Promise.resolve(r.value.v).then(l,c):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function l(e){s("next",e)}function c(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function C(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function b(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var T=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function L(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return T(t,e),t}function _(e){return e&&e.__esModule?e:{default:e}}function I(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function P(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,o){return t.traceTag(e,r,n,o)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,o){return t.debugTraceTag(e,r,n,o)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,o){return t.assertTag(e,r,n,o)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,o){return t.shipAssertTag(e,r,n,o)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,o){return t.dnmTraceTag(e,r,n,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=o},function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"sharedClipboardSettingsVariableName",(function(){return U})),r.d(n,"defaultPromiseTimeoutInMinutes",(function(){return j})),r.d(n,"getSharedClipboardSettings",(function(){return F})),r.d(n,"initializeSharedClipboardSettingsFromWindow",(function(){return N})),r.d(n,"initializeSharedClipboardSettings",(function(){return J})),r.d(n,"createEmptySharedClipboardSettings",(function(){return z}));var o,i=r(0);function a(){return o}function s(e){if(!e)throw new Error("The 'logger' argument is missing");o=i.ULS.getFromExternalLogger(e)}var l,c,d,u,g,p=r(1);!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(c||(c={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(u||(u={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var f=function(e){function t(r,n,o){var s=this,l=t.augmentParameterValue(r);if((s=e.call(this,l)||this).name=t.augmentParameterValue(n),s.errorName=s.name,s.name?a().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+s.name+"': "+l):a().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+l),o){s.innerError=o;var c=s.innerError.message;c||(c=s.innerError.name);var d=t.augmentParameterValue(c);d.length>0&&a().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+d)}return s.stack||(s.stack=(new Error).stack),s}return Object(p.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),h=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(p.__extends)(t,e),t}(f),m=function(e){function t(r,n,o){var i=this,a=f.augmentParameterValue(n),s=t.getDefaultMessage(a),l=f.augmentParameterValue(r);return 0===l.length&&(l=s),(i=e.call(this,l,"MissingArgumentError",o)||this).name=a,i}return Object(p.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(f),S=function(e){function t(r,n,o,i){var a=this,s=f.augmentParameterValue(n),l=o;l||(l="");var c=t.getDefaultMessage(s,l),d=f.augmentParameterValue(r);return 0===r.length&&(d=c),(a=e.call(this,d,"InvalidArgumentError",i)||this).name=s,a.value=l,a}return Object(p.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(f),w=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(p.__extends)(t,e),t}(f);(function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}Object(p.__extends)(t,e)})(f),function(e){function t(t,r,n,o,i){return e.call(this,t+". Data version: "+r+", Infra version: "+n+", blockMismatchDataVersion: "+o,"MismatchVersionError",i)||this}Object(p.__extends)(t,e)}(f),function(e){function t(t,r,n,o){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+n,"TTLClipboardDataError",o)||this}Object(p.__extends)(t,e)}(f),function(e){function t(t,r,n,o){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+n,"UserHashMismatchError",o)||this}Object(p.__extends)(t,e)}(f),function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}Object(p.__extends)(t,e)}(f);function y(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var v=function(e){function t(t,r,n,o,i){var a=e.call(this,r||"reason="+t,n,o)||this;return a.reason=t,i&&(a.errorName=i),a}return Object(p.__extends)(t,e),t}(f),C=(function(e){function t(t,r,n){return e.call(this,t,r,"CopyError",n,y(t,d))||this}Object(p.__extends)(t,e)}(v),function(e){function t(t,r,n){return e.call(this,t,r,"PasteError",n,y(t,u))||this}Object(p.__extends)(t,e)}(v),function(e){function t(t,r,n){return e.call(this,t,r,"CancelError",n,y(t,g))||this}Object(p.__extends)(t,e)}(v),function(e){function t(t,r,n){return e.call(this,t,r,"ClipboardPlatformError",n,y(t,c))||this}return Object(p.__extends)(t,e),t}(v));!function(e){function t(t,r,n){return e.call(this,t,r,"SharedClipboardError",n,y(t,c))||this}Object(p.__extends)(t,e)}(v);new RegExp("(\\bTrident/| MSIE )"),new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");var b={postMessage:function(e,t,r,n){e.postMessage(t,r,n)}};var E,T,L,_,I=(E={items:{}},{getData:function(){return E},getItem:function(e){},setItem:function(e,t){throw new w("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":"")+"empty)")},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return W(void 0)}});function P(){return I}function A(e){return e&&e.items?Object.keys(e.items).length:0}function M(e){return A(e&&e.getData())}function x(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return O(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new m("","clipboardItemsData");if(!e.items)throw new S("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return W(t)}}}function O(e,t){if(!e)throw new m("","clipboardItemsData");if(!e.items)throw new S("","clipboardItemsData.items");return e.items[t]}function W(e){var t=[];if(0===A(e))return t;for(var r in e.items){var n=O(e,r);n||(n="");var o={clipboardDataFormat:r,data:n,deferred:!1};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(T||(T={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(L||(L={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(_||(_={}));var U="sharedClipboardSettings",R=z(),D=!1,j=2;function F(){if(!D)throw new w("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return R}function N(){D=!1,function(){if(!window||!(U in window))return R=z(),void(D=!0);var e=window[U];if(!e||"object"!=typeof e)return R=z(),void(D=!0);H(e)}()}function J(e){D=!1,H(e)}function H(e){if(!e)throw new m("","sharedClipboardSettingsCandidate");var t=z();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return R=t,void(D=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),R=t,void(D=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,n=r.indexOf("-");n>=0&&(r=r.substr(n+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){a().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return a().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],R=t,void(D=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){a().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return a().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(D=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return a().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(D=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return a().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(D=!0)}t.whitelistOriginComponents=!0,R=t,D=!0}function z(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:j,remoteLoggerPath:""}}var k,V,B=new RegExp("^\\d+$"),K=!1;function G(e){if(!e)throw new m("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new S("Missing protocol","origin",e);if(1===r.length)throw new S("Missing domain","origin",e);if(r.length>2)throw new S("'://' should appear once","origin",e);var n=r[1];if(!n)throw new S("Missing domain","origin",e);if(t=r[0]+"://",!(r=(n=n.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new S("Missing domain","origin",e);if(r.length>2)throw new S("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new S("The last part of the origin should be the domain","origin",e);if(!(r=n.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new S("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new S("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=n=r[0].trim(),2===r.length){var o=r[1].trim(),s=B.exec(o);if(!s||1!==s.length)throw new S("Invalid port number","origin",e);var l=Number(o);if(isNaN(l))throw new S("Invalid port number","origin",e);t+=":"+o}return a().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+t+"'"),t}function q(e){Y();var t,r=G(e),n=G((t="",window&&window.location&&window.location.origin?(t=window.location.origin)||(t=""):(a().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(t=window.location.protocol+"//"+window.location.hostname,window.location.origin=t)),{origin:t}).origin);if(r===n)return r;if(!F().whitelistOriginComponents)throw new w("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+n+"'");var o=Q(r),s=Q(n);if(o.protocol!==s.protocol)throw new w("validateRemoteWindowOrigin: Caller origin's protocol '"+o.protocol+"' doesn't match the current window origin's protocol '"+s.protocol+"'");if(o.environment!==s.environment)throw new w("validateRemoteWindowOrigin: Caller origin's environment '"+o.environment+"' doesn't match the current window origin's environment '"+s.environment+"'");return r}function Q(e){Y();var t=e.split("://",2),r=t[0],n=X(t[1]),o={protocol:r};if(o.environment=$(e,n,V),n.length<=o.environment.length+1)throw new S("Missing app component","origin",e);if("."!==n.charAt(o.environment.length))throw new S("Missing a domain separator after the environment component","origin",e);var i=n.substr(o.environment.length+".".length);if(o.app=$(e,i,k),o.app.length<i.length&&"-"!==i.charAt(o.app.length))throw new S("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return o}function X(e){if(!e)throw new m("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function $(e,t,r){if(!t)throw new m("","reversedValidatedHostname");if(!r)throw new m("","reversedStringsToLengthMap");var n=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=n&&t.substr(0,o)===e}));if(o&&o.length>0)return X(o[0]);throw new S("Invalid origin","validatedOrigin",e)}function Y(){if(!K){var e=F();e.whitelistOriginComponents&&(k=Z(e.sharedClipboardHostingApps),V=Z(e.sharedClipboardHostingEnvironments),K=!0)}}function Z(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[X(e)]=e.length})),t):t}function ee(){return re()}function te(e){if(!e)throw new m("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new S("","id");return t}function re(){return(Math.random()+1).toString(36).substring(7)}var ne=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function oe(e){return"get"===e||"set"===e||"init"===e}var ie=function(e){if(!e)throw new m("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new m("","id");if(!e.operationCode)throw new m("","operationCode");if(!e.destination)throw new m("","destination");if(!oe(e.operationCode))throw new S("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function ae(e,t,r,n,o){var i={id:e,operationCode:t,failed:r,error:n,clipboardItemsData:o};return se(i),i}var se=function(e){if(!e)throw new m("","clipboardOperationResultMessage");if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5551760_FixTag99sq1Spike2")){for(var t=!1,r=0,n=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<n.length;r++){var o=n[r];if(e.hasOwnProperty(o)){t=!0;break}}if(!t)throw new h("clipboardOperationResultMessage has no valid key")}if(!e.id||0===e.id.trim().length)throw Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5323309_LogsToInvestigate99sq1Spike")?a().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: "+JSON.stringify(Object.keys(e))+", isConstructorObject: "+(e.constructor===Object)+", operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."):a().ULS.traceTag(560562970,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Missing argument 'id'. operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."),new m("","id");if(!e.operationCode)throw new m("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new S("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new S("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new S("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new S("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new S("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new S("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function le(e){if(!e||0===e.trim().length)throw new S("","className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&a().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new w(r(e))}}}()}var ce=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=le(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,a().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)}),(function(e){return a().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new C(c.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new C(c.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new C(c.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new C(c.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(P(),e):(a().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new C(c.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new C(c.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),de=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ue(e){var t=e;return t&&0!==t.trim().length||(t=ee()),new he(t)}function ge(){return de?window.performance.now():Date.now()}function pe(e){return de?new Date(e+window.performance.timing.navigationStart):new Date(e)}function fe(e,t,r){if(!r)throw new m("","creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":ge()-r)+"ms"}var he=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=te(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=ge(),a().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+pe(this.creationTimestamp)),this.promise=new Promise((function(e,t){a().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+pe(ge())),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=ge(),a().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+fe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return a().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&a().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+pe(this.fulfillmentTimestamp)+". "+fe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();!function(){function e(){this.deferredResultMessagePromiseCache={}}e.prototype.getDeferredPromise=function(e){var t=te(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return a().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;a().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=ue(e);if(this.getDeferredPromise(t.id))throw new S("A deferred promise already exists in the cache for the specified id","id",t.id);var r=te(t.id);return this.deferredResultMessagePromiseCache[r]=t,a().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=te(e);delete this.deferredResultMessagePromiseCache[t],a().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else a().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(a().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){a().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}}}();function me(e){if(!e)throw new m("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new m("","incomingMessage");if(!t)throw new m("","validator");if(0===e.length)throw new S("An empty message is invalid","incomingMessage");var r,n=e.trim();if(0===n.length)throw new S("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(n)}catch(t){throw new S("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new S("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function Se(e){if(!e)throw new m("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new m("","outgoingMessage");if(!t)throw new m("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new S("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return a().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function we(e){if(!e)throw new m("","remoteWindow");if(!("window"in e)||!e.window)throw new m("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new m("","remoteWindow.windowOrigin");var t=q(e.windowOrigin);return{window:e.window,windowOrigin:t}}var ye=function(){function e(e,t,r,n){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=le(n)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(!function(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new w(e.message,e))}else a().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")})),r)throw r}else a().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new m("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new w(t)}this.sender.postMessage(e)},e}();function ve(){return Ce}var Ce={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};var be=function(){function e(e,t,r){var n=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return n.onMessageReceived(e)},!e)throw new m("","deserializer");if(!t)throw new m("","handler");if(!r)throw new m("","windowRPC");this.disposableImplementationExtension=le("WindowRPCReceiverInternal"),this.remoteWindow=we(r.remoteWindow),ve().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(ve().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5405878_LogsToInvestigate99sq1Spike2")&&a().ULS.traceTag(544609310,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"this.remoteWindow.window is "+(this.remoteWindow.window?"defined":"not defined")+"."),this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(e)}catch(e){a().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){a().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}))}catch(e){a().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else a().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();var Ee=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new m("","serializer");if(!t)throw new m("","windowRPC");this.disposableImplementationExtension=le("WindowRPCSenderInternal"),this.remoteWindow=we(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new m("","outgoingMessage");if(!this.remoteWindow.window)throw new w("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new w("The remote window does not support postMessage");var t=this.serializer.serialize(e);b.postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Te(e){return"OfficeOnlineCCP_Metadata_"+e}var Le;!function(){function e(){this.startTime=i.perfWatch.timeStamp()}e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: "+e+", pasteId: "+this.id+", timeMS: "+t.toFixed()}}();!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Le||(Le={}));var _e=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new C(c.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new C(c.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=T.LocalStorage,this.disposableImplementationExtension=le("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='"+(e?e.id:"")+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(P());try{var r=JSON.parse(t);if(!r||0===A(r))return Promise.resolve(P());var n=x(r);return Promise.resolve(n)}catch(e){return Promise.resolve(P())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+M(e)+"'; commandParameters.id='"+(t?t.id:"")+"'"),0===M(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=this.localStorageKey+"_LocalStorageChangedFlag",n=ee();return a().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+n),localStorage.setItem(r,n),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Ie(e){return a().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+l.LocalStorage+"' with localStorageKey: '"+e+"'"),(new Pe).initialize(function(e){try{a().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+T.LocalStorage+"'");var t=new _e(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}var Pe=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(p.__extends)(t,e),t}(ce),Ae=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;a().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),a().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),a().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){a().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return a().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),a().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)}),(function(e){a().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return a().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(a().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return a().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=ue(),n=new Date,o=setInterval((function(){var s=(new Date).getTime()-n.getTime();a().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+n+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(o),a().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+n+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):s>e&&(clearInterval(o),a().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+n+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())}),200);return r.promise},e}();new RegExp("(\n\r)|(\r\n)|(\r)","g"),new RegExp("(\t)","g"),new RegExp("<","g"),new RegExp(">","g");var Me,xe=r(2);function Oe(e,t,r){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,r){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}(e,t,r)}}function We(e,t,r,n){var o=[],i=e.map((function(e){return function(e,t,r){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=r.findIndex((function(t){return t===e.correlationId}));o<0&&(o=r.push(e.correlationId)-1),n.I=o}var i=1e3*e.type+e.level;return n.D=i,n}(e,n,o)})),a=function(e,t,r,n,o){var i={};i.T=e,i.L=t,i.S=r,i.I=n,o&&o.length>0&&(i.W=o);return i.V=1,i}(n,i,t,r,o);return JSON.stringify(a)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(Me||(Me={}));var Ue;!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(Ue||(Ue={}));var Re=function(){function e(t,r){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,r){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,Oe(We(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,r),n.logCache=[],n.timestampBase=Date.now());t&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=r+"?usid="+t,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===Ue.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}();!function(){function e(e,t){this.correlationId="",this.cache=new Re(e,t)}e.prototype.setCorrelationId=function(e){this.correlationId=e},e.prototype.sendTraceTag=function(e,t,r,n){De(this.cache,e,t,r,n,this.correlationId)},e.prototype.debugAssertTag=function(e,t,r,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},e.prototype.shipAssertTag=function(e,t,r,n){r&&De(this.cache,e,t,Ue.Error,n,this.correlationId)},e.prototype.flush=function(){this.cache.flush()},e.prototype.flushOnClose=function(){this.cache.flushOnClose}}();function De(e,t,r,n,o,i){if(!(n>Ue.Info)){var a={timestamp:Date.now(),category:r,tag:t,level:n,type:Me.Trace,message:o,correlationId:i};e.handleTrace(a)}}function je(e,t){var r=function(e,t){var r=new Re(e,t);return{sendTraceTag:function(e,t,n,o){return De(r,e,t,n,o,"")},shipAssertTag:function(e,t,n,o){n&&De(r,e,t,Ue.Error,o,"")},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose,setCorrelationId:function(){}}}(t,e);return{assertTag:function(e,t,n,o){return r.shipAssertTag(e,t,!n,o)},shipAssertTag:function(e,t,n,o){return r.shipAssertTag(e,t,!n,o)},debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}var Fe=function(e){function t(t){var r=e.call(this)||this;return r.clipboardStrategy=t,r.nameForTelemetry="ClipboardStrategyMessageHandler_StrategyType_"+t.clipboardStrategyType,r.addMessageHandler("get",{handleMessage:r.get.bind(r)}),r.addMessageHandler("set",{handleMessage:r.set.bind(r)}),r}return Object(p.__extends)(t,e),t.prototype.get=function(e,t){var r={userHash:e.userHash};return this.clipboardStrategy.get(r).then((function(e){return t.clipboardItemsData=e.getData(),Promise.resolve(t)}),(function(e){return Ne(t,e)}))},t.prototype.set=function(e,t){var r={userHash:e.userHash},n=void 0;return e.clipboardItemsData&&(n=e.clipboardItemsData),this.clipboardStrategy.set(x(n),r).then((function(){return Promise.resolve(t)}),(function(e){return Ne(t,e)}))},t}(function(){function e(){this._handlers={}}return e.prototype.handleMessage=function(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):Ne(t,new C(c.UnsupportedOperationCode,"Operation code '"+(e?e.operationCode:"incomingMessage is null")+"' is unsupported"))},e.prototype.addMessageHandler=function(e,t){e?e in this._handlers?a().ULS.shipAssertTag(595944464,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: handle for operation: "+e+" already exist"):this._handlers[e]=t:a().ULS.shipAssertTag(595944463,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")},e}());function Ne(e,t){return Je(e,t),Promise.resolve(e)}function Je(e,t){e.failed=!0,e.error=i.utils.getStringifiedError(t)}var He=function(e){function t(t,r,n,o){var i=e.call(this,r,t,n,"WindowRPCServerInternal")||this;if(i.windowRPCServerState=o,!o)throw new C(c.CreateWindowRPCServer,"windowRPCServerState is undefined.");return i.receiver=function(e,t,r){return new be(e,t,r)}(t,i,i),i.sender=function(e,t){return new Ee(e,t)}(r,i),i}return Object(p.__extends)(t,e),t.prototype.handleMessage=function(e){var t=this;if(a().ULS.traceTag(596452360,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"RPC Server - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.clipboardItems.length="+A(e&&e.clipboardItemsData)),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();var r=e&&e.id?e.id:"unknownmessageid",n=!e||!e.operationCode||!oe(e.operationCode),o={id:r,failed:n,error:void 0,operationCode:n?"unknownresult":e.operationCode+"result"};return this.routeOperation(e,o).then((function(e){return t.postMessage(e)})).catch((function(e){return a().ULS.traceTag(596452182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. "+i.utils.getStringifiedError(e)),o.clipboardItemsData=void 0,Je(o,e),t.postMessage(o)})).catch((function(e){return a().ULS.traceTag(596452183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},t.prototype.routeOperation=function(e,t){if(this.windowRPCServerState.isInitializationPending())return Ne(t,new C(c.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return Ne(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);var r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):Ne(t,new C(c.SelectClipboardStrategy,"messageHandler does not exist"))},t.prototype.handleDeserializationError=function(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:i.utils.getStringifiedError(e),operationCode:"unknownresult"}).catch((function(e){a().ULS.traceTag(596451867,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. "+i.utils.getStringifiedError(e))}))},t.prototype.postMessage=function(t){try{return e.prototype.postMessage.call(this,t),Promise.resolve()}catch(e){return Promise.reject(new w("Unable to post message for operation '"+(t&&t.operationCode?t.operationCode:"")+"'",e))}},t}(ye),ze=function(e){function t(t,r,n){var o=e.call(this,n,"getMetadata_longPollingresult")||this;return o.localStorageKeyChangeTracker=new Ae(r,t,o.raiseMetadataChangedEvent.bind(o)),o}return Object(p.__extends)(t,e),t.prototype.raiseMetadataChangedEvent=function(e){this.sendMessage(e.getData())},t}(function(){function e(e,t){this.windowRPCServer=e,this.operationCode=t}return e.prototype.sendMessage=function(e){if(this.windowRPCServer){var t=ae(ee(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}},e}());function ke(e,t){if(!t)return Promise.resolve(!1);var r=function(e,t){try{var r=window.parent,n=e;if(!n)throw new m("remoteWindowOrigin is undefined","remoteWindowOrigin");return new He(me(ie),Se(se),{window:r,windowOrigin:n},t)}catch(e){return void a().ULS.shipAssertTag(595981475,i.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: "+i.utils.getStringifiedError(e))}}(e,Ve);if(!r)return a().ULS.traceTag(595947554,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);var n=ue("initmessageid");return(Be={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:n,windowRPCServer:r}).initializationDeferredPromise.promise.then((function(){return function(){var e=Ge();if(a().ULS.shipAssertTag(595947555,i.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new w("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));var t=ae(qe(),"initresult",!1);return e.postMessage(t)}()}),(function(e){return function(e){var t=Ge();if(a().ULS.shipAssertTag(595947584,i.LogCategory.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new w("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));var r=ae(qe(),"initresult",!0,i.utils.getStringifiedError(e));return t.postMessage(r)}(e)})).catch((function(){})),t.then((function(e){return Be&&(Be.metadataDataChangedMessageSender=new ze(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){var t=Object.keys(e).map((function(t){return"Name: "+t+", handlerName: "+(e[t]&&e[t].nameForTelemetry)})).join(", ");if(a().ULS.traceTag(595947585,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"markInitializationSuccess: Created and initialized ClipboardStrategies '"+t+"'"),a().ULS.shipAssertTag(595947586,i.LogCategory.msoulscat_ES_EWAJS,!!Be,"markInitializationSuccess: windowRPCServerInternalState must be defined"),!Be)return;Be.clipboardOperationMessageHandlerMap=e,Be.clipboardInitError=void 0,Be.clipboardInitTimestamp=Date.now(),Be.initializationDeferredPromise&&Be.initializationDeferredPromise.resolve()}(e.messageHandlers),Promise.resolve(!0)}),(function(e){return function(e){if(a().ULS.traceTag(595947587,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,i.LogCategory.msoulscat_ES_EWAJS,!!Be,"markInitializationFailure: windowRPCServerInternalState must be defined"),!Be)return;Be.clipboardOperationMessageHandlerMap=void 0,Be.clipboardInitError=e,Be.clipboardInitTimestamp=Date.now(),Be.initializationDeferredPromise&&Be.initializationDeferredPromise.reject(Be.clipboardInitError)}(e),Promise.resolve(!1)}))}var Ve={getMessageHandler:function(e){if(!Be)return;if(!e)return void a().ULS.shipAssertTag(595945235,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined");if(!Be.clipboardOperationMessageHandlerMap)return void a().ULS.shipAssertTag(595945236,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");if(!(e in Be.clipboardOperationMessageHandlerMap))return void a().ULS.shipAssertTag(595945237,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: "+e+" is not part of ClipboardStrategyMap");return Be.clipboardOperationMessageHandlerMap[e]},isInitializationPending:Ke,isInitializedSuccessfully:function(){if(Be)return!Ke()&&!!Be.clipboardOperationMessageHandlerMap;return!1},getClipboardInitError:function(){if(Be)return Be.clipboardInitError;return}},Be=void 0;function Ke(){return!Be||!Be.initializationDeferredPromise||!Be.initializationDeferredPromise.fulfilled()}function Ge(){if(Be)return Be.windowRPCServer}function qe(){if(!Be)return"";var e=Be.initMessageIdUniqueRunningSuffix;return Be.initMessageIdUniqueRunningSuffix+=1,"initmessageid"+e}function Qe(e){return-1===decodeURIComponent(window.location.href).indexOf(e)}function Xe(){s(new xe.ConsoleLogger),Object(i.initEwaUtils)({isChangeGateEnabled:Qe}),n.initializeSharedClipboardSettingsFromWindow();var e=i.utils.getQueryParameterByName(window.location.href,"CreatorOrigin")||"";if(!e)throw new m("remoteWindowOrigin is undefined","remoteWindowOrigin");e=q(e);try{var t=i.utils.getQueryParameterByName(window.location.href,"usid")||"",r=n.getSharedClipboardSettings().remoteLoggerPath;if(r&&t)s(je(""+e+r,t))}catch(e){}var o=n.getSharedClipboardSettings().sharedClipboardSchemaVersion;return ke(e,Ie(function(e){return"OfficeOnlineCCP_Data_"+e}(o)).then((function(e){var t=Te(o),r=function(e){return Te(e)+"_LocalStorageChangedFlag"}(o);return Ie(t).then((function(t){var n={};return n[ne.localStorageData]=new Fe(e),n[ne.localStorageMetadata]=new Fe(t),{messageHandlers:n,localStorageMetadataKeyToWatch:r,dataClipboardStrategy:e,metadataClipboardStrategy:t}}))})))}r.d(t,"a",(function(){return Xe}))},function(e,t,r){"use strict";r.r(t);var n=r(0);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);var i=r(3);r.d(t,"initialize",(function(){return i.a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)n(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var o=e[n];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)n(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,o=0;o<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==n-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,o=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(n=i.offset,o=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(n=i.startOffset,o=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;o=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(o),a.setEndPoint("EndToStart",i),n=a.text.length}catch(e){return n}if(r)for(var s=!1;null!=o;)null===o.previousSibling&&null!==o.parentNode&&null!==o.parentNode.parentNode&&o.parentNode.parentNode.childNodes.length>1&&!s?(o=o.parentNode,s=!0):null!=(o=o.previousSibling)&&null!=o.textContent&&(n+=o.textContent.length,s&&(n+=1));else for(;null!=o;)null!=(o=o.previousSibling)&&null!=o.textContent&&(n+=o.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function o(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,a=0;a<i.length&&t>=0;a+=1)t=o(i[a],t,r),n&&"DIV"===i[a].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var i=document.createRange();return o(e,t,(function(e,t){return i.setStart(e,t)})),o(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,i=t,a={},s=function(e,t,n){return function(e,t,r,n,i,a){o(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:a,marks:e},l=JSON.stringify(s);i(l)}(a,r,i,e,t,n)};return a.start=0,{mark:function(e){return function(e){return o(a,e,i)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(9),o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n.setChangeGatesManager({isChangeGateEnabled:e.isChangeGateEnabled}),o=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){n=e};t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var o=n(),i=r;return{reset:function(e){null!=e&&(i=e),o=n()},stop:function(r){var a=n()-o,s=JSON.stringify({Target:i,Duration:a.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var o=!1,i=r.performance;try{i&&i.now&&i.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(o){t.perfNow=!0;var s=Math.floor(100*i.now())%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))}]);
//# sourceMappingURL=sharedClipboard.min.js.map