var copyPasteInfra=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=349)}({1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var o=r(76);t.utils=o;var n=r(67);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return n.ConsoleLogger}});var a=r(84);t.browserSupport=a;var i=r(85);t.perfWatch=i;var s=r(94);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var c=r(98);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return c.initStopwatchFactory}});var l=r(99);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return l.TelemetryCollector}});var d=r(100);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return d.getNewGuid}});var u=r(101);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return u.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return u.TextAreaInputMode}})},100:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,o=r.crypto||r.msCrypto;if(o){t.crypto=!0;try{return o.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,a=r.performance;try{a&&a.now&&a.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var i=0;i<e.length;i+=1){try{if(n){t.perfNow=!0;var s=Math.floor(100*a.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},101:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},349:function(e,t,r){"use strict";r.r(t);var o=r(4),n=r(8),a=r(1);function i(e){return e?navigator.clipboard.read({unsanitized:e}):navigator.clipboard.read()}function s(e,t,r,o){return o&&Object(a.initEwaUtils)(o),new c(e,t,r)}var c=function(){function e(e,t,r){if(this.clipboardPlatformEnvironment=e,this.applicationHost=t,this.inProgressCopyContext=void 0,this.deferredPasteData=void 0,!r)throw new o.B(o.jb,"logger");Object(o.Eb)(r),Object(o.fc)().ULS.shipAssertTag(596456157,a.LogCategory.msoulscat_ES_EWAJS,!!e,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'clipboardPlatformEnvironment' argument"),Object(o.fc)().ULS.shipAssertTag(596456158,a.LogCategory.msoulscat_ES_EWAJS,!!t,"CopyPasteInfra.copyPasteFlowManager.ctor: missing 'applicationHost' argument"),this.metadataManager=e.getMetadataManager(),this.metadataManager.addMetadataChangeListener("CopyPasteFlowManagerOnMetadataChangedListener",this.onMetadataChanged.bind(this)),Object(o.fc)().ULS.shipAssertTag(596456156,a.LogCategory.msoulscat_ES_EWAJS,!!this.metadataManager,"CopyPasteInfra.copyPasteFlowManager.ctor: metadataManager is not valid")}return Object.defineProperty(e.prototype,"clipboardStrategy",{get:function(){if(this.clipboardPlatformEnvironment)return this.clipboardPlatformEnvironment.getClipboardStrategy();throw new o.u("clipboardPlatformEnvironment is missing")},enumerable:!1,configurable:!0}),e.prototype.onCopy=function(e){var t,r,n=this;if(!e)return Promise.reject(new o.m(o.n.MissingArgumentError,"Missing commandParameters argument",new o.B(o.jb,"commandParameters")));t=new o.l;try{t.id=Object(o.U)(),Object(o.fc)().ULS.traceTag(595937123,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: copy "+t.id+" started."),t.sessionId=this.applicationHost.getSessionId(),t.commandParameters=e;var i=this.getCopyFlowHandler(t);t.sourceItem=this.getSourceItem(i,t),this.clearInProgressCopyIfNeeded(t),this.inProgressCopyContext=t,r=this.serialize(i,t),Object(o.fc)().ULS.traceTag(595937152,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"CopyPasteFlowManager.onCopy: updating metadata for copy id "+t.id+" after serialize."),this.metadataManager.updateMetadata({lastCopy:t})}catch(r){return t?Object(o.fc)().ULS.traceTag(595734742,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: catching error for copy id "+t.id+" during serialize."):Object(o.fc)().ULS.traceTag(595734743,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopy: catching error and no copy context during serialize."),this.copyCompleteCleanup(t,e),Promise.reject(r)}try{return Promise.all([this.setClipboardSync(r.synchronousResult,e,t).then((function(){return n.rejectIfCopyCancelled(t)})).then((function(){t.copyStatus=o.o.SynchronousPhaseCompleted,Object(o.fc)().ULS.traceTag(595937153,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: updating metadata for copy id "+t.id+" after status changed to SynchronousPhaseCompleted."),n.metadataManager.updateMetadata({lastCopy:t})})).catch((function(e){if(t?Object(o.fc)().ULS.traceTag(595734744,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: catch error for copy id "+t.id+"."):Object(o.fc)().ULS.traceTag(595734745,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopy: no copy context."),e&&e.reason){var r=e.reason;if(r===o.n.SuccessiveCutCopyOverridingPendingCutCopy||r===o.n.BlockedSynchronousCutCopy||r===o.n.CopyOperationCancelled)return Object(o.fc)().ULS.traceTag(595734746,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Rejecting the promise: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(e)}return Object(o.fc)().ULS.traceTag(596456159,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: synchronous copy failed to populate the clipboard. Ignoring this failure since the active selection will allow for the required functionality: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),n.metadataManager.updateMetadata({lastCopy:t}),Promise.resolve()})),this.rejectIfCopyCancelled(t).then((function(){return n.setClipboardAsync(r.asynchronousResult,e,t)}))]).then((function(){return n.rejectIfCopyCancelled(t)})).then((function(){return n.copyCompleteCleanup(t,e),t}),(function(r){Object(o.fc)().ULS.traceTag(595734747,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopy: got error for copy id "+t.id+".");var i=r;return n.copyCompleteCleanup(t,e),i||(Object(o.fc)().ULS.shipAssertTag(595854806,a.LogCategory.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onCopy: promise rejected without error"),i=new o.m(o.n.UnknownCopyErrorType,"copyPasteFlowManager.onCopy failed without specified error")),i.copyContext=t,Promise.reject(i)}))}catch(r){return this.copyCompleteCleanup(t,e),Object(o.fc)().ULS.traceTag(596456160,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to store content in the clipboard. Exception: "+a.utils.getStringifiedError(r)+". Call stack: "+(r.stack?r.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to store content in the clipboard (with an exception): "+r.message,r))}},e.prototype.shouldShowClipboardReadPermissionDialog=function(){try{if(navigator.permissions){return navigator.permissions.query({name:"clipboard-read",allowWithoutGesture:!0}).then((function(e){return e&&"prompt"===e.state?Promise.resolve(!0):Promise.resolve(!1)}),(function(){return Promise.resolve(!1)}))}return Promise.resolve(!1)}catch(e){return Object(o.fc)().ULS.traceTag(540160579,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.shouldShowDialog: Inside catch block: "+e),Promise.resolve(!1)}},e.prototype.onPaste=function(e){var t=this,r=new o.G;try{if(!e)return Promise.reject(new o.H(o.I.MissingArgumentError,"Missing commandParameters argument",new o.B(o.jb,"commandParameters")));e.isTimestampStoredInSystemClipboard=!0,r.id=Object(o.bb)(),r.sessionId=this.applicationHost.getSessionId(),r.commandParameters=e,r.clipboardItems=Object(o.sb)(),r.isClipboardInaccessible=!1,Object(o.fc)().ULS.traceTag(595685636,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("start"));var n=this.metadataManager.getCachedMetadata();r.copyContextSnapshot=n.lastCopy,this.applicationHost.initializePasteContext(r),r.copyContextSnapshot?Object(o.fc)().ULS.traceTag(595937154,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: paste started for copy id "+r.copyContextSnapshot.id):Object(o.fc)().ULS.traceTag(595730637,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: paste started and copy context is null");var i=void 0;if(e.skipClipboardAccess)Object(o.fc)().ULS.traceTag(595685637,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("skipClipboardAccess")),i=Promise.resolve();else if(navigator.clipboard&&e&&e.clipboardAsyncApiDataFormatsToRead){var s=[this.readFromClipboard(r,e),this.getAsyncApiReadPromise()];i=Promise.all(s).then((function(e){Object(o.fc)().ULS.traceTag(539354334,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: All clipboard read promises have resolved"),r.clipboardItems=e[0]}),(function(e){return e&&e.reason&&e.reason===o.I.ClipboardIsInaccessible?(r.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e)}))}else i=this.readFromClipboard(r,e).then((function(n){if((Object(o.fc)().ULS.traceTag(595685638,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("readFromClipboard_then")),r.clipboardItems=n,navigator.clipboard&&e&&!e.skipSystemClipboardAccess&&e.clipboardPicklingApiDataFormatsToRead)&&n.getItem(o.Sb)===o.Ub)return Object(o.fc)().ULS.traceTag(539033689,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: Reading pickled formats in external paste"),t.willClipboardReadPermissionPromptShow().then((function(o){return t.readPickledFormatPromises(r.clipboardItems,e.clipboardPicklingApiDataFormatsToRead,o)}));return Promise.resolve()}),(function(e){return e&&e.reason&&e.reason===o.I.ClipboardIsInaccessible?(r.isClipboardInaccessible=!0,Promise.resolve()):Promise.reject(e)}));return i.then((function(){return t.readClipboardItemsAgainIfMetadataNotSync(r,e)})).then((function(){return Object(o.fc)().ULS.traceTag(595685639,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("getPasteFlowHandler")),t.getPasteFlowHandler(r)})).then((function(e){return e.beforePaste&&e.beforePaste(r),e})).then((function(n){if(Object(o.fc)().ULS.traceTag(595685640,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("getPasteFlowHandler_then")),r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus!==o.o.Completed&&n.shouldWaitForCopyToComplete(r)){Object(o.fc)().ULS.traceTag(595937155,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: pasteFlowHandler ask to waiting for copy ("+r.copyContextSnapshot.id+") to complete. current status "+r.copyContextSnapshot.copyStatus+". copy session id is "+r.copyContextSnapshot.sessionId),Object(o.fc)().ULS.traceTag(595683427,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("onDeferredPasteStarted")),n.onDeferredPasteStarted(r);var i=t.continueWhenCopyComplete(e,r).then((function(e){return Object(o.fc)().ULS.traceTag(595685642,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("onDeferredPasteCompleted")),n.onDeferredPasteCompleted(r),r.copyContextSnapshot=t.metadataManager.getCachedMetadata().lastCopy,r.clipboardItems=e,n}),(function(e){return n.onDeferredPasteCompleted(r),Object(o.fc)().ULS.traceTag(595882504,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteFlowManager.onPaste: got error while wait for deferred paste to complete. error: ["+e+"]"),Promise.reject(e)}));return Object(o.fc)().ULS.traceTag(595685643,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("continueWhenCopyComplete")),t.testHook("continueWhenCopyComplete"),i}return Object(o.fc)().ULS.traceTag(595940941,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onPaste: not wait for copy("+(r.copyContextSnapshot&&r.copyContextSnapshot.id)+") to complete. is copyContextSnapshot defined: "+(void 0!==r.copyContextSnapshot)+". copyStatus: "+(r.copyContextSnapshot&&r.copyContextSnapshot.copyStatus)),n})).then((function(e){return t.deserialize(e,r)})).then((function(){Object(o.fc)().ULS.traceTag(595685644,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("deserialize_then")),r.clipboardItems&&r.clipboardItems.getItem(o.Sb)===o.Ub&&(Object(o.fc)().ULS.traceTag(595685645,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r.profilingMessage("onSystemClipboardChangedExternally")),t.onSystemClipboardChangedExternally())})).then((function(){var e=r.clipboardItems;if(void 0!==e){var t=e.getItem(o.ec);if(void 0!==t){var n=o.Bb.getExternalSource(t);void 0!==n&&(r.externalAppSource=n)}}})).then((function(){return r})).catch((function(e){var t=e;return t||(Object(o.fc)().ULS.shipAssertTag(595858762,a.LogCategory.msoulscat_ES_EWAJS,!1,"copyPasteFlowManager.onPaste: promise rejected without error"),t=new o.H(o.I.UnknownPasteError,"copyPasteFlowManager.onPaste failed without specified error")),t.pasteContext=r,Promise.reject(t)}))}catch(e){return Object(o.fc)().ULS.shipAssertTag(596456161,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Exception: "+a.utils.getStringifiedError(e)),Promise.reject(new o.H(o.I.FailedToReadFromClipboard,"Failed to read data from the clipboard (with an exception): "+e.message,e,r))}},e.prototype.willClipboardReadPermissionPromptShow=function(){try{if(navigator.permissions){return navigator.permissions.query({name:"clipboard-read",allowWithoutGesture:!0}).then((function(e){return e&&"prompt"===e.state?Promise.resolve(!0):Promise.resolve(!1)}),(function(){return Promise.resolve(!1)}))}return Promise.resolve(!1)}catch(e){return Object(o.fc)().ULS.traceTag(539009885,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.willClipboardReadPermissionPromptShow: In catch block: "+e),Promise.resolve(!1)}},e.prototype.readPickledFormatPromises=function(e,t,r){if(void 0===e||void 0===t)return Promise.resolve();var n=window.performance.now();try{var s=[],c=i(t);return t.forEach((function(t){var i=c.then((function(e){return e[0].getType(t)})).then((function(e){return e.text()})).then((function(i){var s=(window.performance.now()-n).toFixed(3).toString();return Object(o.fc)().ULS.traceTag(539033690,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.readPickledFormatPromises: Format:"+t+" read successfully; TimeInMs="+s+",PromptShown="+r),e.setItem(t,i),Promise.resolve()}),(function(e){var i=(window.performance.now()-n).toFixed(3).toString();return Object(o.fc)().ULS.traceTag(539033691,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.readPickledFormatPromises: Format:"+t+": Promise rejected:"+e+"; TimeInMs="+i+",PromptShown="+r),Promise.resolve()})).catch((function(e){var i=(window.performance.now()-n).toFixed(3).toString();return Object(o.fc)().ULS.traceTag(539033692,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.readPickledFormatPromises: Format:"+t+": Inside catch block:"+e+"; TimeInMs="+i+",PromptShown="+r),Promise.resolve()}));s.push(i)})),Promise.all(s).then((function(){return Promise.resolve()}),(function(){return Promise.resolve()}))}catch(e){return Object(o.fc)().ULS.traceTag(539033693,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.readPickledFormatPromises: Outer catch block exception = "+e),Promise.resolve()}},e.prototype.getAsyncApiReadPromise=function(){try{return i().then((function(e){return e[0].getType("text/plain")})).then((function(e){return e.text()})).then((function(){return Object(o.fc)().ULS.traceTag(539354335,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.getAsyncApiReadPromise: Text read successfully from clipboard"),Promise.resolve()})).catch((function(e){return Object(o.fc)().ULS.traceTag(539354336,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.getAsyncApiReadPromise: navigator.clipboard.read() threw an exception: "+e),Promise.resolve()}))}catch(e){return Object(o.fc)().ULS.traceTag(539354337,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.getAsyncApiReadPromise: In outer catch block: "+e),Promise.resolve()}},e.prototype.onCancelCopy=function(e){try{if(this.inProgressCopyContext?(this.inProgressCopyContext.markForCancellation=!0,Object(o.fc)().ULS.traceTag(595734748,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCancelCopy: canceling copy for copy id "+this.inProgressCopyContext.id+".")):Object(o.fc)().ULS.traceTag(595734749,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCancelCopy: no inProgressCopyContext."),!e)return Promise.resolve();this.metadataManager.clear();var t=Object(o.sb)(),r={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:o.r.Copy};return this.clipboardStrategy.set(t,r).catch((function(e){return Object(o.fc)().ULS.traceTag(596456162,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.c(o.d.FailedToClearClipboard,"Failed to clear the clipboard: "+e.message,e))}))}catch(e){return Object(o.fc)().ULS.traceTag(596456163,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCancelCopy: Failed to clear the clipboard. Exception: "+a.utils.getStringifiedError(e)),Promise.reject(new o.c(o.d.FailedToClearClipboard,"Failed to clear the clipboard (with an exception): "+e.message,e))}},e.prototype.onSystemClipboardChangedExternally=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return this.onCancelCopy(!1),this.metadataManager.updateMetadata({lastCopy:void 0}),e={isKeyboardEvent:!1,silentClipboardAccessFailures:!0,commandType:o.r.Copy},[4,this.clipboardStrategy.onSystemClipboardChangedExternally(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.readClipboardItemsAgainIfMetadataNotSync=function(e,t){var r=this,n=!1;return this.metadataManager.getMetadataSyncPromise().then((function(t){t&&t.lastCopy?(e.copyContextSnapshot&&(n=t.lastCopy.id!==e.copyContextSnapshot.id||t.lastCopy.copyStatus!==e.copyContextSnapshot.copyStatus),e.copyContextSnapshot=t.lastCopy,Object(o.fc)().ULS.traceTag(595937158,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata is sync. copy id = "+e.copyContextSnapshot.id+". copy status = "+e.copyContextSnapshot.copyStatus+". isMetadataChanged = "+n)):Object(o.fc)().ULS.traceTag(595937025,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"MetadataManager.readClipboardItemsAgainIfMetadataNotSync: metadata or metadata.lastCopy are not defined. This should be possible only when the last copy was external (i.e. there is no previous copy operation in xlo). do nothing")})).then((function(){return n?r.readRichClipboardOnly(e,t,e.clipboardItems):Promise.resolve(e.clipboardItems)})).then((function(t){return e.clipboardItems=t,e}))},e.prototype.getCopyFlowHandler=function(e){var t;try{t=this.applicationHost.getCopyFlowHandler(e)}catch(e){throw Object(o.fc)().ULS.shipAssertTag(596456192,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.FetchCopyFlowHandlerFailed,"applicationHost.getCopyFlowHandler failed with an exception: "+e.message,e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onCopy: applicationHost.getCopyFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw Object(o.fc)().ULS.shipAssertTag(596456193,a.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.m(o.n.CopyFlowHandlerNotFound,r)}return t},e.prototype.getSourceItem=function(e,t){try{return e.getSourceItem(t)}catch(e){throw Object(o.fc)().ULS.shipAssertTag(596456194,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.getSourceItem failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.FetchSourceItemFailed,"applicationHost.getSourceItem failed with an exception: "+e.message,e)}},e.prototype.serialize=function(e,t){try{e.beforeSerialize(t)}catch(e){throw Object(o.fc)().ULS.shipAssertTag(596456195,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.beforeSerialize failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.BeforeSerializeFailed,"copyFlowHandler.beforeSerialize failed with an exception: "+e.message,e)}var r;try{r=e.serialize(t)}catch(e){throw Object(o.fc)().ULS.shipAssertTag(596456196,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize failed with an exception: "+a.utils.getStringifiedError(e)),new o.m(o.n.SerializeFailed,"copyFlowHandler.serialize failed with an exception: "+e.message,e)}if(!r)throw Object(o.fc)().ULS.shipAssertTag(596456197,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: copyFlowHandler.serialize should return a non null result"),new o.m(o.n.SerializeResultNotValid,"copyFlowHandler.serialize should return a non null result");return r},e.prototype.setClipboardSync=function(e,t,r){try{r?Object(o.fc)().ULS.traceTag(595734750,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardSync: start setClipboardSync for copy id "+r.id+"."):Object(o.fc)().ULS.traceTag(595734751,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.setClipboardSync: no copy context.");var n=e;return n||(n=Object(o.sb)()),this.clipboardStrategy.set(n,t).catch((function(e){if(Object(o.fc)().ULS.traceTag(596456198,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. isKeyboardEvent: "+t.isKeyboardEvent+", Error: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),e&&void 0!==e.reason){var r=e;if(r.reason===o.f.ClipboardIsInaccessible)return Promise.reject(new o.m(o.n.ClipboardIsInaccessible,r.message,r));if(r.reason===o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation)return Promise.reject(new o.m(o.n.SuccessiveCutCopyOverridingPendingCutCopy,"A successive Cut/Copy user event occurred before the last Cut/Copy browser event fired: "+r.message,r));if(r.reason===o.f.RejectingBlockedSyncCutCopyPromise)return Promise.reject(new o.m(o.n.BlockedSynchronousCutCopy,"In the user Cut/Copy operation, the async part occurred before its predecessor sync Cut/Copy browser event fired: "+r.message,r))}return Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard: "+e.message,e))})).then((function(){r.succeededPopulatingSystemClipboardSync=t.isTimestampStoredInSystemClipboard}))}catch(e){return Object(o.fc)().ULS.shipAssertTag(596456199,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to synchronously store content in the clipboard. Exception: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to synchronously store content in the clipboard (with an exception): "+e.message,e))}},e.prototype.setClipboardAsync=function(e,t,r){var i=this;return Object(o.fc)().ULS.traceTag(595734752,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardAsync: start setClipboardAsync for copy id "+r.id+"."),e?e.then((function(e){try{if(i.isEmptyClipboard(e))return Promise.resolve();var s=t.stopwatch;t.stopwatch=void 0;var c=Object(n.__assign)({},t);return c.isTimestampStoredInSystemClipboard=!1,t.stopwatch=s,t.isKeyboardEvent&&(c.isKeyboardEvent=!1,c.silentClipboardAccessFailures=!0),i.clipboardStrategy.set(e,c).catch((function(e){if((Object(o.fc)().ULS.traceTag(596456200,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),e&&void 0!==e.reason)&&e.reason===o.f.ClipboardIsInaccessible)return Promise.resolve();return Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard: "+(e&&e.message),e))})).then((function(){r.succeededPopulatingSystemClipboardAsync=c.isTimestampStoredInSystemClipboard}))}catch(e){return Object(o.fc)().ULS.shipAssertTag(596456201,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously store content in the clipboard. Exception: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.SaveToTheClipboardFailed,"Failed to asynchronously store content in the clipboard (with an exception): "+e.message,e))}}),(function(e){return r.isAsyncSerializeFailed=!0,Object(o.fc)().ULS.traceTag(596456202,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onCopy: Failed to asynchronously serialize the content - Marking copyContext.isAsyncSerializeFailed as true. Error: "+a.utils.getStringifiedError(e)+". Call stack: "+(e&&e.stack?e.stack:"NA")),Promise.reject(new o.m(o.n.AsyncSerializeFailed,"Failed to asynchronously serialize the content. Error: "+(e?e.message:"..."),e))})):(Object(o.fc)().ULS.traceTag(595734753,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.setClipboardAsync: no clipboardItemsPromise. resolving promise for copy id "+r.id+"."),Promise.resolve())},e.prototype.isEmptyClipboard=function(e){return e?0===Object(o.nb)(e)&&(Object(o.fc)().ULS.traceTag(596456204,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result does not contain items."),!0):(Object(o.fc)().ULS.traceTag(596456203,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onCopy: the async serialization result is undefined."),!0)},e.prototype.readFromClipboard=function(e,t){Object(o.fc)().ULS.traceTag(595685646,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,e.profilingMessage("readFromClipboard")),e.copyContextSnapshot&&(t.isTimestampStoredInSystemClipboard=e.copyContextSnapshot.isTimestampStoredInSystemClipboard);var r=this.clipboardStrategy.get(t);return Object(o.fc)().ULS.traceTag(595685647,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,e.profilingMessage("readFromClipboard_ret")),r?r.then((function(t){return Object(o.fc)().ULS.traceTag(595685648,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,e.profilingMessage("readFromClipboard_then")),t?Promise.resolve(t):(Object(o.fc)().ULS.traceTag(596456206,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. Intercepted a missing clipboard item collection"),Promise.reject(new o.H(o.I.FailedToReadFromClipboard,"Failed to read data from the clipboard. Intercepted a missing clipboard item collection",new o.H(o.I.ClipboardIsEmpty,o.jb))))}),(function(e){if(Object(o.fc)().ULS.traceTag(596456207,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard: "+a.utils.getStringifiedError(e)+". Call stack: "+(e.stack?e.stack:"NA")),t.isPasteCommandFromRecoveryUI&&t.pasteRecoveryCachedClipboardItems)return Object(o.fc)().ULS.traceTag(577249542,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteInfra.copyPasteFlowManager.onPaste: Returning 'pasteRecoveryCachedClipboardItems'"),Promise.resolve(t.pasteRecoveryCachedClipboardItems);var r=e;return Object(o.Gb)(e,o.f.ClipboardIsInaccessible)?Promise.reject(new o.H(o.I.ClipboardIsInaccessible,r.message,r)):Object(o.Gb)(e,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(new o.H(o.I.SuccessivePasteOverridingPendingPaste,"A successive Paste user event occurred before the last Paste browser event fired: "+r.message,r)):Promise.reject(new o.H(o.I.FailedToReadFromClipboard,"Failed to read data from the clipboard: "+e.message,e))})):(Object(o.fc)().ULS.shipAssertTag(596456205,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: Failed to read data from the clipboard. clipboardStrategy.get() did not return an object"),Promise.reject(new o.H(o.I.FailedToReadFromClipboard,"Failed to read data from the clipboard. clipboardStrategy.get() did not return an object",new o.H(o.I.ReadFromClipboardReturnNullOrUndefined,o.jb))))},e.prototype.getPasteFlowHandler=function(e){var t;try{t=this.applicationHost.getPasteFlowHandler(e)}catch(e){throw Object(o.fc)().ULS.shipAssertTag(596456208,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler failed. Exception: "+a.utils.getStringifiedError(e)),new o.H(o.I.FetchPasteFlowHandlerFailed,"applicationHost.getPasteFlowHandler failed with an exception: "+e.message,e)}if(!t){var r="CopyPasteInfra.copyPasteFlowManager.onPaste: applicationHost.getPasteFlowHandler should return an object. Try again later, when the CCP infra is loaded.";throw Object(o.fc)().ULS.shipAssertTag(596456209,a.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.H(o.I.PasteFlowHandlerNotFound,r)}return t},e.prototype.deserialize=function(e,t){return Object(o.fc)().ULS.traceTag(595683456,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t.profilingMessage("deserialize")),e.deserialize(t).catch((function(e){var t=a.utils.getStringifiedError(e);return Object(o.fc)().ULS.traceTag(596456210,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteInfra.copyPasteFlowManager.onPaste: Deserialization failed: "+t+"."),Promise.reject(new o.H(o.I.DeserializeOperationFailed,"Deserialization failed: "+t,e))}))},e.prototype.copyCompleteCleanup=function(e,t){e?(Object(o.fc)().ULS.traceTag(595734754,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: start copy complete for copy id "+e.id+"."),t&&(e.isTimestampStoredInSystemClipboard=t.isTimestampStoredInSystemClipboard),e&&this.inProgressCopyContext&&e.id===this.inProgressCopyContext.id?(this.inProgressCopyContext=void 0,e.copyStatus=o.o.Completed,Object(o.fc)().ULS.traceTag(595937159,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: updating metadata for copy id "+e.id+" after copy completed."),this.metadataManager.updateMetadata({lastCopy:e})):Object(o.fc)().ULS.traceTag(595734755,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.copyCompleteCleanup: not setting copy status to complete state for copy id "+e.id+".")):Object(o.fc)().ULS.traceTag(595734784,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.copyCompleteCleanup: no copy context.")},e.prototype.readRichClipboardOnly=function(e,t,r){return t.skipSystemClipboardAccess=!0,this.readFromClipboard(e,t).then((function(e){return Object(o.fc)().ULS.traceTag(595937160,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.readRichClipboardOnly: get clipboard items."),e}),(function(e){return Object(o.fc)().ULS.traceTag(595940942,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.readRichClipboardOnly: reading form rich clipboard failed with error: "+a.utils.getStringifiedError(e)+". use clipboard items from the first read as fallback."),Promise.resolve(r)}))},e.prototype.continueWhenCopyComplete=function(e,t){var r=this;if(!t||!t.copyContextSnapshot)return Promise.resolve(void 0);if(t.copyContextSnapshot.copyStatus===o.o.Completed)return Promise.resolve(void 0);if(this.deferredPasteData&&this.deferredPasteData.copyContextId!==t.copyContextSnapshot.id&&(Object(o.fc)().ULS.shipAssertTag(595937161,a.LogCategory.msoulscat_ES_EWAJS,!1,"CopyPasteFlowManager.continueWhenCopyComplete: deferred paste for another copy("+this.deferredPasteData.copyContextId+" !== "+t.copyContextSnapshot.id+") exist, this is not expected as we should clean deferred paste data when new copy started(both same and cross session)"),this.rejectDeferredPasteData(o.I.DeferredPasteRejectedBecauseOtherCopyCompleted)),!this.deferredPasteData){var n=this.metadataManager.getCachedMetadata();if(n&&n.lastCopy&&n.lastCopy.copyStatus===o.o.Completed&&n.lastCopy.id===t.copyContextSnapshot.id)return Object(o.fc)().ULS.traceTag(595937162,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.continueWhenCopyComplete: copy "+n.lastCopy.id+" already completed, not need for waiting any longer, reading the rich clipboard items"),this.readRichClipboardOnly(t,e,t.clipboardItems);var i=Object(o.V)(),s=i.promise.then((function(){return r.readRichClipboardOnly(t,e,t.clipboardItems)}));this.deferredPasteData={copyContextId:t.copyContextSnapshot.id,copyCompleteDeferredPromise:i,readClipboardPromise:s,numberOfDeferredPaste:0,createdDate:new Date}}return this.deferredPasteData.numberOfDeferredPaste+=1,Object(o.fc)().ULS.traceTag(595937163,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.continueWhenCopyComplete: new deferred paste created for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()),this.deferredPasteData.readClipboardPromise},e.prototype.rejectDeferredPasteData=function(e){if(this.deferredPasteData){Object(o.fc)().ULS.traceTag(595937164,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred pastes for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()+". totalTime = "+((new Date).getTime()-this.deferredPasteData.createdDate.getTime())+"ms");var t=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,t.reject(new o.H(e,"CopyPasteFlowManager.rejectDeferredPasteData: reject deferred paste"))}},e.prototype.resolveDeferredPasteData=function(){if(this.deferredPasteData){Object(o.fc)().ULS.traceTag(595937165,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.resolveDeferredPasteData: resolve deferred pastes for copy id: "+this.deferredPasteData.copyContextId+". number of deferred paste for this copy is: "+this.deferredPasteData.numberOfDeferredPaste+". first deferred paste created time: "+this.deferredPasteData.createdDate.toUTCString()+". totalTime = "+((new Date).getTime()-this.deferredPasteData.createdDate.getTime())+"ms");var e=this.deferredPasteData.copyCompleteDeferredPromise;this.deferredPasteData=void 0,e.resolve()}},e.prototype.rejectIfCopyCancelled=function(e){return e?Object(o.fc)().ULS.traceTag(595734785,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: start rejectIfCopyCancelled for copy id "+e.id+"."):Object(o.fc)().ULS.traceTag(595734786,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.rejectIfCopyCancelled: no copy context."),e&&e.markForCancellation?(Object(o.fc)().ULS.traceTag(595734787,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: reject for copy id "+e.id+"."),Promise.reject(new o.m(o.n.CopyOperationCancelled,"CopyPasteFlowManager.rejectIfCopyCancelled: Rejecting since copyContext with id "+e.id+" is marked for cancellation"))):(e&&Object(o.fc)().ULS.traceTag(595734788,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.rejectIfCopyCancelled: resolve for copy id "+e.id+"."),Promise.resolve())},e.prototype.clearInProgressCopyIfNeeded=function(e){e&&e.markForCancellation||!this.inProgressCopyContext||e&&this.inProgressCopyContext.id===e.id||(Object(o.fc)().ULS.traceTag(595937166,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.clearInProgressCopyIfNeeded: cancel previous in-progress copy (id = "+this.inProgressCopyContext.id+") as new copy started ("+e.id+")"),this.inProgressCopyContext.markForCancellation=!0,this.inProgressCopyContext=void 0)},e.prototype.onMetadataChanged=function(e){e&&e.lastCopy?(Object(o.fc)().ULS.traceTag(595937167,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: the status of copy id "+e.lastCopy.id+" from session "+e.lastCopy.sessionId+" changed to "+e.lastCopy.copyStatus),this.clearInProgressCopyIfNeeded(e.lastCopy),this.deferredPasteData&&e.lastCopy.id!==this.deferredPasteData.copyContextId&&(Object(o.fc)().ULS.traceTag(595734789,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because copy id "+e.lastCopy.id+" is not equal to "+this.deferredPasteData.copyContextId),this.rejectDeferredPasteData(o.I.DeferredPasteRejectedBecauseOtherCopyStarted)),e.lastCopy.copyStatus===o.o.Completed&&this.onCopyCompletedSuccessfully(e.lastCopy)):(Object(o.fc)().ULS.traceTag(595734790,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: no metadata or no metadata.lastCopy"),this.deferredPasteData&&(Object(o.fc)().ULS.traceTag(595724049,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onMetadataChanged: reject deferred paste because metadata update without copy context"),this.rejectDeferredPasteData(o.I.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext)))},e.prototype.onCopyCompletedSuccessfully=function(e){e?Object(o.fc)().ULS.traceTag(595734791,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"CopyPasteFlowManager.onCopyCompletedSuccessfully: start onCopyCompletedSuccessfully for copy id "+e.id+"."):Object(o.fc)().ULS.traceTag(595734792,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"CopyPasteFlowManager.onCopyCompletedSuccessfully: no copy context."),this.deferredPasteData&&e&&e.copyStatus===o.o.Completed&&e.id===this.deferredPasteData.copyContextId&&this.resolveDeferredPasteData()},e.prototype.testHook=function(e){},e}(),l=r(76);r.d(t,"createCopyPasteInfra",(function(){return s})),r.d(t,"getStringifiedError",(function(){return l.getStringifiedError})),r.d(t,"queryStringSessionIdParameter",(function(){return o.Zb})),r.d(t,"queryStringWacClusterParameter",(function(){return o.ac})),r.d(t,"htmlClipboardItem",(function(){return o.Bb})),r.d(t,"sharedClipboardSettings",(function(){return o.cc})),r.d(t,"ulsLogger",(function(){return o.fc})),r.d(t,"initLogger",(function(){return o.Eb})),r.d(t,"isClipboardPlatformErrorType",(function(){return o.Gb})),r.d(t,"isClipboardPlatformErrorTypes",(function(){return o.Hb})),r.d(t,"BaseError",(function(){return o.a})),r.d(t,"NoValidKeyError",(function(){return o.D})),r.d(t,"MissingArgumentError",(function(){return o.B})),r.d(t,"InvalidArgumentError",(function(){return o.t})),r.d(t,"InvalidOperationError",(function(){return o.u})),r.d(t,"UnsupportedError",(function(){return o.M})),r.d(t,"MismatchVersionError",(function(){return o.A})),r.d(t,"TTLClipboardDataError",(function(){return o.K})),r.d(t,"UserHashMismatchError",(function(){return o.N})),r.d(t,"UnexpectedError",(function(){return o.L})),r.d(t,"CCPError",(function(){return o.b})),r.d(t,"CopyError",(function(){return o.m})),r.d(t,"PasteError",(function(){return o.H})),r.d(t,"CancelError",(function(){return o.c})),r.d(t,"ClipboardPlatformError",(function(){return o.e})),r.d(t,"SharedClipboardError",(function(){return o.J})),r.d(t,"rethrowAfterAllActions",(function(){return o.bc})),r.d(t,"init",(function(){return o.Db})),r.d(t,"isIE",(function(){return o.Lb})),r.d(t,"isEdge",(function(){return o.Ib})),r.d(t,"isEdgeWithTextHtmlClipboardSupport",(function(){return o.Kb})),r.d(t,"isEdgeVersionWithTextHtmlWrapperSupport",(function(){return o.Jb})),r.d(t,"getWindowMessaging",(function(){return o.Ab})),r.d(t,"emptyString",(function(){return o.jb})),r.d(t,"oneSpace",(function(){return o.Xb})),r.d(t,"oneDot",(function(){return o.Wb})),r.d(t,"metadataLastCopyWasExternal",(function(){return o.Ub})),r.d(t,"metadataLastCopyWasExternalXLOSource",(function(){return o.Vb})),r.d(t,"ClipboardStrategyType",(function(){return o.i})),r.d(t,"CopyClipboardCommand",(function(){return o.j})),r.d(t,"CutClipboardCommand",(function(){return o.p})),r.d(t,"PasteClipboardCommand",(function(){return o.E})),r.d(t,"CopyClipboardEvent",(function(){return o.k})),r.d(t,"CutClipboardEvent",(function(){return o.q})),r.d(t,"PasteClipboardEvent",(function(){return o.F})),r.d(t,"addEventListener",(function(){return o.P})),r.d(t,"defaultClipboardDataFormat",(function(){return o.hb})),r.d(t,"defaultIEClipboardDataFormat",(function(){return o.ib})),r.d(t,"textHtmlClipboardDataFormat",(function(){return o.ec})),r.d(t,"imageClipboardDataFormat",(function(){return o.Cb})),r.d(t,"metadataIsLastCopyWasExternal",(function(){return o.Sb})),r.d(t,"metadataIsLastCopyWasExternalXLOSource",(function(){return o.Tb})),r.d(t,"metadataChromeExtensionId",(function(){return o.Pb})),r.d(t,"metadataInfraVersionFormat",(function(){return o.Rb})),r.d(t,"metadataCopyId",(function(){return o.Qb})),r.d(t,"metadataAdditionalSignatureDataAttributes",(function(){return o.Ob})),r.d(t,"getEmptyClipboardItemsData",(function(){return o.qb})),r.d(t,"getImmutableEmptyClipboardItems",(function(){return o.sb})),r.d(t,"getClipboardItemsDataCount",(function(){return o.ob})),r.d(t,"getClipboardItemsCount",(function(){return o.nb})),r.d(t,"createClipboardItems",(function(){return o.R})),r.d(t,"getClipboardItemContent",(function(){return o.mb})),r.d(t,"getClipboardItem",(function(){return o.lb})),r.d(t,"getDefaultClipboardData",(function(){return o.pb})),r.d(t,"getItemsFromClipboardItems",(function(){return o.tb})),r.d(t,"ClipboardStorageType",(function(){return o.g})),r.d(t,"CutCopyPasteFlags",(function(){return o.r})),r.d(t,"ClipboardPlatformErrorTypes",(function(){return o.f})),r.d(t,"CopyErrorTypes",(function(){return o.n})),r.d(t,"PasteErrorTypes",(function(){return o.I})),r.d(t,"CancelErrorTypes",(function(){return o.d})),r.d(t,"InfraInitializationErrorTypes",(function(){return o.s})),r.d(t,"getSharedClipboardValidatedOrigin",(function(){return o.xb})),r.d(t,"validateRemoteWindowOrigin",(function(){return o.jc})),r.d(t,"NoUserHash",(function(){return o.C})),r.d(t,"shouldClearClipboard",(function(){return o.dc})),r.d(t,"createMessageId",(function(){return o.bb})),r.d(t,"createContextId",(function(){return o.U})),r.d(t,"getCanonicalValidatedMessageId",(function(){return o.kb})),r.d(t,"createClipboardOperationMessage",(function(){return o.S})),r.d(t,"MessageDestinationConst",(function(){return o.z})),r.d(t,"isValidClipboardOperationCode",(function(){return o.Nb})),r.d(t,"validateClipboardOperationMessage",(function(){return o.hc})),r.d(t,"createClipboardOperationResultMessage",(function(){return o.T})),r.d(t,"validateClipboardOperationResultMessage",(function(){return o.ic})),r.d(t,"ClipboardStrategyBase",(function(){return o.h})),r.d(t,"createDeferredPromise",(function(){return o.V})),r.d(t,"createDeferredPromiseCache",(function(){return o.W})),r.d(t,"createDisposableImplementationExtension",(function(){return o.X})),r.d(t,"createMessageDeserializer",(function(){return o.ab})),r.d(t,"createMessageSerializer",(function(){return o.cb})),r.d(t,"initMessageIdPrefix",(function(){return o.Fb})),r.d(t,"unknownMessageId",(function(){return o.gc})),r.d(t,"queryStringCreatorOriginParameter",(function(){return o.Yb})),r.d(t,"getValidatedRemoteWindow",(function(){return o.yb})),r.d(t,"WindowRPCBase",(function(){return o.O})),r.d(t,"createWindowRPCServerReceiver",(function(){return o.fb})),r.d(t,"createWindowRPCClientReceiver",(function(){return o.db})),r.d(t,"createWindowRPCServerSender",(function(){return o.gb})),r.d(t,"createWindowRPCClientSender",(function(){return o.eb})),r.d(t,"LocalStorageChangedEventFlagPostfix",(function(){return o.v})),r.d(t,"isLocalStorageSupported",(function(){return o.Mb})),r.d(t,"getLocalStorageDataKey",(function(){return o.ub})),r.d(t,"getLocalStorageMetadataKey",(function(){return o.vb})),r.d(t,"getLocalStorageMetadataKeyToWatch",(function(){return o.wb})),r.d(t,"CopyContext",(function(){return o.l})),r.d(t,"PasteContext",(function(){return o.G})),r.d(t,"CopyStatus",(function(){return o.o})),r.d(t,"getEmptyMetadata",(function(){return o.rb})),r.d(t,"cloneMetadata",(function(){return o.Q})),r.d(t,"getWindowLocation",(function(){return o.zb})),r.d(t,"createLocalStorageClipboardStrategy",(function(){return o.Z})),r.d(t,"LocalStorageClipboardStrategy",(function(){return o.x})),r.d(t,"createLocalStorageClipboardStorage",(function(){return o.Y})),r.d(t,"LocalStorageClipboardStorage",(function(){return o.w})),r.d(t,"LocalStorageKeyChangeTracker",(function(){return o.y}))},4:function(e,t,r){"use strict";var o={};r.r(o),r.d(o,"sharedClipboardSettingsVariableName",(function(){return le})),r.d(o,"defaultPromiseTimeoutInMinutes",(function(){return pe})),r.d(o,"getSharedClipboardSettings",(function(){return ge})),r.d(o,"initializeSharedClipboardSettingsFromWindow",(function(){return fe})),r.d(o,"initializeSharedClipboardSettings",(function(){return me})),r.d(o,"createEmptySharedClipboardSettings",(function(){return ye}));var n={};r.r(n),r.d(n,"divTagName",(function(){return At})),r.d(n,"preTagName",(function(){return xt})),r.d(n,"tableTagName",(function(){return Ot})),r.d(n,"trTagName",(function(){return Ft})),r.d(n,"tdTagName",(function(){return Mt})),r.d(n,"ccpTimestampHtmlCustomAttributeName",(function(){return Nt})),r.d(n,"minCcpTimestampHtmlCustomAttributeValue",(function(){return Rt})),r.d(n,"ensureOneLFPerNewLine",(function(){return Ht})),r.d(n,"trimToLength",(function(){return kt})),r.d(n,"createTextHtmlFromTextPlain",(function(){return Vt})),r.d(n,"createHtmlItemFromTextPlain",(function(){return zt})),r.d(n,"createPlainTextFromHtml",(function(){return Bt})),r.d(n,"isContainsTimestampWrapper",(function(){return Gt})),r.d(n,"addClipboardWrapperForEdge",(function(){return qt})),r.d(n,"getFragmentFromTextHtml",(function(){return Xt})),r.d(n,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return Qt})),r.d(n,"getExternalSource",(function(){return Yt})),r.d(n,"encodeAngleBrackets",(function(){return Zt})),r.d(n,"wrapContentWithTagAndAttributes",(function(){return $t}));var a,i=r(1);function s(){return a}function c(e){if(!e)throw new Error("The 'logger' argument is missing");a=i.ULS.getFromExternalLogger(e)}var l,d,u,p,g,f=r(8);function m(e,t){return h(e,[t])}function h(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var y=function(e){function t(r,o,n){var a=this,c=t.augmentParameterValue(r);if((a=e.call(this,c)||this).name=t.augmentParameterValue(o),a.errorName=a.name,a.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+a.name+"': "+c):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+c),n){a.innerError=n;var l=a.innerError.message;l||(l=a.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+d)}return a.stack||(a.stack=(new Error).stack),a}return Object(f.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),C=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(f.__extends)(t,e),t}(y),S=function(e){function t(r,o,n){var a=this,i=y.augmentParameterValue(o),s=t.getDefaultMessage(i),c=y.augmentParameterValue(r);return 0===c.length&&(c=s),(a=e.call(this,c,"MissingArgumentError",n)||this).name=i,a}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(y),b=function(e){function t(r,o,n,a){var i=this,s=y.augmentParameterValue(o),c=n;c||(c="");var l=t.getDefaultMessage(s,c),d=y.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",a)||this).name=s,i.value=c,i}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(y),w=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(f.__extends)(t,e),t}(y),v=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return Object(f.__extends)(t,e),t}(y),E=function(e){function t(t,r,o,n,a){return e.call(this,t+". Data version: "+r+", Infra version: "+o+", blockMismatchDataVersion: "+n,"MismatchVersionError",a)||this}return Object(f.__extends)(t,e),t}(y),L=function(e){function t(t,r,o,n){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+o,"TTLClipboardDataError",n)||this}return Object(f.__extends)(t,e),t}(y),P=function(e){function t(t,r,o,n){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+o,"UserHashMismatchError",n)||this}return Object(f.__extends)(t,e),t}(y),T=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return Object(f.__extends)(t,e),t}(y);function _(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var I=function(e){function t(t,r,o,n,a){var i=e.call(this,r||"reason="+t,o,n)||this;return i.reason=t,a&&(i.errorName=a),i}return Object(f.__extends)(t,e),t}(y),A=function(e){function t(t,r,o){return e.call(this,t,r,"CopyError",o,_(t,u))||this}return Object(f.__extends)(t,e),t}(I),x=function(e){function t(t,r,o){return e.call(this,t,r,"PasteError",o,_(t,p))||this}return Object(f.__extends)(t,e),t}(I),O=function(e){function t(t,r,o){return e.call(this,t,r,"CancelError",o,_(t,g))||this}return Object(f.__extends)(t,e),t}(I),F=function(e){function t(t,r,o){return e.call(this,t,r,"ClipboardPlatformError",o,_(t,d))||this}return Object(f.__extends)(t,e),t}(I),M=function(e){function t(t,r,o){return e.call(this,t,r,"SharedClipboardError",o,_(t,d))||this}return Object(f.__extends)(t,e),t}(I);function j(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new w(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")})),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function W(){return U}var U={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:""},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:""}},D={};function J(){D={}}var N=new RegExp("(\\bTrident/| MSIE )"),R=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function H(){if(void 0===D.isIEProperty){D.isIEProperty=!1;var e=W();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(N);r&&2===r.length&&(D.isIEProperty=!0)}}}return D.isIEProperty}function k(){if(void 0===D.isEdgeProperty){D.isEdgeProperty=!1,D.isEdgeWithTextHtmlClipboardSupportProperty=!1,D.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=W();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(R);if(r&&2===r.length){D.isEdgeProperty=!0;var o=Number(r[1]);isNaN(o)||(o>=16.16299&&(D.isEdgeWithTextHtmlClipboardSupportProperty=!0),o>=17.17123&&(D.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return D.isEdgeProperty}function V(){return k()&&D.isEdgeWithTextHtmlClipboardSupportProperty}function z(){return k()&&D.isEdgeVersionWithTextHtmlWrapperSupportProperty}function B(){return K}var K={postMessage:function(e,t,r,o){e.postMessage(t,r,o)}},G=function(e,t,r,o){return void 0===o&&(o=!1),e.addEventListener(t,r,o),function(){e.removeEventListener(t,r,o)}};function q(){return{items:{}}}var X,Q,Y,Z,$=(X={items:{}},{getData:function(){return X},getItem:function(e){},setItem:function(e,t){throw new w("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":"")+"empty)")},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return ce(void 0)}});function ee(){return $}function te(e){return e&&e.items?Object.keys(e.items).length:0}function re(e){return te(e&&e.getData())}function oe(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return ne(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new b("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return ce(t)}}}function ne(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new b("","clipboardItemsData.items");return e.items[t]}function ae(e,t){if(!e||0===e.length||!t||!t.trim())return"";var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||""}function ie(e){return ae(e,"text/plain")}function se(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:"text/plain",data:""}),t}function ce(e){var t=[];if(0===te(e))return t;for(var r in e.items){var o=ne(e,r);o||(o="");var n={clipboardDataFormat:r,data:o,deferred:!1};t.push(n)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(Q||(Q={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(Y||(Y={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Z||(Z={}));var le="sharedClipboardSettings",de=ye(),ue=!1,pe=2;function ge(){if(!ue)throw new w("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return de}function fe(){ue=!1,function(){if(!window||!(le in window))return de=ye(),void(ue=!0);var e=window[le];if(!e||"object"!=typeof e)return de=ye(),void(ue=!0);he(e)}()}function me(e){ue=!1,he(e)}function he(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");var t=ye();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return de=t,void(ue=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),de=t,void(ue=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,o=r.indexOf("-");o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],de=t,void(ue=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],de=t,void(ue=!0)}t.whitelistOriginComponents=!0,de=t,ue=!0}function ye(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:pe,remoteLoggerPath:""}}function Ce(){var e="";return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=""):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var Se,be,we=new RegExp("^\\d+$"),ve=!1;function Ee(e){if(!e)throw new S("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new b("Missing protocol","origin",e);if(1===r.length)throw new b("Missing domain","origin",e);if(r.length>2)throw new b("'://' should appear once","origin",e);var o=r[1];if(!o)throw new b("Missing domain","origin",e);if(t=r[0]+"://",!(r=(o=o.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new b("Missing domain","origin",e);if(r.length>2)throw new b("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new b("The last part of the origin should be the domain","origin",e);if(!(r=o.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new b("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new b("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=o=r[0].trim(),2===r.length){var n=r[1].trim(),a=we.exec(n);if(!a||1!==a.length)throw new b("Invalid port number","origin",e);var c=Number(n);if(isNaN(c))throw new b("Invalid port number","origin",e);t+=":"+n}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+t+"'"),t}function Le(e){Ae();var t=Ee(e),r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new b("Invalid origin","parentOrigin",e);var o=ge(),n="";if(o.whitelistOriginComponents){var a=r[0]+"://";if(!(r=r[1].split("."))||r.length<2||!r[0])throw new b("Invalid origin","parentOrigin",e);r.splice(0,1,o.sharedClipboardHostingApp),n=a+r.join(".")}else n=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '"+e+"'; Shared Clipboard iframe origin = '"+n+"' components="+JSON.stringify(r)),n}function Pe(e){Ae();var t=Ee(e),r=Ee(Ce().origin);if(t===r)return t;if(!ge().whitelistOriginComponents)throw new w("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+r+"'");var o=Te(t),n=Te(r);if(o.protocol!==n.protocol)throw new w("validateRemoteWindowOrigin: Caller origin's protocol '"+o.protocol+"' doesn't match the current window origin's protocol '"+n.protocol+"'");if(o.environment!==n.environment)throw new w("validateRemoteWindowOrigin: Caller origin's environment '"+o.environment+"' doesn't match the current window origin's environment '"+n.environment+"'");return t}function Te(e){Ae();var t=e.split("://",2),r=t[0],o=_e(t[1]),n={protocol:r};if(n.environment=Ie(e,o,be),o.length<=n.environment.length+1)throw new b("Missing app component","origin",e);if("."!==o.charAt(n.environment.length))throw new b("Missing a domain separator after the environment component","origin",e);var a=o.substr(n.environment.length+".".length);if(n.app=Ie(e,a,Se),n.app.length<a.length&&"-"!==a.charAt(n.app.length))throw new b("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return n}function _e(e){if(!e)throw new S("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Ie(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");var o=t.length,n=Object.keys(r).filter((function(e){var n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return _e(n[0]);throw new b("Invalid origin","validatedOrigin",e)}function Ae(){if(!ve){var e=ge();e.whitelistOriginComponents&&(Se=xe(e.sharedClipboardHostingApps),be=xe(e.sharedClipboardHostingEnvironments),ve=!0)}}function xe(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[_e(e)]=e.length})),t):t}function Oe(e,t){return null==e||1===e||null==t||e!==t}function Fe(){return We()}function Me(){return We()}function je(e){if(!e)throw new S("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new b("","id");return t}function We(){return(Math.random()+1).toString(36).substring(7)}function Ue(e,t,r,o,n){var a={id:e,operationCode:t,destination:r,userHash:o,clipboardItemsData:n};return Ne(a),a}var De=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function Je(e){return"get"===e||"set"===e||"init"===e}var Ne=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!Je(e.operationCode))throw new b("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function Re(e,t,r,o,n){var a={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return He(a),a}var He=function(e){if(!e)throw new S("","clipboardOperationResultMessage");if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5551760_FixTag99sq1Spike2")){for(var t=!1,r=0,o=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<o.length;r++){var n=o[r];if(e.hasOwnProperty(n)){t=!0;break}}if(!t)throw new C("clipboardOperationResultMessage has no valid key")}if(!e.id||0===e.id.trim().length)throw Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5323309_LogsToInvestigate99sq1Spike")?s().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: "+JSON.stringify(Object.keys(e))+", isConstructorObject: "+(e.constructor===Object)+", operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."):s().ULS.traceTag(560562970,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Missing argument 'id'. operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."),new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new b("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new b("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new b("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new b("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new b("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function ke(e){if(!e||0===e.trim().length)throw new b("","className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new w(r(e))}}}()}var Ve=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=ke(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)}),(function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new F(d.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new F(d.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(ee(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new F(d.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),ze=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Be(e){var t=e;return t&&0!==t.trim().length||(t=Fe()),new Xe(t)}function Ke(){return ze?window.performance.now():Date.now()}function Ge(e){return ze?new Date(e+window.performance.timing.navigationStart):new Date(e)}function qe(e,t,r){if(!r)throw new S("","creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":Ke()-r)+"ms"}var Xe=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=je(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Ke(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+Ge(this.creationTimestamp)),this.promise=new Promise((function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+Ge(Ke())),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Ke(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+qe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+Ge(this.fulfillmentTimestamp)+". "+qe(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();function Qe(){return new Ye}var Ye=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=je(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=Be(e);if(this.getDeferredPromise(t.id))throw new b("A deferred promise already exists in the cache for the specified id","id",t.id);var r=je(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=je(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}},e}();function Ze(e){if(!e)throw new S("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new b("An empty message is invalid","incomingMessage");var r,o=e.trim();if(0===o.length)throw new b("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(o)}catch(t){throw new b("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new b("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function $e(e){if(!e)throw new S("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new b("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function et(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");var t=Pe(e.windowOrigin);return{window:e.window,windowOrigin:t}}var tt=function(){function e(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=ke(o)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(j([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new w(t)}this.sender.postMessage(e)},e}();function rt(){return ot}var ot={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function nt(e,t,r){return new it(e,t,r)}function at(e,t,r){return new it(e,t,r)}var it=function(){function e(e,t,r){var o=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return o.onMessageReceived(e)},!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=ke("WindowRPCReceiverInternal"),this.remoteWindow=et(r.remoteWindow),rt().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(rt().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5405878_LogsToInvestigate99sq1Spike2")&&s().ULS.traceTag(544609310,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"this.remoteWindow.window is "+(this.remoteWindow.window?"defined":"not defined")+"."),this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(e)}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}))}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function st(e,t){return new lt(e,t)}function ct(e,t){return new lt(e,t)}var lt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=ke("WindowRPCSenderInternal"),this.remoteWindow=et(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new w("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new w("The remote window does not support postMessage");var t=this.serializer.serialize(e);B().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function dt(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function ut(e){return"OfficeOnlineCCP_Data_"+e}function pt(e){return"OfficeOnlineCCP_Metadata_"+e}function gt(e){return pt(e)+"_LocalStorageChangedFlag"}var ft,mt=function(){this.copyStatus=ft.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0},ht=function(){function e(){this.startTime=i.perfWatch.timeStamp()}return e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: "+e+", pasteId: "+this.id+", timeMS: "+t.toFixed()},e}();function yt(){return{}}function Ct(e){var t=void 0;return e&&e.lastCopy&&(t=Object(f.__assign)({},e.lastCopy)),{lastCopy:t}}function St(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+Q.LocalStorage+"'");var t=new bt(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(ft||(ft={}));var bt=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new F(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new F(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Q.LocalStorage,this.disposableImplementationExtension=ke("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='"+(e?e.id:"")+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(ee());try{var r=JSON.parse(t);if(!r||0===te(r))return Promise.resolve(ee());var o=oe(r);return Promise.resolve(o)}catch(e){return Promise.resolve(ee())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+re(e)+"'; commandParameters.id='"+(t?t.id:"")+"'"),0===re(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=this.localStorageKey+"_LocalStorageChangedFlag",o=Fe();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+o),localStorage.setItem(r,o),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function wt(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+l.LocalStorage+"' with localStorageKey: '"+e+"'"),(new vt).initialize(St(e))}var vt=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(f.__extends)(t,e),t}(Ve),Et=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)}),(function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=Be(),o=new Date,n=setInterval((function(){var a=(new Date).getTime()-o.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(n),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):a>e&&(clearInterval(n),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+o+". elapseTime = "+a+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())}),200);return r.promise},e}(),Lt="\n",Pt=new RegExp("(\n\r)|(\r\n)|(\r)","g"),Tt=new RegExp("(\t)","g"),_t=new RegExp("<","g"),It=new RegExp(">","g"),At="div",xt="pre",Ot="table",Ft="tr",Mt="td",jt="\x3c!--EndFragment--\x3e",Wt="\x3c!--StartFragment--\x3e".length,Ut=jt.length,Dt="Version:0.9\nStartHTML:0000000100\nEndHTML:{EndHTML0}\nStartFragment:0000000134\nEndFragment:{EndFragm}\n<html>\n<body>\n\x3c!--StartFragment--\x3e\n",Jt="</html>".length,Nt="data-ccp-timestamp",Rt=0;function Ht(e){return e?e.replace(Pt,Lt):e}function kt(e){return e?e.length<=10240?e:e.substr(0,10240):""}function Vt(e){var t,r=Zt(e),o=function(e){return e?e.replace(Pt,"</"+Mt+"></"+Ft+"><"+Ft+"><"+Mt+">"):e}((t=r)?t.replace(Tt,"</"+Mt+"><"+Mt+">"):t);return"<"+Ot+"><"+Ft+"><"+Mt+">"+o+"</"+Mt+"></"+Ft+"></"+Ot+">"}function zt(e,t,r){if(r!==Rt&&!r)throw new S("","timestamp");if(isNaN(r))throw new b("","timestamp",r.toString());return qt(function(e,t,r){return"<"+e+" "+Nt+"='"+r+"'>"+t+"</"+e+">"}(e,Vt(t),r))}function Bt(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var o=Kt(r[0]);t.push(o);for(var n=1;n<r.length;n+=1){t.push("\r"),t.push(Lt);var a=Kt(r[n]);t.push(a)}}return t.join("")}function Kt(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var o=1;o<r.length;o+=1)t.push("\t"),t.push(r[o].innerText)}return t.join("")}function Gt(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Nt)}function qt(e){if(!k()||z())return e;var t="0000000000".length,r=Dt.length+e.length+"\x3c!--EndFragment--\x3e\n</body>\n</html>".length,o=(r-"\x3c!--EndFragment--\x3e\n</body>\n</html>".length).toString();if(o.length<t&&(o="0000000000".substr(0,t-o.length)+o),o.length!==t){var n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is "+o.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new F(d.UnexpectedClipboardTextHtmlContentLength,n)}var a=(r-Jt).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){n="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is "+a.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,n),new F(d.UnexpectedClipboardTextHtmlContentLength,n)}var c=Dt.replace("{EndHTML0}",a).replace("{EndFragm}",o)+e+"\x3c!--EndFragment--\x3e\n</body>\n</html>";return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of "+c.length+" differs from the expected length of "+r),c}function Xt(e){if(!e)return"";if(!e.trim())return e;var t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf(jt);if(t<0||r<0||t>r)return e;var o=t+Wt,n=r-o,a=e.indexOf("\x3c!--StartFragment--\x3e",o),i=e.indexOf(jt,r+Ut);return a>=0||i>=0?e:e.substr(o,n)}function Qt(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new S("","attributeName");var r=new RegExp(t+"=['\"](\\d+)['\"]","i").exec(e);if(!r||r.length<2)return;return r[1]}(e,Nt);if(t&&t.trim()){var r=Number(t);if((r||r===Rt)&&!isNaN(r))return r}}function Yt(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var o=t[r];if("ProgId"===o.getAttribute("name")){var n=o.getAttribute("content");if(null!==n){if(n.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(n.startsWith("Word"))return"Word Desktop";if(n.startsWith("Excel"))return"Excel Desktop";if(n.startsWith("PowerPoint"))return"PowerPoint Desktop";if(n.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}return}(t);if(void 0!==r)return r;var o=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var o=t.classList[r];if(o.startsWith("SCXO"))return"OneNote Online";if(o.startsWith("SCXP"))return"PowerPoint Online";if(o.startsWith("SCXW"))return"Word Online"}return}(t);return void 0!==o?o:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];if(null!=r&&null!=r.id&&null!=r.id.startsWith&&r.id.startsWith("docs-internal-guid-"))return!0;return!1}(t)?"Google Docs":void 0}}function Zt(e){return e?e.replace(_t,"&lt;").replace(It,"&gt;"):""}function $t(e,t,r){var o="";return r&&(o=Object.keys(r).reduce((function(e,t){return t?e+" "+t+"='"+r[t]+"'":e}),"")),"<"+t+o+">"+e+"</"+t+">"}r.d(t,"fc",(function(){return s})),r.d(t,"Eb",(function(){return c})),r.d(t,"Gb",(function(){return m})),r.d(t,"Hb",(function(){return h})),r.d(t,"a",(function(){return y})),r.d(t,"D",(function(){return C})),r.d(t,"B",(function(){return S})),r.d(t,"t",(function(){return b})),r.d(t,"u",(function(){return w})),r.d(t,"M",(function(){return v})),r.d(t,"A",(function(){return E})),r.d(t,"K",(function(){return L})),r.d(t,"N",(function(){return P})),r.d(t,"L",(function(){return T})),r.d(t,"b",(function(){return I})),r.d(t,"m",(function(){return A})),r.d(t,"H",(function(){return x})),r.d(t,"c",(function(){return O})),r.d(t,"e",(function(){return F})),r.d(t,"J",(function(){return M})),r.d(t,"bc",(function(){return j})),r.d(t,"Db",(function(){return J})),r.d(t,"Lb",(function(){return H})),r.d(t,"Ib",(function(){return k})),r.d(t,"Kb",(function(){return V})),r.d(t,"Jb",(function(){return z})),r.d(t,"Ab",(function(){return B})),r.d(t,"jb",(function(){return""})),r.d(t,"Xb",(function(){return" "})),r.d(t,"Wb",(function(){return"."})),r.d(t,"Ub",(function(){return"1"})),r.d(t,"Vb",(function(){return"1"})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return"copy"})),r.d(t,"p",(function(){return"cut"})),r.d(t,"E",(function(){return"paste"})),r.d(t,"k",(function(){return"copy"})),r.d(t,"q",(function(){return"cut"})),r.d(t,"F",(function(){return"paste"})),r.d(t,"P",(function(){return G})),r.d(t,"hb",(function(){return"text/plain"})),r.d(t,"ib",(function(){return"Text"})),r.d(t,"ec",(function(){return"text/html"})),r.d(t,"Cb",(function(){return"image/png"})),r.d(t,"Sb",(function(){return"metadata/is-last-copy-was-external"})),r.d(t,"Tb",(function(){return"metadata/is-last-copy-was-external-XLO-source"})),r.d(t,"Pb",(function(){return"metadata/chrome-extension-id"})),r.d(t,"Rb",(function(){return"metadata/ccp-infra-version"})),r.d(t,"Qb",(function(){return"copyId"})),r.d(t,"Ob",(function(){return"metadata/additional-signature-data-attributes"})),r.d(t,"qb",(function(){return q})),r.d(t,"sb",(function(){return ee})),r.d(t,"ob",(function(){return te})),r.d(t,"nb",(function(){return re})),r.d(t,"R",(function(){return oe})),r.d(t,"mb",(function(){return ne})),r.d(t,"lb",(function(){return ae})),r.d(t,"pb",(function(){return ie})),r.d(t,"tb",(function(){return se})),r.d(t,"g",(function(){return Q})),r.d(t,"r",(function(){return Y})),r.d(t,"f",(function(){return d})),r.d(t,"n",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"s",(function(){return Z})),r.d(t,"xb",(function(){return Le})),r.d(t,"jc",(function(){return Pe})),r.d(t,"C",(function(){return 1})),r.d(t,"dc",(function(){return Oe})),r.d(t,"bb",(function(){return Fe})),r.d(t,"U",(function(){return Me})),r.d(t,"kb",(function(){return je})),r.d(t,"S",(function(){return Ue})),r.d(t,"z",(function(){return De})),r.d(t,"Nb",(function(){return Je})),r.d(t,"hc",(function(){return Ne})),r.d(t,"T",(function(){return Re})),r.d(t,"ic",(function(){return He})),r.d(t,"h",(function(){return Ve})),r.d(t,"V",(function(){return Be})),r.d(t,"W",(function(){return Qe})),r.d(t,"X",(function(){return ke})),r.d(t,"ab",(function(){return Ze})),r.d(t,"cb",(function(){return $e})),r.d(t,"Fb",(function(){return"initmessageid"})),r.d(t,"gc",(function(){return"unknownmessageid"})),r.d(t,"Yb",(function(){return"CreatorOrigin"})),r.d(t,"yb",(function(){return et})),r.d(t,"O",(function(){return tt})),r.d(t,"fb",(function(){return nt})),r.d(t,"db",(function(){return at})),r.d(t,"gb",(function(){return st})),r.d(t,"eb",(function(){return ct})),r.d(t,"v",(function(){return"_LocalStorageChangedFlag"})),r.d(t,"Mb",(function(){return dt})),r.d(t,"ub",(function(){return ut})),r.d(t,"vb",(function(){return pt})),r.d(t,"wb",(function(){return gt})),r.d(t,"l",(function(){return mt})),r.d(t,"G",(function(){return ht})),r.d(t,"o",(function(){return ft})),r.d(t,"rb",(function(){return yt})),r.d(t,"Q",(function(){return Ct})),r.d(t,"zb",(function(){return Ce})),r.d(t,"Z",(function(){return wt})),r.d(t,"x",(function(){return vt})),r.d(t,"Y",(function(){return St})),r.d(t,"w",(function(){return bt})),r.d(t,"y",(function(){return Et})),r.d(t,"Zb",(function(){return"usid"})),r.d(t,"ac",(function(){return"WacCluster"})),r.d(t,"Bb",(function(){return n})),r.d(t,"cc",(function(){return o}))},67:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,o){return t.traceTag(0,e,r,o)},traceTag:function(e,r,o,n){return t.traceTag(e,r,o,n)},debugTrace:function(e,r,o){return t.debugTraceTag(0,e,r,o)},debugTraceTag:function(e,r,o,n){return t.debugTraceTag(e,r,o,n)},assert:function(e,r,o){return t.assertTag(0,e,r,o)},assertTag:function(e,r,o,n){return t.assertTag(e,r,o,n)},shipAssert:function(e,r,o){return t.shipAssertTag(0,e,r,o)},shipAssertTag:function(e,r,o,n){return t.shipAssertTag(e,r,o,n)},dnmTrace:function(e,r,o){return t.dnmTraceTag(0,e,r,o)},dnmTraceTag:function(e,r,o,n){return t.dnmTraceTag(e,r,o,n)}}}}};var o=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)},e.prototype.assertTag=function(e,t,r,o){console.assert(r,"assertTag",e,t,o)},e.prototype.traceTag=function(e,t,r,o){console.log("traceTag",e,o,t,r)},e.prototype.dnmTraceTag=function(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)},e.prototype.debugTraceTag=function(e,t,r,o){console.log("debugTraceTag",e,o,t,r)},e}();t.ConsoleLogger=o;var n=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=n},76:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,o){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(o,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var o={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])}));var n=Object.getPrototypeOf(t);n&&"object"==typeof n&&Object.keys(n).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])}));var a={};return Object.keys(o).forEach((function(t){a[t]=e(o[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var o=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(o,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),o=function(t){r=r.catch((function(r){return e(t,r)}))},n=1;n<=t;n+=1)o(n);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),o=function(o){var n=e[o];r=r.catch((function(){return t(n)}))},n=1;n<e.length;n+=1)o(n);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,o=e.length,n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var o=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(o=a.offset,n=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(o=a.startOffset,n=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;n=document.elementFromPoint(e,t),(a=document.body.createTextRange()).moveToPoint(e,t);var i=document.body.createTextRange();i.moveToElementText(n),i.setEndPoint("EndToStart",a),o=i.text.length}catch(e){return o}if(r)for(var s=!1;null!=n;)null===n.previousSibling&&null!==n.parentNode&&null!==n.parentNode.parentNode&&n.parentNode.parentNode.childNodes.length>1&&!s?(n=n.parentNode,s=!0):null!=(n=n.previousSibling)&&null!=n.textContent&&(o+=n.textContent.length,s&&(o+=1));else for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(o+=n.textContent.length);return o},t.getBoundingRectForText=function(e,t,r,o){function n(e,t,r){if(!e||!e.textContent)return t;if(o&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,i=0;i<a.length&&t>=0;i+=1)t=n(a[i],t,r),o&&"DIV"===a[i].nodeName&&(t-=1);return t}void 0===o&&(o=!1);var a=document.createRange();return n(e,t,(function(e,t){return a.setStart(e,t)})),n(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},8:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return n})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return l})),r.d(t,"__awaiter",(function(){return d})),r.d(t,"__generator",(function(){return u})),r.d(t,"__createBinding",(function(){return p})),r.d(t,"__exportStar",(function(){return g})),r.d(t,"__values",(function(){return f})),r.d(t,"__read",(function(){return m})),r.d(t,"__spread",(function(){return h})),r.d(t,"__spreadArrays",(function(){return y})),r.d(t,"__spreadArray",(function(){return C})),r.d(t,"__await",(function(){return S})),r.d(t,"__asyncGenerator",(function(){return b})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return v})),r.d(t,"__makeTemplateObject",(function(){return E})),r.d(t,"__importStar",(function(){return P})),r.d(t,"__importDefault",(function(){return T})),r.d(t,"__classPrivateFieldGet",(function(){return _})),r.d(t,"__classPrivateFieldSet",(function(){return I}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function s(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,o){t(r,o,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,o){return new(r||(r=Promise))((function(n,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}))}function u(e,t){var r,o,n,a,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(n=i.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){i.label=a[1];break}if(6===a[0]&&i.label<n[1]){i.label=n[1],n=a;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(a);break}n[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var p=Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function g(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||p(t,e,r)}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)i.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,n++)o[n]=a[i];return o}function C(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||s(e,t)}))})}function s(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(c,l):d(a[0][2],r)}catch(e){d(a[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function w(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:S(e[o](t)),done:"return"===o}:n?n(t):t}:n}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){(function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)})(o,n,(t=e[r](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var L=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return L(t,e),t}function T(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function I(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}},84:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var o={};t.promises=function(){return void 0===o.promises&&(o.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),o.promises}},85:function(e,t,r){"use strict";function o(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,r){e[t]=o()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=o(),r=e,a=t,i={},s=function(e,t,o){return function(e,t,r,o,a,i){n(e,"end",r);var s={sessionName:t,result:o?"success":"failure",message:i,marks:e},c=JSON.stringify(s);a(c)}(i,r,a,e,t,o)};return i.start=0,{mark:function(e){return function(e){return n(i,e,a)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=o},94:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var o=r(95),n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");o.setChangeGatesManager({isChangeGateEnabled:e.isChangeGateEnabled}),n=e}},95:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(8);o.__exportStar(r(96),t),o.__exportStar(r(97),t)},96:function(e,t,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){o=e};t.isChangeGateEnabled=function(e){return!o||o.isChangeGateEnabled(e)}},97:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},98:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var o=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(o=function(){return self.performance.now()}),function(r){var n=o(),a=r;return{reset:function(e){null!=e&&(a=e),n=o()},stop:function(r){var i=o()-n,s=JSON.stringify({Target:a,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},99:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var o=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=o}});
//# sourceMappingURL=copyPasteInfra.min.js.map